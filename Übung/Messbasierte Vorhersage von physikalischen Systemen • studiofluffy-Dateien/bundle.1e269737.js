/*! For license information please see bundle.1e269737.js.LICENSE.txt */
(()=>{var __webpack_modules__={6916:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(47),n=/^#(?:[0-9a-f]{3}){1,2}$/i,s=hexToRgb("#2F2F2F");function safeToLowerCase(e){return e&&"string"==typeof e?e.toLowerCase():""}function isValidHexColor(e){return n.test(safeToLowerCase(e))}t.isValidHexColor=isValidHexColor;var a=/^rgb\((( *0*([1]?[\d]?[\d]|2[0-4][\d]|25[0-5]) *),){2}( *0*([1]?[\d]?[\d]|2[0-4][\d]|25[0-5]) *)\)$/;function isValidRgbString(e){return a.test(safeToLowerCase(e))}t.isValidRgbString=isValidRgbString;var o=/^rgba\((( *0*([1]?[\d]?[\d]|2[0-4][\d]|25[0-5]) *),\s?){3}( *0*(0?\.[\d]+|0|1|1\.0) *)\)$/;function isValidRgbaString(e){return o.test(safeToLowerCase(e))}t.isValidRgbaString=isValidRgbaString;var l=/#(.)(.)(.)/;function normalizeHex(e){if(!isValidHexColor(e))throw Error(e+" is not a valid hex color");var t=e;return 4===t.length&&(t=t.replace(l,"#$1$1$2$2$3$3")),t.toLowerCase()}function str2rgba(e){if(!e||"string"!=typeof e)throw new Error("You must provide a string to str2rgba");if("transparent"===e)return{r:0,g:0,b:0,a:0};if(isValidHexColor(e)){var t=normalizeHex(e);return{r:r.safeParseInt(t.substr(1,2),16),g:r.safeParseInt(t.substr(3,2),16),b:r.safeParseInt(t.substr(5,2),16),a:1}}if(isValidRgbString(e)||isValidRgbaString(e)){var i=e.split(/\(|\)|,/g);return{r:r.safeParseInt(i[1],10),g:r.safeParseInt(i[2],10),b:r.safeParseInt(i[3],10),a:r.safeParseFloat(i[4]||"1",1)}}throw new Error("You must provide a valid color to str2rgba. "+e+" was provided")}function hexToRgb(e){var t=normalizeHex(e);return[parseInt(t.substr(1,2),16),parseInt(t.substr(3,2),16),parseInt(t.substr(5,2),16)]}function fromStyleString(e){var t=e.replace(/\s/gi,"").toLowerCase();return isValidRgbString(t)||isValidRgbaString(t)?t.match(/\d+(\.\d+)?/gi).map(parseFloat).slice(0,3):hexToRgb(t)}function rgbToHex(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var i=Number(e[0]),n=Number(e[1]),s=Number(e[2]);if(isNaN(i)||i<0||i>255||isNaN(n)||n<0||n>255||isNaN(s)||s<0||s>255)throw Error('"('+i+","+n+","+s+'") is not a valid RGB color');var a=r.prependZeroIfNecessary(i.toString(16)),o=r.prependZeroIfNecessary(n.toString(16)),l=r.prependZeroIfNecessary(s.toString(16));return"#"+a+o+l}function rgbArrayToHex(e){return rgbToHex(e[0],e[1],e[2])}function yiqBrightness(e){return Math.round((299*e[0]+587*e[1]+114*e[2])/1e3)}function yiqBrightnessDiff(e,t){return Math.abs(yiqBrightness(e)-yiqBrightness(t))}function colorDiff(e,t){return Math.abs(e[0]-t[0])+Math.abs(e[1]-t[1])+Math.abs(e[2]-t[2])}function highContrast(e,t){for(var i=[],r=0;r<t.length;)i.push({color:t[r],diff:yiqBrightnessDiff(t[r],e)+colorDiff(t[r],e)}),r+=1;return i.sort((function(e,t){return t.diff-e.diff})),i[0].color}function blend(e,t,i){var n=r.clamp(i,0,1);return e.map((function(e,i){var r=t[i];return Math.round(n*e+(1-n)*r)}))}function darken(e,t,i){if(void 0===i&&(i="classic"),"default"===i)return blend(s,e,t);return blend([0,0,0],e,t)}function lighten(e,t){return blend([255,255,255],e,t)}t.normalizeHex=normalizeHex,t.str2rgba=str2rgba,t.str2hex=function str2hex(e){if("transparent"===e)throw new Error("transparent can not be converted to hex");var t=str2rgba(e);return"#"+r.dec2hex(t.r)+r.dec2hex(t.g)+r.dec2hex(t.b)},t.getContrastYIQ=function getContrastYIQ(e){var t=str2rgba(e),i=(299*t.r+587*t.g+114*t.b)/1e3;return 0===t.a||i>=128?"black":"white"},t.hexToRgb=hexToRgb,t.hexToRgba=function hexToRgba(e,t){var i=hexToRgb(e);return"rgba("+i[0]+", "+i[1]+", "+i[2]+", "+t+")"},t.hexToRgbStyle=function hexToRgbStyle(e){return function rgbStyle(e){return"rgb("+e.join(",")+")"}(hexToRgb(e))},t.fromStyleString=fromStyleString,t.rgbToHex=rgbToHex,t.rgbArrayToHex=rgbArrayToHex,t.rgbaStyle=function rgbaStyle(e,t){if(!e||!e.join||3!==e.length)throw new Error("Invalid rgb color");return"rgba("+e.join(",")+","+t+")"},t.highContrast=highContrast,t.blend=blend,t.darken=darken,t.darkenHex=function darkenHex(e,t,i){return void 0===i&&(i="classic"),rgbArrayToHex(darken(hexToRgb(e),t,i))},t.lighten=lighten,t.lightenHex=function lightenHex(e,t){return rgbArrayToHex(lighten(hexToRgb(e),t))},t.colorForUser=function colorForUser(e){if("celesteolivieri"===e||!e||"string"!=typeof e)return"#ff0066";if("musimunpol"===e)return"#0280C7";for(var t=1,i=e.length-1;i>=0;i--)t*=e.charCodeAt(i);for(var r=(t%=16777215).toString(16);r.length<6;)r="0"+r;return"#"+r},t.colorForBackground=function colorForBackground(e,t){if(!e||"string"!=typeof e)throw new Error("You must supply a color for colorForBackground");if(!t||!t.map)throw new Error("options is undefined or not an array");var i=t.map((function(e){return hexToRgb(e)}));return rgbArrayToHex(highContrast(hexToRgb(e),i))},t.isTransparent=function isTransparent(e){return!!e&&0===str2rgba(e).a};var d=1/12.92;function adjustGamma(e){return Math.pow((e+.055)/1.055,2.4)}t.stickyTextColor=function stickyTextColor(e,t,i){void 0===t&&(t="#000000"),void 0===i&&(i="#f5f5f5");try{return!e||str2rgba(e).a<=.3?t:function relativeLuminance(e){var t=e[0]/255,i=e[1]/255,r=e[2]/255;return.2126*(t<=.03928?t*d:adjustGamma(t))+.7152*(i<=.03928?i*d:adjustGamma(i))+.0722*(r<=.03928?r*d:adjustGamma(r))}(fromStyleString(e))<.23?i:t}catch(e){return t}},t.strToRRGGBBAA=function strToRRGGBBAA(e){var t=str2rgba(e),i=t.r,n=t.g,s=t.b,a=t.a,o=Math.floor(255*a);return""+r.dec2hex(i)+r.dec2hex(n)+r.dec2hex(s)+r.dec2hex(o)}},47:(e,t)=>{"use strict";function safeParseInt(e,t,i){void 0===i&&(i=0);var r=parseInt(e,t);return isNaN(r)?i:r}function prependZeroIfNecessary(e){return("0"+e).slice(-2)}Object.defineProperty(t,"__esModule",{value:!0}),t.safeParseInt=safeParseInt,t.safeParseFloat=function safeParseFloat(e,t){void 0===t&&(t=0);var i=parseFloat(e);return isNaN(i)?t:i},t.clamp=function clamp(e,t,i){return Math.min(Math.max(e,t),i)},t.prependZeroIfNecessary=prependZeroIfNecessary,t.dec2hex=function dec2hex(e){return prependZeroIfNecessary(safeParseInt(e).toString(16))}},9787:function(e,t){"use strict";var i=this&&this.__assign||function(){return i=Object.assign||function(e){for(var t,i=1,r=arguments.length;i<r;i++)for(var n in t=arguments[i])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},i.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});t.svgShapes=function buildShapesProps(e){return function mapValues(e,t){var i={};return Object.keys(e).forEach((function(r){return i[r]=t(e[r])})),i}(e,(function(e){return i({},e.shared,e.webOnly,{viewBox:"0 0 "+e.shared.width+" "+e.shared.height})}))}({circle:{shared:{svg:"M138,69 C138,107.165625 107.165625,138 69,138 C30.834375,138 0,107.165625 0,69 C0,30.834375 30.834375,0 69,0 C107.165625,0 138,30.834375 138,69 Z",width:138,height:138},webOnly:{dragWidth:55,dragHeight:55,dragOffsetX:20,dragOffsetY:20,className:"circle"}},square:{shared:{svg:"M138,138 L0,138 L0,0 L138,0 Z",width:138,height:138},webOnly:{dragWidth:55,dragHeight:55,dragOffsetX:20,dragOffsetY:20,className:"square"}},roundedSquare:{shared:{svg:"M128 136.5C132.7 136.5 136.5 132.7 136.5 128L136.5 10C136.5 5.3 132.7 1.5 128 1.5L10 1.5C5.3 1.5 1.5 5.3 1.5 10L1.5 128C1.5 132.7 5.3 136.5 10 136.5L128 136.5Z",width:138,height:138},webOnly:{dragWidth:55,dragHeight:55,dragOffsetX:20,dragOffsetY:20,className:"roundedSquare"}},triangle:{shared:{svg:"M2.5 123L135.4 123 68.5 3.1 2.5 123Z",width:138,height:125},webOnly:{dragWidth:55,dragHeight:49.8,dragOffsetX:20,dragOffsetY:18.1,className:"triangle"}},diamond:{shared:{svg:"M69.2 135.9L135.9 69.1 69.2 2.1 2.1 69.1 69.2 135.9Z",width:138,height:138},webOnly:{dragWidth:55,dragHeight:55,dragOffsetX:20,dragOffsetY:20,className:"diamond"}},pentagon:{shared:{svg:"M110.6 129.5L136.2 50.6 69 1.9 1.8 50.6 27.4 129.5 110.6 129.5Z",width:138,height:131},webOnly:{dragWidth:55,dragHeight:52.2,dragOffsetX:20,dragOffsetY:19,className:"pentagon"}},hexagon:{shared:{svg:"M102.6 118.5L136.3 60 102.6 1.5 35.4 1.5 1.7 60 35.4 118.5 102.6 118.5Z",width:138,height:120},webOnly:{dragWidth:55,dragHeight:47.8,dragOffsetX:20,dragOffsetY:17.4,className:"hexagon"}},terminator:{shared:{svg:"M99.8,0L28.2,0C18.7,0,0,7.1,0,32 c0,23.9,16.6,32,28.2,32l71.7,0c9.4,0,28.2-7.1,28.2-32C128,8.1,111.4,0,99.8,0z",width:128,height:64},webOnly:{dragWidth:62,dragHeight:78,dragOffsetX:17,dragOffsetY:32,className:"terminator"}},decision:{shared:{svg:"M64,0l64,32L64,64L0,32L64,0z",width:128,height:64},webOnly:{className:"decision",dragWidth:62,dragHeight:78,dragOffsetX:17,dragOffsetY:32}},delay:{shared:{svg:"M100.3,0H63.5H0v64h29.4l0,0h70.8c9.3,0,27.8-7,27.8-32.1C128.1,8.1,111.6,0,100.3,0z",width:128,height:64},webOnly:{className:"delay",dragWidth:62,dragHeight:78,dragOffsetX:17,dragOffsetY:32}},data:{shared:{svg:"M20,0h108l-19.8,64H0L20,0z",width:128,height:64},webOnly:{className:"data",dragWidth:62,dragHeight:78,dragOffsetX:17,dragOffsetY:32}},documentShape:{shared:{svg:"M0,0v54.9c0,0,17.6,9.1,32,9.1c21.5,0,29.7-17.9,64-17.9c17.8,0,26.1,4.3,32,8.2V0H0z",width:128,height:64},webOnly:{className:"documentShape",dragWidth:62,dragHeight:78,dragOffsetX:17,dragOffsetY:32}},eventShape:{shared:{svg:"M113,0H15C6.7,0,0,6.7,0,15v34c0,8.3,6.7,15,15,15h98c8.3,0,15-6.7,15-15V15 C128,6.7,121.3,0,113,0z",width:128,height:64},webOnly:{className:"eventShape",dragWidth:62,dragHeight:78,dragOffsetX:17,dragOffsetY:32}},preparation:{shared:{svg:"M23.1,64L0,32L23.1,0l81.7,0L128,32l-23.1,32L23.1,64z",width:128,height:64},webOnly:{className:"preparation",dragWidth:62,dragHeight:78,dragOffsetX:17,dragOffsetY:32}},display:{shared:{svg:"M0,32C0,21.3,20.7,0,39.9,0h67.8c3.9,0,20.3,8.1,20.3,32c0,24.9-16,32-20.4,32H39.9 C20.7,64,0,43.8,0,32z",width:128,height:64},webOnly:{className:"display",dragWidth:62,dragHeight:78,dragOffsetX:17,dragOffsetY:32}},manualInput:{shared:{svg:"M0,64V21L128,0v64H0z",width:128,height:64},webOnly:{className:"manualInput",dragWidth:62,dragHeight:78,dragOffsetX:17,dragOffsetY:32}},manualLoop:{shared:{svg:"M20.6,61.6L0,0h128l-21.2,64H21.4L20.6,61.6z",width:128,height:64},webOnly:{className:"manualLoop",dragWidth:62,dragHeight:78,dragOffsetX:17,dragOffsetY:32}},loopLimit:{shared:{svg:"M0,64V19.1L17.9,0h92.2L128,19.1V64H0z",width:128,height:64},webOnly:{className:"loopLimit",dragWidth:62,dragHeight:78,dragOffsetX:17,dragOffsetY:32}},offPageConnector:{shared:{svg:"M0,0l0,32.2L32,64l32-31.8V0L0,0z",width:64,height:64},webOnly:{className:"offPageConnector",dragWidth:53,dragHeight:53,dragOffsetX:22,dragOffsetY:22}},offPageReferenceIncoming:{shared:{svg:"M64,64L32,48.4L0,64V0h64V64z",width:64,height:64},webOnly:{className:"offPageReferenceIncoming",dragWidth:53,dragHeight:53,dragOffsetX:22,dragOffsetY:22}},offPageReference:{shared:{svg:"M38.6,64V53H0V11h38.6V0L64,32L38.6,64z",width:64,height:64},webOnly:{className:"offPageReference",dragWidth:53,dragHeight:53,dragOffsetX:22,dragOffsetY:22}},merge:{shared:{svg:"M0,0l32.1,64L64,0H0z",width:78,height:64},webOnly:{className:"merge",svg2:"M0,4.9l32.1,54.3L64,4.9H0z",dragWidth:50,dragHeight:46,dragOffsetX:23,dragOffsetY:28}},database:{shared:{svg:"M64,49.5C64,58.9,49.7,64,32,64S0,58.9,0,49.5V10.7C0,3.9,14.3,0,32,0s32,3.2,32,10.7V49.5z M64,9.6c0,5.6-14.3,11.9-32,11.9S0,17,0,10",width:64,height:64},webOnly:{className:"database",dragWidth:56,dragHeight:56,dragOffsetX:20,dragOffsetY:20}}}),t.getShapeProps=function(e){return t.svgShapes[e]}},8247:(e,t,i)=>{"use strict";i.r(t),i.d(t,{decode:()=>decode,encode:()=>encode});for(var r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",n="undefined"==typeof Uint8Array?[]:new Uint8Array(256),s=0;s<r.length;s++)n[r.charCodeAt(s)]=s;var encode=function(e){var t,i=new Uint8Array(e),n=i.length,s="";for(t=0;t<n;t+=3)s+=r[i[t]>>2],s+=r[(3&i[t])<<4|i[t+1]>>4],s+=r[(15&i[t+1])<<2|i[t+2]>>6],s+=r[63&i[t+2]];return n%3==2?s=s.substring(0,s.length-1)+"=":n%3==1&&(s=s.substring(0,s.length-2)+"=="),s},decode=function(e){var t,i,r,s,a,o=.75*e.length,l=e.length,d=0;"="===e[e.length-1]&&(o--,"="===e[e.length-2]&&o--);var h=new ArrayBuffer(o),c=new Uint8Array(h);for(t=0;t<l;t+=4)i=n[e.charCodeAt(t)],r=n[e.charCodeAt(t+1)],s=n[e.charCodeAt(t+2)],a=n[e.charCodeAt(t+3)],c[d++]=i<<2|r>>4,c[d++]=(15&r)<<4|s>>2,c[d++]=(3&s)<<6|63&a;return h}},5874:(e,t,i)=>{e.exports=i(5969)},5969:(e,t,i)=>{!function(){"use strict";var t=Math.abs,r=Math.min,n=Math.max,s=Math.cos,a=Math.sin,o=Math.acos,l=Math.sqrt,d=Math.PI,h={x:0,y:0,z:0},c=i(6240),u=i(91),Bezier=function(e){var i=e&&e.forEach?e:[].slice.call(arguments),r=!1;if("object"==typeof i[0]){r=i.length;var n=[];i.forEach((function(e){["x","y","z"].forEach((function(t){void 0!==e[t]&&n.push(e[t])}))})),i=n}var s=!1,a=i.length;if(r){if(r>4){if(1!==arguments.length)throw new Error("Only new Bezier(point[]) is accepted for 4th and higher order curves");s=!0}}else if(6!==a&&8!==a&&9!==a&&12!==a&&1!==arguments.length)throw new Error("Only new Bezier(point[]) is accepted for 4th and higher order curves");var o=!s&&(9===a||12===a)||e&&e[0]&&void 0!==e[0].z;this._3d=o;for(var l=[],d=0,h=o?3:2;d<a;d+=h){var u={x:i[d],y:i[d+1]};o&&(u.z=i[d+2]),l.push(u)}this.order=l.length-1,this.points=l;var g=["x","y"];o&&g.push("z"),this.dims=g,this.dimlen=g.length,function(e){for(var i=e.order,r=e.points,n=c.align(r,{p1:r[0],p2:r[i]}),s=0;s<n.length;s++)if(t(n[s].y)>1e-4)return void(e._linear=!1);e._linear=!0}(this),this._t1=0,this._t2=1,this.update()},g=i(3985);function getABC(e,t,i,r,n){void 0===n&&(n=.5);var s=c.projectionratio(n,e),a=1-s,o={x:s*t.x+a*r.x,y:s*t.y+a*r.y},l=c.abcratio(n,e);return{A:{x:i.x+(i.x-o.x)/l,y:i.y+(i.y-o.y)/l},B:i,C:o}}Bezier.SVGtoBeziers=function(e){return g(Bezier,e)},Bezier.quadraticFromPoints=function(e,t,i,r){if(void 0===r&&(r=.5),0===r)return new Bezier(t,t,i);if(1===r)return new Bezier(e,t,t);var n=getABC(2,e,t,i,r);return new Bezier(e,n.A,i)},Bezier.cubicFromPoints=function(e,t,i,r,n){void 0===r&&(r=.5);var s=getABC(3,e,t,i,r);void 0===n&&(n=c.dist(t,s.C));var a=n*(1-r)/r,o=c.dist(e,i),l=(i.x-e.x)/o,d=(i.y-e.y)/o,h=n*l,u=n*d,g=a*l,f=a*d,m=t.x-h,v=t.y-u,y=t.x+g,w=t.y+f,x=s.A,b=x.x+(m-x.x)/(1-r),C=x.y+(v-x.y)/(1-r),A=x.x+(y-x.x)/r,I=x.y+(w-x.y)/r,S={x:e.x+(b-e.x)/r,y:e.y+(C-e.y)/r},T={x:i.x+(A-i.x)/(1-r),y:i.y+(I-i.y)/(1-r)};return new Bezier(e,S,T,i)};var getUtils=function(){return c};Bezier.getUtils=getUtils,Bezier.PolyBezier=u,Bezier.prototype={getUtils,valueOf:function(){return this.toString()},toString:function(){return c.pointsToString(this.points)},toSVG:function(e){if(this._3d)return!1;for(var t=this.points,i=["M",t[0].x,t[0].y,2===this.order?"Q":"C"],r=1,n=t.length;r<n;r++)i.push(t[r].x),i.push(t[r].y);return i.join(" ")},setRatios:function(e){if(e.length!==this.points.length)throw new Error("incorrect number of ratio values");this.ratios=e,this._lut=[]},update:function(){this._lut=[],this.dpoints=c.derive(this.points,this._3d),this.computedirection()},computedirection:function(){var e=this.points,t=c.angle(e[0],e[this.order],e[1]);this.clockwise=t>0},length:function(){return c.length(this.derivative.bind(this))},_lut:[],getLUT:function(e){if(e=e||100,this._lut.length===e)return this._lut;this._lut=[],e--;for(var t=0;t<=e;t++)this._lut.push(this.compute(t/e));return this._lut},on:function(e,t){t=t||5;for(var i,r=this.getLUT(),n=[],s=0,a=0;a<r.length;a++)i=r[a],c.dist(i,e)<t&&(n.push(i),s+=a/r.length);return!!n.length&&s/n.length},project:function(e){var t=this.getLUT(),i=t.length-1,r=c.closest(t,e),n=r.mdist,s=r.mpos;if(0===s||s===i){var a=s/i,o=this.compute(a);return o.t=a,o.d=n,o}var l,d,h,u=(s+1)/i,g=.1/i;for(n+=1,l=a=(s-1)/i;a<u+g;a+=g)d=this.compute(a),(h=c.dist(e,d))<n&&(n=h,l=a);return(d=this.compute(l)).t=l,d.d=n,d},get:function(e){return this.compute(e)},point:function(e){return this.points[e]},compute:function(e){return this.ratios?c.computeWithRatios(e,this.points,this.ratios,this._3d):c.compute(e,this.points,this._3d,this.ratios)},raise:function(){for(var e,t,i=this.points,r=[i[0]],n=i.length,s=1;s<n;s++)e=i[s],t=i[s-1],r[s]={x:(n-s)/n*e.x+s/n*t.x,y:(n-s)/n*e.y+s/n*t.y};return r[n]=i[n-1],new Bezier(r)},derivative:function(e){var t,i,r=1-e,n=0,s=this.dpoints[0];2===this.order&&(s=[s[0],s[1],h],t=r,i=e),3===this.order&&(t=r*r,i=r*e*2,n=e*e);var a={x:t*s[0].x+i*s[1].x+n*s[2].x,y:t*s[0].y+i*s[1].y+n*s[2].y};return this._3d&&(a.z=t*s[0].z+i*s[1].z+n*s[2].z),a},curvature:function(e){return c.curvature(e,this.points,this._3d)},inflections:function(){return c.inflections(this.points)},normal:function(e){return this._3d?this.__normal3(e):this.__normal2(e)},__normal2:function(e){var t=this.derivative(e),i=l(t.x*t.x+t.y*t.y);return{x:-t.y/i,y:t.x/i}},__normal3:function(e){var t=this.derivative(e),i=this.derivative(e+.01),r=l(t.x*t.x+t.y*t.y+t.z*t.z),n=l(i.x*i.x+i.y*i.y+i.z*i.z);t.x/=r,t.y/=r,t.z/=r,i.x/=n,i.y/=n,i.z/=n;var s={x:i.y*t.z-i.z*t.y,y:i.z*t.x-i.x*t.z,z:i.x*t.y-i.y*t.x},a=l(s.x*s.x+s.y*s.y+s.z*s.z);s.x/=a,s.y/=a,s.z/=a;var o=[s.x*s.x,s.x*s.y-s.z,s.x*s.z+s.y,s.x*s.y+s.z,s.y*s.y,s.y*s.z-s.x,s.x*s.z-s.y,s.y*s.z+s.x,s.z*s.z];return{x:o[0]*t.x+o[1]*t.y+o[2]*t.z,y:o[3]*t.x+o[4]*t.y+o[5]*t.z,z:o[6]*t.x+o[7]*t.y+o[8]*t.z}},hull:function(e){var t,i=this.points,r=[],n=[],s=0,a=0,o=0;for(n[s++]=i[0],n[s++]=i[1],n[s++]=i[2],3===this.order&&(n[s++]=i[3]);i.length>1;){for(r=[],a=0,o=i.length-1;a<o;a++)t=c.lerp(e,i[a],i[a+1]),n[s++]=t,r.push(t);i=r}return n},split:function(e,t){if(0===e&&t)return this.split(t).left;if(1===t)return this.split(e).right;var i=this.hull(e),r={left:2===this.order?new Bezier([i[0],i[3],i[5]]):new Bezier([i[0],i[4],i[7],i[9]]),right:2===this.order?new Bezier([i[5],i[4],i[2]]):new Bezier([i[9],i[8],i[6],i[3]]),span:i};return r.left._t1=c.map(0,0,1,this._t1,this._t2),r.left._t2=c.map(e,0,1,this._t1,this._t2),r.right._t1=c.map(e,0,1,this._t1,this._t2),r.right._t2=c.map(1,0,1,this._t1,this._t2),t?(t=c.map(t,e,1,0,1),r.right.split(t).left):r},extrema:function(){var e,t,i=this.dims,r={},n=[];return i.forEach(function(i){t=function(e){return e[i]},e=this.dpoints[0].map(t),r[i]=c.droots(e),3===this.order&&(e=this.dpoints[1].map(t),r[i]=r[i].concat(c.droots(e))),r[i]=r[i].filter((function(e){return e>=0&&e<=1})),n=n.concat(r[i].sort(c.numberSort))}.bind(this)),n=n.sort(c.numberSort).filter((function(e,t){return n.indexOf(e)===t})),r.values=n,r},bbox:function(){var e=this.extrema(),t={};return this.dims.forEach(function(i){t[i]=c.getminmax(this,i,e[i])}.bind(this)),t},overlaps:function(e){var t=this.bbox(),i=e.bbox();return c.bboxoverlap(t,i)},offset:function(e,t){if(void 0!==t){var i=this.get(e),r=this.normal(e),n={c:i,n:r,x:i.x+r.x*t,y:i.y+r.y*t};return this._3d&&(n.z=i.z+r.z*t),n}if(this._linear){var s=this.normal(0),a=this.points.map((function(t){var i={x:t.x+e*s.x,y:t.y+e*s.y};return t.z&&r.z&&(i.z=t.z+e*s.z),i}));return[new Bezier(a)]}return this.reduce().map((function(t){return t.scale(e)}))},simple:function(){if(3===this.order){var e=c.angle(this.points[0],this.points[3],this.points[1]),i=c.angle(this.points[0],this.points[3],this.points[2]);if(e>0&&i<0||e<0&&i>0)return!1}var r=this.normal(0),n=this.normal(1),s=r.x*n.x+r.y*n.y;return this._3d&&(s+=r.z*n.z),t(o(s))<d/3},reduce:function(){var e,i,r=0,n=0,s=.01,a=[],o=[],l=this.extrema().values;for(-1===l.indexOf(0)&&(l=[0].concat(l)),-1===l.indexOf(1)&&l.push(1),r=l[0],e=1;e<l.length;e++)n=l[e],(i=this.split(r,n))._t1=r,i._t2=n,a.push(i),r=n;return a.forEach((function(e){for(r=0,n=0;n<=1;)for(n=r+s;n<=1.01;n+=s)if(!(i=e.split(r,n)).simple()){if(t(r-(n-=s))<s)return[];(i=e.split(r,n))._t1=c.map(r,0,1,e._t1,e._t2),i._t2=c.map(n,0,1,e._t1,e._t2),o.push(i),r=n;break}r<1&&((i=e.split(r,1))._t1=c.map(r,0,1,e._t1,e._t2),i._t2=e._t2,o.push(i))})),o},scale:function(e){var t=this.order,i=!1;if("function"==typeof e&&(i=e),i&&2===t)return this.raise().scale(i);var r=this.clockwise,n=i?i(0):e,s=i?i(1):e,a=[this.offset(0,10),this.offset(1,10)],o=c.lli4(a[0],a[0].c,a[1],a[1].c);if(!o)throw new Error("cannot scale this curve. Try reducing it first.");var d=this.points,h=[];return[0,1].forEach(function(e){var i=h[e*t]=c.copy(d[e*t]);i.x+=(e?s:n)*a[e].n.x,i.y+=(e?s:n)*a[e].n.y}.bind(this)),i?([0,1].forEach(function(n){if(2!==this.order||!n){var s=d[n+1],a={x:s.x-o.x,y:s.y-o.y},c=i?i((n+1)/t):e;i&&!r&&(c=-c);var u=l(a.x*a.x+a.y*a.y);a.x/=u,a.y/=u,h[n+1]={x:s.x+c*a.x,y:s.y+c*a.y}}}.bind(this)),new Bezier(h)):([0,1].forEach(function(e){if(2!==this.order||!e){var i=h[e*t],r=this.derivative(e),n={x:i.x+r.x,y:i.y+r.y};h[e+1]=c.lli4(i,n,o,d[e+1])}}.bind(this)),new Bezier(h))},outline:function(e,t,i,r){t=void 0===t?e:t;var n,s=this.reduce(),a=s.length,o=[],l=[],d=0,h=this.length(),g=void 0!==i&&void 0!==r;function linearDistanceFunction(e,t,i,r,n){return function(s){var a=r/i,o=(r+n)/i,l=t-e;return c.map(s,0,1,e+a*l,e+o*l)}}s.forEach((function(n){C=n.length(),g?(o.push(n.scale(linearDistanceFunction(e,i,h,d,C))),l.push(n.scale(linearDistanceFunction(-t,-r,h,d,C)))):(o.push(n.scale(e)),l.push(n.scale(-t))),d+=C})),l=l.map((function(e){return(n=e.points)[3]?e.points=[n[3],n[2],n[1],n[0]]:e.points=[n[2],n[1],n[0]],e})).reverse();var f=o[0].points[0],m=o[a-1].points[o[a-1].points.length-1],v=l[a-1].points[l[a-1].points.length-1],y=l[0].points[0],w=c.makeline(v,f),x=c.makeline(m,y),b=[w].concat(o).concat([x]).concat(l),C=b.length;return new u(b)},outlineshapes:function(e,t,i){t=t||e;for(var r=this.outline(e,t).curves,n=[],s=1,a=r.length;s<a/2;s++){var o=c.makeshape(r[s],r[a-s],i);o.startcap.virtual=s>1,o.endcap.virtual=s<a/2-1,n.push(o)}return n},intersects:function(e,t){return e?e.p1&&e.p2?this.lineIntersects(e):(e instanceof Bezier&&(e=e.reduce()),this.curveintersects(this.reduce(),e,t)):this.selfintersects(t)},lineIntersects:function(e){var t=r(e.p1.x,e.p2.x),i=r(e.p1.y,e.p2.y),s=n(e.p1.x,e.p2.x),a=n(e.p1.y,e.p2.y),o=this;return c.roots(this.points,e).filter((function(e){var r=o.get(e);return c.between(r.x,t,s)&&c.between(r.y,i,a)}))},selfintersects:function(e){var t,i,r,n,s=this.reduce(),a=s.length-2,o=[];for(t=0;t<a;t++)r=s.slice(t,t+1),n=s.slice(t+2),i=this.curveintersects(r,n,e),o=o.concat(i);return o},curveintersects:function(e,t,i){var r=[];e.forEach((function(e){t.forEach((function(t){e.overlaps(t)&&r.push({left:e,right:t})}))}));var n=[];return r.forEach((function(e){var t=c.pairiteration(e.left,e.right,i);t.length>0&&(n=n.concat(t))})),n},arcs:function(e){e=e||.5;return this._iterate(e,[])},_error:function(e,i,r,n){var s=(n-r)/4,a=this.get(r+s),o=this.get(n-s),l=c.dist(e,i),d=c.dist(e,a),h=c.dist(e,o);return t(d-l)+t(h-l)},_iterate:function(e,t){var i,r=0,n=1;do{i=0,n=1;var o,l,d,h,u,g=this.get(r),f=!1,m=!1,v=n,y=1;do{if(m=f,h=d,v=(r+n)/2,o=this.get(v),l=this.get(n),(d=c.getccenter(g,o,l)).interval={start:r,end:n},f=this._error(d,g,r,n)<=e,(u=m&&!f)||(y=n),f){if(n>=1){if(d.interval.end=y=1,h=d,n>1){var w={x:d.x+d.r*s(d.e),y:d.y+d.r*a(d.e)};d.e+=c.angle({x:d.x,y:d.y},w,this.get(1))}break}n+=(n-r)/2}else n=v}while(!u&&i++<100);if(i>=100)break;h=h||d,t.push(h),r=y}while(n<1);return t}},e.exports=Bezier}()},1814:e=>{e.exports=function normalizePath(e){var t,i,r,n,s,a,o=(e=e.replace(/,/g," ").replace(/-/g," - ").replace(/-\s+/g,"-").replace(/([a-zA-Z])/g," $1 ")).replace(/([a-zA-Z])\s?/g,"|$1").split("|"),l=o.length,d=[],h=0,c=0,u=0,g=0,f=0,m=0,v=0,y=0,w="";for(t=1;t<l;t++)if(n=(r=(i=o[t]).substring(0,1)).toLowerCase(),s=(d=(d=i.replace(r,"").trim().split(" ")).filter((function(e){return""!==e})).map(parseFloat)).length,"m"===n){if(w+="M ","m"===r?(u+=d[0],g+=d[1]):(u=d[0],g=d[1]),h=u,c=g,w+=u+" "+g+" ",s>2)for(a=0;a<s;a+=2)"m"===r?(u+=d[a],g+=d[a+1]):(u=d[a],g=d[a+1]),w+=["L",u,g,""].join(" ")}else if("l"===n)for(a=0;a<s;a+=2)"l"===r?(u+=d[a],g+=d[a+1]):(u=d[a],g=d[a+1]),w+=["L",u,g,""].join(" ");else if("h"===n)for(a=0;a<s;a++)"h"===r?u+=d[a]:u=d[a],w+=["L",u,g,""].join(" ");else if("v"===n)for(a=0;a<s;a++)"v"===r?g+=d[a]:g=d[a],w+=["L",u,g,""].join(" ");else if("q"===n)for(a=0;a<s;a+=4)"q"===r?(f=u+d[a],m=g+d[a+1],u+=d[a+2],g+=d[a+3]):(f=d[a],m=d[a+1],u=d[a+2],g=d[a+3]),w+=["Q",f,m,u,g,""].join(" ");else if("t"===n)for(a=0;a<s;a+=2)f=u+(u-f),m=g+(g-m),"t"===r?(u+=d[a],g+=d[a+1]):(u=d[a],g=d[a+1]),w+=["Q",f,m,u,g,""].join(" ");else if("c"===n)for(a=0;a<s;a+=6)"c"===r?(f=u+d[a],m=g+d[a+1],v=u+d[a+2],y=g+d[a+3],u+=d[a+4],g+=d[a+5]):(f=d[a],m=d[a+1],v=d[a+2],y=d[a+3],u=d[a+4],g=d[a+5]),w+=["C",f,m,v,y,u,g,""].join(" ");else if("s"===n)for(a=0;a<s;a+=4)f=u+(u-v),m=g+(g-y),"s"===r?(v=u+d[a],y=g+d[a+1],u+=d[a+2],g+=d[a+3]):(v=d[a],y=d[a+1],u=d[a+2],g=d[a+3]),w+=["C",f,m,v,y,u,g,""].join(" ");else"z"===n&&(w+="Z ",u=h,g=c);return w.trim()}},91:(e,t,i)=>{!function(){"use strict";var t=i(6240),PolyBezier=function(e){this.curves=[],this._3d=!1,e&&(this.curves=e,this._3d=this.curves[0]._3d)};PolyBezier.prototype={valueOf:function(){return this.toString()},toString:function(){return"["+this.curves.map((function(e){return t.pointsToString(e.points)})).join(", ")+"]"},addCurve:function(e){this.curves.push(e),this._3d=this._3d||e._3d},length:function(){return this.curves.map((function(e){return e.length()})).reduce((function(e,t){return e+t}))},curve:function(e){return this.curves[e]},bbox:function(){for(var e=this.curves,i=e[0].bbox(),r=1;r<e.length;r++)t.expandbox(i,e[r].bbox());return i},offset:function(e){var t=[];return this.curves.forEach((function(i){t=t.concat(i.offset(e))})),new PolyBezier(t)}},e.exports=PolyBezier}()},3985:(e,t,i)=>{var r=i(1814),n={x:!1,y:!1};function makeBezier(e,t,i){if("Z"!==t){if("M"!==t){var r=[!1,n.x,n.y].concat(i),s=new(e.bind.apply(e,r)),a=i.slice(-2);return n={x:a[0],y:a[1]},s}n={x:i[0],y:i[1]}}}e.exports=function convertPath(e,t){for(var i,n,s=r(t).split(" "),a=new RegExp("[MLCQZ]",""),o=[],l={C:6,Q:4,L:2,M:2};s.length;)i=s.splice(0,1)[0],a.test(i)&&(n=makeBezier(e,i,s.splice(0,l[i]).map(parseFloat)))&&o.push(n);return new e.PolyBezier(o)}},6240:(e,t,i)=>{!function(){"use strict";var t=Math.abs,r=Math.cos,n=Math.sin,s=Math.acos,a=Math.atan2,o=Math.sqrt,l=Math.pow,crt=function(e){return e<0?-l(-e,1/3):l(e,1/3)},d=Math.PI,h=2*d,c=d/2,u=Number.MAX_SAFE_INTEGER||9007199254740991,g=Number.MIN_SAFE_INTEGER||-9007199254740991,f={x:0,y:0,z:0},m={Tvalues:[-.06405689286260563,.06405689286260563,-.1911188674736163,.1911188674736163,-.3150426796961634,.3150426796961634,-.4337935076260451,.4337935076260451,-.5454214713888396,.5454214713888396,-.6480936519369755,.6480936519369755,-.7401241915785544,.7401241915785544,-.820001985973903,.820001985973903,-.8864155270044011,.8864155270044011,-.9382745520027328,.9382745520027328,-.9747285559713095,.9747285559713095,-.9951872199970213,.9951872199970213],Cvalues:[.12793819534675216,.12793819534675216,.1258374563468283,.1258374563468283,.12167047292780339,.12167047292780339,.1155056680537256,.1155056680537256,.10744427011596563,.10744427011596563,.09761865210411388,.09761865210411388,.08619016153195327,.08619016153195327,.0733464814110803,.0733464814110803,.05929858491543678,.05929858491543678,.04427743881741981,.04427743881741981,.028531388628933663,.028531388628933663,.0123412297999872,.0123412297999872],arcfn:function(e,t){var i=t(e),r=i.x*i.x+i.y*i.y;return void 0!==i.z&&(r+=i.z*i.z),o(r)},compute:function(e,t,i){if(0===e)return t[0];let r=t.length-1;if(1===e)return t[r];var n=t,s=1-e;if(0===r)return t[0];if(1===r)return u={x:s*n[0].x+e*n[1].x,y:s*n[0].y+e*n[1].y},i&&(u.z=s*n[0].z+e*n[1].z),u;if(r<4){var a,o,l,d=s*s,h=e*e,c=0;2===r?(n=[n[0],n[1],n[2],f],a=d,o=s*e*2,l=h):3===r&&(a=d*s,o=d*e*3,l=s*h*3,c=e*h);var u={x:a*n[0].x+o*n[1].x+l*n[2].x+c*n[3].x,y:a*n[0].y+o*n[1].y+l*n[2].y+c*n[3].y};return i&&(u.z=a*n[0].z+o*n[1].z+l*n[2].z+c*n[3].z),u}for(var g=JSON.parse(JSON.stringify(t));g.length>1;){for(var m=0;m<g.length-1;m++)g[m]={x:g[m].x+(g[m+1].x-g[m].x)*e,y:g[m].y+(g[m+1].y-g[m].y)*e},void 0!==g[m].z&&(g[m]=g[m].z+(g[m+1].z-g[m].z)*e);g.splice(g.length-1,1)}return g[0]},computeWithRatios:function(e,t,i,r){var n,s=1-e,a=i,o=t,l=a[0],d=a[1],h=a[2],c=a[3];return l*=s,d*=e,2===o.length?(n=l+d,{x:(l*o[0].x+d*o[1].x)/n,y:(l*o[0].y+d*o[1].y)/n,z:!!r&&(l*o[0].z+d*o[1].z)/n}):(l*=s,d*=2*s,h*=e*e,3===o.length?(n=l+d+h,{x:(l*o[0].x+d*o[1].x+h*o[2].x)/n,y:(l*o[0].y+d*o[1].y+h*o[2].y)/n,z:!!r&&(l*o[0].z+d*o[1].z+h*o[2].z)/n}):(l*=s,d*=1.5*s,h*=3*s,c*=e*e*e,4===o.length?(n=l+d+h+c,{x:(l*o[0].x+d*o[1].x+h*o[2].x+c*o[3].x)/n,y:(l*o[0].y+d*o[1].y+h*o[2].y+c*o[3].y)/n,z:!!r&&(l*o[0].z+d*o[1].z+h*o[2].z+c*o[3].z)/n}):void 0))},derive:function(e,t){for(var i=[],r=e,n=r.length,s=n-1;n>1;n--,s--){for(var a,o=[],l=0;l<s;l++)a={x:s*(r[l+1].x-r[l].x),y:s*(r[l+1].y-r[l].y)},t&&(a.z=s*(r[l+1].z-r[l].z)),o.push(a);i.push(o),r=o}return i},between:function(e,t,i){return t<=e&&e<=i||m.approximately(e,t)||m.approximately(e,i)},approximately:function(e,i,r){return t(e-i)<=(r||1e-6)},length:function(e){var t,i,r=0,n=m.Tvalues.length;for(t=0;t<n;t++)i=.5*m.Tvalues[t]+.5,r+=m.Cvalues[t]*m.arcfn(i,e);return.5*r},map:function(e,t,i,r,n){return r+(n-r)*((e-t)/(i-t))},lerp:function(e,t,i){var r={x:t.x+e*(i.x-t.x),y:t.y+e*(i.y-t.y)};return t.z&&i.z&&(r.z=t.z+e*(i.z-t.z)),r},pointToString:function(e){var t=e.x+"/"+e.y;return void 0!==e.z&&(t+="/"+e.z),t},pointsToString:function(e){return"["+e.map(m.pointToString).join(", ")+"]"},copy:function(e){return JSON.parse(JSON.stringify(e))},angle:function(e,t,i){var r=t.x-e.x,n=t.y-e.y,s=i.x-e.x,o=i.y-e.y;return a(r*o-n*s,r*s+n*o)},round:function(e,t){var i=""+e,r=i.indexOf(".");return parseFloat(i.substring(0,r+1+t))},dist:function(e,t){var i=e.x-t.x,r=e.y-t.y;return o(i*i+r*r)},closest:function(e,t){var i,r,n=l(2,63);return e.forEach((function(e,s){(r=m.dist(t,e))<n&&(n=r,i=s)})),{mdist:n,mpos:i}},abcratio:function(e,i){if(2!==i&&3!==i)return!1;if(void 0===e)e=.5;else if(0===e||1===e)return e;var r=l(e,i)+l(1-e,i);return t((r-1)/r)},projectionratio:function(e,t){if(2!==t&&3!==t)return!1;if(void 0===e)e=.5;else if(0===e||1===e)return e;var i=l(1-e,t);return i/(l(e,t)+i)},lli8:function(e,t,i,r,n,s,a,o){var l=(e-i)*(s-o)-(t-r)*(n-a);return 0!=l&&{x:((e*r-t*i)*(n-a)-(e-i)*(n*o-s*a))/l,y:((e*r-t*i)*(s-o)-(t-r)*(n*o-s*a))/l}},lli4:function(e,t,i,r){var n=e.x,s=e.y,a=t.x,o=t.y,l=i.x,d=i.y,h=r.x,c=r.y;return m.lli8(n,s,a,o,l,d,h,c)},lli:function(e,t){return m.lli4(e,e.c,t,t.c)},makeline:function(e,t){var r=i(5969),n=e.x,s=e.y,a=t.x,o=t.y,l=(a-n)/3,d=(o-s)/3;return new r(n,s,n+l,s+d,n+2*l,s+2*d,a,o)},findbbox:function(e){var t=u,i=u,r=g,n=g;return e.forEach((function(e){var s=e.bbox();t>s.x.min&&(t=s.x.min),i>s.y.min&&(i=s.y.min),r<s.x.max&&(r=s.x.max),n<s.y.max&&(n=s.y.max)})),{x:{min:t,mid:(t+r)/2,max:r,size:r-t},y:{min:i,mid:(i+n)/2,max:n,size:n-i}}},shapeintersections:function(e,t,i,r,n){if(!m.bboxoverlap(t,r))return[];var s=[],a=[e.startcap,e.forward,e.back,e.endcap],o=[i.startcap,i.forward,i.back,i.endcap];return a.forEach((function(t){t.virtual||o.forEach((function(r){if(!r.virtual){var a=t.intersects(r,n);a.length>0&&(a.c1=t,a.c2=r,a.s1=e,a.s2=i,s.push(a))}}))})),s},makeshape:function(e,t,i){var r=t.points.length,n=e.points.length,s=m.makeline(t.points[r-1],e.points[0]),a=m.makeline(e.points[n-1],t.points[0]),o={startcap:s,forward:e,back:t,endcap:a,bbox:m.findbbox([s,e,t,a])},l=m;return o.intersections=function(e){return l.shapeintersections(o,o.bbox,e,e.bbox,i)},o},getminmax:function(e,t,i){if(!i)return{min:0,max:0};var r,n,s=u,a=g;-1===i.indexOf(0)&&(i=[0].concat(i)),-1===i.indexOf(1)&&i.push(1);for(var o=0,l=i.length;o<l;o++)r=i[o],(n=e.get(r))[t]<s&&(s=n[t]),n[t]>a&&(a=n[t]);return{min:s,mid:(s+a)/2,max:a,size:a-s}},align:function(e,t){var i=t.p1.x,s=t.p1.y,o=-a(t.p2.y-s,t.p2.x-i);return e.map((function(e){return{x:(e.x-i)*r(o)-(e.y-s)*n(o),y:(e.x-i)*n(o)+(e.y-s)*r(o)}}))},roots:function(e,t){t=t||{p1:{x:0,y:0},p2:{x:1,y:0}};var i=e.length-1,n=m.align(e,t),reduce=function(e){return 0<=e&&e<=1};if(2===i){if(0!==(g=(f=n[0].y)-2*(v=n[1].y)+(y=n[2].y))){var a=-o(v*v-f*y),l=-f+v;return[-(a+l)/g,-(-a+l)/g].filter(reduce)}return v!==y&&0===g?[(2*v-y)/(2*v-2*y)].filter(reduce):[]}var d=n[0].y,c=n[1].y,u=n[2].y,g=3*c-d-3*u+n[3].y,f=3*d-6*c+3*u,v=-3*d+3*c,y=d;if(m.approximately(g,0)){if(m.approximately(f,0))return m.approximately(v,0)?[]:[-y/v].filter(reduce);var w=2*f;return[((x=o(v*v-4*f*y))-v)/w,(-v-x)/w].filter(reduce)}var x,b,C=(n=(3*(v/=g)-(f/=g)*f)/3)/3,A=(x=(2*f*f*f-9*f*v+27*(y/=g))/27)/2,I=A*A+C*C*C;if(I<0){var S=-n/3,T=o(S*S*S),_=-x/(2*T),M=s(_<-1?-1:_>1?1:_),O=2*crt(T);return[O*r(M/3)-f/3,O*r((M+h)/3)-f/3,O*r((M+2*h)/3)-f/3].filter(reduce)}if(0===I)return[2*(b=A<0?crt(-A):-crt(A))-f/3,-b-f/3].filter(reduce);var R=o(I);return[(b=crt(-A+R))-crt(A+R)-f/3].filter(reduce)},droots:function(e){if(3===e.length){var t=e[0],i=e[1],r=e[2],n=t-2*i+r;if(0!==n){var s=-o(i*i-t*r),a=-t+i;return[-(s+a)/n,-(-s+a)/n]}return i!==r&&0===n?[(2*i-r)/(2*(i-r))]:[]}if(2===e.length)return(t=e[0])!==(i=e[1])?[t/(t-i)]:[]},curvature:function(e,i,r,n){var s,a,d,h,c,u,g=m.derive(i),f=g[0],v=g[1],y=m.compute(e,f),w=m.compute(e,v),x=y.x*y.x+y.y*y.y;if(r?(s=o(l(y.y*w.z-w.y*y.z,2)+l(y.z*w.x-w.z*y.x,2)+l(y.x*w.y-w.x*y.y,2)),a=l(x+y.z*y.z,2/3)):(s=y.x*w.y-y.y*w.x,a=l(x,2/3)),0===s||0===a)return{k:0,r:0};if(c=s/a,u=a/s,!n){var b=m.curvature(e-.001,i,r,!0).k,C=m.curvature(e+.001,i,r,!0).k;h=(C-c+(c-b))/2,d=(t(C-c)+t(c-b))/2}return{k:c,r:u,dk:h,adk:d}},inflections:function(e){if(e.length<4)return[];var t=m.align(e,{p1:e[0],p2:e.slice(-1)[0]}),i=t[2].x*t[1].y,r=t[3].x*t[1].y,n=t[1].x*t[2].y,s=18*(-3*i+2*r+3*n-(c=t[3].x*t[2].y)),a=18*(3*i-r-3*n),o=18*(n-i);if(m.approximately(s,0)){if(!m.approximately(a,0)){var l=-o/a;if(0<=l&&l<=1)return[l]}return[]}var d=a*a-4*s*o,h=Math.sqrt(d),c=2*s;return m.approximately(c,0)?[]:[(h-a)/c,-(a+h)/c].filter((function(e){return 0<=e&&e<=1}))},bboxoverlap:function(e,i){var r,n,s,a,o,l=["x","y"],d=l.length;for(r=0;r<d;r++)if(s=e[n=l[r]].mid,a=i[n].mid,o=(e[n].size+i[n].size)/2,t(s-a)>=o)return!1;return!0},expandbox:function(e,t){t.x.min<e.x.min&&(e.x.min=t.x.min),t.y.min<e.y.min&&(e.y.min=t.y.min),t.z&&t.z.min<e.z.min&&(e.z.min=t.z.min),t.x.max>e.x.max&&(e.x.max=t.x.max),t.y.max>e.y.max&&(e.y.max=t.y.max),t.z&&t.z.max>e.z.max&&(e.z.max=t.z.max),e.x.mid=(e.x.min+e.x.max)/2,e.y.mid=(e.y.min+e.y.max)/2,e.z&&(e.z.mid=(e.z.min+e.z.max)/2),e.x.size=e.x.max-e.x.min,e.y.size=e.y.max-e.y.min,e.z&&(e.z.size=e.z.max-e.z.min)},pairiteration:function(e,t,i){var r=e.bbox(),n=t.bbox(),s=1e5,a=i||.5;if(r.x.size+r.y.size<a&&n.x.size+n.y.size<a)return[(s*(e._t1+e._t2)/2|0)/s+"/"+(s*(t._t1+t._t2)/2|0)/s];var o=e.split(.5),l=t.split(.5),d=[{left:o.left,right:l.left},{left:o.left,right:l.right},{left:o.right,right:l.right},{left:o.right,right:l.left}];d=d.filter((function(e){return m.bboxoverlap(e.left.bbox(),e.right.bbox())}));var h=[];return 0===d.length?h:(d.forEach((function(e){h=h.concat(m.pairiteration(e.left,e.right,a))})),h=h.filter((function(e,t){return h.indexOf(e)===t})))},getccenter:function(e,t,i){var s,o=t.x-e.x,l=t.y-e.y,d=i.x-t.x,u=i.y-t.y,g=o*r(c)-l*n(c),f=o*n(c)+l*r(c),v=d*r(c)-u*n(c),y=d*n(c)+u*r(c),w=(e.x+t.x)/2,x=(e.y+t.y)/2,b=(t.x+i.x)/2,C=(t.y+i.y)/2,A=w+g,I=x+f,S=b+v,T=C+y,_=m.lli8(w,x,A,I,b,C,S,T),M=m.dist(_,e),O=a(e.y-_.y,e.x-_.x),R=a(t.y-_.y,t.x-_.x),E=a(i.y-_.y,i.x-_.x);return O<E?((O>R||R>E)&&(O+=h),O>E&&(s=E,E=O,O=s)):E<R&&R<O?(s=E,E=O,O=s):E+=h,_.s=O,_.e=E,_.r=M,_},numberSort:function(e,t){return e-t}};e.exports=m}()},738:(e,t,i)=>{"use strict";const r=i(3341),n=i(6401),s=i(5299);function cloneDeep(e,t){switch(n(e)){case"object":return function cloneObjectDeep(e,t){if("function"==typeof t)return t(e);if(t||s(e)){const i=new e.constructor;for(let r in e)i[r]=cloneDeep(e[r],t);return i}return e}(e,t);case"array":return function cloneArrayDeep(e,t){const i=new e.constructor(e.length);for(let r=0;r<e.length;r++)i[r]=cloneDeep(e[r],t);return i}(e,t);default:return r(e)}}e.exports=cloneDeep},5299:(e,t,i)=>{"use strict";var r=i(7798);function isObjectObject(e){return!0===r(e)&&"[object Object]"===Object.prototype.toString.call(e)}e.exports=function isPlainObject(e){var t,i;return!1!==isObjectObject(e)&&("function"==typeof(t=e.constructor)&&(!1!==isObjectObject(i=t.prototype)&&!1!==i.hasOwnProperty("isPrototypeOf")))}},7798:e=>{"use strict";e.exports=function isObject(e){return null!=e&&"object"==typeof e&&!1===Array.isArray(e)}},6401:e=>{var t=Object.prototype.toString;function ctorName(e){return"function"==typeof e.constructor?e.constructor.name:null}e.exports=function kindOf(e){if(void 0===e)return"undefined";if(null===e)return"null";var i=typeof e;if("boolean"===i)return"boolean";if("string"===i)return"string";if("number"===i)return"number";if("symbol"===i)return"symbol";if("function"===i)return function isGeneratorFn(e,t){return"GeneratorFunction"===ctorName(e)}(e)?"generatorfunction":"function";if(function isArray(e){return Array.isArray?Array.isArray(e):e instanceof Array}(e))return"array";if(function isBuffer(e){if(e.constructor&&"function"==typeof e.constructor.isBuffer)return e.constructor.isBuffer(e);return!1}(e))return"buffer";if(function isArguments(e){try{if("number"==typeof e.length&&"function"==typeof e.callee)return!0}catch(e){if(-1!==e.message.indexOf("callee"))return!0}return!1}(e))return"arguments";if(function isDate(e){return e instanceof Date||"function"==typeof e.toDateString&&"function"==typeof e.getDate&&"function"==typeof e.setDate}(e))return"date";if(function isError(e){return e instanceof Error||"string"==typeof e.message&&e.constructor&&"number"==typeof e.constructor.stackTraceLimit}(e))return"error";if(function isRegexp(e){return e instanceof RegExp||"string"==typeof e.flags&&"boolean"==typeof e.ignoreCase&&"boolean"==typeof e.multiline&&"boolean"==typeof e.global}(e))return"regexp";switch(ctorName(e)){case"Symbol":return"symbol";case"Promise":return"promise";case"WeakMap":return"weakmap";case"WeakSet":return"weakset";case"Map":return"map";case"Set":return"set";case"Int8Array":return"int8array";case"Uint8Array":return"uint8array";case"Uint8ClampedArray":return"uint8clampedarray";case"Int16Array":return"int16array";case"Uint16Array":return"uint16array";case"Int32Array":return"int32array";case"Uint32Array":return"uint32array";case"Float32Array":return"float32array";case"Float64Array":return"float64array"}if(function isGeneratorObj(e){return"function"==typeof e.throw&&"function"==typeof e.return&&"function"==typeof e.next}(e))return"generator";switch(i=t.call(e)){case"[object Object]":return"object";case"[object Map Iterator]":return"mapiterator";case"[object Set Iterator]":return"setiterator";case"[object String Iterator]":return"stringiterator";case"[object Array Iterator]":return"arrayiterator"}return i.slice(8,-1).toLowerCase().replace(/\s/g,"")}},6470:(e,t,i)=>{"use strict";var r=i(4155);function assertPath(e){if("string"!=typeof e)throw new TypeError("Path must be a string. Received "+JSON.stringify(e))}function normalizeStringPosix(e,t){for(var i,r="",n=0,s=-1,a=0,o=0;o<=e.length;++o){if(o<e.length)i=e.charCodeAt(o);else{if(47===i)break;i=47}if(47===i){if(s===o-1||1===a);else if(s!==o-1&&2===a){if(r.length<2||2!==n||46!==r.charCodeAt(r.length-1)||46!==r.charCodeAt(r.length-2))if(r.length>2){var l=r.lastIndexOf("/");if(l!==r.length-1){-1===l?(r="",n=0):n=(r=r.slice(0,l)).length-1-r.lastIndexOf("/"),s=o,a=0;continue}}else if(2===r.length||1===r.length){r="",n=0,s=o,a=0;continue}t&&(r.length>0?r+="/..":r="..",n=2)}else r.length>0?r+="/"+e.slice(s+1,o):r=e.slice(s+1,o),n=o-s-1;s=o,a=0}else 46===i&&-1!==a?++a:a=-1}return r}var n={resolve:function resolve(){for(var e,t="",i=!1,n=arguments.length-1;n>=-1&&!i;n--){var s;n>=0?s=arguments[n]:(void 0===e&&(e=r.cwd()),s=e),assertPath(s),0!==s.length&&(t=s+"/"+t,i=47===s.charCodeAt(0))}return t=normalizeStringPosix(t,!i),i?t.length>0?"/"+t:"/":t.length>0?t:"."},normalize:function normalize(e){if(assertPath(e),0===e.length)return".";var t=47===e.charCodeAt(0),i=47===e.charCodeAt(e.length-1);return 0!==(e=normalizeStringPosix(e,!t)).length||t||(e="."),e.length>0&&i&&(e+="/"),t?"/"+e:e},isAbsolute:function isAbsolute(e){return assertPath(e),e.length>0&&47===e.charCodeAt(0)},join:function join(){if(0===arguments.length)return".";for(var e,t=0;t<arguments.length;++t){var i=arguments[t];assertPath(i),i.length>0&&(void 0===e?e=i:e+="/"+i)}return void 0===e?".":n.normalize(e)},relative:function relative(e,t){if(assertPath(e),assertPath(t),e===t)return"";if((e=n.resolve(e))===(t=n.resolve(t)))return"";for(var i=1;i<e.length&&47===e.charCodeAt(i);++i);for(var r=e.length,s=r-i,a=1;a<t.length&&47===t.charCodeAt(a);++a);for(var o=t.length-a,l=s<o?s:o,d=-1,h=0;h<=l;++h){if(h===l){if(o>l){if(47===t.charCodeAt(a+h))return t.slice(a+h+1);if(0===h)return t.slice(a+h)}else s>l&&(47===e.charCodeAt(i+h)?d=h:0===h&&(d=0));break}var c=e.charCodeAt(i+h);if(c!==t.charCodeAt(a+h))break;47===c&&(d=h)}var u="";for(h=i+d+1;h<=r;++h)h!==r&&47!==e.charCodeAt(h)||(0===u.length?u+="..":u+="/..");return u.length>0?u+t.slice(a+d):(a+=d,47===t.charCodeAt(a)&&++a,t.slice(a))},_makeLong:function _makeLong(e){return e},dirname:function dirname(e){if(assertPath(e),0===e.length)return".";for(var t=e.charCodeAt(0),i=47===t,r=-1,n=!0,s=e.length-1;s>=1;--s)if(47===(t=e.charCodeAt(s))){if(!n){r=s;break}}else n=!1;return-1===r?i?"/":".":i&&1===r?"//":e.slice(0,r)},basename:function basename(e,t){if(void 0!==t&&"string"!=typeof t)throw new TypeError('"ext" argument must be a string');assertPath(e);var i,r=0,n=-1,s=!0;if(void 0!==t&&t.length>0&&t.length<=e.length){if(t.length===e.length&&t===e)return"";var a=t.length-1,o=-1;for(i=e.length-1;i>=0;--i){var l=e.charCodeAt(i);if(47===l){if(!s){r=i+1;break}}else-1===o&&(s=!1,o=i+1),a>=0&&(l===t.charCodeAt(a)?-1==--a&&(n=i):(a=-1,n=o))}return r===n?n=o:-1===n&&(n=e.length),e.slice(r,n)}for(i=e.length-1;i>=0;--i)if(47===e.charCodeAt(i)){if(!s){r=i+1;break}}else-1===n&&(s=!1,n=i+1);return-1===n?"":e.slice(r,n)},extname:function extname(e){assertPath(e);for(var t=-1,i=0,r=-1,n=!0,s=0,a=e.length-1;a>=0;--a){var o=e.charCodeAt(a);if(47!==o)-1===r&&(n=!1,r=a+1),46===o?-1===t?t=a:1!==s&&(s=1):-1!==t&&(s=-1);else if(!n){i=a+1;break}}return-1===t||-1===r||0===s||1===s&&t===r-1&&t===i+1?"":e.slice(t,r)},format:function format(e){if(null===e||"object"!=typeof e)throw new TypeError('The "pathObject" argument must be of type Object. Received type '+typeof e);return function _format(e,t){var i=t.dir||t.root,r=t.base||(t.name||"")+(t.ext||"");return i?i===t.root?i+r:i+e+r:r}("/",e)},parse:function parse(e){assertPath(e);var t={root:"",dir:"",base:"",ext:"",name:""};if(0===e.length)return t;var i,r=e.charCodeAt(0),n=47===r;n?(t.root="/",i=1):i=0;for(var s=-1,a=0,o=-1,l=!0,d=e.length-1,h=0;d>=i;--d)if(47!==(r=e.charCodeAt(d)))-1===o&&(l=!1,o=d+1),46===r?-1===s?s=d:1!==h&&(h=1):-1!==s&&(h=-1);else if(!l){a=d+1;break}return-1===s||-1===o||0===h||1===h&&s===o-1&&s===a+1?-1!==o&&(t.base=t.name=0===a&&n?e.slice(1,o):e.slice(a,o)):(0===a&&n?(t.name=e.slice(1,s),t.base=e.slice(1,o)):(t.name=e.slice(a,s),t.base=e.slice(a,o)),t.ext=e.slice(s,o)),a>0?t.dir=e.slice(0,a-1):n&&(t.dir="/"),t},sep:"/",delimiter:":",win32:null,posix:null};n.posix=n,e.exports=n},4155:e=>{var t,i,r=e.exports={};function defaultSetTimout(){throw new Error("setTimeout has not been defined")}function defaultClearTimeout(){throw new Error("clearTimeout has not been defined")}function runTimeout(e){if(t===setTimeout)return setTimeout(e,0);if((t===defaultSetTimout||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(i){try{return t.call(null,e,0)}catch(i){return t.call(this,e,0)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:defaultSetTimout}catch(e){t=defaultSetTimout}try{i="function"==typeof clearTimeout?clearTimeout:defaultClearTimeout}catch(e){i=defaultClearTimeout}}();var n,s=[],a=!1,o=-1;function cleanUpNextTick(){a&&n&&(a=!1,n.length?s=n.concat(s):o=-1,s.length&&drainQueue())}function drainQueue(){if(!a){var e=runTimeout(cleanUpNextTick);a=!0;for(var t=s.length;t;){for(n=s,s=[];++o<t;)n&&n[o].run();o=-1,t=s.length}n=null,a=!1,function runClearTimeout(e){if(i===clearTimeout)return clearTimeout(e);if((i===defaultClearTimeout||!i)&&clearTimeout)return i=clearTimeout,clearTimeout(e);try{return i(e)}catch(t){try{return i.call(null,e)}catch(t){return i.call(this,e)}}}(e)}}function Item(e,t){this.fun=e,this.array=t}function noop(){}r.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var i=1;i<arguments.length;i++)t[i-1]=arguments[i];s.push(new Item(e,t)),1!==s.length||a||runTimeout(drainQueue)},Item.prototype.run=function(){this.fun.apply(null,this.array)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={},r.on=noop,r.addListener=noop,r.once=noop,r.off=noop,r.removeListener=noop,r.removeAllListeners=noop,r.emit=noop,r.prependListener=noop,r.prependOnceListener=noop,r.listeners=function(e){return[]},r.binding=function(e){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(e){throw new Error("process.chdir is not supported")},r.umask=function(){return 0}},3341:(e,t,i)=>{"use strict";const r=Symbol.prototype.valueOf,n=i(6401);e.exports=function clone(e,t){switch(n(e)){case"array":return e.slice();case"object":return Object.assign({},e);case"date":return new e.constructor(Number(e));case"map":return new Map(e);case"set":return new Set(e);case"buffer":return function cloneBuffer(e){const t=e.length,i=Buffer.allocUnsafe?Buffer.allocUnsafe(t):Buffer.from(t);return e.copy(i),i}(e);case"symbol":return function cloneSymbol(e){return r?Object(r.call(e)):{}}(e);case"arraybuffer":return function cloneArrayBuffer(e){const t=new e.constructor(e.byteLength);return new Uint8Array(t).set(new Uint8Array(e)),t}(e);case"float32array":case"float64array":case"int16array":case"int32array":case"int8array":case"uint16array":case"uint32array":case"uint8clampedarray":case"uint8array":return function cloneTypedArray(e,t){return new e.constructor(e.buffer,e.byteOffset,e.length)}(e);case"regexp":return function cloneRegExp(e){const t=void 0!==e.flags?e.flags:/\w+$/.exec(e)||void 0,i=new e.constructor(e.source,t);return i.lastIndex=e.lastIndex,i}(e);case"error":return Object.create(e);default:return e}}},6721:(e,t,i)=>{"use strict";e.exports=i(2192)},2921:e=>{"use strict";var t=2*Math.PI;function unit_vector_angle(e,t,i,r){var n=e*i+t*r;return n>1&&(n=1),n<-1&&(n=-1),(e*r-t*i<0?-1:1)*Math.acos(n)}function approximate_unit_arc(e,t){var i=4/3*Math.tan(t/4),r=Math.cos(e),n=Math.sin(e),s=Math.cos(e+t),a=Math.sin(e+t);return[r,n,r-n*i,n+r*i,s+a*i,a-s*i,s,a]}e.exports=function a2c(e,i,r,n,s,a,o,l,d){var h=Math.sin(d*t/360),c=Math.cos(d*t/360),u=c*(e-r)/2+h*(i-n)/2,g=-h*(e-r)/2+c*(i-n)/2;if(0===u&&0===g)return[];if(0===o||0===l)return[];o=Math.abs(o),l=Math.abs(l);var f=u*u/(o*o)+g*g/(l*l);f>1&&(o*=Math.sqrt(f),l*=Math.sqrt(f));var m=function get_arc_center(e,i,r,n,s,a,o,l,d,h){var c=h*(e-r)/2+d*(i-n)/2,u=-d*(e-r)/2+h*(i-n)/2,g=o*o,f=l*l,m=c*c,v=u*u,y=g*f-g*v-f*m;y<0&&(y=0),y/=g*v+f*m;var w=(y=Math.sqrt(y)*(s===a?-1:1))*o/l*u,x=y*-l/o*c,b=h*w-d*x+(e+r)/2,C=d*w+h*x+(i+n)/2,A=(c-w)/o,I=(u-x)/l,S=(-c-w)/o,T=(-u-x)/l,_=unit_vector_angle(1,0,A,I),M=unit_vector_angle(A,I,S,T);return 0===a&&M>0&&(M-=t),1===a&&M<0&&(M+=t),[b,C,_,M]}(e,i,r,n,s,a,o,l,h,c),v=[],y=m[2],w=m[3],x=Math.max(Math.ceil(Math.abs(w)/(t/4)),1);w/=x;for(var b=0;b<x;b++)v.push(approximate_unit_arc(y,w)),y+=w;return v.map((function(e){for(var t=0;t<e.length;t+=2){var i=e[t+0],r=e[t+1],n=c*(i*=o)-h*(r*=l),s=h*i+c*r;e[t+0]=n+m[0],e[t+1]=s+m[1]}return e}))}},6954:e=>{"use strict";var t=1e-10,i=Math.PI/180;function Ellipse(e,t,i){if(!(this instanceof Ellipse))return new Ellipse(e,t,i);this.rx=e,this.ry=t,this.ax=i}Ellipse.prototype.transform=function(e){var r=Math.cos(this.ax*i),n=Math.sin(this.ax*i),s=[this.rx*(e[0]*r+e[2]*n),this.rx*(e[1]*r+e[3]*n),this.ry*(-e[0]*n+e[2]*r),this.ry*(-e[1]*n+e[3]*r)],a=s[0]*s[0]+s[2]*s[2],o=s[1]*s[1]+s[3]*s[3],l=((s[0]-s[3])*(s[0]-s[3])+(s[2]+s[1])*(s[2]+s[1]))*((s[0]+s[3])*(s[0]+s[3])+(s[2]-s[1])*(s[2]-s[1])),d=(a+o)/2;if(l<t*d)return this.rx=this.ry=Math.sqrt(d),this.ax=0,this;var h=s[0]*s[1]+s[2]*s[3],c=d+(l=Math.sqrt(l))/2,u=d-l/2;return this.ax=Math.abs(h)<t&&Math.abs(c-o)<t?90:180*Math.atan(Math.abs(h)>Math.abs(c-o)?(c-a)/h:h/(c-o))/Math.PI,this.ax>=0?(this.rx=Math.sqrt(c),this.ry=Math.sqrt(u)):(this.ax+=90,this.rx=Math.sqrt(u),this.ry=Math.sqrt(c)),this},Ellipse.prototype.isDegenerate=function(){return this.rx<t*this.ry||this.ry<t*this.rx},e.exports=Ellipse},9159:e=>{"use strict";function combine(e,t){return[e[0]*t[0]+e[2]*t[1],e[1]*t[0]+e[3]*t[1],e[0]*t[2]+e[2]*t[3],e[1]*t[2]+e[3]*t[3],e[0]*t[4]+e[2]*t[5]+e[4],e[1]*t[4]+e[3]*t[5]+e[5]]}function Matrix(){if(!(this instanceof Matrix))return new Matrix;this.queue=[],this.cache=null}Matrix.prototype.matrix=function(e){return 1===e[0]&&0===e[1]&&0===e[2]&&1===e[3]&&0===e[4]&&0===e[5]||(this.cache=null,this.queue.push(e)),this},Matrix.prototype.translate=function(e,t){return 0===e&&0===t||(this.cache=null,this.queue.push([1,0,0,1,e,t])),this},Matrix.prototype.scale=function(e,t){return 1===e&&1===t||(this.cache=null,this.queue.push([e,0,0,t,0,0])),this},Matrix.prototype.rotate=function(e,t,i){var r,n,s;return 0!==e&&(this.translate(t,i),r=e*Math.PI/180,n=Math.cos(r),s=Math.sin(r),this.queue.push([n,s,-s,n,0,0]),this.cache=null,this.translate(-t,-i)),this},Matrix.prototype.skewX=function(e){return 0!==e&&(this.cache=null,this.queue.push([1,0,Math.tan(e*Math.PI/180),1,0,0])),this},Matrix.prototype.skewY=function(e){return 0!==e&&(this.cache=null,this.queue.push([1,Math.tan(e*Math.PI/180),0,1,0,0])),this},Matrix.prototype.toArray=function(){if(this.cache)return this.cache;if(!this.queue.length)return this.cache=[1,0,0,1,0,0],this.cache;if(this.cache=this.queue[0],1===this.queue.length)return this.cache;for(var e=1;e<this.queue.length;e++)this.cache=combine(this.cache,this.queue[e]);return this.cache},Matrix.prototype.calc=function(e,t,i){var r;return this.queue.length?(this.cache||(this.cache=this.toArray()),[e*(r=this.cache)[0]+t*r[2]+(i?0:r[4]),e*r[1]+t*r[3]+(i?0:r[5])]):[e,t]},e.exports=Matrix},3665:e=>{"use strict";var t={a:7,c:6,h:1,l:2,m:2,r:4,q:4,s:4,t:2,v:1,z:0},i=[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279];function isSpace(e){return 10===e||13===e||8232===e||8233===e||32===e||9===e||11===e||12===e||160===e||e>=5760&&i.indexOf(e)>=0}function isDigit(e){return e>=48&&e<=57}function isDigitStart(e){return e>=48&&e<=57||43===e||45===e||46===e}function State(e){this.index=0,this.path=e,this.max=e.length,this.result=[],this.param=0,this.err="",this.segmentStart=0,this.data=[]}function skipSpaces(e){for(;e.index<e.max&&isSpace(e.path.charCodeAt(e.index));)e.index++}function scanFlag(e){var t=e.path.charCodeAt(e.index);return 48===t?(e.param=0,void e.index++):49===t?(e.param=1,void e.index++):void(e.err="SvgPath: arc flag can be 0 or 1 only (at pos "+e.index+")")}function scanParam(e){var t,i=e.index,r=i,n=e.max,s=!1,a=!1,o=!1,l=!1;if(r>=n)e.err="SvgPath: missed param (at pos "+r+")";else if(43!==(t=e.path.charCodeAt(r))&&45!==t||(t=++r<n?e.path.charCodeAt(r):0),isDigit(t)||46===t){if(46!==t){if(s=48===t,t=++r<n?e.path.charCodeAt(r):0,s&&r<n&&t&&isDigit(t))return void(e.err="SvgPath: numbers started with `0` such as `09` are illegal (at pos "+i+")");for(;r<n&&isDigit(e.path.charCodeAt(r));)r++,a=!0;t=r<n?e.path.charCodeAt(r):0}if(46===t){for(l=!0,r++;isDigit(e.path.charCodeAt(r));)r++,o=!0;t=r<n?e.path.charCodeAt(r):0}if(101===t||69===t){if(l&&!a&&!o)return void(e.err="SvgPath: invalid float exponent (at pos "+r+")");if(43!==(t=++r<n?e.path.charCodeAt(r):0)&&45!==t||r++,!(r<n&&isDigit(e.path.charCodeAt(r))))return void(e.err="SvgPath: invalid float exponent (at pos "+r+")");for(;r<n&&isDigit(e.path.charCodeAt(r));)r++}e.index=r,e.param=parseFloat(e.path.slice(i,r))+0}else e.err="SvgPath: param should start with 0..9 or `.` (at pos "+r+")"}function finalizeSegment(e){var i,r;r=(i=e.path[e.segmentStart]).toLowerCase();var n=e.data;if("m"===r&&n.length>2&&(e.result.push([i,n[0],n[1]]),n=n.slice(2),r="l",i="m"===i?"l":"L"),"r"===r)e.result.push([i].concat(n));else for(;n.length>=t[r]&&(e.result.push([i].concat(n.splice(0,t[r]))),t[r]););}function scanSegment(e){var i,r,n,s,a,o=e.max;if(e.segmentStart=e.index,r=function isArc(e){return 97==(32|e)}(i=e.path.charCodeAt(e.index)),function isCommand(e){switch(32|e){case 109:case 122:case 108:case 104:case 118:case 99:case 115:case 113:case 116:case 97:case 114:return!0}return!1}(i))if(s=t[e.path[e.index].toLowerCase()],e.index++,skipSpaces(e),e.data=[],s){for(n=!1;;){for(a=s;a>0;a--){if(!r||3!==a&&4!==a?scanParam(e):scanFlag(e),e.err.length)return;e.data.push(e.param),skipSpaces(e),n=!1,e.index<o&&44===e.path.charCodeAt(e.index)&&(e.index++,skipSpaces(e),n=!0)}if(!n){if(e.index>=e.max)break;if(!isDigitStart(e.path.charCodeAt(e.index)))break}}finalizeSegment(e)}else finalizeSegment(e);else e.err="SvgPath: bad command "+e.path[e.index]+" (at pos "+e.index+")"}e.exports=function pathParse(e){var t=new State(e),i=t.max;for(skipSpaces(t);t.index<i&&!t.err.length;)scanSegment(t);return t.err.length?t.result=[]:t.result.length&&("mM".indexOf(t.result[0][0])<0?(t.err="SvgPath: string should start with `M` or `m`",t.result=[]):t.result[0][0]="M"),{err:t.err,segments:t.result}}},2192:(e,t,i)=>{"use strict";var r=i(3665),n=i(2094),s=i(9159),a=i(2921),o=i(6954);function SvgPath(e){if(!(this instanceof SvgPath))return new SvgPath(e);var t=r(e);this.segments=t.segments,this.err=t.err,this.__stack=[]}SvgPath.from=function(e){if("string"==typeof e)return new SvgPath(e);if(e instanceof SvgPath){var t=new SvgPath("");return t.err=e.err,t.segments=e.segments.map((function(e){return e.slice()})),t.__stack=e.__stack.map((function(e){return s().matrix(e.toArray())})),t}throw new Error("SvgPath.from: invalid param type "+e)},SvgPath.prototype.__matrix=function(e){var t,i=this;e.queue.length&&this.iterate((function(r,n,s,a){var l,d,h,c;switch(r[0]){case"v":d=0===(l=e.calc(0,r[1],!0))[0]?["v",l[1]]:["l",l[0],l[1]];break;case"V":d=(l=e.calc(s,r[1],!1))[0]===e.calc(s,a,!1)[0]?["V",l[1]]:["L",l[0],l[1]];break;case"h":d=0===(l=e.calc(r[1],0,!0))[1]?["h",l[0]]:["l",l[0],l[1]];break;case"H":d=(l=e.calc(r[1],a,!1))[1]===e.calc(s,a,!1)[1]?["H",l[0]]:["L",l[0],l[1]];break;case"a":case"A":var u=e.toArray(),g=o(r[1],r[2],r[3]).transform(u);if(u[0]*u[3]-u[1]*u[2]<0&&(r[5]=r[5]?"0":"1"),l=e.calc(r[6],r[7],"a"===r[0]),"A"===r[0]&&r[6]===s&&r[7]===a||"a"===r[0]&&0===r[6]&&0===r[7]){d=["a"===r[0]?"l":"L",l[0],l[1]];break}d=g.isDegenerate()?["a"===r[0]?"l":"L",l[0],l[1]]:[r[0],g.rx,g.ry,g.ax,r[4],r[5],l[0],l[1]];break;case"m":c=n>0,d=["m",(l=e.calc(r[1],r[2],c))[0],l[1]];break;default:for(d=[h=r[0]],c=h.toLowerCase()===h,t=1;t<r.length;t+=2)l=e.calc(r[t],r[t+1],c),d.push(l[0],l[1])}i.segments[n]=d}),!0)},SvgPath.prototype.__evaluateStack=function(){var e,t;if(this.__stack.length){if(1===this.__stack.length)return this.__matrix(this.__stack[0]),void(this.__stack=[]);for(e=s(),t=this.__stack.length;--t>=0;)e.matrix(this.__stack[t].toArray());this.__matrix(e),this.__stack=[]}},SvgPath.prototype.toString=function(){var e="",t="",i=!1;this.__evaluateStack();for(var r=0,n=this.segments.length;r<n;r++){var s=this.segments[r],a=s[0];a!==t||"m"===a||"M"===a?("m"===a&&"z"===t&&(e+=" "),e+=a,i=!1):i=!0;for(var o=1;o<s.length;o++){var l=s[o];1===o?i&&l>=0&&(e+=" "):l>=0&&(e+=" "),e+=l}t=a}return e},SvgPath.prototype.translate=function(e,t){return this.__stack.push(s().translate(e,t||0)),this},SvgPath.prototype.scale=function(e,t){return this.__stack.push(s().scale(e,t||0===t?t:e)),this},SvgPath.prototype.rotate=function(e,t,i){return this.__stack.push(s().rotate(e,t||0,i||0)),this},SvgPath.prototype.skewX=function(e){return this.__stack.push(s().skewX(e)),this},SvgPath.prototype.skewY=function(e){return this.__stack.push(s().skewY(e)),this},SvgPath.prototype.matrix=function(e){return this.__stack.push(s().matrix(e)),this},SvgPath.prototype.transform=function(e){return e.trim()?(this.__stack.push(n(e)),this):this},SvgPath.prototype.round=function(e){var t,i=0,r=0,n=0,s=0;return e=e||0,this.__evaluateStack(),this.segments.forEach((function(a){var o=a[0].toLowerCase()===a[0];switch(a[0]){case"H":case"h":return o&&(a[1]+=n),n=a[1]-a[1].toFixed(e),void(a[1]=+a[1].toFixed(e));case"V":case"v":return o&&(a[1]+=s),s=a[1]-a[1].toFixed(e),void(a[1]=+a[1].toFixed(e));case"Z":case"z":return n=i,void(s=r);case"M":case"m":return o&&(a[1]+=n,a[2]+=s),n=a[1]-a[1].toFixed(e),s=a[2]-a[2].toFixed(e),i=n,r=s,a[1]=+a[1].toFixed(e),void(a[2]=+a[2].toFixed(e));case"A":case"a":return o&&(a[6]+=n,a[7]+=s),n=a[6]-a[6].toFixed(e),s=a[7]-a[7].toFixed(e),a[1]=+a[1].toFixed(e),a[2]=+a[2].toFixed(e),a[3]=+a[3].toFixed(e+2),a[6]=+a[6].toFixed(e),void(a[7]=+a[7].toFixed(e));default:return t=a.length,o&&(a[t-2]+=n,a[t-1]+=s),n=a[t-2]-a[t-2].toFixed(e),s=a[t-1]-a[t-1].toFixed(e),void a.forEach((function(t,i){i&&(a[i]=+a[i].toFixed(e))}))}})),this},SvgPath.prototype.iterate=function(e,t){var i,r,n,s=this.segments,a={},o=!1,l=0,d=0,h=0,c=0;if(t||this.__evaluateStack(),s.forEach((function(t,i){var r=e(t,i,l,d);Array.isArray(r)&&(a[i]=r,o=!0);var n=t[0]===t[0].toLowerCase();switch(t[0]){case"m":case"M":return l=t[1]+(n?l:0),d=t[2]+(n?d:0),h=l,void(c=d);case"h":case"H":return void(l=t[1]+(n?l:0));case"v":case"V":return void(d=t[1]+(n?d:0));case"z":case"Z":return l=h,void(d=c);default:l=t[t.length-2]+(n?l:0),d=t[t.length-1]+(n?d:0)}})),!o)return this;for(n=[],i=0;i<s.length;i++)if(void 0!==a[i])for(r=0;r<a[i].length;r++)n.push(a[i][r]);else n.push(s[i]);return this.segments=n,this},SvgPath.prototype.abs=function(){return this.iterate((function(e,t,i,r){var n,s=e[0],a=s.toUpperCase();if(s!==a)switch(e[0]=a,s){case"v":return void(e[1]+=r);case"a":return e[6]+=i,void(e[7]+=r);default:for(n=1;n<e.length;n++)e[n]+=n%2?i:r}}),!0),this},SvgPath.prototype.rel=function(){return this.iterate((function(e,t,i,r){var n,s=e[0],a=s.toLowerCase();if(s!==a&&(0!==t||"M"!==s))switch(e[0]=a,s){case"V":return void(e[1]-=r);case"A":return e[6]-=i,void(e[7]-=r);default:for(n=1;n<e.length;n++)e[n]-=n%2?i:r}}),!0),this},SvgPath.prototype.unarc=function(){return this.iterate((function(e,t,i,r){var n,s,o,l=[],d=e[0];return"A"!==d&&"a"!==d?null:("a"===d?(s=i+e[6],o=r+e[7]):(s=e[6],o=e[7]),0===(n=a(i,r,s,o,e[4],e[5],e[1],e[2],e[3])).length?[["a"===e[0]?"l":"L",e[6],e[7]]]:(n.forEach((function(e){l.push(["C",e[2],e[3],e[4],e[5],e[6],e[7]])})),l))})),this},SvgPath.prototype.unshort=function(){var e,t,i,r,n,s=this.segments;return this.iterate((function(a,o,l,d){var h,c=a[0],u=c.toUpperCase();o&&("T"===u?(h="t"===c,"Q"===(i=s[o-1])[0]?(e=i[1]-l,t=i[2]-d):"q"===i[0]?(e=i[1]-i[3],t=i[2]-i[4]):(e=0,t=0),r=-e,n=-t,h||(r+=l,n+=d),s[o]=[h?"q":"Q",r,n,a[1],a[2]]):"S"===u&&(h="s"===c,"C"===(i=s[o-1])[0]?(e=i[3]-l,t=i[4]-d):"c"===i[0]?(e=i[3]-i[5],t=i[4]-i[6]):(e=0,t=0),r=-e,n=-t,h||(r+=l,n+=d),s[o]=[h?"c":"C",r,n,a[1],a[2],a[3],a[4]]))})),this},e.exports=SvgPath},2094:(e,t,i)=>{"use strict";var r=i(9159),n={matrix:!0,scale:!0,rotate:!0,translate:!0,skewX:!0,skewY:!0},s=/\s*(matrix|translate|scale|rotate|skewX|skewY)\s*\(\s*(.+?)\s*\)[\s,]*/,a=/[\s,]+/;e.exports=function transformParse(e){var t,i,o=new r;return e.split(s).forEach((function(e){if(e.length)if(void 0===n[e])switch(i=e.split(a).map((function(e){return+e||0})),t){case"matrix":return void(6===i.length&&o.matrix(i));case"scale":return void(1===i.length?o.scale(i[0],i[0]):2===i.length&&o.scale(i[0],i[1]));case"rotate":return void(1===i.length?o.rotate(i[0],0,0):3===i.length&&o.rotate(i[0],i[1],i[2]));case"translate":return void(1===i.length?o.translate(i[0],0):2===i.length&&o.translate(i[0],i[1]));case"skewX":return void(1===i.length&&o.skewX(i[0]));case"skewY":return void(1===i.length&&o.skewY(i[0]))}else t=e})),o}},6481:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createCustomFeedbackActions=void 0;const r=i(1106),n=i(7700),s=i(3966),a=i(1487);function drawSelectionShapes(e,t,i,r){let n=!1;for(let a=0;a<t.length;a++){const o=t[a];o.selectionShapes&&(n||(n=!0,i.saveContext(),i.native.resetTransform(),i.native.scale(i.renderScaleMultiplier,i.renderScaleMultiplier)),(0,s.drawSelectionShape)(o,e.selectionShapes.color,e.selectionShapes.lineWidth,e.selectionShapes.lineWidthIgnoreCameraScale,i.native,r))}n&&i.restoreContext()}function drawFeedback(e,t,i){for(let s=0;s<e.shapes.length;s++){const o=e.shapes[s],l=(0,n.getFinalPosition)(t,o.position,i.cameraScale,!1),d=(0,n.getFinalSize)(t,o.size,i.cameraScale),h=o.border.lineWidthIgnoreCameraScale?o.border.lineWidth:o.border.lineWidth/i.cameraScale,c=(0,a.calculateBorderOffset)(2*h,o.border.lineGrowth),u=d.width+c,g=d.height+c,f=-u/2,m=-g/2;i.translateRotateAndScale(l.x,l.y,t.rotation*a.DegToRad,1);const v=(0,r.getStrokePatternClassic)(o.border.style,h);switch(o.type){case"rectangle":if(o.cornerRadius>0){const e=o.cornerRadiusIgnoreCameraScale?o.cornerRadius:o.cornerRadius/i.cameraScale;i.drawRoundedRectangle(f,m,u,g,e,o.fillColor,o.border.color,h,v)}else i.drawRectangle(f,m,u,g,o.fillColor,o.border.color,h,v);break;case"ellipse":i.drawEllipse(f,m,u,g,o.fillColor,o.border.color,h,v)}i.undoTranslateRotateAndScale(l.x,l.y,t.rotation*a.DegToRad,1)}}function initFeedbackWithDefaults(e){var t,i,r,n;return Object.assign(Object.assign({},e),{selectionShapes:void 0===e.selectionShapes?{draw:!1,color:"",lineWidth:0,lineWidthIgnoreCameraScale:!1}:{draw:null!==(t=e.selectionShapes.draw)&&void 0!==t&&t,color:null!==(i=e.selectionShapes.color)&&void 0!==i?i:"black",lineWidth:null!==(r=e.selectionShapes.lineWidth)&&void 0!==r?r:0,lineWidthIgnoreCameraScale:null!==(n=e.selectionShapes.lineWidthIgnoreCameraScale)&&void 0!==n&&n},shapes:e.shapes.map((e=>function initShapeWithDefault(e){var t,i,r,n,s,a,o,l;const d={fillColor:e.fillColor||"",border:{color:(null===(t=e.border)||void 0===t?void 0:t.color)||"",lineGrowth:(null===(i=e.border)||void 0===i?void 0:i.lineGrowth)||"inwards-outwards",lineWidth:(null===(r=e.border)||void 0===r?void 0:r.lineWidth)||0,lineWidthIgnoreCameraScale:null!==(s=null===(n=e.border)||void 0===n?void 0:n.lineWidthIgnoreCameraScale)&&void 0!==s&&s,style:(null===(a=e.border)||void 0===a?void 0:a.style)||""},position:Object.assign(Object.assign({},e.position),{offset:e.position.offset||{x:0,y:0},screenOffset:e.position.screenOffset||{x:0,y:0}}),size:Object.assign(Object.assign({},e.size),{offset:e.size.offset||{width:0,height:0},screenOffset:e.size.screenOffset||{width:0,height:0}})};switch(e.type){case"rectangle":return Object.assign(Object.assign({},d),{type:"rectangle",cornerRadius:null!==(o=e.cornerRadius)&&void 0!==o?o:0,cornerRadiusIgnoreCameraScale:null!==(l=e.cornerRadiusIgnoreCameraScale)&&void 0!==l&&l});case"ellipse":return Object.assign(Object.assign({},d),{type:"ellipse"})}}(e)))})}t.createCustomFeedbackActions=e=>{const t=[],i=new Map;let r;const enqueueRedrawFeedbacks=()=>e.invalidateViewport(),remove=e=>{const r=i.get(e);if(!r)return void console.error("Unable to remove feedback, not found in existing feedbacks.",e);const n=t.indexOf(r);n>=0&&t.splice(n,1),i.delete(r.id),enqueueRedrawFeedbacks()},add=(r,s)=>{i.has(s.id)&&remove(s.id);const a={id:s.id,relativeToIds:r,relativeToNodes:[],feedback:initFeedbackWithDefaults(s),bounds:null,animation:null};i.set(s.id,a),a.relativeToNodes=(0,n.getReferenceNodes)(e,a.relativeToIds),a.bounds=(0,n.getReferenceBoundsFromNodes)(a.relativeToNodes),t.push(a),(()=>{t.sort(((e,t)=>e.feedback.drawingPriority-t.feedback.drawingPriority))})(),enqueueRedrawFeedbacks()};return{api:{add:(e,t)=>add(e,t),remove:e=>remove(e),getAll:()=>t.map((e=>e.id)),playEaseInAnimation:(e,t)=>((e,t)=>{if(t.duration<=0)return;const r=i.get(e);r?(r.animation={animation:t,time:performance.now()/1e3},enqueueRedrawFeedbacks()):console.error("Unable to play ease in animation, not found in existing feedbacks.",e)})(e,t)},animationsDone:()=>{for(const e of i.values())if(null!==e.animation&&null!==e.animation)return!1;return!0},setDebugAnimationTime:e=>{r=e},draw:i=>{if(0===t.length)return;const s=i.surface,a=s.beginRender(!0);for(let i=0;i<t.length;i++){const r=t[i];r.relativeToNodes=(0,n.getReferenceNodes)(e,r.relativeToIds),r.bounds=(0,n.getReferenceBoundsFromNodes)(r.relativeToNodes)}const o=performance.now();let l=!1;for(let e=0;e<t.length;e++){const n=t[e];if(null===n.bounds)continue;i.setDirty();let d=1;if(null!==n.animation){const e=void 0===r?o/1e3:n.animation.time+r;d=Math.min((e-n.animation.time)/n.animation.animation.duration,1),1===d?n.animation=null:l=!0}s.ctx.globalAlpha=d,n.feedback.selectionShapes.draw&&drawSelectionShapes(n.feedback,n.relativeToNodes,a,i.camera),drawFeedback(n.feedback,n.bounds,a)}s.ctx.globalAlpha=1,a.finishRendering(),l&&enqueueRedrawFeedbacks()}}}},8665:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createCustomHandleActions=void 0;const r=i(7700),n=i(1799),s=i(9819),a=i(3037),o=i(1487);function deleteFromArray(e,t){const i=e.indexOf(t);i>=0&&e.splice(i,1)}function getHitAreasRects(e,t,i,n){const s=(0,r.getFinalPosition)(t,e.position,i,n);return e.hitAreas.map((e=>{const o=n?e.offset:(0,r.applyBoundsRotation)(e.offset,t),l=0!==e.size.width||0!==e.size.height?{width:e.size.width/i,height:e.size.height/i}:(0,r.getFinalSize)(t,e.relativeSize,i),d=n||!t.rotated?l.width:Math.sqrt(l.width*l.width+l.height*l.height),h=n||!t.rotated?l.height:d;return(new a.Rectangle).setBounds(s.x+o.x/i-d/2,s.y+o.y/i-h/2,d,h)}))}function isOverlappingHandle(e,t,i){const r=e.bounds,n=t.bounds,s=e.hitRects,a=t.hitRects;if(null===r||null===n||null===s||null===a)return!1;const o=r.rotation===n.rotation;if(o&&0===r.rotation)return s.some((e=>a.some((t=>e.intersects(t)))));const l=getHitAreasRects(e.handle,r,i,o),d=getHitAreasRects(t.handle,n,i,o);return l.some((e=>d.some((t=>e.intersects(t)))))}function isCameraScaleDependant(e){if(0!==e.position.screenOffset.x||0!==e.position.screenOffset.y)return!0;for(let t=0;t<e.hitAreas.length;t++){const i=e.hitAreas[t];if(0!==i.offset.x||0!==i.offset.y)return!0;if(0!==i.size.width||0!==i.size.height)return!0;if(0!==i.relativeSize.screenOffset.width||0!==i.relativeSize.screenOffset.height)return!0}return!1}const l={dataUrl:"",size:{width:0,height:0}};function drawHandle(e,t,i,n,s){const a=n?e.hoverIcon:e.icon;if(a===l)return;const d=(0,r.getFinalPosition)(t,e.position,i.cameraScale,!1),h=s.get(a.dataUrl);if(!h)return;const c=a.size.width,u=a.size.height,g=-c/2,f=-u/2;i.translateRotateAndScale(d.x,d.y,t.rotation*o.DegToRad,1/i.cameraScale),i.drawImage(h,g,f,c,u),i.undoTranslateRotateAndScale(d.x,d.y,t.rotation*o.DegToRad,1/i.cameraScale)}t.createCustomHandleActions=e=>{const t=[],i=[],d=[],h=[];let c=!0;const u=new Map,g=new Map,f=new Map,m=new Set,v=new s.QuadTreeRoot,y=new n.QuadTreeIterator(v);let w=0,x=null,b=null,C=e.camera.scale,A=e.camera.scale;const enqueueRedrawHandles=()=>e.invalidateViewport(),sortHandleByVisibleOrder=e=>{e.sort(((e,t)=>e.handle.drawingPriority-t.handle.drawingPriority))},getHitHandlesInVisibleOrder=(e,t)=>{const i=new Set;if(y.forEachVisibleNode((new a.Rectangle).setBounds(e-C/2,t-C/2,C,C),(n=>{const s=n.handleRef;!s.hidden&&function isInsideHandle(e,t,i,n){if(null===i.bounds||null===i.hitRects)return!1;let s=!1;for(let r=0;r<i.hitRects.length&&!s;r++)i.hitRects[r].containsPoint(e,t)&&(s=!0);if(!s)return!1;if(!i.bounds.rotated)return!0;const a=i.bounds,l=i.handle,d=(0,r.getFinalPosition)(a,l.position,n,!1),h=(0,o.transformPointToLocalPoint)({x:e,y:t},d,a.rotation);for(let e=0;e<l.hitAreas.length;e++){const t=l.hitAreas[e],i=h.x-t.offset.x/n,s=h.y-t.offset.y/n,o=0!==t.size.width||0!==t.size.height?{width:t.size.width/n,height:t.size.height/n}:(0,r.getFinalSize)(a,t.relativeSize,n);if(Math.abs(i)<=o.width/2&&Math.abs(s)<=o.height/2)return!0}return!1}(e,t,s,C)&&i.add(s)})),0===i.size)return[];const n=[...i];return sortHandleByVisibleOrder(n),n},updateHitRects=t=>{t.bounds=(0,r.getReferenceBounds)(e,t.relativeToIds);const i=null!==t.bounds?getHitAreasRects(t.handle,t.bounds,A,!1):null;if(null===i&&null!==t.quadTreeNodes){for(let e=0;e<t.quadTreeNodes.length;e++)v.delete(t.quadTreeNodes[e]);t.quadTreeNodes=null}else if(null!==i&&null===t.quadTreeNodes)t.quadTreeNodes=i.map((e=>({aabb:(new a.Rectangle).copy(e),handleRef:t,id:w++,qtFrame:-1,qtParent:null,qtIndexInParent:-1}))),t.quadTreeNodes.forEach((e=>v.insert(e)));else if(null!==i&&null!==t.quadTreeNodes&&t.quadTreeNodes.length===i.length)for(let e=0;e<i.length;e++)t.quadTreeNodes[e].aabb.copy(i[e]),v.updated(t.quadTreeNodes[e]);t.hitRects=i},applyPendingChangesToHandles=()=>{if(c||(c=!0,sortHandleByVisibleOrder(h),sortHandleByVisibleOrder(d)),m.size>0&&(m.forEach((e=>updateHitRects(e))),m.clear()),A!==C){A=C;for(let e=0;e<i.length;e++){const t=i[e];updateHitRects(t)}}},updateHover=()=>{var e;if(null===x)return!1;applyPendingChangesToHandles();const t=null!==(e=getHitHandlesInVisibleOrder(x.x,x.y).pop())&&void 0!==e?e:null;return t!==b&&(b=t,!0)},updateHidden=e=>{let t=!1;if(null!==e.bounds&&null!==e.handle.hide){const i=e.handle.hide;if(i.onOverlap){const i=g.get(e.relativeToIdsUnified);if(void 0!==i)for(let r=i.length-1;r>=0&&!t;r--){const n=i[r];n!==e&&(n.hidden||(t=isOverlappingHandle(e,n,C)))}}t=t||i.minWidth>0&&e.bounds.size.width<i.minWidth,t=t||i.minHeight>0&&e.bounds.size.height<i.minHeight,t=t||i.minScreenWidth>0&&e.bounds.size.width*C<i.minScreenWidth,t=t||i.minScreenHeight>0&&e.bounds.size.height*C<i.minScreenHeight}e.hidden=t},onNodeAABBUpdated=e=>{const t=f.get(e);if(void 0!==t)for(let e=0;e<t.length;e++)m.add(t[e])},I=(0,r.buildSimpleCanvasImageCache)((()=>enqueueRedrawHandles()),(e=>console.error("Error decoding handle icon image",e))),remove=(r,n)=>{const s=u.get(r);s?((r=>{deleteFromArray(t,r),null!==r.handle.hide&&deleteFromArray(d,r),r.cameraScaleDependant&&deleteFromArray(i,r);const n=g.get(r.relativeToIdsUnified);if(void 0!==n&&(deleteFromArray(n,r),0===n.length&&g.delete(r.relativeToIdsUnified)),r.hasIcon&&deleteFromArray(h,r),u.delete(r.id),r.relativeToIds.forEach((t=>{const i=f.get(t);i&&(deleteFromArray(i,r),0===i.length&&(f.delete(t),e.removeWatchNodeAABB(t,onNodeAABBUpdated)))})),null!==r.quadTreeNodes){for(let e=0;e<r.quadTreeNodes.length;e++)v.delete(r.quadTreeNodes[e]);r.quadTreeNodes=null}})(s),n&&enqueueRedrawHandles()):console.error("Unable to remove handle, not found in existing handles.",r)},addHandleRefInDrawingOrder=(e,t,i=!0)=>{if(0===e.length||i&&!c)return void e.push(t);const r=t.handle,n=e[0].handle,s=e[e.length-1].handle;r.drawingPriority>=s.drawingPriority?e.push(t):r.drawingPriority<=n.drawingPriority?e.unshift(t):(e.push(t),i?c=!1:sortHandleByVisibleOrder(e))},add=(n,s,a)=>{u.has(s.id)&&remove(s.id,!1);const o=function initHandleWithDefaults(e){var t,i,r,n,s,a,o,d,h,c,u,g;return Object.assign(Object.assign({},e),{icon:e.icon||l,hoverIcon:e.hoverIcon||e.icon||l,hide:e.hide?{onOverlap:null!==(i=null===(t=e.hide)||void 0===t?void 0:t.onOverlap)&&void 0!==i&&i,minWidth:null!==(n=null===(r=e.hide)||void 0===r?void 0:r.minWidth)&&void 0!==n?n:0,minHeight:null!==(a=null===(s=e.hide)||void 0===s?void 0:s.minHeight)&&void 0!==a?a:0,minScreenWidth:null!==(d=null===(o=e.hide)||void 0===o?void 0:o.minScreenWidth)&&void 0!==d?d:0,minScreenHeight:null!==(c=null===(h=e.hide)||void 0===h?void 0:h.minScreenHeight)&&void 0!==c?c:0}:null,position:Object.assign(Object.assign({},e.position),{offset:null!==(u=e.position.offset)&&void 0!==u?u:{x:0,y:0},screenOffset:null!==(g=e.position.screenOffset)&&void 0!==g?g:{x:0,y:0}}),hitAreas:e.hitAreas.map((e=>{var t,i,r,n;return Object.assign(Object.assign({},e),{offset:null!==(t=e.offset)&&void 0!==t?t:{x:0,y:0},size:null!==(i=e.size)&&void 0!==i?i:{width:0,height:0},relativeSize:void 0!==e.relativeSize?Object.assign(Object.assign({},e.relativeSize),{offset:null!==(r=e.relativeSize.offset)&&void 0!==r?r:{width:0,height:0},screenOffset:null!==(n=e.relativeSize.screenOffset)&&void 0!==n?n:{width:0,height:0}}):{scale:{width:0,height:0},offset:{width:0,height:0},screenOffset:{width:0,height:0}}})}))})}(s),c={id:s.id,relativeToIds:n,relativeToIdsUnified:n.join(","),handle:o,hidden:!1,bounds:null,cameraScaleDependant:isCameraScaleDependant(o),hasIcon:void 0!==s.icon||void 0!==s.hoverIcon,hitRects:null,quadTreeNodes:null};u.set(s.id,c),c.bounds=(0,r.getReferenceBounds)(e,c.relativeToIds),updateHitRects(c),(r=>{t.push(r),null!==r.handle.hide&&addHandleRefInDrawingOrder(d,r),r.cameraScaleDependant&&i.push(r);let n=g.get(r.relativeToIdsUnified);void 0===n&&(n=[],g.set(r.relativeToIdsUnified,n)),addHandleRefInDrawingOrder(n,r,!1),r.hasIcon&&addHandleRefInDrawingOrder(h,r),r.relativeToIds.forEach((t=>{let i=f.get(t);i||(i=[],f.set(t,i),e.addWatchNodeAABB(t,onNodeAABBUpdated)),i.push(r)}))})(c),a&&enqueueRedrawHandles()};return{api:{add:(e,t)=>add(e,t,!0),addBatch:e=>(e=>{0!==e.length&&(e.forEach((e=>add(e.ids,e.handle,!1))),enqueueRedrawHandles())})(e),remove:e=>remove(e,!0),removeBatch:e=>(e=>{0!==e.length&&(e.forEach((e=>remove(e,!1))),enqueueRedrawHandles())})(e),getAt:(e,t)=>{var i,r;applyPendingChangesToHandles();return null!==(r=null===(i=getHitHandlesInVisibleOrder(e,t).pop())||void 0===i?void 0:i.id)&&void 0!==r?r:null},getAllAt:(e,t)=>{applyPendingChangesToHandles();const i=getHitHandlesInVisibleOrder(e,t);return i.reverse(),i.map((e=>e.id))},hoverAt:(e,t)=>{null!==x&&e===x.x&&t===x.y||(x={x:e,y:t},updateHover()&&enqueueRedrawHandles())},getAll:()=>(applyPendingChangesToHandles(),t.map((e=>e.id)))},draw:i=>{if(C=e.camera.scale,0===t.length)return;applyPendingChangesToHandles(),updateHover();const r=i.surface.beginRender(!0);for(let e=d.length-1;e>=0;e--){updateHidden(d[e])}for(let e=0;e<h.length;e++){const t=h[e];null!==t.bounds&&(t.hidden||(i.setDirty(),drawHandle(t.handle,t.bounds,r,t===b,I)))}r.finishRendering()}}}},3074:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createCustomLayersActions=void 0;t.createCustomLayersActions=e=>({show:t=>e.showCustomLayer(t),hide:t=>e.hideCustomLayer(t)})},7700:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.buildSimpleCanvasImageCache=t.getFinalSize=t.getFinalPosition=t.getReferenceBounds=t.getReferenceNodes=t.getReferenceBoundsFromNodes=t.applyBoundsRotation=void 0;const r=i(3037),n=i(1487);function applyBoundsRotation(e,t){return t.rotated?(0,n.addPoints)((0,n.multiplyPoint)(t.right,e.x),(0,n.multiplyPoint)(t.down,e.y)):e}t.applyBoundsRotation=applyBoundsRotation;const s={x:0,y:1},a={x:1,y:0};function getReferenceBoundsFromNodes(e){if(1===e.length){const t=e[0];if(t.simpleTransform){const e=t.aabbSelfOnlyWithoutRenderOverflow;return{center:{x:e.centerX,y:e.centerY},down:s,right:a,rotated:!1,rotation:0,size:{width:e.width,height:e.height}}}}let t=null,i=null;const o={width:0,height:0},l=new r.Rectangle;let d=!1,h=!1,c=0;for(let r=0;r<e.length;r++){const s=e[r];1!==e.length||s.axisAligned||(t={x:0,y:1},i={x:1,y:0},t=s.localToGlobalRotate(t),i=s.localToGlobalRotate(i),(0,n.normalizePointInPlace)(t),(0,n.normalizePointInPlace)(i),s.getNonRotatedGlobalSizeWithBorder(o),c=s.rotation,h=!0),d?l.union(s.aabbSelfOnlyWithoutRenderOverflow):(l.copy(s.aabbSelfOnlyWithoutRenderOverflow),d=!0)}if(!d)return null;h||(o.width=l.width,o.height=l.height);return{center:{x:l.centerX,y:l.centerY},size:o,rotated:h,rotation:c,right:null!==i?i:a,down:null!==t?t:s}}function getReferenceNodes(e,t){const i=[];for(let r=0;r<t.length;r++){const n=e.findNodeByExternalId(t[r]);n&&i.push(n)}return i}t.getReferenceBoundsFromNodes=getReferenceBoundsFromNodes,t.getReferenceNodes=getReferenceNodes,t.getReferenceBounds=function getReferenceBounds(e,t){return getReferenceBoundsFromNodes(getReferenceNodes(e,t))},t.getFinalPosition=function getFinalPosition(e,t,i,r){const s=t.anchor.x*e.size.width+t.offset.x+t.screenOffset.x/i,a=t.anchor.y*e.size.height+t.offset.y+t.screenOffset.y/i;return(0,n.addPoints)(e.center,r?{x:s,y:a}:applyBoundsRotation({x:s,y:a},e))},t.getFinalSize=function getFinalSize(e,t,i){return{width:t.scale.width*e.size.width+t.offset.width+t.screenOffset.width/i,height:t.scale.height*e.size.height+t.offset.height+t.screenOffset.height/i}},t.buildSimpleCanvasImageCache=function buildSimpleCanvasImageCache(e,t){const i=new Map,r=new Set;return{get:n=>{const s=i.get(n);if(s)return s;if(r.has(n))return null;r.add(n);const a=new Image;return a.onload=()=>{i.set(n,a),r.delete(n),e(n,a)},a.onerror=()=>{t(n)},a.src=n,null}}}},5443:function(__unused_webpack_module,exports,__webpack_require__){"use strict";var __awaiter=this&&this.__awaiter||function(e,t,i,r){return new(i||(i=Promise))((function(n,s){function fulfilled(e){try{step(r.next(e))}catch(e){s(e)}}function rejected(e){try{step(r.throw(e))}catch(e){s(e)}}function step(e){e.done?n(e.value):function adopt(e){return e instanceof i?e:new i((function(t){t(e)}))}(e.value).then(fulfilled,rejected)}step((r=r.apply(e,t||[])).next())}))};Object.defineProperty(exports,"__esModule",{value:!0}),exports.createDebugActions=void 0;const profiler_1=__webpack_require__(2112),Rectangle_1=__webpack_require__(3037),CONSOLE_LINE_HEIGHT=24,CONSOLE_MARGIN=10;class CanvasConsole{constructor(e,t){this.bounds=new Rectangle_1.Rectangle,this.lines=0,this.context=e,this.bounds.copy(t)}begin(e="rgba(255, 0, 0, 0.95)"){this.context.saveContext(),this.context.native.resetTransform(),this.context.native.scale(this.context.renderScaleMultiplier,this.context.renderScaleMultiplier),this.context.clipRectangle(this.bounds.x,this.bounds.y,this.bounds.width,this.bounds.height),this.context.fillRect(this.bounds.x,this.bounds.y,this.bounds.width,this.bounds.height,e)}drawTextLine(e){this.context.fillText(e,this.bounds.x+CONSOLE_MARGIN,this.bounds.y+CONSOLE_MARGIN+CONSOLE_LINE_HEIGHT*this.lines,"14px Lucida Console","black","left","top"),this.lines++}end(){this.context.restoreContext()}}function showQuadTreeRecursive(e,t){e.strokeStyle="#ff0",e.strokeRect(t.rect.x,t.rect.y,t.rect.width,t.rect.height),e.strokeStyle=t.subdivisions?"#f00":"#0f7",t.nodes.forEach((t=>{e.strokeRect(t.aabb.x,t.aabb.y,t.aabb.width,t.aabb.height)}));const i=t.subdivisions;null!==i&&(showQuadTreeRecursive(e,i.topLeft),showQuadTreeRecursive(e,i.topRight),showQuadTreeRecursive(e,i.bottomLeft),showQuadTreeRecursive(e,i.bottomRight))}function showQuadTree(e,t){e.save(),e.resetTransform(),e.lineWidth=1;const i=Math.min(e.canvas.width,e.canvas.height)/t.rect.width;e.scale(i,i),e.fillStyle="rgba(0,0,0,.5)",e.fillRect(0,0,t.rect.width,t.rect.height),e.translate(t.rect.width/2,t.rect.height/2),e.lineWidth=1/i,showQuadTreeRecursive(e,t),e.restore()}function showRootCache(e,t){const i=e.ctx;i.save(),e.resetTransform();const r=2/e.getCameraScale();i.lineWidth=r;const n=t.getFullBoundsIterator();for(i.beginPath();n.next();){const e=n.getCurrentBounds(),t=n.getCurrentInfo();i.strokeStyle=null!==t?"red":"green",i.strokeRect(e.x+r,e.y+r,e.width-2*r,e.height-2*r)}i.stroke(),i.restore()}function showRootCacheStats(e,t){const i=t.getStats(),r=e.beginRender(!0),n=8*CONSOLE_LINE_HEIGHT,s=new CanvasConsole(r,(new Rectangle_1.Rectangle).setBounds(r.targetWidth-300,r.targetHeight-n,300,n));s.begin(),s.drawTextLine("Enabled: "+i.enabled),s.drawTextLine("Force Skip: "+i.forceSkip),s.drawTextLine("Used Last Frame: "+i.used),s.drawTextLine("Tiles: "+i.rectsCount),s.drawTextLine("Invalidated Tiles: "+i.invalidatedTileIds.size),s.drawTextLine("Updated Tiles: "+i.updatedTiles),s.drawTextLine("Total Memory: "+i.totalMemoryMB+" MB"),s.drawTextLine("Total Pool: "+i.totalPoolMB+" MB"),s.end(),r.finishRendering()}function showPerformance(e){const t=e.beginRender(!0),i=new CanvasConsole(t,(new Rectangle_1.Rectangle).setBounds(t.targetWidth-600,t.targetHeight-700,600,700));i.begin("rgba(240, 255, 240, 0.95)"),i.drawTextLine("section : total : self");for(const{id:e,total:t,self:r}of profiler_1.profiler.timeDigest(!0))i.drawTextLine(`${e} : ${t.toFixed(3)} : ${r.toFixed(3)}`);i.drawTextLine(""),i.drawTextLine("counter : number");for(const[e,t]of profiler_1.profiler.counters())i.drawTextLine(`${e} : ${t}`);i.drawTextLine(""),i.drawTextLine("store : numbers");for(const[e,t]of profiler_1.profiler.stored())i.drawTextLine(`${e} : ${t.join(", ")}`);profiler_1.profiler.reset(),i.end(),t.finishRendering()}function showDeviceInfo(e,t){const i=e.beginRender(!0),r=new CanvasConsole(i,(new Rectangle_1.Rectangle).setBounds(i.targetWidth-600,i.targetHeight-700,600,700));if(r.begin("rgba(240, 255, 240, 0.95)"),r.drawTextLine(`Device Runtime: ${t.runtime} `),r.drawTextLine(`Device Mobile: ${t.mobile} `),r.drawTextLine(`Device Type: ${t.deviceType} `),r.drawTextLine(`Device Chromium Flavour: ${t.chromiumFlavour} `),t.debugUserAgent){const e=t.debugUserAgent.match(/.{1,60}/g);if(e){r.drawTextLine("Device UserAgent:");for(let t=0;t<e.length;t++)r.drawTextLine(`  ${e[t]}`)}}if(t.debugVendor){const e=t.debugVendor.match(/.{1,60}/g);if(e){r.drawTextLine("Device Vendor:");for(let t=0;t<e.length;t++)r.drawTextLine(`  ${e[t]}`)}}r.end(),i.finishRendering()}const getCircularReplacer=()=>{const e=new WeakSet;return(t,i)=>{if("object"==typeof i&&null!==i){if(e.has(i))return"[circular REF]";e.add(i)}return i}};function enableRepro(e,t=[],i="engine",r={idx:0,ts:0}){"engine"===i&&localStorage.setItem("$repro","const delay = n => new Promise(resolve => setTimeout(resolve, n));\n"),"object"!=typeof e||null===e||Array.isArray(e)||Object.keys(e).forEach((n=>{if(n.startsWith("__"))return;const s=`${i}.${n}`;if(t.includes(s))return;const a=e[n];"function"!=typeof a?enableRepro(a,t,s,r):e[n]=function(...e){++r.idx;const t=0===r.ts?0:Date.now()-r.ts;r.ts=Date.now();const i=t?`await delay(${t});\n`:"",n=`repro_${r.idx}`,o=localStorage.getItem("$repro")||"",l=`${s}(...${JSON.stringify(e,getCircularReplacer())});`;return localStorage.setItem("$repro",`${o}${i}const ${n} = ${l}\n`),a.apply(this,e)}}))}const createDebugActions=(muraldoc,imageCache,canvasFactory,selection,customFeedback,render,runtimeInfo)=>{let drawRootCache=!1,drawQuadTree=!1,drawPerformance=!1,drawDeviceInfo=!1,customDrawFn=null;function drawDebug(e,t){const i=t.surface;drawRootCache&&null!==e.cache&&(showRootCache(i,e.cache),showRootCacheStats(i,e.cache),t.setDirty()),drawQuadTree&&(showQuadTree(i.ctx,e.qt.root),t.setDirty()),drawPerformance&&(showPerformance(i),t.setDirty()),drawDeviceInfo&&(showDeviceInfo(i,runtimeInfo),t.setDirty()),null!==customDrawFn&&(i.resetTransform(),customDrawFn(i.ctx,t.setDirty))}return{draw:e=>drawDebug(muraldoc,e),api:{cacheFetching:()=>imageCache.fetching(),enableRepro:(api,exclude)=>(enableRepro(api,exclude),()=>__awaiter(void 0,void 0,void 0,(function*(){const code=localStorage.getItem("$repro")||"";yield eval(`(async () => {${code}})()`),localStorage.setItem("$repro",code)}))),forceRender:()=>render.flushRender(),toggleDrawQuadTree:()=>{drawQuadTree=!drawQuadTree,muraldoc.invalidateViewport()},toggleDrawRootCache:()=>{drawRootCache=!drawRootCache,muraldoc.invalidateViewport()},toggleDrawPerformance:()=>{drawPerformance=!drawPerformance,profiler_1.profiler.on=drawPerformance,profiler_1.profiler.reset(),muraldoc.invalidateViewport()},toggleDrawDeviceInfo:()=>{drawDeviceInfo=!drawDeviceInfo,muraldoc.invalidateViewport()},imageCacheStats:()=>imageCache.memoryStats(),zoomCacheStats:()=>{var e,t;return null!==(t=null===(e=muraldoc.cache)||void 0===e?void 0:e.getStats())&&void 0!==t?t:null},isUseCacheOn:()=>muraldoc.isUseCacheOn(),setUseCache:e=>muraldoc.setUseCache(e),wasCacheUsedLastFrame:()=>{var e;return!!(null===(e=muraldoc.cache)||void 0===e?void 0:e.getStats().used)},wasViewportOptimizationUsedLastFrame:()=>{var e;return!!(null===(e=muraldoc.viewportOptimization)||void 0===e?void 0:e.getStats().usedLastRender)},isUseViewportOptimizationOn:()=>muraldoc.isUseViewportOptimizationOn(),isUseSkipCacheHeuristicOn:()=>muraldoc.isUseSkipCacheHeuristicOn(),setUseViewportOptimization:e=>muraldoc.setUseViewportOptimization(e),isUseThrottledInvalidationOn:()=>muraldoc.isUseThrottledInvalidationOn(),setUseThrottledInvalidation:e=>muraldoc.setUseThrottledInvalidation(e),setUseSkipCacheHeuristic:e=>muraldoc.setUseSkipCacheHeuristic(e),renderDone:()=>muraldoc.renderDone,minimapDone:()=>muraldoc.minimapDone,getNumberOfHtmlCanvasElementsAlive:()=>canvasFactory.getCanvasMemoryStats().count,getRunningAnimations:()=>{let e=muraldoc.getRunningAnimations();return selection.animationsDone()||(e=new Set([...e,"selection"])),customFeedback.animationsDone()||(e=new Set([...e,"custom-feedback"])),e},animationsDone:()=>muraldoc.animationsDone&&selection.animationsDone()&&customFeedback.animationsDone(),toggleDrawSelectionDebug:()=>selection.toggleDrawDebug(),setSelectionAnimationTime:e=>selection.setDebugAnimationTime(e),setCustomFeedbackAnimationTime:e=>customFeedback.setDebugAnimationTime(e),setCustomDrawFn:e=>customDrawFn=e,getNumberOfNodesAlive:()=>muraldoc.getNodesAliveCount(),getCommitSha:()=>"1e269737"}}};exports.createDebugActions=createDebugActions},168:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MCustomLayer=void 0;t.MCustomLayer=class MCustomLayer{constructor(e,t,i,r,n){this.visible=!0,this.nodes=new Map,this.layerRootNodes=[],this.drawingOrderValid=!1,this.id=e,this.backColor=t,this.blocking=i,this.visible=r,this.root=n}hasNode(e){return this.nodes.has(e.id)}nodeAdded(e){this.nodes.set(e.id,e),this.drawingOrderValid=!1}nodeRemoved(e){this.nodes.delete(e.id);const t=this.layerRootNodes.indexOf(e);t>=0&&this.layerRootNodes.splice(t,1)}nodeInvalidated(){this.drawingOrderValid=!1}getLayerRootNodes(){return this.drawingOrderValid||(this.layerRootNodes.length=0,this.updateLayerRootNodes(this.root),this.drawingOrderValid=!0),this.layerRootNodes}updateLayerRootNodes(e){if(this.nodes.has(e.id))e.visible&&this.layerRootNodes.push(e);else{const t=e.children;for(let e=0;e<t.length;e++)this.updateLayerRootNodes(t[e])}}}},8333:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MDocument=void 0;const r=i(9570),n=i(3037),s=i(7313),a=i(3703),o=i(687),l={x:0,y:0},d={x:0,y:0},h=new n.Rectangle;class MDocument{constructor(e,t,i,r,n,l,d,h,c,u){this.nodesByExternalId=new Map,this.watchedAABB=new Map,this.newNodesToRegister=[],this.preRenderFn=()=>{},this.postRenderFn=()=>{},this.onContextRestoredFn=()=>{};const g=new s.RootNode;this.renderer=new o.Renderer(e,t,r,(e=>this.preRenderFn(e)),(e=>this.postRenderFn(e)),(()=>{this.root.disposeCacheSelfAndChildren(),this.minimap.disposeCache(),this.onContextRestoredFn()}),n,g,l,d,h,u,(()=>this.applyPendingChanges())),this.minimap=new a.Minimap(i,d,n,this.camera,g,l,c),g.setRootChangeListener(this.buildChangesListener())}get qt(){return this.renderer.qt}get cache(){return this.renderer.rootCache}get viewportOptimization(){return this.renderer.viewportOptimization}set bounds(e){this.renderer.bounds=(new n.Rectangle).copy(e),this.minimap.setMuralBounds(e.x,e.y,e.width,e.height)}get animationsDone(){return!this.root.isAnimating()}get renderDone(){return this.renderer.done}get minimapDone(){return this.minimap.done}getAllRect(){return this.applyPendingChanges(),this.root.aabb}registerViewportChangeListener(e){this.camera.registerChangeListener(e)}getRunningAnimations(){return this.root.getRunningAnimations()}buildChangesListener(){const updateNodeLayers=(e,t)=>{if(t(this.renderer.getLayer(e.layer)),null!==e.customLayersIds)for(let i=0;i<e.customLayersIds.length;i++){const r=this.renderer.getCustomLayer(e.customLayersIds[i]);null!==r&&t(r)}};return{nodeAdded:e=>{if(this.newNodesToRegister.push(e),updateNodeLayers(e,(t=>t.nodeAdded(e))),""!==e.externalId&&e!==this.root){if(this.nodesByExternalId.has(e.externalId)){let t=e;for(;t&&t.isPartialNode;)t=t.parent;console.error("Duplicated external id "+e.externalId+" non partial root external id "+(null==t?void 0:t.externalId)),console.error("existing node",this.nodesByExternalId.get(e.externalId)),console.error("new node",e)}this.nodesByExternalId.set(e.externalId,e)}},nodeRemoved:(e,t)=>{this.newNodesToRegister.indexOf(e)>=0?this.newNodesToRegister.splice(this.newNodesToRegister.indexOf(e),1):(this.renderer.qt.delete(e),this.renderer.invalidateRect(t),this.minimap.removeNode(e)),updateNodeLayers(e,(t=>t.nodeRemoved(e))),""!==e.externalId&&this.nodesByExternalId.delete(e.externalId)},nodeInvalidated:e=>{e!==this.root&&(this.renderer.invalidateRect(e.aabb),updateNodeLayers(e,(e=>e.nodeInvalidated())),this.minimap.updateNode(e))},nodeAABBChanged:(e,t)=>{if(this.renderer.qt.updated(e),e!==this.root){if(e.externalId&&this.watchedAABB.has(e.externalId)){const t=this.watchedAABB.get(e.externalId);if(void 0!==t)for(let i=0;i<t.length;i++)t[i](e.externalId,e)}t.intersects(e.aabb)?this.renderer.invalidateRect(h.copy(e.aabb).union(t)):(this.renderer.invalidateRect(t),this.renderer.invalidateRect(e.aabb)),updateNodeLayers(e,(e=>e.nodeInvalidated())),this.minimap.updateNode(e)}},nodeLayerChanged:(e,t)=>{this.renderer.getLayer(t).nodeRemoved(e),this.renderer.getLayer(e.layer).nodeAdded(e),e.invalidate(!1)},nodeCustomLayerAdded:(e,t)=>{var i,r;null===(i=this.renderer.getCustomLayer(t))||void 0===i||i.nodeAdded(e),(null===(r=this.renderer.getCustomLayer(t))||void 0===r?void 0:r.visible)&&e.invalidate(!1)},nodeCustomLayerRemoved:(e,t)=>{var i,r;null===(i=this.renderer.getCustomLayer(t))||void 0===i||i.nodeRemoved(e),(null===(r=this.renderer.getCustomLayer(t))||void 0===r?void 0:r.visible)&&e.invalidate(!1)},deferUpdate:()=>this.invalidateViewport()}}static create(e,t,i,r,s,a,o,l,d,h,c,u,g,f,m,v,y,w,x){const b=new MDocument(e,t,i,r,f,m,v,y,w,x);return d&&(b.renderer.backgroundColor=d),b.bounds=(new n.Rectangle).setBounds(s,a,o,l),h.forEach((e=>b.root.addChild(e))),b.applyPendingChanges(),b.renderer.warmupStrategies(),b.camera.setFullViewport(c,u,g),b.invalidateViewport(),b}destroy(){this.minimap.destroy(),this.renderer.destroy(),this.root.children.slice().forEach((e=>this.removeAndDestroyNode(e))),this.watchedAABB.clear(),this.newNodesToRegister.length=0}viewportResize(e,t){this.renderer.viewportResize(e,t)}get root(){return this.renderer.root}get cameraWidth(){return this.renderer.surface.width}get cameraHeight(){return this.renderer.surface.height}get camera(){return this.renderer.surface.camera}render(){this.renderer.render()}renderCustom(e,t){this.renderer.renderCustom(e,t)}findNodeByExternalId(e){const t=this.nodesByExternalId.get(e);return t||null}get cameraPosition(){return this.renderer.surface.cameraPosition}setCameraPosition(e,t){this.renderer.surface.setCameraPosition(e,t),this.renderer.invalidateViewport()}set cameraScale(e){this.renderer.surface.setCameraScale(e),this.renderer.invalidateViewport()}get cameraScale(){return this.renderer.surface.getCameraScale()}removeAndDestroyNode(e){const t=e.parent;e.removeFromParent(),e.destroy(),null!==t&&t.dontCleanChildrenOnUpdate&&t.dummy&&0===t.children.length&&this.removeAndDestroyNode(t)}updateOrBuildNodesFromState(e,t,i){e.forEach((e=>{const r=e.parentId?this.findNodeByExternalId(e.parentId):this.root;if(r)this.updateOrBuildNodeFromStateInternal(e,r,t,void 0);else{const r=e.parentId||"",n=i(r),s=this.updateOrBuildNodeFromStateInternal(n,this.root,t,void 0);s&&this.updateOrBuildNodeFromStateInternal(e,s,t,void 0)}})),e.forEach((e=>this.destroyUnknownChildren(e)))}destroyUnknownChildren(e){const t=this.findNodeByExternalId(e.externalId);if(t&&!t.dontCleanChildrenOnUpdate)for(let i=t.children.length-1;i>=0;i--){const r=t.children[i],n=e.children.find((e=>e.externalId===r.externalId));n?this.destroyUnknownChildren(n):r.dontCleanChildrenOnUpdate&&r.children.length>0?(r.removeFromParent(),r.dummy=!0,r.visible=!1,this.root.adoptChild(r)):this.removeAndDestroyNode(r)}}updateOrBuildNodeFromStateInternal(e,t,i,r){const n=this.findNodeByExternalId(e.externalId),s=n||i(e);n&&n.init(e),s.parent!==t&&(s.removeFromParent(),t.adoptChild(s,r));for(let t=0;t<e.children.length;++t){const r=e.children[t];this.updateOrBuildNodeFromStateInternal(r,s,i,s.isPartialNode?void 0:t)}return s}isUseCacheOn(){return this.renderer.isUseCacheOn()}setUseCache(e){this.renderer.setUseCache(e)}isUseViewportOptimizationOn(){return this.renderer.isUseViewportOptimizationOn()}setUseViewportOptimization(e){this.renderer.setUseViewportOptimization(e)}isUseThrottledInvalidationOn(){return this.renderer.isUseViewportOptimizationOn()}setUseThrottledInvalidation(e){this.renderer.setUseThrottledInvalidation(e)}isUseSkipCacheHeuristicOn(){return this.renderer.isUseSkipCacheHeuristicOn()}setUseSkipCacheHeuristic(e){this.renderer.setUseSkipCacheHeuristic(e)}offsetBounds(e,t){const i=(new n.Rectangle).copy(this.renderer.bounds);i.setLocation(e,t),this.bounds=i}resizeBounds(e,t){const i=(new n.Rectangle).copy(this.renderer.bounds);i.setDimension(e,t),this.bounds=i}setBackground(e){this.renderer.backgroundColor=e}setClearColor(e){this.renderer.clearColor=e}visitNodesAtPos(e,t,i,r,n,s){if(!n)for(let n=this.renderer.customLayers.length-1;n>=0;n--){const a=this.renderer.customLayers[n];if(!a.visible)continue;const o=a.getLayerRootNodes();for(let n=o.length-1;n>=0;n--){const l=o[n];if(this.visitNodesInNodeAtPos(l,e,t,i,r,a,null,s,!0))return}if(a.blocking)return}for(let n=this.renderer.layersDrawingOrder.length-1;n>=0;n--){const a=this.renderer.layersDrawingOrder[n],o=a.getLayerRootNodes();for(let n=o.length-1;n>=0;n--){const l=o[n];if(this.visitNodesInNodeAtPos(l,e,t,i,r,null,a.layer,s,!0))return}}}visitNodesInNodeAtPos(e,t,i,r,n,s,a,o,d){if(!e.aabbWithoutRenderOverflow.containsPointTolerance(t,i,r))return!1;null===s||e.isPartialNode||(d=s.hasNode(e)),null!==a&&(d=e.layer===a);for(let l=e.children.length-1;l>=0;l--){const h=e.children[l];if(this.visitNodesInNodeAtPos(h,t,i,r,n,s,a,o,d))return!0}return e!==this.root&&(!!d&&(n?o(e):(l.x=t,l.y=i,e.globalToLocalTransform(l),!!e.hitTest(l.x,l.y,this.cameraScale)&&o(e))))}visitNodesAtRect(e,t,i){const n=this.renderer.qtIterator,s=(0,r.getNextQtFrame)();if(n.forEachVisibleNode(e,(t=>{const i=t;(0===i.renderOverflow||i.aabbWithoutRenderOverflow.intersects(e))&&(t.qtFrame=s)})),!t)for(let t=this.renderer.customLayers.length-1;t>=0;t--){const r=this.renderer.customLayers[t];if(!r.visible)continue;const n=r.getLayerRootNodes();for(let t=n.length-1;t>=0;t--){const a=n[t];if(a.qtFrame!==s)continue;if(this.visitNodesInNodeAtRect(a,e,r,null,i,s,!0))return}if(r.blocking)return}for(let t=this.renderer.layersDrawingOrder.length-1;t>=0;t--){const r=this.renderer.layersDrawingOrder[t],n=r.getLayerRootNodes();for(let t=n.length-1;t>=0;t--){const a=n[t];if(a.qtFrame!==s)continue;if(this.visitNodesInNodeAtRect(a,e,null,r.layer,i,s,!0))return}}}visitNodesInNodeAtRect(e,t,i,r,n,s,a){null===i||e.isPartialNode||(a=i.hasNode(e)),null!==r&&(a=e.layer===r);for(let o=e.children.length-1;o>=0;o--){const l=e.children[o];if(l.qtFrame!==s)continue;if(this.visitNodesInNodeAtRect(l,t,i,r,n,s,a))return!0}return e!==this.root&&(!!a&&(e.axisAligned?(l.x=t.x,l.y=t.y,e.globalToLocalTransform(l),d.x=t.x1,d.y=t.y1,e.globalToLocalTransform(d),!!e.hitTestRect(l.x,l.y,d.x-l.x,d.y-l.y,this.cameraScale)&&n(e)):n(e)))}getNode(e,t,i,r){this.applyPendingChanges();let n=null;const s=r?e=>!!r(e)&&(n=e,!0):e=>(n=e,!0),a=null!=i?i:20/this.camera.scale;return this.visitNodesAtPos(e,t,a,!1,!1,s),n===this.root?null:n}getNodes(e,t,i,r=!1,n=!1){this.applyPendingChanges();const s=[],a=null!=i?i:20/this.camera.scale;return this.visitNodesAtPos(e,t,a,r,n,(e=>e===this.root||(s.push(e),!1))),s}getNodesAtRect(e,t,i=!1){this.applyPendingChanges();const r=[];return this.visitNodesAtRect(e,i,(e=>e===this.root||(t&&!t(e)||r.push(e),!1))),r}getAllNonPartialNodesAtRectUnordered(e,t){this.applyPendingChanges();const i=[],n=this.renderer.qtIterator,s=(0,r.getNextQtFrame)();return n.forEachVisibleNode(e,(r=>{const n=r;!n.isPartialNode&&n.hint===t&&n.qtFrame!==s&&n.aabbSelfOnlyWithoutRenderOverflow.intersects(e)&&(n.qtFrame=s,i.push(n))})),i}getNodesAliveCount(){return this.nodesByExternalId.size}showGridLines(){this.renderer.showGridLines()}hideGridLines(){this.renderer.hideGridLines()}setGridLinesOptions(e){this.renderer.setGridLinesOptions(e)}invalidateViewport(){this.renderer.invalidateViewport()}showCustomLayer(e){this.renderer.showCustomLayer(e)}hideCustomLayer(e){this.renderer.hideCustomLayer(e)}addWatchNodeAABB(e,t){const i=this.watchedAABB.get(e),r=i||[];i||this.watchedAABB.set(e,r),r.push(t)}removeWatchNodeAABB(e,t){const i=this.watchedAABB.get(e);if(!i)return;const r=i.indexOf(t);r>=0&&i.splice(r,1),0===i.length&&this.watchedAABB.delete(e)}applyPendingChanges(){if(this.root.applyPendingTransforms(),this.newNodesToRegister.length>0){for(let e=0;e<this.newNodesToRegister.length;e++){const t=this.newNodesToRegister[e];this.renderer.qt.insert(t),this.renderer.invalidateRect(t.aabb),this.minimap.addNode(t),t.onRegisteredInMDocument()}this.newNodesToRegister.length=0}this.root.applyPendingInvalidate()}mountEngine(e){this.renderer.mountEngine(e)}unmountEngine(){this.renderer.unmountEngine()}}t.MDocument=MDocument},8319:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MLayer=void 0;t.MLayer=class MLayer{constructor(e,t,i){this.drawingOrder=0,this.nodes=new Map,this.layerRootNodes=[],this.drawingOrderValid=!1,this.layer=e,this.drawingOrder=t,this.root=i}nodeAdded(e){this.nodes.set(e.id,e),this.drawingOrderValid=!1}nodeRemoved(e){this.nodes.delete(e.id);const t=this.layerRootNodes.indexOf(e);t>=0&&this.layerRootNodes.splice(t,1)}nodeInvalidated(){this.drawingOrderValid=!1}getLayerRootNodes(){return this.drawingOrderValid||(this.layerRootNodes.length=0,this.updateLayerRootNodes(this.root),this.drawingOrderValid=!0),this.layerRootNodes}updateLayerRootNodes(e){if(e.layer===this.layer)e.visible&&this.layerRootNodes.push(e);else{const t=e.children;for(let e=0;e<t.length;e++)this.updateLayerRootNodes(t[e])}}}},3588:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MNode=t.normalizeRotation=void 0;const r=i(6016),n=i(3037),s=i(8207),a=i(109),o={x:0,y:0},l={x:0,y:0},d={x:0,y:0},h={x:0,y:0},c=function(){let e=0;return function(){return e++}}();t.normalizeRotation=e=>((e%=360)<0&&(e+=360),e);t.MNode=class MNode{constructor(e=""){this.lastState=null,this.id=c(),this.hint="",this.state=0,this.children=[],this.ownLayer_=0,this.parent_=null,this.changeListener=null,this.overlayRenderFn_=null,this.destroyFns=null,this.unitLength=1,this.cache=null,this.animationController_=null,this.animations_=null,this.customLayersIds_=null,this.viewportVisibilityChangedFns=null,this.getViewportScaleFn=null,this.width_=0,this.height_=0,this.x_=0,this.y_=0,this.rotation_=0,this.scaleX_=1,this.scaleY_=1,this.border_=0,this.renderOverflow_=0,this.alpha_=1,this.globalAlpha_=1,this.shadowProperties_=null,this.dontCleanChildrenOnUpdate_=!1,this.layer_=0,this.localMatrix_=r.Matrix3.Create(),this.globalMatrix_=r.Matrix3.Create(),this.inverseGlobalMatrix_=r.Matrix3.Create(),this.stackingLayer_=0,this.stackingOrder_=0,this.flags_=0,this.aabb=new n.Rectangle,this.aabbWithoutRenderOverflow=new n.Rectangle,this.aabbSelfOnlyWithoutRenderOverflow=new n.Rectangle,this.qtFrame=-1,this.qtParent=null,this.qtIndexInParent=-1,this.minimapShape_=null,this.selectionShapes_=null,this.lastReportedAABB=new n.Rectangle,this.externalId=e,this.visible=!0,this.setAxisAligned(!0),this.setInverseTransformDirty(!0),this.setLocalTransformDirty(!0)}init(e){this.initInternal(e),this.lastState=e}initInternal(e){this.animations_=e.animations,this.hint=e.hint,this.state=e.state,this.minimapShape_=e.minimapShape,this.selectionShapes_=e.selectionShapes,this.dontCleanChildrenOnUpdate_=e.dontCleanChildrenOnUpdate,this.setStackingOrder(e.stackingOrder),this.setStackingLayer(e.stackingLayer),this.setPosition(e.transform.x,e.transform.y),this.setSize(e.transform.width,e.transform.height),this.setScale(e.transform.scale,e.transform.scale),this.setRotation(e.transform.rotation),this.setBorder(e.border),e.dummy!==this.dummy&&(this.dummy=e.dummy,this.visible=!this.dummy)}get x(){return this.x_}get y(){return this.y_}get width(){return this.width_}get height(){return this.height_}get border(){return this.border_}get renderOverflow(){return this.renderOverflow_}get rotation(){return this.rotation_}get scaleX(){return this.scaleX_}get scaleY(){return this.scaleY_}get axisAligned(){return this.isFlagSet(2)}setAxisAligned(e){this.setFlagValue(2,e)}get simpleTransform(){return this.isFlagSet(4)}setSimpleTransform(e){return this.setFlagValue(4,e)}get isInvalidated(){return this.isFlagSet(1024)}setInvalidated(e){return this.setFlagValue(1024,e)}get isChildrenInvalidated(){return this.isFlagSet(2048)}setChildrenInvalidated(e){return this.setFlagValue(2048,e)}get isTransformDirty(){return this.isFlagSet(16)}setTransformDirty(e){return this.setFlagValue(16,e)}get isChildrenTransformDirty(){return this.isFlagSet(64)}setChildrenTransformDirty(e){return this.setFlagValue(64,e)}get isLocalTransformDirty(){return this.isFlagSet(8)}setLocalTransformDirty(e){return this.setFlagValue(8,e)}get isInverseTransformDirty(){return this.isFlagSet(32)}setInverseTransformDirty(e){return this.setFlagValue(32,e)}get stackingLayer(){return this.stackingLayer_}get stackingOrder(){return this.stackingOrder_}get parent(){return this.parent_}get ownLayer(){return this.ownLayer_}set ownLayer(e){this.ownLayer_!==e&&(this.ownLayer_=e,this.onOwnLayerChanged())}get layer(){return this.layer_}get isPartialNode(){return this.isFlagSet(128)}set isPartialNode(e){this.setFlagValue(128,e)}get alpha(){return this.alpha_}set alpha(e){Number.isFinite(e)||(console.error("Received a NaN in the alpha value of "+this.externalId),e=1),(e=Math.max(Math.min(e,1),0))!==this.alpha_&&(this.alpha_=e,this.onLocalAlphaChanged(),this.invalidate(!1))}get shadowProperties(){return this.shadowProperties_}set shadowProperties(e){var t,i;let r=!1;(null==e?void 0:e.transition)===(null===(t=this.shadowProperties_)||void 0===t?void 0:t.transition)&&(null==e?void 0:e.transitionPercent)===(null===(i=this.shadowProperties_)||void 0===i?void 0:i.transitionPercent)||(r=!0),this.shadowProperties_=e,r&&this.invalidate(!1)}get visible(){return this.isFlagSet(1)}set visible(e){this.visible!==e&&(this.setFlagValue(1,e),this.invalidate(!1))}get dummy(){return this.isFlagSet(256)}set dummy(e){this.dummy!==e&&(this.setFlagValue(256,e),this.invalidate(!1))}get visibleInViewport(){return this.isFlagSet(512)}setVisibleInViewport(e){this.setFlagValue(512,e)}get minimapShape(){return this.minimapShape_}get selectionShapes(){return this.selectionShapes_}get customLayersIds(){return this.customLayersIds_}get dontCleanChildrenOnUpdate(){return this.dontCleanChildrenOnUpdate_}clearFlag(e){this.flags_&=~e}setFlag(e){this.flags_|=e}isFlagSet(e){return 0!=(this.flags_&e)}setFlagValue(e,t){t?this.setFlag(e):this.clearFlag(e)}setChangeListener(e){this.changeListener=e,e.nodeAdded(this);const t=this.children;for(let i=0;i<t.length;i++)t[i].setChangeListener(e)}onRegisteredInMDocument(){this.lastReportedAABB.copy(this.aabb)}removeChangeListener(){if(null!==this.changeListener){this.changeListener.nodeRemoved(this,this.lastReportedAABB),this.lastReportedAABB.setEmpty(),this.changeListener=null;const e=this.children;for(let t=0;t<e.length;t++)e[t].removeChangeListener()}}setOverlayRenderFn(e){e!==this.overlayRenderFn_&&(this.overlayRenderFn_=e,this.invalidate(!1))}removeOverlayRenderFn(){null!==this.overlayRenderFn_&&(this.overlayRenderFn_=null,this.invalidate(!1))}setPosition(e,t){return Number.isFinite(e)||(console.error("Received a NaN in the X coordinate of "+this.externalId),e=0),Number.isFinite(t)||(console.error("Received a NaN in the Y coordinate of "+this.externalId),t=0),this.x_===e&&this.y_===t||(this.x_=e,this.y_=t,this.invalidateTransform()),this}setSize(e,t){return Number.isFinite(e)||(console.error("Received a NaN in the WIDTH of "+this.externalId),e=0),Number.isFinite(t)||(console.error("Received a NaN in the HEIGHT of "+this.externalId),t=0),this.width_===e&&this.height_===t||(this.width_=e,this.height_=t,null!==this.cache&&this.cache.invalidate(),this.invalidateTransform()),this}invalidateTransform(){var e;this.setTransformDirty(!0),this.setLocalTransformDirty(!0);let t=this.parent_;if(null!==t&&!t.isChildrenTransformDirty)for(t.setChildrenTransformDirty(!0),t=t.parent_,null===(e=this.changeListener)||void 0===e||e.deferUpdate();null!==t&&!t.isChildrenTransformDirty;)t.setChildrenTransformDirty(!0),t=t.parent_}setBorder(e){return Number.isFinite(e)||(console.error("Received a NaN in the BORDER of "+this.externalId),e=0),this.border_!==e&&(this.border_=e,null!==this.cache&&this.cache.invalidate(),this.invalidateTransform()),this}setRenderOverflow(e){return Number.isFinite(e)||(console.error("Received a NaN in the RENDER OVERFLOW of "+this.externalId),e=0),this.renderOverflow_!==e&&(this.renderOverflow_=e,null!==this.cache&&this.cache.invalidate(),this.invalidateTransform()),this}setScale(e,t){return Number.isFinite(e)||(console.error("Received a NaN in the X SCALE of "+this.externalId),e=1),Number.isFinite(t)||(console.error("Received a NaN in the Y SCALE of "+this.externalId),t=1),this.scaleX_===e&&this.scaleY_===t||(this.scaleX_=e,this.scaleY_=t,this.invalidateTransform()),this}setRotation(e){return Number.isFinite(e)||(console.error("Received a NaN in the ROTATION of "+this.externalId),e=0),e=(0,t.normalizeRotation)(e),this.rotation_!==e&&(this.rotation_=e,this.invalidateTransform()),this}updateAxisAligned(){this.setAxisAligned(0===this.rotation_&&(null===this.parent_||this.parent_.axisAligned))}onOwnLayerChanged(){this.updateSelfAndChildrenLayer()}updateSelfAndChildrenLayer(){this.updateLayer();const e=this.children;for(let t=0;t<e.length;t++)e[t].updateSelfAndChildrenLayer()}updateLayer(){const e=0===this.ownLayer_?null!=this.parent_?this.parent_.layer_:1:this.ownLayer_;if(e!==this.layer_){const t=this.layer_;this.layer_=e,null!==this.changeListener&&this.changeListener.nodeLayerChanged(this,t)}}onLocalAlphaChanged(){this.updateSelfAndChildrenGlobalAlpha()}updateSelfAndChildrenGlobalAlpha(){this.globalAlpha_=(null!=this.parent_?this.parent_.globalAlpha_:1)*this.alpha;const e=this.children;for(let t=0;t<e.length;t++)e[t].updateSelfAndChildrenGlobalAlpha()}updateAABBAndExpandWithChildren(){this.updateAABBToWidthHeightBorder();const e=this.children;if(e.length>0){const t=this.aabb,i=this.aabbWithoutRenderOverflow;for(let r=0;r<e.length;r++)t.union(e[r].aabb),i.union(e[r].aabbWithoutRenderOverflow)}this.reportAABBChanged()}updateGlobalTransform(){const e=this.globalMatrix_,t=this.localMatrix_;if(this.updateAxisAligned(),null===this.parent_)e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],this.setSimpleTransform(1===e[0]&&1===e[4]&&this.axisAligned),this.updateUnitLength();else if(this.axisAligned){const i=this.parent_.globalMatrix_;e[0]=i[0]*t[0],e[1]=0,e[2]=i[2]+t[2]*i[0],e[3]=0,e[4]=i[4]*t[4],e[5]=i[5]+t[5]*i[4],this.setSimpleTransform(1===e[0]&&1===e[4]),e[0]!==this.unitLength&&(this.unitLength=e[0],null!==this.cache&&this.cache.invalidate())}else{const i=this.parent_.globalMatrix_;e[0]=i[0],e[1]=i[1],e[2]=i[2],e[3]=i[3],e[4]=i[4],e[5]=i[5],r.Matrix3.Multiply(e,t),this.setSimpleTransform(!1),this.updateUnitLength()}this.setInverseTransformDirty(!0)}updateUnitLength(){const e=this.unitLength;if(this.axisAligned)this.unitLength=this.globalMatrix_[0];else{o.x=1,o.y=0,l.x=0,l.y=0,r.Matrix3.TransformPoint(this.globalMatrix_,o),r.Matrix3.TransformPoint(this.globalMatrix_,l);const e=l.x-o.x,t=l.y-o.y;this.unitLength=Math.sqrt(e*e+t*t)}this.unitLength!==e&&null!==this.cache&&this.cache.invalidate()}getInverseMatrix(){return this.isInverseTransformDirty&&(r.Matrix3.Inverse(this.globalMatrix_,this.inverseGlobalMatrix_),this.setInverseTransformDirty(!1)),this.inverseGlobalMatrix_}updateLocalTransform(){if(!this.isLocalTransformDirty)return;const e=this.localMatrix_;return 0!==this.rotation?this.updateLocalTransformRotated():(e[2]=this.x_,e[5]=this.y_,e[0]=this.scaleX_,e[4]=this.scaleY_,e[3]=0,e[1]=0),this.setLocalTransformDirty(!1),!0}updateLocalTransformRotated(){const e=this.localMatrix_,t=this.x_,i=this.y_,r=this.rotation_*Math.PI/180,n=Math.cos(r),s=Math.sin(r),a=this.scaleX_,o=this.scaleY_,l=a*n,d=a*-s,h=o*s,c=o*n;e[0]=l,e[1]=d,e[2]=t,e[3]=h,e[4]=c,e[5]=i}updateAABBToWidthHeightBorder(){const e=this.border_,t=e+this.renderOverflow_,i=this.globalMatrix_;if(this.axisAligned)this.aabb.setBounds(i[2]-t*i[0],i[5]-t*i[4],(this.width+2*t)*i[0],(this.height+2*t)*i[4]);else{o.x=-t,o.y=-t,r.Matrix3.TransformPoint(i,o),l.x=this.width+t,l.y=-t,r.Matrix3.TransformPoint(i,l),d.x=this.width+t,d.y=this.height+t,r.Matrix3.TransformPoint(i,d),h.x=-t,h.y=this.height+t,r.Matrix3.TransformPoint(i,h);const e=Math.min(o.x,l.x,d.x,h.x),n=Math.min(o.y,l.y,d.y,h.y),s=Math.max(o.x,l.x,d.x,h.x),a=Math.max(o.y,l.y,d.y,h.y);this.aabb.setBounds(e,n,Math.abs(s-e),Math.abs(a-n))}if(0===this.renderOverflow_)this.aabbWithoutRenderOverflow.copy(this.aabb);else if(this.axisAligned)this.aabbWithoutRenderOverflow.setBounds(i[2]-e*i[0],i[5]-e*i[4],(this.width+2*e)*i[0],(this.height+2*e)*i[4]);else{o.x=-e,o.y=-e,r.Matrix3.TransformPoint(i,o),l.x=this.width+e,l.y=-e,r.Matrix3.TransformPoint(i,l),d.x=this.width+e,d.y=this.height+e,r.Matrix3.TransformPoint(i,d),h.x=-e,h.y=this.height+e,r.Matrix3.TransformPoint(i,h);const t=Math.min(o.x,l.x,d.x,h.x),n=Math.min(o.y,l.y,d.y,h.y),s=Math.max(o.x,l.x,d.x,h.x),a=Math.max(o.y,l.y,d.y,h.y);this.aabbWithoutRenderOverflow.setBounds(t,n,Math.abs(s-t),Math.abs(a-n))}this.aabbSelfOnlyWithoutRenderOverflow.copy(this.aabbWithoutRenderOverflow)}transformPoints(e){for(let t=0,i=e.length;t<i;++t)r.Matrix3.TransformPoint(this.globalMatrix_,e[t])}getNonRotatedGlobalSizeWithBorder(e){const t=this.border_;if(this.axisAligned)e.width=this.aabbSelfOnlyWithoutRenderOverflow.width,e.height=this.aabbSelfOnlyWithoutRenderOverflow.height;else{let i=this.scaleX,r=this.scaleY,n=this.parent_;for(;null!==n;)i*=n.scaleX,r*=n.scaleY,n=n.parent_;e.width=Math.abs((this.width+2*t)*i),e.height=Math.abs((this.height+2*t)*r)}}getAABBCoords(e,t){for(;e.length<4;)e.push({x:0,y:0});const i=this.border_+(t?this.renderOverflow_:0);return e[0].x=-i,e[0].y=-i,e[1].x=this.width+i,e[1].y=-i,e[2].x=this.width+i,e[2].y=this.height+i,e[3].x=-i,e[3].y=this.height+i,this.transformPoints(e),e}setStackingOrder(e){return Number.isFinite(e)&&void 0!==e||(console.error("Received a NaN in the stackingOrder of "+this.externalId),e=0),this.stackingOrder_!==e&&(this.stackingOrder_=e,this.onStackingOrderChanged()),this}setStackingLayer(e){return Number.isFinite(e)||(console.error("Received a NaN in the stackingLayer of "+this.externalId),e=0),this.stackingLayer_!==e&&(this.stackingLayer_=e,this.onStackingOrderChanged()),this}onStackingOrderChanged(){null!==this.parent_&&this.parent_.onChildrenStackingOrderChanged(this)}onChildrenStackingOrderChanged(e){const t=this.children,i=t.indexOf(e),r=i-1,n=i+1,s=t.length-1,a=!(r>=0)||t[r].goesBefore(e),o=!(n<=s)||e.goesBefore(t[n]);if(!a||!o){if(a)if(t[s].goesBefore(e,!0))t.splice(i,1),t.push(e);else for(let r=i;r<s;++r){const i=t[r+1];if(e.goesBefore(i))break;t[r]=i,t[r+1]=e}else if(e.goesBefore(t[0],!0))t.splice(i,1),t.unshift(e);else for(let r=i;r>0;--r){const i=t[r-1];if(i.goesBefore(e))break;t[r]=i,t[r-1]=e}e.invalidate()}}localToGlobalTransform(e){return r.Matrix3.TransformPoint(this.globalMatrix_,e),e}localToGlobalRotate(e){return r.Matrix3.RotateAndScalePoint(this.globalMatrix_,e),e}globalToLocalTransform(e){r.Matrix3.TransformPoint(this.getInverseMatrix(),e)}addChild(e,t){if(null===e.parent_)return this.adoptChild(e,t);console.error(`node with parent added to ${this.id}`)}adoptChild(e,t){void 0===t||t>=this.children.length?this.children.push(e):this.children.splice(t,0,e),e.parent_=this,null!==this.changeListener&&e.setChangeListener(this.changeListener),this.onChildrenStackingOrderChanged(e),e.isInvalidated&&e.invalidate(!1),e.invalidateTransform(),e.updateSelfAndChildrenGlobalAlpha(),e.updateSelfAndChildrenLayer()}getChildIndex(e){const t=this.children.indexOf(e);return-1===t?void 0:t}removeChild(e){const t=this.children.indexOf(e);-1!==t&&this.removeChildAt(t)}removeChildAt(e){if(e<0||e>=this.children.length)return;const t=this.children[e];t.parent_=null,t.removeChangeListener(),this.children.splice(e,1),t.invalidateTransform(),t.updateSelfAndChildrenGlobalAlpha(),t.updateSelfAndChildrenLayer(),this.invalidateTransform()}removeFromParent(){null!==this.parent_&&this.parent_.removeChild(this)}reportAABBChanged(){null===this.changeListener||this.aabb.equals(this.lastReportedAABB)||(this.changeListener.nodeAABBChanged(this,this.lastReportedAABB),this.lastReportedAABB.copy(this.aabb))}render(e,t,i,r=!0){if(!t(this))return;const n=i(this,r);if(n&&this.willRender()){const t=this.globalMatrix_;this.simpleTransform?e.translate(t[2],t[5]):(e.saveTransform(),e.transform(t[0],t[3],t[1],t[4],t[2],t[5])),e.setGlobalAlpha(this.globalAlpha_);const i=this.cache;null!==i&&this.renderCache(i,e)||this.renderImpl(e),this.simpleTransform?e.translate(-t[2],-t[5]):e.restoreTransform()}const s=this.children;for(let r=0;r<s.length;r++)s[r].render(e,t,i,n);if(n&&null!==this.overlayRenderFn_){const t=this.globalMatrix_;this.simpleTransform?e.translate(t[2],t[5]):(e.saveTransform(),e.transform(t[0],t[3],t[1],t[4],t[2],t[5])),e.setGlobalAlpha(this.globalAlpha_),this.overlayRenderFn_(this,e),this.simpleTransform?e.translate(-t[2],-t[5]):e.restoreTransform()}}renderCache(e,t){if(e.valid||e.update(this.width*this.unitLength,this.height*this.unitLength,(this.border_+this.renderOverflow_)*this.unitLength,this.renderImpl.bind(this)),!e.use(t))return!1;const i=e.getBestMipmap(t);if(null===i)return!1;const r=this.border_+this.renderOverflow_;return t.drawImageDest(i,0,0,i.width,i.height,-r,-r,this.width+2*r,this.height+2*r),!0}postRender(e){if(null!==this.overlayRenderFn_){const t=this.globalMatrix_;e.transform(t[0],t[3],t[1],t[4],t[2],t[5]),e.setGlobalAlpha(this.globalAlpha_),this.overlayRenderFn_(this,e)}}invalidate(e=!0){var t;e&&null!==this.cache&&this.cache.invalidate(),this.setInvalidated(!0);let i=this.parent_;if(null!==i&&!i.isChildrenInvalidated)for(i.setChildrenInvalidated(!0),i=i.parent_,null===(t=this.changeListener)||void 0===t||t.deferUpdate();null!==i&&!i.isChildrenInvalidated;)i.setChildrenInvalidated(!0),i=i.parent_}disposeCacheSelfAndChildren(){this.disposeCache();for(let e=0;e<this.children.length;e++)this.children[e].disposeCacheSelfAndChildren()}registerDestroy(e){null===this.destroyFns&&(this.destroyFns=[]),this.destroyFns.push(e)}unregisterDestroy(e){if(null!==this.destroyFns){const t=this.destroyFns.indexOf(e);t>=0&&this.destroyFns.splice(t,1)}}registerViewportVisibilityChanged(e){null===this.viewportVisibilityChangedFns&&(this.viewportVisibilityChangedFns=[]),this.viewportVisibilityChangedFns.push(e),e(this.visibleInViewport,this.getViewportScaleFn)}unregisterViewportVisibilityChanged(e){if(null!==this.viewportVisibilityChangedFns){const t=this.viewportVisibilityChangedFns.indexOf(e);t>=0&&this.viewportVisibilityChangedFns.splice(t,1)}}viewportVisibilityChanged(e,t=null){if(this.setVisibleInViewport(e),this.getViewportScaleFn=t,null!==this.viewportVisibilityChangedFns){const t=this.viewportVisibilityChangedFns;for(let i=0;i<t.length;i++)t[i](e,this.getViewportScaleFn)}}destroy(){var e;this.children.forEach((e=>e.destroy())),null!==this.destroyFns&&(this.destroyFns.forEach((e=>e())),this.destroyFns=null),null!==this.animationController_&&this.animationController_.cancelAll(),this.children.length=0,this.parent_=null,this.changeListener=null,null===(e=this.cache)||void 0===e||e.dispose()}unitLengthForContext(e){return e.renderScale*this.unitLength}enableCache(e,t){if(null===this.cache){if(t.mobile&&"safari"===t.runtime)return;this.cache=new s.MNodeCache(e,t)}}disposeCache(){null!==this.cache&&this.cache.disposeBitmap()}get animate(){return this.animationController_||(this.animationController_=new a.NodeAnimationController(this))}getAnimation(e){return this.animations_&&this.animations_[e]||null}isAnimating(){return!(!this.animationController_||this.animationController_.isDone())||this.children.some((e=>e.isAnimating()))}getRunningAnimations(){const e=new Set;return this.getRunningAnimationsInternal(e),e}getRunningAnimationsInternal(e){this.animationController_&&this.animate.getRunningAnimations().forEach((t=>e.add(t))),this.children.forEach((t=>t.getRunningAnimationsInternal(e)))}toggleState(e,t,i){if(this.state===e)return void(this.visible=t);const r=this.children;for(let n=0;n<r.length;n++)(0===i||r[n].isPartialNode)&&r[n].toggleState(e,t,i)}goesBefore(e,t=!1){return this.stackingLayer_===e.stackingLayer_?t?this.stackingOrder_<e.stackingOrder_:this.stackingOrder_<=e.stackingOrder_:t?this.stackingLayer_<e.stackingLayer_:this.stackingLayer_<=e.stackingLayer_}addToCustomLayer(e){var t;null===this.customLayersIds_&&(this.customLayersIds_=[]),this.customLayersIds_.includes(e)||(this.customLayersIds_.push(e),null===(t=this.changeListener)||void 0===t||t.nodeCustomLayerAdded(this,e))}removeFromCustomLayer(e){var t;null!==this.customLayersIds_&&this.customLayersIds_.includes(e)&&(this.customLayersIds_.splice(this.customLayersIds_.indexOf(e),1),null===(t=this.changeListener)||void 0===t||t.nodeCustomLayerRemoved(this,e))}applyPendingTransforms(){if(this.isTransformDirty&&this.updateSelfAndChildrenTransform(),this.isChildrenTransformDirty){this.setChildrenTransformDirty(!1);for(let e=0;e<this.children.length;e++)this.children[e].applyPendingTransforms();this.updateAABBAndExpandWithChildren()}}updateSelfAndChildrenTransform(){this.updateLocalTransform(),this.updateGlobalTransform(),this.setTransformDirty(!1),this.setChildrenTransformDirty(!1);const e=this.children;for(let t=0;t<e.length;t++)e[t].updateSelfAndChildrenTransform();this.updateAABBAndExpandWithChildren()}applyPendingInvalidate(){if(this.isInvalidated&&(this.setInvalidated(!1),null!==this.changeListener&&this.changeListener.nodeInvalidated(this)),this.isChildrenInvalidated){this.setChildrenInvalidated(!1);for(let e=0;e<this.children.length;e++)this.children[e].applyPendingInvalidate()}}}},8207:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MNodeCache=void 0;const r=i(1962),n=512;t.MNodeCache=class MNodeCache{constructor(e,t){this.lastWidth=0,this.lastHeight=0,this.lastBorder=0,this.bitmap_=null,this.valid_=!1,this.canvasFactory=e,this.runtimeInfo=t}get valid(){return this.valid_}get scale(){return this.bitmap_?this.bitmap_.surface.getCameraScale():0}invalidate(){this.valid_=!1}disposeBitmap(){var e;this.lastWidth=0,this.lastHeight=0,this.lastBorder=0,null===(e=this.bitmap_)||void 0===e||e.disposeBitmaps(),this.bitmap_=null,this.valid_=!1}initBitmap(e,t,i){var s;let a=1,o=e+2*i,l=t+2*i;if(o>n||l>n)if(o>l){const e=l/o;a=n/o,o=n,l=Math.ceil(o*e)}else{const e=o/l;a=n/l,l=n,o=Math.ceil(l*e)}a*=2,o*=2,l*=2,null===(s=this.bitmap_)||void 0===s||s.disposeBitmaps(),this.bitmap_=new r.CacheRectBitmap(o,l,3,this.canvasFactory,this.runtimeInfo.screen.gpu.bugs),this.bitmap_.surface.setCameraScale(a),this.bitmap_.surface.setCameraPosition(e/2,t/2),this.bitmap_.surface.clearColor="transparent"}use(e){return e.cameraScale<this.scale/e.renderScaleMultiplier/4}getBestMipmap(e){return null===this.bitmap_?null:this.bitmap_.getBestMipmap(1/(e.cameraScale/this.scale)/4)}update(e,t,i,r){if(null!==this.bitmap_&&this.lastWidth===e&&this.lastHeight===t&&this.lastBorder===i||(this.initBitmap(Math.ceil(e),Math.ceil(t),Math.ceil(i)),this.lastWidth=e,this.lastHeight=t),null===this.bitmap_)return;const n=this.bitmap_.surface;n.clear();const s=n.beginRender(!1);r(s),s.finishRendering(),this.bitmap_.dirtyAllMipmaps(!1),this.valid_=!0}dispose(){var e;null===(e=this.bitmap_)||void 0===e||e.disposeBitmaps(),this.bitmap_=null,this.valid_=!1}}},7313:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RootNode=void 0;const r=i(3588);class RootNode extends r.MNode{renderImpl(){}willRender(){return!1}constructor(){super(),this.ownLayer=1}hitTest(){return!0}hitTestRect(){return!0}setRootChangeListener(e){this.setChangeListener(e)}updateAABBAndExpandWithChildren(){const e=this.children;if(0===e.length)this.aabb.setBounds(0,0,0,0),this.aabbWithoutRenderOverflow.setBounds(0,0,0,0),this.aabbSelfOnlyWithoutRenderOverflow.setBounds(0,0,0,0);else{const t=e[0];if(this.aabb.copy(t.aabb),this.aabbWithoutRenderOverflow.copy(t.aabbWithoutRenderOverflow),this.aabbSelfOnlyWithoutRenderOverflow.copy(t.aabbSelfOnlyWithoutRenderOverflow),e.length>1){const t=this.aabb,i=this.aabbWithoutRenderOverflow;for(let r=1;r<e.length;r++)t.union(e[r].aabb),i.union(e[r].aabbWithoutRenderOverflow)}}this.reportAABBChanged()}}t.RootNode=RootNode},3235:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NodeAnimationImplWithCb=t.NodeAnimationImpl=void 0;class NodeAnimationImpl{constructor(){this.doneCbs=[],this.resolved=!1}cancel(){this.resolved||(this.resolved=!0,this.onCancel(),this.doneCbs.forEach((e=>e(!1))))}onCancel(){}onDone(e){return this.doneCbs.push(e),this}isDone(){return this.resolved}resolve(){this.resolved||(this.resolved=!0,this.doneCbs.forEach((e=>e(!0))))}}t.NodeAnimationImpl=NodeAnimationImpl;t.NodeAnimationImplWithCb=class NodeAnimationImplWithCb extends NodeAnimationImpl{constructor(e,t,i,r){super(),this.animateCb=i,this.getTimeFn=r,this.duration=e,this.delay=t,this.startTime=r(),this.updateAnimationBound=this.updateAnimation.bind(this),requestAnimationFrame(this.updateAnimationBound)}updateAnimation(){if(this.resolved)return;const e=this.getTimeFn();e<this.startTime&&(this.startTime=e);const t=(e-this.startTime)/1e3;if(t<this.delay)requestAnimationFrame(this.updateAnimationBound);else{const e=Math.min((t-this.delay)/this.duration,1);this.animateCb(e),e<1?requestAnimationFrame(this.updateAnimationBound):this.resolve()}}}},6461:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IgnoreCameraScale=void 0;const r=i(3235);class IgnoreCameraScale extends r.NodeAnimationImpl{constructor(e,t,i,r){super(),this.lastScale=-1,this.startingTx={sx:e.scaleX,sy:e.scaleY,x:e.x,y:e.y},this.node=e,this.camera=t,this.minScale=i,this.maxScale=r,this.boundUpdateFn=this.update.bind(this),this.boundUpdateFn(),t.registerChangeListener(this.boundUpdateFn)}onCancel(){this.camera.unregisterChangeListener(this.boundUpdateFn),this.node.setPosition(this.startingTx.x,this.startingTx.y),this.node.setScale(this.startingTx.sx,this.startingTx.sy)}update(){const e=this.camera.scale;if(e!==this.lastScale){this.lastScale=e;const t=this.startingTx,i=this.node,r=Math.min(Math.max(e,this.minScale),this.maxScale)/e;let n=1,s=1,a=i.parent;for(;null!==a;)n*=a.scaleX,s*=a.scaleY,a=a.parent;const o=1/n*r,l=1/s*r,d=-(o-1)*i.width*.5,h=-(l-1)*i.height*.5;i.setPosition(t.x+d,t.y+h),i.setScale(t.sx*o,t.sy*l)}}}t.IgnoreCameraScale=IgnoreCameraScale},9731:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LoadingAnimation=void 0;const r=i(2575),n=i(5672),s=i(3235),a=new Path2D("M 0 -0.5 C -0.0223 -0.5001 -0.0374 -0.4948 -0.0536 -0.48 L -0.4095 -0.1564 C -0.4416 -0.1276 -0.4454 -0.0737 -0.4151 -0.0433 L -0.4089 -0.0377 C -0.3785 -0.0133 -0.3316 -0.0127 -0.303 -0.0388 L -0.0796 -0.2421 L -0.0796 0.4207 C -0.0796 0.4645 -0.0441 0.5 -0.0003 0.5 L 0.0074 0.4996 C 0.0476 0.4958 0.079 0.4619 0.079 0.4207 L 0.079 -0.2421 L 0.3024 -0.0388 C 0.3335 -0.0104 0.3868 -0.0127 0.4151 -0.0438 C 0.4437 -0.0754 0.4412 -0.1284 0.4088 -0.1566 L 0.053 -0.48 C 0.0404 -0.4916 0.0198 -0.4996 0 -0.5 Z"),o=new Path2D("M 0.35 -0.5 L -0.224 0.1661 L -0.4656 -0.0733 C -0.493 -0.1007 -0.5331 -0.1115 -0.5706 -0.1014 C -0.6081 -0.0914 -0.6374 -0.062 -0.6475 -0.0245 C -0.6576 0.013 -0.6468 0.0531 -0.6194 0.0805 L -0.2944 0.4054 C -0.2737 0.4252 -0.2462 0.4365 -0.2175 0.4369 L -0.2175 0.4369 C -0.1874 0.4356 -0.1591 0.4219 -0.1395 0.3989 L 0.5103 -0.3592 C 0.5354 -0.3886 0.543 -0.4292 0.5301 -0.4657 C 0.5172 -0.5022 0.4858 -0.529 0.4478 -0.5361 C 0.4097 -0.5432 0.3708 -0.5294 0.3457 -0.5 L 0.35 -0.5 Z"),l="#4c4c4c";function drawPathAt(e,t,i,n,s,a){i<=0||(a.translateRotateAndScale(e,t,0,i),a.drawPath(n,"",0,s,r.SOLID_STROKE_PATTERN,"round","round"),a.undoTranslateRotateAndScale(e,t,0,i))}class LoadingAnimation extends s.NodeAnimationImpl{constructor(e,t,i,r){super(),this.progress=0,this.infinite=!1,this.startTime=0,this.completeTime=0,this.pendingRedraw=!1,this.pendingEnqueueRedraw=!1,this.visible=!1,this.getViewportScaleFn=null,this.waitingDelay=!1,this.node=e,this.getTimeFn=t,this.setTimeoutFn=i,this.startTime=t(),this.node.setOverlayRenderFn(this.render.bind(this)),this.onViewportVisibilityChangedFn=(e,t)=>this.onViewportVisibilityChanged(e,t),this.onDone((()=>{this.node.removeOverlayRenderFn(),this.node.unregisterViewportVisibilityChanged(this.onViewportVisibilityChangedFn)})),this.type=r,e.registerViewportVisibilityChanged(this.onViewportVisibilityChangedFn),"downloading"===r&&(this.waitingDelay=!0,i((()=>{this.resolved||(this.waitingDelay=!1,this.startTime=this.getTimeFn(),this.pendingRedraw=!0,this.enqueueRedraw())}),2600))}onViewportVisibilityChanged(e,t){this.visible=e,this.getViewportScaleFn=t,this.pendingRedraw&&this.enqueueRedraw()}enqueueRedraw(){this.visible&&(this.isBigEnoughOnViewport()||this.isComplete())?(this.pendingRedraw=!1,this.node.invalidate(!1)):this.pendingRedraw=!0}isBigEnoughOnViewport(){if(null===this.getViewportScaleFn)return!1;return function getCircleSize(e,t){return.05*Math.min(e,t)*2}(this.node.aabbSelfOnlyWithoutRenderOverflow.width,this.node.aabbSelfOnlyWithoutRenderOverflow.height)*this.getViewportScaleFn()>=8}isComplete(){return 1===this.progress}setProgress(e,t){const i=Math.max(e,this.progress);i===this.progress&&t===this.infinite||(this.progress=i,this.infinite=t,1===this.progress&&0===this.completeTime&&(this.completeTime=this.getTimeFn()),this.enqueueRedraw())}render(e,t){!function renderBackground(e,t,i){const r=.5/i.cameraScale;i.drawRectangle(-r,-r,e+2*r,t+2*r,"rgba(255, 255, 255, 0.8)","",0)}(e.width,e.height,t);const i=this.progress;if(this.waitingDelay)return void(1===i&&this.resolve());const s=this.getTimeFn(),d=this.infinite;s<this.startTime&&(this.startTime=s),0!==this.completeTime&&s<this.completeTime&&(this.completeTime=s);const h=(s-this.startTime)/1e3,c=1===i?(s-this.completeTime)/1e3:0,u="uploading"===this.type,g=this.isBigEnoughOnViewport()&&this.visible&&("uploading"===this.type||this.isComplete()&&(this.completeTime-this.startTime)/1e3>=1),f=function renderLoadingAnimation(e,t,i,s,d,h,c,u){const g=Math.min(e,t),f=.03*g,m=.05*g,v=e-(f+m),y=f+m;u.saveClip(),u.clipEllipse(v-m,y-m,2*m,2*m),c&&drawPathAt(v,d<1?(0,n.spring)(2*y,y,Math.min(i/.5,1)):(0,n.spring)(y,0,Math.min(s/.5,1)),1*m,a,l,u);1===d&&s>.2&&drawPathAt(v,y,(0,n.spring)(0,.75*m,Math.min((s-.2)/.5,1)),o,l,u),u.restoreClip();const w=.01*g;if(u.drawEllipse(v-m,y-m,2*m,2*m,"","#888888",w,r.SOLID_STROKE_PATTERN),h){const e=1*i*Math.PI*2;u.drawPartialEllipse(v-m,y-m,2*m,2*m,"",l,w,r.SOLID_STROKE_PATTERN,e+0,e+2*Math.PI*.2)}else u.drawPartialEllipse(v-m,y-m,2*m,2*m,"",l,w,r.SOLID_STROKE_PATTERN,0,2*Math.PI*d);return 1===d||!!(c&&i<.5)||!!h}(e.width,e.height,h,c,i,d,u,t);this.isComplete()&&(!g||c>1.2)?this.resolve():f&&(this.pendingEnqueueRedraw||(this.pendingEnqueueRedraw=!0,this.setTimeoutFn((()=>{this.pendingEnqueueRedraw=!1,this.resolved||this.enqueueRedraw()}),1e3/30)))}}t.LoadingAnimation=LoadingAnimation},7706:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PulseAnimation=void 0;const r=i(2575),n=i(5672),s=i(3235),a=25,o=18.75,l=966,d=982,h=600,c=4400,u={0:"rgba(255,0,101,0)",20:"rgba(255,0,102, 0.1)",80:"rgba(255,0,102, 0.1)",100:"rgba(255,0,101,0)"};class PulseAnimation extends s.NodeAnimationImpl{constructor(e,t,i,r){super(),this.visible=!1,this.node=e,this.getTimeFn=t,this.setTimeoutFn=i,this.startTime=t(),this.node.setOverlayRenderFn(this.render.bind(this)),this.nodeCenterX=this.node.width/2,this.nodeCenterY=this.node.height/2,this.glowBorderGradient=r||u,this.timerComplete=0,this.onViewportVisibilityChangedFn=e=>this.onViewportVisibilityChanged(e),this.onDone((()=>{this.node.removeOverlayRenderFn(),this.node.unregisterViewportVisibilityChanged(this.onViewportVisibilityChangedFn)})),e.registerViewportVisibilityChanged(this.onViewportVisibilityChangedFn)}enqueueRedraw(){this.visible&&!this.isComplete()&&this.node.invalidate(!1)}isComplete(){return this.timerComplete<=0}getCurrentGlowPhase(e){return e<l?1:e<=1948?2:3}getGlowPhaseTime(e){return e<l?e:e<=1948?e-l:e-1948}render(e,t){const{width:i,height:r}=e,n=this.getTimeFn()-this.startTime;switch(this.getCurrentGlowPhase(n)){case 1:case 3:this.animateGlowPhaseMax(n,i,r,t);break;case 2:this.animateGlowPhaseMin(n,i,r,t)}this.timerComplete=6e3-n,!this.isComplete()&&this.visible?this.setTimeoutFn((()=>{this.resolved||this.enqueueRedraw()}),1e3/30):this.resolve()}onViewportVisibilityChanged(e){this.visible=e}getGlowAlphaPhase(e){return e<h?1:e<=c?2:3}getGlowAlphaPhaseTime(e){return e<h?e:e<=c?e-h:e-5e3}getGlowOpacity(e){const t=this.getGlowAlphaPhase(e),i=this.getGlowAlphaPhaseTime(e);let r=0;switch(t){case 1:r=(0,n.easeInOutCubic)(i/h);break;case 2:r=1;break;case 3:r=1-(0,n.easeInOutCubic)(i/1e3)}return r>0?r:0}animateGlowPhaseMax(e,t,i,s){const a=this.getGlowPhaseTime(e);let d=6.25;if(a<l){d=.006469979296066253*a*(0,n.easeInOutCubic)(a/l)}const h=o+d,c=23.5+h/2,u=s.createCenteredRadialGradient(t-this.nodeCenterX,i-this.nodeCenterY,c-h/2,c+h/2,this.glowBorderGradient);s.drawEllipse(t-this.nodeCenterX-c,i-this.nodeCenterY-c,2*c,2*c,"transparent",u,h,r.SOLID_STROKE_PATTERN,this.getGlowOpacity(e))}animateGlowPhaseMin(e,t,i,s){const o=this.getGlowPhaseTime(e);let l=6.25;if(o<d){l=.006364562118126273*o*(0,n.easeInOutCubic)(o/d)}const h=a-l,c=23.5+h/2,u=s.createCenteredRadialGradient(t-this.nodeCenterX,i-this.nodeCenterY,c-h/2,c+h/2,this.glowBorderGradient);s.drawEllipse(t-this.nodeCenterX-c,i-this.nodeCenterY-c,2*c,2*c,"transparent",u,h,r.SOLID_STROKE_PATTERN,this.getGlowOpacity(e))}}t.PulseAnimation=PulseAnimation},109:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NodeAnimationController=void 0;const r=i(3235),n=i(6461),s=i(9731),a=i(7706),o=i(5672),l="ignoreCameraScale",d="uploading",h="downloading",c="pulse",u={transition:0,transitionPercent:0};t.NodeAnimationController=class NodeAnimationController{constructor(e){this.getTimeFn=()=>Date.now(),this.setTimeoutFn=(e,t)=>setTimeout(e,t),this.animations=new Map,this.node=e,e.registerDestroy((()=>this.destroy()))}setGetTimeFn(e){this.getTimeFn=e}setSetTimeoutFn(e){this.setTimeoutFn=e}alphaTo(e,t,i=0){const r=this.node;return this.buildAnimationWithCb("alpha",t,i,r.alpha,e,((e,t,i)=>r.alpha=(0,o.linear)(t,i,e)))}shadowDraggingTransitionTo(e,t,i=0){var r,n;const s=this.node;return this.buildAnimationWithCb("shadow-dragging-transition",t,i,null!==(n=null===(r=s.shadowProperties)||void 0===r?void 0:r.transitionPercent)&&void 0!==n?n:0,e,((e,t,i)=>{var r;s.shadowProperties=Object.assign(Object.assign({},null!==(r=s.shadowProperties)&&void 0!==r?r:u),{transitionPercent:(0,o.linear)(t,i,e)})}))}setCameraScaleConstraint(e,t,i){var r,s;if(!t&&!i)return null===(r=this.animations.get(l))||void 0===r||r.cancel(),this.animations.delete(l),null;const a=t||0,o=i||Number.MAX_SAFE_INTEGER;null===(s=this.animations.get(l))||void 0===s||s.cancel();const d=new n.IgnoreCameraScale(this.node,e,a,o);return this.animations.set(l,d),d}setLoadingProgress(e,t=0){var i,r;const n="downloading-infinite"===e?"downloading":e,a="downloading-infinite"===e,o="uploading"===n?d:h;if("uploading"!==n&&(null===(i=this.animations.get(d))||void 0===i||i.cancel(),this.animations.delete(d)),"downloading"!==n&&(null===(r=this.animations.get(h))||void 0===r||r.cancel(),this.animations.delete(h)),"none"===n)return;if(!Number.isFinite(t))return;const l=Math.min(Math.max(t,0),1),c=this.animations.get(o);if(!c&&1===l)return;const u=c||new s.LoadingAnimation(this.node,this.getTimeFn,this.setTimeoutFn,n);c||(u.onDone((()=>this.animations.delete(o))),this.animations.set(o,u)),u.setProgress(l,a)}hasLoadingInProgress(){return this.animations.has(d)||this.animations.has(h)}cancelAll(){this.animations.forEach((e=>e.cancel())),this.animations.clear()}isDone(){for(const e of this.animations.values())if(!e.isDone())return!1;return!0}getRunningAnimations(){const e=[];for(const[t,i]of this.animations.entries())i.isDone()||e.push(t);return e}setCommentPulse(e){var t;null===(t=this.animations.get(c))||void 0===t||t.cancel(),this.animations.delete(c);const i=new a.PulseAnimation(this.node,this.getTimeFn,this.setTimeoutFn,e);i.onDone((()=>this.animations.delete(c))),this.animations.set(c,i)}setIntroScale(e,t,i){const r=this.node;return this.buildAnimationWithCb("introScale",e,0,t,i,((e,t,i)=>{const n=(0,o.easeInOutCubic)(e),s=(0,o.linear)(t,i,n),a=-(s-1)*r.width*.5,l=-(s-1)*r.height*.5;r.setPosition(a,l),r.setScale(s,s)}))}buildAnimationWithCb(e,t,i,n,s,a){var o;null===(o=this.animations.get(e))||void 0===o||o.cancel();const l=new r.NodeAnimationImplWithCb(t,i,(e=>a(e,n,s)),this.getTimeFn);return this.animations.set(e,l),l}destroy(){this.cancelAll()}}},5672:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.easeInOutCubic=t.spring=t.linearClamped=t.linear=void 0;t.linear=(e,t,i)=>(t-e)*i+e;t.linearClamped=(e,i,r)=>(0,t.linear)(e,i,Math.min(Math.max(r,0),1));t.spring=(e,i,r)=>(0,t.linear)(e,i,(e=>0===e?0:1===e?1:Math.pow(3,-5*e)*Math.sin((5*e-.75)*(2*Math.PI)/3)+1)(r));t.easeInOutCubic=e=>e<.5?4*e*e*e:1-Math.pow(-2*e+2,3)/2},3703:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Minimap=void 0;const r=i(3037),n=i(4086);function drawRoundedRect(e,t,i,r,n,s){e.beginPath(),s>0?(e.moveTo(t+s,i),e.arcTo(t+r,i,t+r,i+n,s),e.arcTo(t+r,i+n,t,i+n,s),e.arcTo(t,i+n,t,i,s),e.arcTo(t,i,t+r,i,s),e.closePath()):e.rect(t,i,r,n)}function drawViewport(e,t,i,r,n,s){const a=.5*s.viewport.lineWidth;e.lineWidth=s.viewport.lineWidth,e.fillStyle=n.color,e.strokeStyle=n.borderColor,drawRoundedRect(e,Math.floor(t+n.x*r)+a,Math.floor(i+n.y*r)+a,Math.ceil(n.width*r),Math.ceil(n.height*r),s.viewport.cornerRadius),e.stroke(),e.fill()}function cacheNode(e){const t=e.minimapShape;return t&&"path"===t.type?{type:"path",x:e.x,y:e.y,rotation:e.rotation*Math.PI/180,path:t.path}:e.axisAligned?{type:"aabb",rect:(new r.Rectangle).copy(e.aabbSelfOnlyWithoutRenderOverflow)}:{type:"rotated-aabb",points:e.getAABBCoords([],!1)}}t.Minimap=class Minimap{constructor(e,t,i,n,s,a,o){if(this.viewports=new Map,this.nodes=new Map,this.shapesDirty=!1,this.viewportsDirty=!1,this.visible=!0,this.destroyed=!1,this.sizeBehavior="MuralBounds",this.padding=0,this._muralBounds=(new r.Rectangle).setBounds(0,0,100,100),this._nodesBounds=new r.Rectangle,this._nodesBoundsValid=!0,this.canvasFactory=t,this.canvas=e,this.width=this.canvas.canvas.width,this.height=this.canvas.canvas.height,this.renderScaleMultiplier=i,this.style=o,this.padding=o.muralBackground.padding,this.throttleShapesUpdate="node"!==a.runtime,this.rootNode=s,this.canvas.ctx.resetTransform=this.canvas.ctx.resetTransform||function(){this.setTransform(1,0,0,1,0,0)}.bind(this.canvas.ctx),this.shapesCanvas=this.buildShapeCanvas(),1!==i){const e=this.canvas.canvas.width,t=this.canvas.canvas.height;this.canvas.canvas.style.width=e+"px",this.canvas.canvas.style.height=t+"px",this.canvas.canvas.width=e*i,this.canvas.canvas.height=t*i}const l=n.getClipBounds();this.userViewport={x:l.x,y:l.y,width:l.width,height:l.height,color:"rgba(255,0,0,0.5)",borderColor:"rgba(255,0,0,1)"},n.registerChangeListener((()=>{const e=n.getClipBounds();this.userViewport.x=e.x,this.userViewport.y=e.y,this.userViewport.width=e.width,this.userViewport.height=e.height,this.invalidateViewports()}))}get done(){return!this.viewportsDirty&&!this.shapesDirty}buildShapeCanvas(){const e=this.canvasFactory.createCanvas(this.canvas.canvas.width*this.renderScaleMultiplier,this.canvas.canvas.height*this.renderScaleMultiplier);return e.ctx.resetTransform=e.ctx.resetTransform||function(){this.setTransform(1,0,0,1,0,0)}.bind(e.ctx),e}getDrawBounds(){let e=this._muralBounds;"WidgetsBounds"===this.sizeBehavior&&(this._nodesBoundsValid||this.updateNodesBounds(),e=this._nodesBounds);const t=this.width-2*this.padding,i=t>0?this.padding*e.width/t:0,r=this.height-2*this.padding,n=r>0?this.padding*e.height/r:0;return{x:e.x-i,y:e.y-n,width:Math.max(e.width+2*i,1),height:Math.max(e.height+2*n,1)}}destroy(){this.destroyed=!0,this.canvasFactory.destroyCanvas(this.shapesCanvas.canvas)}show(){this.visible||(this.visible=!0,this.viewportsDirty&&this.drawViewports(),this.shapesDirty&&this.drawShapes())}disposeCache(){this.canvasFactory.destroyCanvas(this.shapesCanvas.canvas),this.shapesCanvas=this.buildShapeCanvas(),this.invalidateShapes(),this.invalidateViewports()}hide(){this.visible=!1}fromScreenPos(e,t){const i=this.width,r=this.height,n=this.getDrawBounds(),s=n.x,a=n.y,o=n.width,l=n.height,d=i/o,h=r/l,c=Math.min(d,h);return{x:(e-Math.floor((i-o*c)/2))/c+s,y:(t-Math.floor((r-l*c)/2))/c+a}}setSizeBehavior(e){e!==this.sizeBehavior&&(this.sizeBehavior=e,this.invalidateShapes())}setPadding(e){e!==this.padding&&(this.padding=e,this.invalidateShapes())}setMuralBounds(e,t,i,r){Number.isFinite(e)&&Number.isFinite(t)&&Number.isFinite(i)&&Number.isFinite(r)&&(e===this._muralBounds.x&&t===this._muralBounds.y&&i===this._muralBounds.width&&r===this._muralBounds.height||(this._muralBounds.setBounds(e,t,i,r),this.invalidateShapes(),this.invalidateViewports()))}shouldAddNode(e){return!e.isPartialNode&&""!==e.externalId&&e.parent===this.rootNode&&e.visible}addNode(e){if(!this.shouldAddNode(e))return;const t=(new r.Rectangle).copy(e.aabbSelfOnlyWithoutRenderOverflow),i={cache:cacheNode(e),lastShape:e.minimapShape,lastAABB:t};this.nodes.set(e,i),this.onNodesAABBAdded(t),this.invalidateShapes()}onNodesAABBAdded(e){this._nodesBoundsValid&&(1===this.nodes.size?this._nodesBounds.copy(e):this._nodesBounds.contains(e)||this._nodesBounds.union(e))}updateNodesBounds(){const e=this._nodesBounds;if(this.nodes.size>0){const t=this.nodes.entries().next().value[1];e.copy(t.lastAABB),this.nodes.forEach((t=>e.union(t.lastAABB)))}else e.setEmpty();this._nodesBoundsValid=!0}onNodesAABBRemoved(e){this._nodesBoundsValid&&this._nodesBounds.matchesAnyBorder(e)&&(this._nodesBoundsValid=!1)}removeNode(e){const t=this.nodes.get(e);t&&(this.nodes.delete(e),this.onNodesAABBRemoved(t.lastAABB),this.invalidateShapes())}updateNode(e){if(this.shouldAddNode(e)){const t=this.nodes.get(e);if(t){const i=e.aabbSelfOnlyWithoutRenderOverflow,r=t.lastAABB,n=r.equals(i),s=t.lastShape===e.minimapShape;n&&s||(t.lastShape=e.minimapShape,t.cache=cacheNode(e),n||(this.onNodesAABBRemoved(r),this.onNodesAABBAdded(i),r.copy(i)),this.invalidateShapes())}else this.addNode(e)}else this.removeNode(e)}resize(e,t){if(this.canvas.canvas.width=e,this.canvas.canvas.height=t,this.width=e,this.height=t,1!==this.renderScaleMultiplier){const e=this.canvas.canvas.width,t=this.canvas.canvas.height;this.canvas.canvas.style.width=e+"px",this.canvas.canvas.style.height=t+"px",this.canvas.canvas.width=e*this.renderScaleMultiplier,this.canvas.canvas.height=t*this.renderScaleMultiplier}this.disposeCache()}setStyle(e){this.style=(0,n.replaceUndefinedPropertiesWithDefaultsRecursively)(this.style,e),this.invalidateShapes(),this.invalidateViewports()}setUserViewportColor(e,t){e===this.userViewport.color&&t===this.userViewport.borderColor||(this.userViewport.color=e,this.userViewport.borderColor=t,this.invalidateViewports())}setViewport(e,t){Number.isFinite(t.x)&&Number.isFinite(t.y)&&Number.isFinite(t.width)&&Number.isFinite(t.height)&&(this.viewports.set(e,t),this.invalidateViewports())}getViewport(e){return e?this.viewports.get(e)||null:this.userViewport}deleteViewport(e){this.viewports.delete(e),this.invalidateViewports()}invalidateViewports(){this.viewportsDirty||(this.viewportsDirty=!0,this.visible&&requestAnimationFrame((()=>this.drawViewports())))}invalidateShapes(){this.shapesDirty||(this.shapesDirty=!0,this.visible&&(this.throttleShapesUpdate?setTimeout((()=>this.drawShapes()),200):requestAnimationFrame((()=>this.drawShapes()))))}drawViewports(){if(!this.viewportsDirty||this.destroyed)return;this.viewportsDirty=!1;const e=this.getDrawBounds();if(0===this.width||0===this.height)return;const t=this.width,i=this.height,r=e.x,n=e.y,s=e.width,a=e.height,o=t/s,l=i/a,d=Math.min(o,l),h=Math.floor((t-s*d)/2),c=Math.floor((i-a*d)/2),u=h-Math.floor(r*d),g=c-Math.floor(n*d),f=this.style,m=this.canvas.ctx;m.resetTransform(),m.lineWidth=0,f.border.cornerRadius>0&&(m.scale(this.renderScaleMultiplier,this.renderScaleMultiplier),m.clearRect(0,0,t,i),m.save(),drawRoundedRect(m,.5*f.border.lineWidth,.5*f.border.lineWidth,t-f.border.lineWidth,i-f.border.lineWidth,f.border.cornerRadius),m.clip(),m.resetTransform()),m.drawImage(this.shapesCanvas.canvas,0,0),m.scale(this.renderScaleMultiplier,this.renderScaleMultiplier),"MuralBounds"===this.sizeBehavior&&(m.save(),m.beginPath(),m.rect(h,c,s*d,a*d),m.clip()),this.viewports.forEach((e=>drawViewport(m,u,g,d,e,f))),drawViewport(m,u,g,d,this.userViewport,f),"MuralBounds"===this.sizeBehavior&&m.restore(),m.strokeStyle=f.muralBorder.lineColor,m.lineWidth=f.muralBorder.lineWidth,"MuralBounds"===this.sizeBehavior&&(m.beginPath(),m.rect(h-.5*f.muralBorder.lineWidth,c-.5*f.muralBorder.lineWidth,Math.ceil(s*d+f.muralBorder.lineWidth),Math.ceil(a*d+f.muralBorder.lineWidth)),m.stroke()),f.border.cornerRadius>0&&m.restore(),m.strokeStyle=f.border.lineColor,m.lineWidth=f.border.lineWidth,m.resetTransform(),m.scale(this.renderScaleMultiplier,this.renderScaleMultiplier),drawRoundedRect(m,.5*f.border.lineWidth,.5*f.border.lineWidth,t-f.border.lineWidth,i-f.border.lineWidth,f.border.cornerRadius),m.stroke()}drawShapes(){if(!this.shapesDirty||this.destroyed)return;this.shapesDirty=!1;const e=this.getDrawBounds();if(0===this.width||0===this.height)return;const t=this.width,i=this.height,r=e.x,n=e.y,s=e.width||1,a=e.height||1,o=t/s,l=i/a,d=Math.min(o,l),h=Math.floor((t-s*d)/2),c=Math.floor((i-a*d)/2),u=h-Math.floor(r*d),g=c-Math.floor(n*d),f=this.shapesCanvas.ctx,m=this.style;f.resetTransform(),f.scale(this.renderScaleMultiplier,this.renderScaleMultiplier),f.fillStyle=m.outsideMural.color,f.fillRect(0,0,t,i),"MuralBounds"===this.sizeBehavior&&m.outsideMural.lineWidth>0&&function drawBackgroundPattern(e,t,i,r){e.strokeStyle=r.outsideMural.lineColor,e.lineWidth=r.outsideMural.lineWidth,e.beginPath();for(let n=0;n<t;n+=r.outsideMural.lineSpacing)e.moveTo(n,0),e.lineTo(n+i,i);for(let n=0;n<i;n+=r.outsideMural.lineSpacing)e.moveTo(0,n),e.lineTo(t,n+t);e.stroke()}(f,t,i,m),"MuralBounds"===this.sizeBehavior&&(f.save(),f.beginPath(),f.rect(h,c,s*d,a*d),f.clip()),f.fillStyle=m.muralBackground.color,"MuralBounds"===this.sizeBehavior?f.fillRect(h,c,s*d,a*d):f.fillRect(0,0,t,i),f.strokeStyle=m.widget.lineColor,f.lineWidth=m.widget.lineWidth,f.lineCap="square",f.save(),f.lineWidth=m.widget.lineWidth/d,f.translate(u,g),f.scale(d,d),f.beginPath(),this.nodes.forEach((e=>function drawCachedNode(e,t){switch(t.type){case"aabb":e.rect(t.rect.x,t.rect.y,t.rect.width,t.rect.height);break;case"rotated-aabb":e.moveTo(t.points[0].x,t.points[0].y),e.lineTo(t.points[1].x,t.points[1].y),e.lineTo(t.points[2].x,t.points[2].y),e.lineTo(t.points[3].x,t.points[3].y),e.lineTo(t.points[0].x,t.points[0].y);break;case"path":e.translate(t.x,t.y),e.rotate(t.rotation),e.stroke(),e.stroke(t.path),e.beginPath(),e.rotate(-t.rotation),e.translate(-t.x,-t.y)}}(f,e.cache))),f.stroke(),f.restore(),"MuralBounds"===this.sizeBehavior&&f.restore(),this.invalidateViewports()}}},687:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Renderer=void 0;const r=i(1799),n=i(9819),s=i(3037),a=i(2404),o=i(168),l=i(8319),d=i(8387),h=i(788),c=i(1241),u=i(2129),g=i(5181),f=i(3963),m=i(3661),v=i(821),y=i(8620),w=i(6823),x={0:-1,1:0,3:1,2:2};t.Renderer=class Renderer{constructor(e,t,i,l,h,c,u,g,f,m,v,y,x){this.surfaceOverlayDirty=!0,this.useCache=!0,this.gridLinesVisible=!1,this.useThrottledInvalidation=!1,this.cacheStrategy=null,this.viewportOptimizationStrategy=null,this.lastBounds=new s.Rectangle,this.backgroundColor_="black",this.layers=new Map,this.layersDrawingOrder=[],this.customLayersById=new Map,this.customLayers=[],this.useSkipCacheHeuristic=!0,this.domContainer=null,this.surfaceOverlayMounted=!1,this.destroyed=!1,this.useViewportOptimization=!0,this.lastSkipCacheTime=0,this.pendingSkipCacheUpdate=!1,this.runtimeInfo=f,this.useThrottledInvalidation=f.mobile,this.canvasFactory=m,this.surface=new a.RenderSurface(e,f.screen.gpu.bugs,u,y),this.surfaceOverlay=new a.RenderSurface(t,f.screen.gpu.bugs,u,"transparent"),this.gridLines=new d.GridLines(m),this.surfaceOverlay.resize(this.surface.width,this.surface.height),this.onPreRenderCallback=l,this.onPostRenderCallback=h,this.onContextRestoredCallback=c,this.renderScaleMultiplier=u,this.root_=g,this.qt=new n.QuadTreeRoot,this.qtIterator=new r.QuadTreeIterator(this.qt),this.viewportVisibility=new w.ViewportVisibility(this.qtIterator),this.useViewportOptimization=!0,this.buildStrategy(),this.preRenderInterface={camera:this.surface.camera},this.postRenderInterface={camera:this.surface.camera,surface:this.surfaceOverlay,setDirty:()=>this.surfaceOverlayDirty=!0};for(const e of v){const t=new o.MCustomLayer(e.id,e.backColor,e.blocking,e.visible,this.root);this.customLayersById.set(t.id,t),this.customLayers.push(t)}this.contextLostListener=i,i.onContextLost((()=>this.onContextLost())),i.onContextRestored((()=>this.onContextRestored())),this.applyPendingChanges=x}get backgroundColor(){return this.backgroundColor_}set backgroundColor(e){this.backgroundColor_!==e&&(this.backgroundColor_=e,this.invalidateBounds())}set clearColor(e){var t;this.surface.clearColor!==e&&(this.surface.clearColor=e,null===(t=this.viewportOptimizationStrategy)||void 0===t||t.forceInvalidation(),this.invalidateViewport())}get bounds(){return this.lastBounds}set bounds(e){this.lastBounds.equals(e)||(this.invalidateBounds(),this.lastBounds.copy(e),this.invalidateBounds())}get rootCache(){return this.cacheStrategy}get viewportOptimization(){return this.viewportOptimizationStrategy}get done(){var e;return!(null===(e=this.invalidationStrategy)||void 0===e?void 0:e.isPendingRedraw())&&!this.wasTileCacheSkipped()}onContextLost(){console.warn("Renderer.onContextLost()")}onContextRestored(){var e;console.warn("Renderer.onContextRestored()"),this.onContextRestoredCallback(),null===(e=this.renderingStrategy)||void 0===e||e.discardCache(),this.surface.clear(),this.surfaceOverlay.clear(),this.gridLines.discardCache(),this.invalidateBounds(),this.invalidateViewport()}buildStrategy(){var e,t;const i=[];if(null===(e=this.invalidationStrategy)||void 0===e||e.destroy(),null===(t=this.renderingStrategy)||void 0===t||t.destroy(),this.useViewportOptimization){const e=new m.OptimizedViewportStrategy(this.runtimeInfo,this.renderScaleMultiplier,(()=>this.bounds),this.surface.hasBackgroundImage());this.viewportOptimizationStrategy=e,i.push(e)}else this.viewportOptimizationStrategy=null;if(i.push(new f.CustomLayerStrategy(this.qtIterator,this.customLayers)),this.useCache){const e=new v.TileCacheStrategy(this.qtIterator,this.root,this.renderScaleMultiplier,this.drawBackground.bind(this),this.canvasFactory,this.runtimeInfo);this.cacheStrategy=e,i.push(e)}else this.cacheStrategy=null;i.push(new y.ViewportStrategy(this.qtIterator,this.drawBackground.bind(this),this.layersDrawingOrder)),this.renderingStrategy=new g.CompositeStrategy(i);const r=new h.DefaultInvalidationStrategy(this.renderingStrategy,this.surface,this.doRepaint.bind(this));this.invalidationStrategy=this.useThrottledInvalidation?new c.ThrottledInvalidationStrategy(r,this.doRepaint.bind(this)):r}get root(){return this.root_}viewportResize(e,t){var i;const{x:r,y:n}=this.surface.camera.getClipBounds(),s=this.surface.camera.scale;this.surface.resize(e,t),this.surfaceOverlay.resize(e,t),this.surfaceOverlayDirty=!0,null===(i=this.renderingStrategy)||void 0===i||i.viewportResize(e,t),this.surface.camera.setFullViewport(r,n,s),this.invalidateViewport()}render(){var e;null===(e=this.invalidationStrategy)||void 0===e||e.flush(),this.renderInternal()}renderInternal(){if(void 0===this.renderingStrategy)return u.RenderResult.Done;this.applyPendingChanges();const e=this.surface,t=e.camera,i=t.getClipBounds();this.viewportVisibility.update(i,(()=>t.scale)),this.onPreRenderCallback(this.preRenderInterface);const r=this.renderCustom(this.renderingStrategy,this.surface);return this.surfaceOverlay.camera.copy(e.camera),this.surfaceOverlayDirty&&(this.surfaceOverlay.clear(),this.surfaceOverlayDirty=!1),this.surfaceOverlay.resetTransform(),this.onPostRenderCallback(this.postRenderInterface),this.domContainer&&(this.surfaceOverlayDirty&&!this.surfaceOverlayMounted?(this.domContainer.appendChild(this.surfaceOverlay.getCanvas()),this.surfaceOverlayMounted=!0):!this.surfaceOverlayDirty&&this.surfaceOverlayMounted&&(this.surfaceOverlay.getCanvas().remove(),this.surfaceOverlayMounted=!1)),r}updateSkipTileCache(e){var t;if(null===this.cacheStrategy||!this.useSkipCacheHeuristic)return;const i=this.cacheStrategy.getVisibleCacheRectsStats(e);if(0===i.visibleRects)return;const r=i.rectsToUpdateFromInvalidationsThisFrame/i.visibleRects>.5;r&&(this.lastSkipCacheTime=performance.now()),!r&&this.getRemainingSkipTileCacheCooldown()>0||r!==this.cacheStrategy.forceSkipCache&&(this.cacheStrategy.forceSkipCache=r,null===(t=this.viewportOptimizationStrategy)||void 0===t||t.forceInvalidation())}getRemainingSkipTileCacheCooldown(){if(0===this.lastSkipCacheTime)return 0;const e=performance.now()-this.lastSkipCacheTime;return Math.max(1e3-e,0)}wasTileCacheSkipped(){return null!==this.cacheStrategy&&this.useSkipCacheHeuristic&&this.cacheStrategy.forceSkipCache}enqueueTileCacheUpdate(){if(this.pendingSkipCacheUpdate)return;this.pendingSkipCacheUpdate=!0;const fn=()=>{if(this.pendingSkipCacheUpdate=!1,!this.destroyed&&null!==this.cacheStrategy&&this.cacheStrategy.forceSkipCache){const e=this.getRemainingSkipTileCacheCooldown();0===e?this.invalidateViewport():(this.pendingSkipCacheUpdate=!0,setTimeout(fn,e))}};setTimeout(fn,1e3)}renderCustom(e,t){this.applyPendingChanges();const i=t.camera.getClipBounds();e.newFrame(),this.updateSkipTileCache(i);const r=t.beginRender(!0),n=e.render(r,i,!0,u.renderNoOp);return r.finishRendering(),this.wasTileCacheSkipped()&&this.enqueueTileCacheUpdate(),n}drawBackground(e,t){e.clearSurfaceRegion(t),t.intersects(this.bounds)&&this.drawMuralBackground(e),this.gridLinesVisible&&this.gridLines.draw(e,this.bounds,t)}drawMuralBackground(e){e.drawRectangle(Math.floor(this.bounds.x),Math.floor(this.bounds.y),Math.ceil(this.bounds.width),Math.ceil(this.bounds.height),this.backgroundColor,"",0)}warmupStrategies(){var e;null===(e=this.renderingStrategy)||void 0===e||e.warmup()}invalidateBounds(){const e=2/this.surface.getCameraScale();this.invalidateRect((new s.Rectangle).copy(this.bounds).expand(e,e))}invalidateViewport(){var e;null===(e=this.invalidationStrategy)||void 0===e||e.enqueuePendingRedraw()}invalidateRect(e){void 0!==this.invalidationStrategy&&this.invalidationStrategy.invalidateRect(e,!0)}doRepaint(){var e;this.renderInternal()===u.RenderResult.InProgress&&(null===(e=this.invalidationStrategy)||void 0===e||e.enqueuePendingRedraw())}getLayer(e){const t=this.layers.get(e),i=t||new l.MLayer(e,x[e],this.root);return t||(this.layers.set(e,i),this.layersDrawingOrder.push(i),this.sortDrawingLayers()),i}sortDrawingLayers(){this.layersDrawingOrder.sort(((e,t)=>e.drawingOrder-t.drawingOrder))}getCustomLayer(e){return this.customLayersById.get(e)||null}showCustomLayer(e){const t=this.getCustomLayer(e);null!==t&&!0!==t.visible&&(t.visible=!0,this.forceRedrawViewport())}hideCustomLayer(e){const t=this.getCustomLayer(e);null!==t&&!1!==t.visible&&(t.visible=!1,this.forceRedrawViewport())}isUseCacheOn(){return this.useCache}setUseCache(e){this.useCache!==e&&(this.useCache=e,this.buildStrategy(),this.invalidateViewport())}isUseViewportOptimizationOn(){return this.useViewportOptimization}setUseViewportOptimization(e){this.useViewportOptimization!==e&&(this.useViewportOptimization=e,this.buildStrategy(),this.invalidateViewport())}isUseThrottledInvalidationOn(){return this.useThrottledInvalidation}setUseThrottledInvalidation(e){this.useThrottledInvalidation!==e&&(this.useThrottledInvalidation=e,this.buildStrategy(),this.invalidateViewport())}isUseSkipCacheHeuristicOn(){return this.useSkipCacheHeuristic}setUseSkipCacheHeuristic(e){this.useSkipCacheHeuristic!==e&&(this.useSkipCacheHeuristic=e,!e&&null!==this.cacheStrategy&&this.cacheStrategy.forceSkipCache&&(this.cacheStrategy.forceSkipCache=!1),this.invalidateViewport())}showGridLines(){!0!==this.gridLinesVisible&&(this.gridLinesVisible=!0,this.forceRedrawViewport())}hideGridLines(){!1!==this.gridLinesVisible&&(this.gridLinesVisible=!1,this.forceRedrawViewport())}setGridLinesOptions(e){this.gridLines.setOptions(e),this.gridLinesVisible&&this.forceRedrawViewport()}forceRedrawViewport(){var e;null===(e=this.viewportOptimizationStrategy)||void 0===e||e.forceInvalidation(),this.invalidateViewport()}mountEngine(e){this.domContainer=e,e.appendChild(this.surface.getCanvas()),e.appendChild(this.surfaceOverlay.getCanvas()),this.surfaceOverlayMounted=!0}unmountEngine(){this.domContainer=null,this.surface.getCanvas().remove(),this.surfaceOverlay.getCanvas().remove()}destroy(){var e,t,i;this.destroyed=!0;const r=this.surface.getCanvas();null===(e=r.parentNode)||void 0===e||e.removeChild(r),null===(t=this.invalidationStrategy)||void 0===t||t.destroy(),this.invalidationStrategy=void 0,null===(i=this.renderingStrategy)||void 0===i||i.destroy(),this.renderingStrategy=void 0,this.gridLines.destroy(),this.contextLostListener.destroy()}}},8387:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GridLines=void 0;const r=i(3993),n=i(5672);t.GridLines=class GridLines{constructor(e){this.cachedGridRender=null,this.cachedGridZoom=0,this.cachedGridRenderScaleMultiplier=1,this.cachedGridDrawSize=0,this.useCache=!0,this.options={type:"dot",size:4,spacing:23,minZoomLevel:.5,colors:[{zoom:.5,r:47,g:47,b:47,a:.24},{zoom:1,r:47,g:47,b:47,a:.12},{zoom:2,r:47,g:47,b:47,a:.06}]},this.canvasFactory=e}setOptions(e){this.options=Object.assign(Object.assign({},e),{colors:e.colors.map((e=>Object.assign({},e)))}),this.options.colors.sort(((e,t)=>e.zoom-t.zoom)),this.invalidateCache()}draw(e,t,i){const r=e.cameraScale,n=e.renderScaleMultiplier,s=this.options;if(r<s.minZoomLevel)return;if(0===s.colors.length)return;const a="canvas-only"===s.drawingMode;if(a&&!i.intersects(t))return;const o=s.spacing,l=Math.floor(i.x/o)*o,d=Math.floor(i.y/o)*o,h=Math.ceil(i.x1/o)*o,c=Math.ceil(i.y1/o)*o;this.updateCachedGrid(r,n),a&&(e.saveClip(),e.clipRectangle(t.x,t.y,t.width,t.height)),this.useCache?this.drawCachedGrid(e,l,d,h,c):e.drawDotsGrid(l,d,h,c,o,s.size,this.getDotColor(r)),a&&e.restoreClip()}getDotColor(e){const t=this.options,i=t.colors.findIndex((t=>e<=t.zoom)),r=i>=0?i:t.colors.length-1,s=t.colors[r],a=t.colors[r>0?r-1:0],o=a.zoom<s.zoom?(e-a.zoom)/(s.zoom-a.zoom):0;return`rgba(${Math.round((0,n.linearClamped)(a.r,s.r,o))},${Math.round((0,n.linearClamped)(a.g,s.g,o))},${Math.round((0,n.linearClamped)(a.b,s.b,o))},${(0,n.linearClamped)(a.a,s.a,o)})`}updateCachedGrid(e,t){if(null!==this.cachedGridRender&&this.cachedGridZoom===e&&this.cachedGridRenderScaleMultiplier===t)return;null!==this.cachedGridRender&&t===this.cachedGridRenderScaleMultiplier||this.buildCachedGridRender(t);const i=this.cachedGridRender;if(null===i)return void(this.useCache=!1);const r=this.options.spacing*e*t,n=this.options.size*e*t,s=this.getDotColor(e),a=Math.floor(i.nativeCanvas.width/r);a>1?(i.clear(),i.drawDotsGrid(0,0,i.nativeCanvas.width,i.nativeCanvas.height,r,n,s),this.useCache=!0):this.useCache=!1,this.cachedGridDrawSize=a*r,this.cachedGridZoom=e,this.cachedGridRenderScaleMultiplier=t}drawCachedGrid(e,t,i,r,n){if(null===this.cachedGridRender)return;const s=this.cachedGridRenderScaleMultiplier,a=this.cachedGridRender.nativeCanvas,o=this.cachedGridDrawSize,l=o/e.cameraScale/s;for(let s=i;s<=n;s+=l)for(let i=t;i<=r;i+=l)e.drawImageDest(a,0,0,o,o,i,s,l,l)}buildCachedGridRender(e){null!==this.cachedGridRender&&(this.canvasFactory.destroyCanvas(this.cachedGridRender.nativeCanvas),this.cachedGridRender=null);const t=this.canvasFactory.createCanvas(128*e,128*e);this.cachedGridRender=r.RenderContext.buildDefault(t,"transparent"),this.invalidateCache()}discardCache(){null!==this.cachedGridRender&&(this.buildCachedGridRender(this.cachedGridRenderScaleMultiplier),this.invalidateCache())}destroy(){null!==this.cachedGridRender&&(this.canvasFactory.destroyCanvas(this.cachedGridRender.nativeCanvas),this.cachedGridRender=null),this.cachedGridZoom=0}invalidateCache(){this.cachedGridZoom=0}}},788:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DefaultInvalidationStrategy=void 0;t.DefaultInvalidationStrategy=class DefaultInvalidationStrategy{constructor(e,t,i){this.renderingStrategy=e,this.surface=t,this.paint=i}isPendingRedraw(){return void 0!==this.pendingRedrawRequest}invalidateRect(e,t){this.renderingStrategy.invalidateRect(e,this.surface),t&&this.enqueuePendingRedraw()}enqueuePendingRedraw(){void 0===this.pendingRedrawRequest&&(this.pendingRedrawRequest=requestAnimationFrame(this.redraw.bind(this)))}redraw(){void 0!==this.pendingRedrawRequest&&(this.pendingRedrawRequest=void 0,this.paint())}flush(){}destroy(){void 0!==this.pendingRedrawRequest&&(cancelAnimationFrame(this.pendingRedrawRequest),this.pendingRedrawRequest=void 0)}}},1241:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ThrottledInvalidationStrategy=void 0;const r=i(3037),n=i(5391),s=i(7032);t.ThrottledInvalidationStrategy=class ThrottledInvalidationStrategy{constructor(e,t){this.pendingRects=new s.PendingRedrawRects(new n.SimplePool(r.Rectangle,256)),this.pendingRedraw=!1,this.childStrategy=e,this.paint=t}isPendingRedraw(){return this.pendingRedraw||this.childStrategy.isPendingRedraw()}invalidateRect(e,t){this.pendingRects.push(e),t&&this.enqueueThrottledRedraw()}enqueueThrottledRedraw(){this.pendingRedraw||(this.pendingRedraw=!0,setTimeout(this.redraw.bind(this),1e3/45))}redraw(){this.pendingRedraw&&(this.pendingRedraw=!1,this.flush(),this.childStrategy.isPendingRedraw()||this.paint())}flush(){this.childStrategy.flush(),this.pendingRects.length>0&&(this.pendingRects.forEach((e=>this.childStrategy.invalidateRect(e,!1))),this.pendingRects.clear())}enqueuePendingRedraw(){this.childStrategy.enqueuePendingRedraw()}destroy(){this.flush(),this.pendingRedraw=!1,this.childStrategy.destroy()}}},5181:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CompositeStrategy=void 0;const r=i(2129);t.CompositeStrategy=class CompositeStrategy{constructor(e){this.strategies=[],this.strategies=e,this.renderFn=r.renderNoOp;for(let t=e.length-1;t>=0;--t){const i=this.renderFn,r=e[t];this.renderFn=(e,t,n)=>r.render(e,t,n,i)}}warmup(){for(let e=0,t=this.strategies.length;e<t;++e)this.strategies[e].warmup()}viewportResize(e,t){for(let i=0,r=this.strategies.length;i<r;++i)this.strategies[i].viewportResize(e,t)}invalidateRect(e,t){for(let i=0,r=this.strategies.length;i<r;++i)this.strategies[i].invalidateRect(e,t)}newFrame(){for(let e=0,t=this.strategies.length;e<t;++e)this.strategies[e].newFrame()}render(e,t,i){return this.renderFn(e,t,i)}discardCache(){this.strategies.forEach((e=>e.discardCache()))}destroy(){this.strategies.forEach((e=>e.destroy()))}}},3963:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CustomLayerStrategy=void 0;const r=i(9570);t.CustomLayerStrategy=class CustomLayerStrategy{constructor(e,t){this.qtIterator=e,this.customLayersDrawingOrder=t}warmup(){}viewportResize(){}invalidateRect(){}newFrame(){}render(e,t,i,n){const s=n(e,t,i);let a=!1;const o=(0,r.getNextQtFrame)();for(let i=0;i<this.customLayersDrawingOrder.length;i++){const r=this.customLayersDrawingOrder[i];r.visible&&(a||(a=!0,this.qtIterator.forEachVisibleNode(t,(e=>e.qtFrame=o))),this.renderQtLayer(r,e,t,o))}return s}renderQtLayer(e,t,i,r){if(e.backColor&&"transparent"!==e.backColor){t.setupViewportTransform();const r=t.renderScaleMultiplier/t.renderScale;t.drawRectangle(i.x,i.y,i.width+r,i.height+r,e.backColor,"",0)}const n=e.getLayerRootNodes();t.setupViewportTransform();for(let i=0;i<n.length;i++)this.renderQtFrame(n[i],t,r,e)}renderQtFrame(e,t,i,r){e.render(t,(e=>e.qtFrame===i&&e.visible),((e,t)=>{const i=e.isPartialNode&&t,n=!e.isPartialNode&&r.hasNode(e);return i||n}))}discardCache(){}destroy(){}}},2129:(e,t)=>{"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0}),t.renderNoOp=t.RenderResult=void 0,function(e){e[e.Done=0]="Done",e[e.InProgress=1]="InProgress"}(i=t.RenderResult||(t.RenderResult={}));t.renderNoOp=()=>i.Done},3661:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.OptimizedViewportStrategy=void 0;const r=i(3037),n=i(5391),s=i(2129),a=i(7032);t.OptimizedViewportStrategy=class OptimizedViewportStrategy{constructor(e,t,i,s){this.usedLastRender=!1,this.cacheValid=!1,this.cacheClipBounds=new r.Rectangle,this.zooming=!1,this.zoomingFrames=0,this.zoomingMinScale=1,this.rectsPool=new n.SimplePool(r.Rectangle,1024),this.usePan=!0,this.useZoomIn=!0,this.useZoomOut=!0,this.fixedBackground=!1,this.renderScaleMultiplier=t,this.getMuralBoundsFn=i,this.fixedBackground=s,"safari"!==e.runtime||e.mobile&&"ipad"!==e.deviceType||(this.usePan=!1,this.useZoomOut=!1,"ipad"===e.deviceType&&(this.useZoomIn=!1)),this.pendingRedrawViewportRects=new a.PendingRedrawRects(this.rectsPool,16)}warmup(){this.invalidateCache()}invalidateRect(e,t){t.shows(e)&&this.pendingRedrawViewportRects.push(e)}viewportResize(){this.invalidateCache()}newFrame(){}render(e,t,i,r){let n=s.RenderResult.Done;if(this.canUseCacheForInvalidation(e))this.usedLastRender=!0,n=this.drawPendingRects(e,r,[]);else if(this.canUseCacheForPanning(e)){const t=e.cameraClipBounds,i=e.cameraScale,s=this.renderScaleMultiplier,a=Math.round((t.x-this.cacheClipBounds.x)*i),o=Math.round((t.y-this.cacheClipBounds.y)*i),l=this.cacheClipBounds.x+a/i,d=this.cacheClipBounds.y+o/i,h=(-this.cacheClipBounds.x*i-a)*s,c=(-this.cacheClipBounds.y*i-o)*s,u=e.cameraClipBounds.x,g=e.cameraClipBounds.y,f=e.cameraTransformMatrixI[2],m=e.cameraTransformMatrixI[5];e.cameraClipBounds.setLocation(l,d),e.cameraTransformMatrixI[2]=h,e.cameraTransformMatrixI[5]=c,n=this.renderOptimizedViewportPanning(e,r,a,o),e.cameraClipBounds.setLocation(u,g),e.cameraTransformMatrixI[2]=f,e.cameraTransformMatrixI[5]=m,this.usedLastRender=!0,this.cacheClipBounds.setLocation(l,d)}else this.canUseCacheForZooming(e)?(this.zooming||(this.zooming=!0,this.zoomingFrames=0,this.zoomingMinScale=e.cameraScale),n=this.renderOptimizedViewportZooming(e,r),this.usedLastRender=!0,this.cacheClipBounds.copy(e.cameraClipBounds),this.zoomingFrames++,this.zoomingMinScale=Math.min(this.zoomingMinScale,e.cameraScale)):(this.invalidateCache(),n=r(e,t,i),this.usedLastRender=!1,n===s.RenderResult.Done&&(this.cacheClipBounds.copy(e.cameraClipBounds),this.cacheValid=!0,this.zooming=!1));return n}invalidateCache(){this.cacheValid=!1,this.pendingRedrawViewportRects.clear()}renderOptimizedViewportZooming(e,t){const i=this.renderScaleMultiplier,r=this.cacheClipBounds,{cameraClipBounds:n,native:a,targetWidth:o,targetHeight:l}=e,d=o/r.width,h=o/n.width,c=(n.x-r.x)*d,u=(n.y-r.y)*d,g=(n.x1-r.x)*d,f=(n.y1-r.y)*d,m=g-c,v=f-u,y=[],w=o/m;e.saveContext(),a.imageSmoothingEnabled=!0,a.resetTransform();const x=-Math.min(c,0),b=-Math.min(u,0),C=x+Math.max(m-x-o,0),A=b+Math.max(v-b-l,0);return a.drawImage(a.canvas,(c+x)*i,(u+b)*i,(m-C)*i,(v-A)*i,(0+x*w)*i,(0+b*w)*i,(o-C*w)*i,(l-A*w)*i),c<0&&y.push(this.newRectangle(0,0,-c*w,l)),g>o&&y.push(this.newRectangle(o-(g-o)*w,0,(g-o)*w,l)),u<0&&y.push(this.newRectangle(0,0,o,-u*w)),f>l&&y.push(this.newRectangle(0,l-(f-l)*w,o,(f-l)*w)),this.fixedBackground&&this.forEachOutsideMuralRect(n,this.getMuralBoundsFn(),((e,t,i,r)=>{const s=(e-n.x)*h,a=(t-n.y)*h,o=s+i*h-s,l=a+r*h-a;y.push(this.newRectangle(s,a,o,l))})),this.drawNewVisibleContent(y,e,t),this.rectsPool.returnAndClearArray(y),s.RenderResult.InProgress}renderOptimizedViewportPanning(e,t,i,r){const n=this.renderScaleMultiplier,s=e.targetWidth,a=e.targetHeight,o=e.native,l=[];return 0===i&&0===r||(e.saveContext(),o.imageSmoothingEnabled=!1,o.resetTransform(),o.drawImage(o.canvas,-i*n,-r*n),e.restoreContext(),i<0?l.push(this.newRectangle(0,0,-i,a)):i>0&&l.push(this.newRectangle(s-i,0,i,a)),r<0?l.push(this.newRectangle(0,0,s,-r)):r>0&&l.push(this.newRectangle(0,a-r,s,r)),this.fixedBackground&&this.forEachOutsideMuralRect(e.cameraClipBounds,this.getMuralBoundsFn(),this.pendingRedrawViewportRects.pushNewRectangle.bind(this.pendingRedrawViewportRects))),this.drawPendingRects(e,t,l)}drawPendingRects(e,t,i){let r=s.RenderResult.Done;const n=e.cameraScale,a=e.cameraClipBounds.x,o=e.cameraClipBounds.y;for(let e=0;e<this.pendingRedrawViewportRects.length;e++){const t=this.pendingRedrawViewportRects.get(e),r=(t.x-a)*n,s=(t.y-o)*n,l=t.width*n,d=t.height*n;i.push(this.newRectangle(r,s,l,d))}return this.pendingRedrawViewportRects.clear(),r=this.drawNewVisibleContent(i,e,t),this.rectsPool.returnAndClearArray(i),r}forEachOutsideMuralRect(e,t,i){const r=e.x,n=e.y,s=e.x1,a=e.y1,o=e.width,l=e.height;let d=0,h=0;r<t.x&&(d=t.x-r,i(r,n,t.x-r,l)),s>t.x1&&(h=s-t.x1,i(t.x1,n,s-t.x1,l)),n<t.y&&i(r+d,n,o-(h+d),t.y-n),a>t.y1&&i(r+d,t.y1,o-(h+d),a-t.y1)}newRectangle(e,t,i,r){return this.rectsPool.get().setBounds(e,t,i,r)}drawNewVisibleContent(e,t,i){const r=t.native,n=t.cameraScale,a=t.cameraClipBounds.x,o=t.cameraClipBounds.y,l=t.targetWidth,d=t.targetHeight,h=this.renderScaleMultiplier;let c=s.RenderResult.Done;for(let u=0;u<e.length;u++){const g=e[u],f=Math.floor(g.x)-1,m=Math.floor(g.y)-1,v=Math.max(f,0),y=Math.max(m,0),w=Math.min(Math.ceil(g.x1)+1,l)-v,x=Math.min(Math.ceil(g.y1)+1,d)-y;if(w<=0||x<=0)continue;t.saveContext(),r.resetTransform(),r.beginPath(),r.rect(v*h,y*h,w*h,x*h),r.clip(),t.setupViewportTransform(),g.setBounds(v/n+a,y/n+o,w/n,x/n);i(t,g,!0)===s.RenderResult.InProgress&&(c=s.RenderResult.InProgress),t.restoreContext()}return c}canUseCacheForInvalidation(e){const t=e.cameraClipBounds;return this.cacheValid&&!this.zooming&&this.cacheClipBounds.equals(t)}canUseCacheForPanning(e){const t=e.cameraClipBounds,i=this.getMuralBoundsFn();return this.usePan&&this.cacheValid&&!this.zooming&&this.cacheClipBounds.width==t.width&&this.cacheClipBounds.height==t.height&&(this.cacheClipBounds.x!==t.x||this.cacheClipBounds.y!==t.y)&&this.cacheClipBounds.intersects(t)&&(!this.fixedBackground||i.intersects(t))}canUseCacheForZooming(e){const t=e.cameraClipBounds,i=this.getMuralBoundsFn(),r=t.width<this.cacheClipBounds.width,n=t.width>this.cacheClipBounds.width;return this.cacheValid&&(r&&this.useZoomIn||n&&this.useZoomOut)&&(!this.zooming||this.zoomingFrames<60)&&(!this.zooming||e.cameraScale/this.zoomingMinScale<4)&&this.cacheClipBounds.intersects(t)&&(!this.fixedBackground||i.intersects(t))}getStats(){return{usedLastRender:this.usedLastRender}}discardCache(){this.invalidateCache()}destroy(){}forceInvalidation(){this.invalidateCache()}}},2248:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ScreenshotStrategy=void 0;const r=i(2129);t.ScreenshotStrategy=class ScreenshotStrategy{constructor(e,t,i){this.states=e,this.externalIdsFilter=t,this.root=i}warmup(){}viewportResize(){}invalidateRect(){}newFrame(){}render(e){return e.setupViewportTransform(),this.renderNode(this.root,e),r.RenderResult.Done}renderNode(e,t){e.render(t,(e=>e.visible),((e,t)=>{const i=this.states.includes(e.state),r=e.isPartialNode&&t,n=!e.isPartialNode&&(0==this.externalIdsFilter.length||this.externalIdsFilter.includes(e.externalId));return e===this.root||i&&(r||n)}))}discardCache(){}destroy(){}}},821:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TileCacheStrategy=void 0;const r=i(3037),n=i(5391),s=i(541),a=i(4501),o=i(2129),l=i(7032);function floorToScale(e){return Math.floor(e/a.TILE_CACHE_SCALE)*a.TILE_CACHE_SCALE}function ceilToScale(e){return Math.ceil(e/a.TILE_CACHE_SCALE)*a.TILE_CACHE_SCALE}t.TileCacheStrategy=class TileCacheStrategy{constructor(e,t,i,a,o,d){this.frame=0,this.pendingWarmUp=!0,this.rectsPool=new n.SimplePool(r.Rectangle,1024),this.stats=function buildStats(){return{used:!1,updatedTiles:0,invalidatedTileIds:new Set}}(),this.enabled_=!0,this.forceSkipCache_=!1,this.pendingDirtyCacheRects=new Map,this.pendingRedrawRects=new l.PendingRedrawRects(this.rectsPool),this.qtIterator=e,this.root=t,this.rects=new s.TileCacheRects(o,d.screen.gpu.bugs,i),this.drawBackgroundFn=a,this.maxCacheSize="safari"===d.runtime&&d.mobile?314572800:2147483648}get enabled(){return this.enabled_}get forceSkipCache(){return this.forceSkipCache_}set forceSkipCache(e){this.forceSkipCache_=e}warmup(){this.pendingWarmUp=!0}warmupCache(e){if(this.updateEnabled(),this.enabled_){const t=this.rects.getIteratorForBounds(this.root.aabb);for(;t.next();)this.cacheIterator(t,e)}if(this.updateEnabled(),this.enabled_){const t=this.rects.getIteratorForBounds(this.root.aabb);for(;t.next();){const i=t.getCurrentInfo();null===i||i.hasBitmap||this.updateBitmap(i,e,!0)}}this.pendingRedrawRects.clear()}updateEnabled(){const e=this.rects.getIteratorForBounds(this.root.aabb),t=this.rects.getMaxPotentialMemoryUsage()<=this.maxCacheSize&&e.rectsCount<=1e7;this.enabled_!==t&&(this.enabled_=t,t||(this.pendingRedrawRects.clear(),this.rects.freeMemory()))}invalidateRect(e){if(!this.enabled_)return;const t=floorToScale(e.x)-a.TILE_CACHE_SCALE,i=floorToScale(e.y)-a.TILE_CACHE_SCALE,r=ceilToScale(e.width)+2*a.TILE_CACHE_SCALE,n=ceilToScale(e.height)+2*a.TILE_CACHE_SCALE;this.pendingRedrawRects.pushNewRectangle(t,i,r,n)}viewportResize(){}newFrame(){!function resetStats(e){e.updatedTiles=0,e.invalidatedTileIds.clear()}(this.stats),this.pendingWarmUp||this.addPendingRedrawRectsToDirtyCacheRects()}getVisibleCacheRectsStats(e){const t=this.rects.getIteratorForBounds(e);let i=0,r=0;for(;t.next();){const e=t.getCurrentInfo(),n=t.getCurrentInfoId();(null!==e||null===e&&this.pendingDirtyCacheRects.has(n))&&i++,this.stats.invalidatedTileIds.has(n)&&r++}return{visibleRects:i,rectsToUpdateFromInvalidationsThisFrame:r}}render(e,t,i,r){return this.pendingWarmUp&&(this.pendingWarmUp=!1,this.warmupCache(r)),this.addPendingRedrawRectsToDirtyCacheRects(),this.shouldUseCache(e.cameraScale)?(this.updateFromDirtyCacheRects(r,t),this.stats.used=!0,i&&this.drawBackgroundFn(e,t),this.renderCacheRects(e,t,r)):(this.stats.used=!1,r(e,t,i))}renderCacheRects(e,t,i){const r=e.cameraScale,n=e.renderScale,s=e.native;this.frame++;const a=this.rects.getIteratorForBounds(t);e.saveContext(),s.imageSmoothingEnabled=!0,s.resetTransform();const l=[];for(;a.next();){const t=a.getCurrentInfo();null!==t&&(t.visibleFrame=this.frame,t.hasBitmap?this.renderBitmap(t,r,n,e.cameraClipBounds,s):l.push(t))}if(l.length>0){for(let t=0;t<l.length;t++){const a=l[t];this.updateBitmap(a,i,!1),this.renderBitmap(a,r,n,e.cameraClipBounds,s)}this.updateEnabled()}return e.restoreContext(),o.RenderResult.Done}addPendingRedrawRectsToDirtyCacheRects(){const e=this.pendingRedrawRects.getAllRects(),t=this.pendingDirtyCacheRects;for(let i=0;i<e.length;i++){const r=e[i],n=this.rects.getIteratorForBounds(r);for(;n.next();){const e=n.getCurrentInfoId(),i=t.get(e);if(i)i.union(r);else{const i=this.rectsPool.get().copy(r);t.set(e,i)}this.stats.invalidatedTileIds.add(e)}}this.pendingRedrawRects.clear()}updateFromDirtyCacheRects(e,t){if(0===this.pendingDirtyCacheRects.size)return;const i=this.rects.getIteratorForBounds(t);for(;i.next();){const t=i.getCurrentInfoId(),r=this.pendingDirtyCacheRects.get(t);r&&(this.cacheIterator(i,e,r),this.rectsPool.return(r),this.pendingDirtyCacheRects.delete(t))}}cacheIterator(e,t,i){const r=e.getCurrentBounds();let n=0;if(this.qtIterator.forEachVisibleNode(r,(e=>{const t=e;t.visible&&t!==this.root&&n++})),0==n)return void e.disposeCurrentInfo();e.prepareCurrentInfo();const s=e.getCurrentInfo();if(null!==s&&s.hasBitmap){const e=i&&i.contains(r)?void 0:i;this.updateBitmap(s,t,!1,e)}}updateBitmap(e,t,i,r){this.stats.updatedTiles++,e.prepareBitmapAndSurface();const n=e.surface;if(null===n)return;r?(n.resetTransform(),n.ctx.save(),n.ctx.beginPath(),n.ctx.rect(r.x,r.y,r.width,r.height),n.ctx.clip(),n.ctx.clearRect(r.x,r.y,r.width,r.height)):n.clear();const s=n.beginRender(!1);t(s,e.bounds,!1),s.finishRendering(),r?(n.ctx.restore(),e.dirtyMipmapsRect(r)):e.dirtyAllMipmaps(i)}renderBitmap(e,t,i,r,n){const s=e.getBestMipmap(t);if(null===s)return;const a=e.bounds,o=Math.floor((a.x-r.x)*i),l=Math.floor((a.x1-r.x)*i),d=Math.floor((a.y-r.y)*i),h=Math.floor((a.y1-r.y)*i);n.drawImage(s,o,d,l-o,h-d)}shouldUseCache(e){if(!this.enabled_||this.forceSkipCache_)return!1;return a.TILE_CACHE_SCALE<1/e}getStats(){return Object.assign(Object.assign(Object.assign({},this.rects.getStats()),this.stats),{enabled:this.enabled_,forceSkip:this.forceSkipCache_})}getFullBoundsIterator(){return this.rects.getIteratorForBounds(this.root.aabb)}discardCache(){this.rects.freeMemory(),this.warmup()}destroy(){this.rects.freeMemory()}}},7032:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PendingRedrawRects=void 0;const r=i(3037);t.PendingRedrawRects=class PendingRedrawRects{constructor(e,t=0){this.rects=[],this.tmpRect=new r.Rectangle,this.pool=e,this.maxRectsBeforeMerge=t}get length(){return this.rects.length}get(e){return this.rects[e]}getAllRects(){return this.rects}push(e){let t=this.rects.length>0?this.rects[this.rects.length-1]:null;if(null===t||!e.inside(t)){for(;null!==t&&t.inside(e);)this.pool.return(t),this.rects.pop(),t=this.rects.length>0?this.rects[this.rects.length-1]:null;if(this.rects.push(this.pool.get().copy(e)),this.maxRectsBeforeMerge>0&&this.rects.length>this.maxRectsBeforeMerge){const e=this.pool.get().copy(this.rects[0]);this.rects.forEach((t=>e.union(t))),this.clear(),this.rects.push(e)}}}pushNewRectangle(e,t,i,r){this.tmpRect.setBounds(e,t,i,r),this.push(this.tmpRect)}clear(){this.pool.returnAndClearArray(this.rects)}forEach(e){this.rects.forEach(e)}}},8620:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ViewportStrategy=void 0;const r=i(9570),n=i(2129);t.ViewportStrategy=class ViewportStrategy{constructor(e,t,i){this.qtIterator=e,this.drawBackgroundFn=t,this.layersDrawingOrder=i}warmup(){}viewportResize(){}invalidateRect(){}newFrame(){}render(e,t,i){i&&this.drawBackgroundFn(e,t);const s=(0,r.getNextQtFrame)();this.qtIterator.forEachVisibleNode(t,(e=>e.qtFrame=s));for(let t=0;t<this.layersDrawingOrder.length;t++)this.renderQtLayer(this.layersDrawingOrder[t],e,s);return n.RenderResult.Done}renderQtLayer(e,t,i){const r=e.getLayerRootNodes(),n=e.layer;t.setupViewportTransform();for(let e=0;e<r.length;e++)this.renderQtFrame(r[e],t,i,n)}renderQtFrame(e,t,i,r){e.render(t,(e=>e.qtFrame===i&&e.visible),(e=>e.layer===r))}discardCache(){}destroy(){}}},1962:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CacheRectBitmap=t.getCacheRectMemoryUsage=void 0;const r=i(3993),n=i(3037),s=i(2404);function floorToEven(e){return 2*Math.floor(e/2)}function ceilToEven(e){return 2*Math.ceil(e/2)}function getCacheRectMemoryUsage(e,t,i){let r=e*t;for(let n=0;n<i;n++){r+=e/(1<<n+1)*(t/(1<<n+1))}return 4*r}t.getCacheRectMemoryUsage=getCacheRectMemoryUsage;t.CacheRectBitmap=class CacheRectBitmap{constructor(e,t,i,r,a,o=null){this.bounds=new n.Rectangle,this.mipmaps=[],this.mipmapsCtx=[],this.validMipmapLevel=0,this.validMipmapRectLevel=0,this.invalidMipmapRect=new n.Rectangle,this.asyncHelper=null,this.asyncHelper=o,this.canvasFactory=r;const l=r.createCanvas(ceilToEven(e),ceilToEven(t));this.bitmap=l.canvas,this.bounds.setBounds(0,0,e,t),this.surface=new s.RenderSurface(l,a,1),this.surface.setCameraPosition(this.bounds.centerX,this.bounds.centerY),this.mipmapLevels=i,this.buildMipmaps()}get hasPendingUpdates(){return this.validMipmapLevel!==this.mipmapLevels||this.validMipmapRectLevel!==this.validMipmapLevel}init(e){this.bounds.copy(e),this.surface.setCameraPosition(e.centerX,e.centerY),this.surface.clear(),this.validMipmapLevel=0,this.validMipmapRectLevel=0}buildMipmaps(){for(let e=0;e<this.mipmapLevels;e++){const{canvas:t,ctx:i}=this.canvasFactory.createCanvas(this.bitmap.width/(1<<e+1),this.bitmap.height/(1<<e+1));i.imageSmoothingEnabled=!0,this.mipmaps.push(t),this.mipmapsCtx.push(i)}}dirtyAllMipmaps(e){if(this.validMipmapLevel=0,this.validMipmapRectLevel=0,e)for(;this.hasPendingUpdates;)this.update();else null!==this.asyncHelper&&this.asyncHelper.registerForUpdate(this)}dirtyMipmapsRect(e){if(this.validMipmapRectLevel===this.validMipmapLevel?(this.validMipmapRectLevel=0,this.invalidMipmapRect.copy(e)):(this.validMipmapRectLevel=0,this.invalidMipmapRect.union(e)),null!==this.asyncHelper)this.asyncHelper.registerForUpdate(this);else for(;this.validMipmapRectLevel!==this.validMipmapLevel;)this.update()}getBestMipmap(e){if(null===this.asyncHelper&&this.update(),e<2||0==this.validMipmapLevel)return this.bitmap;let t=-1;for(let i=0;i<this.validMipmapLevel;i++){if(1<<i+2>e){t=i;break}}for(t<0&&(t=this.validMipmapLevel-1);this.validMipmapRectLevel<=t;)this.update();return this.mipmaps[t]}update(){if(this.validMipmapLevel<this.mipmapLevels){const e=this.validMipmapLevel,t=this.mipmaps[e],i=this.mipmapsCtx[e];i.clearRect(0,0,t.width,t.height);const n=0==e?this.bitmap:this.mipmaps[e-1];(0,r.isValidDrawImageSource)(n)&&i.drawImage(n,0,0,t.width,t.height),this.validMipmapLevel++,this.validMipmapRectLevel===this.validMipmapLevel-1&&this.validMipmapRectLevel++}else if(this.validMipmapRectLevel<this.validMipmapLevel){const e=this.validMipmapRectLevel,t=this.invalidMipmapRect,i=this.mipmaps[e],n=this.mipmapsCtx[e],s=0==e?this.bitmap:this.mipmaps[e-1],a=this.bounds.width/i.width,o=this.bounds.height/i.height,l=s.width/i.width,d=s.height/i.height,h=Math.max(floorToEven((t.x-this.bounds.x)/a-a),0),c=Math.max(floorToEven((t.y-this.bounds.y)/o-o),0),u=Math.min(ceilToEven((t.x1-this.bounds.x)/a+a),i.width),g=Math.min(ceilToEven((t.y1-this.bounds.y)/o+o),i.height),f=h*l,m=c*d,v=u*l,y=g*d;n.clearRect(h,c,u-h,g-c),(0,r.isValidDrawImageSource)(s)&&n.drawImage(s,f,m,v-f,y-m,h,c,u-h,g-c),this.validMipmapRectLevel++}this.hasPendingUpdates||null===this.asyncHelper||this.asyncHelper.unregisterForUpdate(this)}getMemoryUsage(){return getCacheRectMemoryUsage(this.bitmap.width,this.bitmap.height,this.mipmapLevels)}disposeBitmaps(){this.canvasFactory.destroyCanvas(this.bitmap),this.mipmaps.forEach(this.canvasFactory.destroyCanvas)}clear(){null!==this.asyncHelper&&this.asyncHelper.unregisterForUpdate(this)}}},1949:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TileCacheRectAsyncHelper=void 0;t.TileCacheRectAsyncHelper=class TileCacheRectAsyncHelper{constructor(){this.rects=new Set,this.animationFrameRequested=!1}registerForUpdate(e){this.rects.add(e),this.requestEnterFrame()}unregisterForUpdate(e){this.rects.delete(e)}requestEnterFrame(){this.animationFrameRequested||(this.animationFrameRequested=!0,requestAnimationFrame((()=>this.onAnimationFrame())))}onAnimationFrame(){this.animationFrameRequested=!1,this.rects.forEach((e=>e.update())),this.rects.size>0&&this.requestEnterFrame()}clear(){this.rects.clear()}}},8961:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TileCacheRectInfo=void 0;const r=i(3037),n=i(1962),s=i(4501);t.TileCacheRectInfo=class TileCacheRectInfo{constructor(e){this.visibleFrame=-1,this.bounds=new r.Rectangle,this.rectBitmap=null,this.bounds.setDimension(s.TILE_CACHE_RECT_SIZE,s.TILE_CACHE_RECT_SIZE),this.bitmapsPool=e}get bitmap(){return null!==this.rectBitmap?this.rectBitmap.bitmap:null}get surface(){return null!==this.rectBitmap?this.rectBitmap.surface:null}get hasBitmap(){return null!==this.rectBitmap}init(e,t){this.bounds.setLocation(e,t),null!==this.rectBitmap&&this.rectBitmap.init(this.bounds),this.visibleFrame=-1}prepareBitmapAndSurface(){null===this.rectBitmap&&(this.rectBitmap=this.bitmapsPool.get(),this.rectBitmap.init(this.bounds))}disposeBitmapAndSurface(){null!==this.rectBitmap&&(this.bitmapsPool.return(this.rectBitmap),this.rectBitmap=null)}dirtyAllMipmaps(e){var t;null===(t=this.rectBitmap)||void 0===t||t.dirtyAllMipmaps(e)}dirtyMipmapsRect(e){var t;null===(t=this.rectBitmap)||void 0===t||t.dirtyMipmapsRect(e)}getBestMipmap(e){return null!==this.rectBitmap?this.rectBitmap.getBestMipmap(1/(e*s.TILE_CACHE_SCALE)):null}getMemoryUsage(){return null!==this.rectBitmap?this.rectBitmap.getMemoryUsage():0}getMaxPotentialMemoryUsage(e){return(0,n.getCacheRectMemoryUsage)(s.TILE_CACHE_BITMAP_SIZE*e,s.TILE_CACHE_BITMAP_SIZE*e,s.TILE_CACHE_MIPMAP_LEVELS)}clear(){var e;null===(e=this.rectBitmap)||void 0===e||e.clear()}}},541:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TileCacheRects=void 0;const r=i(5391),n=i(1962),s=i(1949),a=i(8961),o=i(6695),l=i(4501);t.TileCacheRects=class TileCacheRects{constructor(e,t,i){this.rectsMap=new Map,this.tmpArray=[],this.renderScaleMultiplier=i,this.asyncHelper=new s.TileCacheRectAsyncHelper,this.bitmapsPool=new r.ParametrizedPool((()=>{const r=new n.CacheRectBitmap(l.TILE_CACHE_BITMAP_SIZE*i,l.TILE_CACHE_BITMAP_SIZE*i,l.TILE_CACHE_MIPMAP_LEVELS,e,t,this.asyncHelper);return r.surface.clearColor="transparent",r.surface.setCameraScale(1/l.TILE_CACHE_SCALE*i),r}),(e=>e.clear())),this.rectsPool=new r.ParametrizedPool((()=>new a.TileCacheRectInfo(this.bitmapsPool)),(e=>e.clear()))}get rectsCount(){return this.rectsMap.size}getIteratorForBounds(e){const t=Math.floor(e.x/l.TILE_CACHE_RECT_SIZE),i=Math.floor(e.y/l.TILE_CACHE_RECT_SIZE),r=Math.floor(e.x1/l.TILE_CACHE_RECT_SIZE+1),n=Math.floor(e.y1/l.TILE_CACHE_RECT_SIZE+1);return new o.TileCacheRectsIterator(this.rectsMap,this.rectsPool,t,i,r,n)}getStats(){const e=this.rectsCount;let t=0,i=0;return this.rectsMap.forEach((e=>{t+=e.getMemoryUsage()})),this.bitmapsPool.forEach((e=>i+=e.getMemoryUsage())),this.rectsPool.forEach((e=>i+=e.getMemoryUsage())),{rectsCount:e,totalMemoryMB:Math.round(t/1048576),totalPoolMB:Math.round(i/1048576)}}getMaxPotentialMemoryUsage(){let e=0;return this.rectsMap.forEach((t=>{e+=t.getMaxPotentialMemoryUsage(this.renderScaleMultiplier)})),e}cleanUpNonVisibleEntries(e,t){const i=this.tmpArray;i.length=0,this.rectsMap.forEach((t=>{t.hasBitmap&&t.visibleFrame!==e&&i.push(t)})),i.sort(((e,t)=>e.visibleFrame-t.visibleFrame));for(let e=0;e<t&&e<i.length;e++)i[e].disposeBitmapAndSurface()}freeMemory(){this.rectsMap.forEach((e=>e.disposeBitmapAndSurface())),this.rectsMap.clear(),this.rectsPool.clear(),this.bitmapsPool.forEach((e=>e.disposeBitmaps())),this.bitmapsPool.clear(),this.asyncHelper.clear()}}},6695:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TileCacheRectsIterator=void 0;const r=i(3037),n=i(4501);t.TileCacheRectsIterator=class TileCacheRectsIterator{constructor(e,t,i,n,s,a){this.fromX=0,this.fromY=0,this.toX=0,this.toY=0,this.started=!1,this.valid=!1,this.x=0,this.y=0,this.currentId=0,this.currentBounds=new r.Rectangle,this.currentInfo=null,this.rectsMap=e,this.rectsPool=t,this.fromX=i,this.fromY=n,this.toX=s,this.toY=a,this.x=this.fromX,this.y=this.fromY}get rectsCount(){return(this.toX-this.fromX)*(this.toY-this.fromY)}restart(){this.started=!1,this.valid=!1,this.x=this.fromX,this.y=this.fromY,this.currentId=0,this.currentBounds.setEmpty(),this.currentInfo=null}getCurrentInfo(){return this.currentInfo}getCurrentInfoId(){return this.currentId}disposeCurrentInfo(){this.valid&&null!==this.currentInfo&&(this.currentInfo.disposeBitmapAndSurface(),this.rectsMap.delete(this.currentId),this.rectsPool.return(this.currentInfo),this.currentInfo=null)}prepareCurrentInfo(){this.valid&&null===this.currentInfo&&(this.currentInfo=this.rectsPool.get(),this.currentInfo.init(this.currentBounds.x,this.currentBounds.y),this.rectsMap.set(this.currentId,this.currentInfo))}getCurrentBounds(){return this.currentBounds}next(){if(this.started?(this.x++,this.x>=this.toX&&(this.x=this.fromX,this.y++)):this.started=!0,this.valid=this.x<this.toX&&this.y<this.toY,this.valid){this.currentId=(this.x<<16)+this.y,this.currentBounds.setBounds(this.x*n.TILE_CACHE_RECT_SIZE,this.y*n.TILE_CACHE_RECT_SIZE,n.TILE_CACHE_RECT_SIZE,n.TILE_CACHE_RECT_SIZE);const e=this.rectsMap.get(this.currentId);this.currentInfo=e||null}else this.currentId=0,this.currentBounds.setBounds(0,0,0,0),this.currentInfo=null;return this.valid}}},4501:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TILE_CACHE_MIPMAP_LEVELS=t.TILE_CACHE_RECT_SIZE=t.TILE_CACHE_SCALE=t.TILE_CACHE_BITMAP_SIZE=void 0,t.TILE_CACHE_BITMAP_SIZE=512,t.TILE_CACHE_SCALE=6,t.TILE_CACHE_RECT_SIZE=t.TILE_CACHE_BITMAP_SIZE*t.TILE_CACHE_SCALE,t.TILE_CACHE_MIPMAP_LEVELS=3},6823:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ViewportVisibility=void 0;t.ViewportVisibility=class ViewportVisibility{constructor(e){this.lastViewportVisibleNodes=new Map,this.qtIterator=e}update(e,t){const i=this.lastViewportVisibleNodes,r=new Map;this.qtIterator.forEachVisibleNode(e,(e=>r.set(e.id,e))),r.forEach((e=>{i.has(e.id)||e.viewportVisibilityChanged(!0,t)})),i.forEach((e=>{r.has(e.id)||e.viewportVisibilityChanged(!1)})),this.lastViewportVisibleNodes=r}}},5391:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ParametrizedPool=t.SimplePool=void 0;t.SimplePool=class SimplePool{constructor(e,t=0){this.builder=e,this.pool=[];for(let e=0;e<t;e++)this.pool.push(new this.builder)}get(){return this.pool.pop()||new this.builder}return(e){this.pool.push(e)}returnAndClearArray(e){for(let t=0;t<e.length;t++)this.return(e[t]);e.length=0}forEach(e){this.pool.forEach(e)}clear(){this.pool.length=0}};t.ParametrizedPool=class ParametrizedPool{constructor(e,t=null){this.destroyer=null,this.pool=[],this.builder=e,this.destroyer=t}get(){return this.pool.pop()||this.builder()}return(e){this.destroyer&&this.destroyer(e),this.pool.push(e)}returnAndClearArray(e){for(let t=0;t<e.length;t++)this.return(e[t]);e.length=0}forEach(e){this.pool.forEach(e)}clear(){this.pool.length=0}}},3956:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createDomActions=void 0;t.createDomActions=(e,t)=>({mountEngine:e=>{t.mountEngine(e)},mountMinimap:t=>{t.appendChild(e.canvasMinimap.canvas)},unmountEngine:()=>{t.unmountEngine()},unmountMinimap:()=>{e.canvasMinimap.canvas.remove()}})},5355:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createFeedbackActions=void 0;const r=i(3037),n=i(3966),s="rgba(118,168,240,0.5)";t.createFeedbackActions=e=>{const t=new Set,addIds=e=>{let i=!1;return e.forEach((e=>{t.add(e),i=!0})),i};return{api:{add:(...t)=>{addIds(t)&&e.invalidateViewport()},set:i=>{const r=t.size>0;r&&t.clear();const n=addIds(i);(r||n)&&e.invalidateViewport()},remove:(...i)=>{let r=!1;i.forEach((e=>{r=r||t.has(e),t.delete(e)})),r&&e.invalidateViewport()},clear:()=>{t.size&&(t.clear(),e.invalidateViewport())}},draw:i=>{if(!t.size)return;const a=new Path2D,o=[{x:0,y:0},{x:0,y:0},{x:0,y:0},{x:0,y:0}],l={width:0,height:0},d=[],h=i.surface.camera.scale,c=i.surface.camera.getClipBounds().x,u=i.surface.camera.getClipBounds().y,g=i.surface.renderScaleMultiplier,transformBoxToCamera=e=>{const t=e.x,i=e.y,r=e.x1,n=e.y1,s=Math.round((t-c)*h),a=Math.round((i-u)*h),o=Math.round((r-c)*h),l=Math.round((n-u)*h);e.setBounds(s,a,o-s,l-a)},transformSizeToCamera=e=>{e.width=Math.round(e.width*h),e.height=Math.round(e.height*h)},transformPointToCamera=e=>(e.x=(e.x-c)*h,e.y=(e.y-u)*h,e),f=new r.Rectangle;for(const i of t){const t=e.findNodeByExternalId(i);if(t)if(t.selectionShapes)d.push(t);else if(t.axisAligned)f.copy(t.aabbSelfOnlyWithoutRenderOverflow),transformBoxToCamera(f),(0,n.drawBox)(f,a);else{const{border:e}=t;t.getNonRotatedGlobalSizeWithBorder(l),transformSizeToCamera(l),o[0].x=-e,o[0].y=-e,o[1].x=t.width+e,o[1].y=-e,o[2].x=t.width+e,o[2].y=t.height+e,o[3].x=-e,o[3].y=t.height+e,t.transformPoints(o);for(let e=0;e<o.length;e++)transformPointToCamera(o[e]);a.moveTo(o[0].x,o[0].y),a.lineTo(o[1].x,o[1].y),a.lineTo(o[2].x,o[2].y),a.lineTo(o[3].x,o[3].y),a.closePath()}}const m=i.surface;m.ctx.globalAlpha=1,i.setDirty(),m.ctx.resetTransform(),m.ctx.scale(g,g);for(let e=0;e<d.length;e++){const t=d[e];(0,n.drawSelectionShape)(t,s,2,!1,m.ctx,m.camera)}m.ctx.resetTransform(),m.ctx.scale(g,g),m.ctx.fillStyle=s,m.ctx.fill(a)}}}},3310:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createGridActions=void 0;t.createGridActions=e=>({show:()=>{e.showGridLines()},hide:()=>{e.hideGridLines()},setOptions(t){e.setGridLinesOptions(t)}})},1449:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createCanvasEngine=void 0;const r=i(6481),n=i(8665),s=i(3074),a=i(5443),o=i(8333),l=i(3956),d=i(5355),h=i(3310),c=i(7518),u=i(6560),g=i(5653),f=i(923),m=i(2439),v=i(6923),y=i(8121);t.createCanvasEngine=(e,t,i,w,x)=>{const b=o.MDocument.create(t.canvas,t.canvasOverlay,t.canvasMinimap,t.contextLostListener,t.bounds.x,t.bounds.y,t.bounds.width,t.bounds.height,t.background,e,t.viewport.x,t.viewport.y,t.viewport.zoom,t.renderScaleMultiplier,t.runtimeInfo,w,t.layers||[],x.minimap,t.clearColor);b.registerViewportChangeListener(t.onViewportChange);const C=(0,v.createSelectionActions)(b,!!t.drawExplicitShadows,x.selection),A=(0,d.createFeedbackActions)(b),I=(0,r.createCustomFeedbackActions)(b),S=(0,n.createCustomHandleActions)(b),T=(0,g.createNodesActions)(b),_=(0,f.createRenderActions)(b),M=(0,a.createDebugActions)(b,i,w,C,I,_,t.runtimeInfo);return b.postRenderFn=e=>{A.draw(e),S.draw(e),C.draw(e),I.draw(e),M.draw(e)},b.onContextRestoredFn=()=>{var e;null===(e=t.onContextRestored)||void 0===e||e.call(t),i.clear()},{debug:M.api,destroy:()=>b.destroy(),minimap:(0,c.createMinimapActions)(b.minimap),mural:(0,u.createMuralActions)(b),nodes:T.api,selection:C.api,feedback:A.api,viewport:(0,y.createViewportActions)(b),gridlines:(0,h.createGridActions)(b),screenshot:(0,m.createScreenshotActions)(b,w,t.runtimeInfo),customLayers:(0,s.createCustomLayersActions)(b),customHandle:S.api,customFeedback:I.api,dom:(0,l.createDomActions)(t,b),render:_,__hackMDoc:b}}},6016:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Matrix3=void 0;class Matrix3{static Create(){const e=new Float32Array(9);return Matrix3.Identity(e),e}static Identity(e){e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1}static Multiply(e,t){const i=t[0],r=t[1],n=t[2],s=t[3],a=t[4],o=t[5],l=e[0],d=e[1],h=e[2];e[0]=l*i+d*s,e[1]=l*r+d*a,e[2]=l*n+d*o+h;const c=e[3],u=e[4],g=e[5];e[3]=c*i+u*s,e[4]=c*r+u*a,e[5]=c*n+u*o+g,e[6]=0,e[7]=0,e[8]=1}static Inverse(e,t){const i=e[0],r=e[1],n=e[2],s=e[3],a=e[4],o=e[5];let l=i*a-s*r;0!==l?(l=1/l,t[0]=a*l,t[1]=-r*l,t[2]=(r*o-n*a)*l,t[3]=-s*l,t[4]=i*l,t[5]=(n*s-i*o)*l):Matrix3.Identity(t)}static TransformPoint(e,t){const i=t.x,r=t.y;return t.x=i*e[0]+r*e[1]+e[2],t.y=i*e[3]+r*e[4]+e[5],t}static RotateAndScalePoint(e,t){const i=t.x,r=t.y;return t.x=i*e[0]+r*e[1],t.y=i*e[3]+r*e[4],t}}t.Matrix3=Matrix3},9570:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.QuadTree=t.getNextQtFrame=void 0;const r=i(3037),n=512;let s=0;t.getNextQtFrame=function getNextQtFrame(){const e=s+1;return s=e,e};class QuadTree{constructor(e,t,i,n,s){this.rect=new r.Rectangle,this.subdivisions=null,this.parent=null,this.nodes=[],this.nodesAABB=new Float64Array(8*r.RECTANGLE_ELEMENTS),this.rect.setBounds(e,t,i,n),void 0!==s&&(this.parent=s)}static Empty(){return new QuadTree(-512,-512,1024,1024)}insertAndExpandIfNeeded(e){const t=this.expandIfNeeded(e.aabb);return t.insert(e),t}insert(e){if(this.needsSubdivision()&&this.subdivide(),this.insertInChildren(e))return;const t=this.nodes;let i=this.nodesAABB;const n=t.length;if(t.push(e),e.qtParent=this,e.qtIndexInParent=n,i.length<t.length*r.RECTANGLE_ELEMENTS){const e=new Float64Array(2*i.length);e.set(i),this.nodesAABB=e,i=e}e.aabb.copyToFloat64Array(i,n*r.RECTANGLE_ELEMENTS)}updatedAABB(e){e.qtParent===this&&e.aabb.copyToFloat64Array(this.nodesAABB,e.qtIndexInParent*r.RECTANGLE_ELEMENTS)}delete(e){if(e.qtParent!==this)return;const t=this.nodes,i=this.nodesAABB,n=e.qtIndexInParent,s=t.length-1;if(n!==s){const e=t.pop();t[n]=e,e.qtIndexInParent=n,i.copyWithin(n*r.RECTANGLE_ELEMENTS,s*r.RECTANGLE_ELEMENTS,(s+1)*r.RECTANGLE_ELEMENTS)}else t.pop();e.qtParent=null,e.qtIndexInParent=-1,null!==this.subdivisions?this.tryToJoin():null!==this.parent&&this.parent.tryToJoin()}tryToJoin(){const e=this.subdivisions;null!=e&&null===e.topLeft.subdivisions&&null===e.topRight.subdivisions&&null===e.bottomLeft.subdivisions&&null===e.bottomRight.subdivisions&&this.nodes.length+e.topLeft.nodes.length+e.topRight.nodes.length+e.bottomLeft.nodes.length+e.bottomRight.nodes.length<16&&(this.subdivisions=null,e.topLeft.nodes.forEach((e=>this.insert(e))),e.topRight.nodes.forEach((e=>this.insert(e))),e.bottomLeft.nodes.forEach((e=>this.insert(e))),e.bottomRight.nodes.forEach((e=>this.insert(e))),null!==this.parent&&this.parent.tryToJoin())}findRect(e){return this.rect.contains(e)?this.findRectInternal(e):null}findRectInternal(e){const t=this.subdivisions;if(null!==t){const i=t.topLeft.rect.x1,r=t.topLeft.rect.y1,n=e.y1<=r,s=e.y>=r,a=e.x>=i,o=e.x1<=i;if(n){if(a){const i=t.topRight.findRectInternal(e);if(null!==i)return i}else if(o){const i=t.topLeft.findRectInternal(e);if(null!==i)return i}}else if(s)if(a){const i=t.bottomRight.findRectInternal(e);if(null!==i)return i}else if(o){const i=t.bottomLeft.findRectInternal(e);if(null!==i)return i}}return this}insertInChildren(e){const t=this.subdivisions;return null!==t&&(t.topLeft.canHold(e.aabb)?(t.topLeft.insert(e),!0):t.topRight.canHold(e.aabb)?(t.topRight.insert(e),!0):t.bottomLeft.canHold(e.aabb)?(t.bottomLeft.insert(e),!0):!!t.bottomRight.canHold(e.aabb)&&(t.bottomRight.insert(e),!0))}subdivide(){const e=this.rect;if(null!==this.subdivisions)return this.subdivisions;const t=e.width/2,i=e.height/2;this.subdivisions={topLeft:new QuadTree(e.x,e.y,t,i,this),topRight:new QuadTree(e.x+t,e.y,t,i,this),bottomLeft:new QuadTree(e.x,e.y+i,t,i,this),bottomRight:new QuadTree(e.x+t,e.y+i,t,i,this)};const r=this.nodes;return this.nodes=[],r.forEach((e=>this.insert(e))),this.subdivisions}needsSubdivision(){return null===this.subdivisions&&this.nodes.length+1>32&&this.rect.width>n}canHold(e){return this.rect.contains(e)}canHoldInChildren(e){const t=this.subdivisions;if(null===t)return!1;const i=t.topLeft.rect.x1,r=t.topLeft.rect.y1;return(e.x>=i||e.x1<=i)&&(e.y>=r||e.y1<=r)}expandIfNeeded(e){let t=this;for(;!t.canHold(e);){const e=new QuadTree(t.rect.x-t.rect.width/2,t.rect.y-t.rect.height/2,2*t.rect.width,2*t.rect.height),i=t.subdivisions;if(null!==i){const t=e.subdivide();if(null!==i.topLeft.subdivisions||i.topLeft.nodes.length>0){const e=t.topLeft.subdivide();e.bottomRight=i.topLeft,e.bottomRight.parent=t.topLeft}if(null!==i.topRight.subdivisions||i.topRight.nodes.length>0){const e=t.topRight.subdivide();e.bottomLeft=i.topRight,e.bottomLeft.parent=t.topRight}if(null!==i.bottomLeft.subdivisions||i.bottomLeft.nodes.length>0){const e=t.bottomLeft.subdivide();e.topRight=i.bottomLeft,e.topRight.parent=t.bottomLeft}if(null!==i.bottomRight.subdivisions||i.bottomRight.nodes.length>0){const e=t.bottomRight.subdivide();e.topLeft=i.bottomRight,e.topLeft.parent=t.bottomRight}}t.nodes.length>0&&(e.nodes=t.nodes,e.nodesAABB=t.nodesAABB,e.nodes.forEach((t=>t.qtParent=e))),t=e}return t}}t.QuadTree=QuadTree},1799:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.QuadTreeIterator=void 0;const r=i(3037);t.QuadTreeIterator=class QuadTreeIterator{constructor(e){this.root_=e}forEachVisibleNode(e,t){this.forEachInBoundsInternal(e,t)}forEachInBoundsInternal(e,t){let i=this.root_.root.findRect(e);null===i&&(i=this.root_.root),null!==i.parent&&this.forEachInBoundsInParents(i.parent,e,t),this.forEachInBoundsInMe(i,e,t)}forEachInBoundsInParents(e,t,i){this.callFnInBounds(e,t,i),null!==e.parent&&this.forEachInBoundsInParents(e.parent,t,i)}forEachInBoundsInMe(e,t,i){if(e.rect.inside(t))this.forAll(e,i);else if(t.intersects(e.rect)){this.callFnInBounds(e,t,i);const r=e.subdivisions;null!==r&&(this.forEachInBoundsInMe(r.topLeft,t,i),this.forEachInBoundsInMe(r.topRight,t,i),this.forEachInBoundsInMe(r.bottomLeft,t,i),this.forEachInBoundsInMe(r.bottomRight,t,i))}}callFnInBounds(e,t,i){const n=e.nodes,s=n.length;if(0===s)return;const a=e.nodesAABB,o=t.x,l=t.y,d=t.x1,h=t.y1;let c=0;for(let e=0;e<s;e++)a[c+r.RECTANGLE_OFFSET_X]<d&&a[c+r.RECTANGLE_OFFSET_Y]<h&&a[c+r.RECTANGLE_OFFSET_X1]>o&&a[c+r.RECTANGLE_OFFSET_Y1]>l&&i(n[e]),c+=r.RECTANGLE_ELEMENTS}forAll(e,t){this.callFn(e,t);const i=e.subdivisions;null!==i&&(this.forAll(i.topLeft,t),this.forAll(i.topRight,t),this.forAll(i.bottomLeft,t),this.forAll(i.bottomRight,t))}callFn(e,t){const i=e.nodes,r=i.length;for(let e=0;e<r;e++)t(i[e])}}},9819:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.QuadTreeRoot=void 0;const r=i(9570);t.QuadTreeRoot=class QuadTreeRoot{constructor(){this.mainRoot=r.QuadTree.Empty()}get root(){return this.mainRoot}insert(e){null===e.qtParent?this.mainRoot=this.mainRoot.insertAndExpandIfNeeded(e):console.error("QuadTree: Trying to insert a node that already has a qtParent!!! This can only happen if you try to use a node in more than one QT, or forget to remove it from an old QT")}delete(e){null!==e.qtParent&&e.qtParent.delete(e)}updated(e){const t=e.qtParent;null!==t&&(!t.canHold(e.aabb)||t.canHoldInChildren(e.aabb)?(this.delete(e),this.insert(e)):t.updatedAABB(e))}}},3037:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Rectangle=t.RECTANGLE_OFFSET_Y1=t.RECTANGLE_OFFSET_X1=t.RECTANGLE_OFFSET_Y=t.RECTANGLE_OFFSET_X=t.RECTANGLE_ELEMENTS=void 0,t.RECTANGLE_ELEMENTS=4,t.RECTANGLE_OFFSET_X=0,t.RECTANGLE_OFFSET_Y=1,t.RECTANGLE_OFFSET_X1=2,t.RECTANGLE_OFFSET_Y1=3;class Rectangle{constructor(){this.x_=0,this.y_=0,this.x1_=0,this.y1_=0}get x(){return this.x_}get y(){return this.y_}get x1(){return this.x1_}get y1(){return this.y1_}get width(){return this.x1_-this.x_}get height(){return this.y1_-this.y_}get centerX(){return.5*(this.x_+this.x1_)}get centerY(){return.5*(this.y_+this.y1_)}setLocation(e,t){const i=this.width,r=this.height;return this.x_=e,this.y_=t,this.x1_=this.x_+i,this.y1_=this.y_+r,this}setDimension(e,t){return this.x1_=this.x_+e,this.y1_=this.y_+t,this}setBounds(e,t,i,r){return this.x_=e,this.y_=t,this.x1_=e+i,this.y1_=t+r,this}expand(e,t){return this.setLocation(this.x-e/2,this.y-t/2),this.setDimension(this.width+e,this.height+t),this}contains(e){return e.x_>=this.x_&&e.y_>=this.y_&&e.x1_<=this.x1_&&e.y1_<=this.y1_}containsPoint(e,t){return e<=this.x1_&&e>=this.x_&&t<=this.y1_&&t>=this.y_}containsPointTolerance(e,t,i){return e<=this.x1_+i&&e>=this.x_-i&&t<=this.y1_+i&&t>=this.y_-i}copy(e){return this.x_=e.x_,this.y_=e.y_,this.x1_=e.x1_,this.y1_=e.y1_,this}equals(e){return e.x_===this.x_&&e.y_===this.y_&&e.x1_===this.x1_&&e.y1_===this.y1_}isEmpty(){return this.x===this.x1_&&this.y===this.y1_}setEmpty(){this.x_=0,this.y_=0,this.x1_=0,this.y1_=0}unionPoint(e,t){this.x_=Math.min(this.x_,e),this.y_=Math.min(this.y_,t),this.x1_=Math.max(this.x1_,e),this.y1_=Math.max(this.y1_,t)}unionPoints(...e){const t=e.map((e=>e.x)),i=e.map((e=>e.y));this.x_=Math.min(this.x_,...t),this.y_=Math.min(this.y_,...i),this.x1_=Math.max(this.x1_,...t),this.y1_=Math.max(this.y1_,...i)}fromPoints(...e){this.x_=Number.MAX_SAFE_INTEGER,this.y_=Number.MAX_SAFE_INTEGER,this.x1_=-Number.MAX_SAFE_INTEGER,this.y1_=-Number.MAX_SAFE_INTEGER,this.unionPoints(...e)}union(e){return this.x_=Math.min(this.x_,e.x_),this.y_=Math.min(this.y_,e.y_),this.x1_=Math.max(this.x1_,e.x1_),this.y1_=Math.max(this.y1_,e.y1_),this}intersects(e){return!(e.x1_<=this.x_)&&(!(e.x_>=this.x1_)&&(!(e.y1_<=this.y_)&&(!(e.y_>=this.y1_)&&(!e.isEmpty()&&!this.isEmpty()))))}intersect(e,t){return void 0===t&&(t=new Rectangle),t.x_=Math.max(this.x_,e.x_),t.y_=Math.max(this.y_,e.y_),t.x1_=Math.min(this.x1_,e.x1_),t.y1_=Math.min(this.y1_,e.y1_),t}inside(e){return this.x1_<=e.x1_&&this.y1_<=e.y1_&&this.x_>=e.x_&&this.y_>=e.y_}matchesAnyBorder(e){return this.x_===e.x_||this.y_===e.y_||this.x1_===e.x1_||this.y1_===e.y1_}copyToFloat64Array(e,i){e[i+t.RECTANGLE_OFFSET_X]=this.x_,e[i+t.RECTANGLE_OFFSET_Y]=this.y_,e[i+t.RECTANGLE_OFFSET_X1]=this.x1_,e[i+t.RECTANGLE_OFFSET_Y1]=this.y1_}readFromFloat64Array(e,i){this.x_=e[i+t.RECTANGLE_OFFSET_X],this.y_=e[i+t.RECTANGLE_OFFSET_Y],this.x1_=e[i+t.RECTANGLE_OFFSET_X1],this.y1_=e[i+t.RECTANGLE_OFFSET_Y1]}}t.Rectangle=Rectangle},7518:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createMinimapActions=void 0;t.createMinimapActions=e=>({fromScreenPos:(t,i)=>e.fromScreenPos(t,i),setSizeBehavior:t=>e.setSizeBehavior(t),setPadding:t=>e.setPadding(t),show:()=>e.show(),hide:()=>e.hide(),getViewport:t=>e.getViewport(t),setViewport:(t,i)=>e.setViewport(t,i),deleteViewport:t=>e.deleteViewport(t),setUserColor:(t,i)=>e.setUserViewportColor(t,i),resize:(t,i)=>e.resize(t,i),setStyle:t=>e.setStyle(t)})},6560:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createMuralActions=void 0;t.createMuralActions=e=>({offset:(t,i)=>{e.offsetBounds(t,i)},resize:(t,i)=>{e.resizeBounds(t,i)},setBackground:t=>e.setBackground(t)})},1435:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createNodesActionsHover=void 0;const r=i(5328);t.createNodesActionsHover=e=>{let t=null,i=null;const n=new Set,setHoveringNodes=(t=new Map)=>{n.forEach((i=>{if(!t.has(i)){const t=e.findNodeByExternalId(i);t&&(0,r.startFadeOutAnimation)(t),n.delete(i)}})),t.forEach((e=>{n.has(e.externalId)||((0,r.startFadeInAnimation)(e),n.add(e.externalId))}))},doHover=(i,r,n,s=0)=>{if(s>50)return;const a=e.getNode(i,r,n||0,(e=>e.visible&&2!==e.state));if(a===t)return;t=a;const o=new Map;for(let e=a;e;e=e.parent)e.children.filter((e=>1===e.state)).forEach((e=>o.set(e.externalId,e)));setHoveringNodes(o),doHover(i,r,n,s+1)};return{clearHover:()=>{setHoveringNodes(),t=null,i=null},hover:(e,t,i)=>{doHover(e,t,i)},hoverOver:t=>{const r=e.findNodeByExternalId(t);if(r===i)return;i=r;const n=i?i.children.find((e=>2===e.state)):null;setHoveringNodes(new Map(n?[[n.externalId,n]]:[]))}}}},7506:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createNodesActionsTransient=void 0;const r=i(5328),n=i(7586),changeNodeDraggingVisualFeedbackActivation=(e,t,i)=>{const n=e.findNodeByExternalId(t);if(n&&(n.toggleState(8,i,1),void 0!==n.shadowProperties)){const n=e.findNodeByExternalId(t+"-shadow-offset");n&&(i?(0,r.startShadowDraggingBeginAnimation)(n):(0,r.startShadowDraggingEndAnimation)(n))}},changeNodeMoveToTopActivation=(e,t,i)=>{const r=e.findNodeByExternalId(t);r&&(r.ownLayer=i?2:1,r.toggleState(5,i,1))};const s=new class TransientActionNoOp{moveToTop(){return this}draggingVisualFeedback(){return this}end(){}};t.createNodesActionsTransient=e=>{const t=new n.RefCountedNodeActivator(e,changeNodeMoveToTopActivation),i=new n.RefCountedNodeActivator(e,changeNodeDraggingVisualFeedbackActivation);class RenderTransientActionImpl{constructor(e){this._ids=e,this._endFns=[],this._ended=!1}moveToTop(){return this.checkEnded()?s:(t.add(this._ids),e.invalidateViewport(),this._endFns.push((()=>{t.delete(this._ids),e.invalidateViewport()})),this)}draggingVisualFeedback(){return this.checkEnded()?s:(i.add(this._ids),e.invalidateViewport(),this._endFns.push((()=>{i.delete(this._ids),e.invalidateViewport()})),this)}end(){this.checkEnded()||(this._endFns.forEach((e=>e())),this._endFns.length=0,this._ended=!0)}checkEnded(){return this._ended&&console.error("RenderTransientAction already ended"),this._ended}}return{startTransientActions:(...e)=>new RenderTransientActionImpl(e)}}},5328:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.startShadowDraggingEndAnimation=t.startShadowDraggingBeginAnimation=t.startFadeInAnimation=t.startFadeOutAnimation=void 0;const noopFn=()=>{},animateAlpha=(e,t,i,r=noopFn)=>{const n=e.getAnimation(t);n?e.animate.alphaTo(i,n.duration,n.delay).onDone(r):(e.alpha=i,r())};t.startFadeOutAnimation=e=>{animateAlpha(e,"out",0,(()=>{e.alpha=1,e.visible=!1}))};t.startFadeInAnimation=e=>{1===e.alpha&&(e.alpha=0),e.visible=!0,animateAlpha(e,"in",1)};const animateShadowDraggingTransition=(e,t,i,r=noopFn)=>{if(!e.shadowProperties)return;const n=e.getAnimation(t);n?e.animate.shadowDraggingTransitionTo(i,n.duration,n.delay).onDone(r):(e.shadowProperties=Object.assign(Object.assign({},e.shadowProperties),{transitionPercent:i}),r())};t.startShadowDraggingBeginAnimation=e=>{e.shadowProperties={transition:1,transitionPercent:0},animateShadowDraggingTransition(e,"drag-begin",1)};t.startShadowDraggingEndAnimation=e=>{e.shadowProperties={transition:2,transitionPercent:0},animateShadowDraggingTransition(e,"drag-end",1)}},5653:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createNodesActions=void 0;const r=i(3037),n=i(1435),s=i(7506),a=i(231);t.createNodesActions=e=>({api:Object.assign(Object.assign(Object.assign({},(0,n.createNodesActionsHover)(e)),(0,s.createNodesActionsTransient)(e)),{updateOrBuildNodeFromState:(t,i,r)=>{e.updateOrBuildNodesFromState(r,t,i)},remove:t=>{t.forEach((t=>{const i=e.findNodeByExternalId(t);i&&e.removeAndDestroyNode(i)}))},setParent:(t,i)=>{const r=e.findNodeByExternalId(t);if(null===r)return!1;const n=i?e.findNodeByExternalId(i):e.root;return null!==n&&(r.parent!==n&&(r.removeFromParent(),n.adoptChild(r)),!0)},hide:(t,i)=>(0,a.toggleVisibility)(e.findNodeByExternalId(t),i,!1),show:(t,i)=>(0,a.toggleVisibility)(e.findNodeByExternalId(t),i,!0),setAlpha:(t,i)=>{const r=e.findNodeByExternalId(t);r&&(r.alpha=i)},toggleState:(t,i,r,n)=>{const s=e.findNodeByExternalId(t);s&&s.toggleState(i,r,n?0:1)},setDrawTopSameLayer:(t,i)=>{const r=e.findNodeByExternalId(t);r&&r.setStackingLayer(Math.floor(r.stackingLayer)+(i?.5:0))},getUnsafe:(t,i)=>(0,a.getNodeByHint)(e,t,i),getSafe:(t,i)=>(e.applyPendingChanges(),(0,a.getNodeByHint)(e,t,i)),getAt:(t,i,r,n)=>e.getNode(t,i,r,n),getAllAt:(t,i,r,n)=>e.getNodes(t,i,r,n),getAllAtRect:(t,i,n,s,a)=>{const o=(new r.Rectangle).setBounds(t,i,n-t,s-i);return e.getNodesAtRect(o,a)},getAllNonPartialNodesAtRectUnordered:(t,i,n,s,a)=>{const o=(new r.Rectangle).setBounds(t,i,n-t,s-i);return e.getAllNonPartialNodesAtRectUnordered(o,a)},getAllRect:()=>e.getAllRect(),setLoadingProgress:(t,i,r=0)=>{const n=e.findNodeByExternalId(t);if(!n)return;((0,a.findChildWithHint)(n,"_loading_progress")||n).animate.setLoadingProgress(i,r)},setScaleConstraint:(t,i,r,n)=>{const s=e.findNodeByExternalId(t);if(!s)return;const o=(0,a.findChildInState)(s,n);o&&o.animate.setCameraScaleConstraint(e.camera,i,r)},setPulse:(t,i,r)=>{const n=e.findNodeByExternalId(t);if(!n)return;const s=(0,a.findChildWithHint)(n,i);null==s||s.animate.setCommentPulse(r)},setIntroScale:(t,i,r,n,s)=>{const o=e.findNodeByExternalId(t);if(!o)return;const l=(0,a.findChildWithHint)(o,i);null==l||l.animate.setIntroScale(r,n,s)}})})},7586:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RefCountedNodeActivator=void 0;t.RefCountedNodeActivator=class RefCountedNodeActivator{constructor(e,t){this._active=new Map,this._muraldoc=e,this._onChangeNodeActivation=t}add(e){var t;const i=this._active;for(const r of e){const e=null!==(t=i.get(r))&&void 0!==t?t:0;0==e&&this._onChangeNodeActivation(this._muraldoc,r,!0),i.set(r,e+1)}}delete(e){var t;const i=this._active;for(const r of e){const e=null!==(t=i.get(r))&&void 0!==t?t:0;e<=0?console.error("Trying to remove inexistent node from RefCountedNodeActivator"):1==e?(this._onChangeNodeActivation(this._muraldoc,r,!1),i.delete(r)):i.set(r,e-1)}}}},231:(e,t)=>{"use strict";function getChildrenInStateImpl(e,t,i){e.state===t?i.push(e):e.children.forEach((e=>{e.isPartialNode&&getChildrenInStateImpl(e,t,i)}))}Object.defineProperty(t,"__esModule",{value:!0}),t.getNodeByHint=t.findChildWithHint=t.findChildInState=t.toggleVisibility=t.getDescendantWithHint=t.getNonPartialDescendants=t.getChildrenInState=void 0,t.getChildrenInState=function getChildrenInState(e,t){const i=[];return getChildrenInStateImpl(e,t,i),i};const visitDescendants=(e,t)=>{for(let i=0,r=e.children.length;i<r;++i){const r=e.children[i],n=t(r);if(1===n)return!0;if(2!==n&&visitDescendants(r,t))return!0}return!1};t.getNonPartialDescendants=e=>{const t=[];return visitDescendants(e,(e=>(e.isPartialNode||t.push(e),0))),t};t.getDescendantWithHint=(e,t)=>{let i=null;return visitDescendants(e,(e=>e.isPartialNode?e.hint!==t?0:(i=e,1):2)),i};t.toggleVisibility=(e,i,r)=>{if(!e)return null;const n=i?(0,t.getDescendantWithHint)(e,i):e;return n&&(n.visible=r),n};t.findChildInState=(e,i)=>{if(e.state===i)return e;for(let r=0;r<e.children.length;r++){const n=(0,t.findChildInState)(e.children[r],i);if(n)return n}return null};t.findChildWithHint=(e,i)=>{if(e.hint===i)return e;for(let r=0;r<e.children.length;r++){const n=(0,t.findChildWithHint)(e.children[r],i);if(n)return n}return null};t.getNodeByHint=(e,i,r)=>{const n=e.findNodeByExternalId(i);return n?r&&n.hint!==r?(0,t.getDescendantWithHint)(n,r):n:null}},923:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createRenderActions=void 0;t.createRenderActions=e=>({flushRender:()=>e.render()})},3646:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Camera=void 0;const r=i(6016),n=i(3037);t.Camera=class Camera{constructor(){this.changeListeners=[],this.scale_=1,this.width=0,this.height=0,this.position={x:0,y:0},this.transformAnchor={x:.5,y:.5},this.clipArea=new n.Rectangle,this.transformMatrix=r.Matrix3.Create(),this.calcTransformMatrix()}get x(){return this.position.x}get y(){return this.position.y}setViewport(e,t){this.width=e,this.height=t,this.calcTransformMatrix(),this.notifyViewportChange()}translate(e,t){this.position.x+=e,this.position.y+=t,this.calcTransformMatrix(),this.notifyViewportChange()}get scale(){return this.scale_}set scale(e){this.scale_=Math.max(e,.01),this.calcTransformMatrix(),this.notifyViewportChange()}getPosition(){return this.position}setPosition(e,t){this.position.x=e,this.position.y=t,this.calcTransformMatrix(),this.notifyViewportChange()}getClipBounds(){return this.clipArea}notifyViewportChange(){const e={x:this.clipArea.x,y:this.clipArea.y,zoom:this.scale_},t=this.changeListeners;for(let i=0;i<t.length;i++)t[i](e)}calcTransformMatrix(){const e=this.transformAnchor.x*this.width,t=this.transformAnchor.y*this.height,i=1/this.scale_;this.transformMatrix[0]=i,this.transformMatrix[1]=0,this.transformMatrix[3]=0,this.transformMatrix[4]=i,this.transformMatrix[2]=this.position.x-i*e,this.transformMatrix[5]=this.position.y-i*t,this.clipArea.setBounds(this.transformMatrix[2],this.transformMatrix[5],this.width/this.scale_,this.height/this.scale_)}setupZoomAtScreenPos(e,t,i){if(i){const i={x:e,y:t};r.Matrix3.TransformPoint(this.transformMatrix,i),this.setPosition(i.x,i.y)}this.transformAnchor.x=e/this.width,this.transformAnchor.y=t/this.height,this.calcTransformMatrix()}setFullViewport(e,t,i){this.scale_=i,this.position.x=e+this.transformAnchor.x*this.width/i,this.position.y=t+this.transformAnchor.y*this.height/i,this.calcTransformMatrix(),this.notifyViewportChange()}copy(e){this.scale_=e.scale_,this.width=e.width,this.height=e.height,this.position.x=e.position.x,this.position.y=e.position.y,this.transformAnchor.x=e.transformAnchor.x,this.transformAnchor.y=e.transformAnchor.y,this.calcTransformMatrix(),this.notifyViewportChange()}registerChangeListener(e){this.changeListeners.push(e)}unregisterChangeListener(e){const t=this.changeListeners.indexOf(e);t>=0&&this.changeListeners.splice(t,1)}}},2404:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RenderSurface=void 0;const r=i(6016),n=i(3646),s=i(6089);t.RenderSurface=class RenderSurface{constructor(e,t,i,s="#4E5155"){if(this.width=0,this.height=0,this.clearColor_=null,this.clearImage=null,this.camera=new n.Camera,this.renderingMatrix=r.Matrix3.Create(),this.renderingMatrixInverse=r.Matrix3.Create(),this.canvas=e.canvas,this.gpuBugs=t,this.ctx=e.ctx,this.renderScaleMultiplier=i,this.canvas.tabIndex=e.canvas.tabIndex,this.width=this.canvas.width,this.height=this.canvas.height,1!==i){const e=this.canvas.width,t=this.canvas.height;this.canvas.style.width=e+"px",this.canvas.style.height=t+"px",this.canvas.width=e*i,this.canvas.height=t*i}this.ctx.textAlign="center",this.ctx.textBaseline="middle",this.ctx.resetTransform=this.ctx.resetTransform||function(){this.setTransform(1,0,0,1,0,0)}.bind(this.ctx),this.clearColor=s,this.camera.scale=1,this.camera.setViewport(this.width,this.height),this.camera.setPosition(this.width/2,this.height/2)}set clearColor(e){"string"==typeof e?(this.clearImage=null,this.clearColor_=e):(this.clearImage=e,this.clearColor_=null)}get clearColor(){return null!==this.clearImage?this.clearImage:null!==this.clearColor_?this.clearColor_:"transparent"}hasBackgroundImage(){return null!==this.clearImage}resize(e,t){1!==this.renderScaleMultiplier?(this.canvas.style.width=e+"px",this.canvas.style.height=t+"px",this.canvas.width=e*this.renderScaleMultiplier,this.canvas.height=t*this.renderScaleMultiplier):(this.canvas.width=e,this.canvas.height=t),this.width=e,this.height=t,this.camera.setViewport(e,t)}drawPattern(e,t,i,r){const n=this.clearImage;if(!n)return;this.ctx.scale(this.renderScaleMultiplier,this.renderScaleMultiplier);const s=Math.max(Math.floor(e/n.width),0)*n.width,a=Math.max(Math.floor(t/n.height),0)*n.height,o=Math.min(e+i,this.width),l=Math.min(t+r,this.height);for(let e=s;e<=o;e+=n.width)for(let t=a;t<=l;t+=n.height)this.ctx.drawImage(n,e,t)}clear(){this.clearRegionInternal(0,0,this.width,this.height)}clearRegion(e){const{x:t,y:i}=this.camera.getClipBounds(),r=this.camera.scale,n=(e.x-t)*r,s=(e.y-i)*r,a=e.width*r,o=e.height*r;this.clearRegionInternal(n,s,a,o)}clearRegionInternal(e,t,i,r){if(this.ctx.save(),this.ctx.resetTransform(),null!==this.clearImage)this.drawPattern(e,t,i,r);else{const n=e*this.renderScaleMultiplier,s=t*this.renderScaleMultiplier,a=i*this.renderScaleMultiplier,o=r*this.renderScaleMultiplier;null!==this.clearColor_&&"transparent"!==this.clearColor_?(n<=0&&s<=0&&n+a>=this.canvas.width&&s+o>=this.canvas.height&&this.gpuBugs.has("clear-whole-canvas-before-fill-faster")&&this.ctx.clearRect(n,s,a,o),this.ctx.fillStyle=this.clearColor_,this.ctx.fillRect(n,s,a,o)):this.ctx.clearRect(n,s,a,o)}this.ctx.restore()}getRenderingMatrixInverse(){return this.renderingMatrix.set(this.camera.transformMatrix),this.renderingMatrix[0]/=this.renderScaleMultiplier,this.renderingMatrix[4]/=this.renderScaleMultiplier,r.Matrix3.Inverse(this.renderingMatrix,this.renderingMatrixInverse),this.renderingMatrixInverse}resetTransform(){const e=this.getRenderingMatrixInverse();this.ctx.setTransform(e[0],e[1],e[3],e[4],e[2],e[5])}get cameraPosition(){return this.camera.getPosition()}setCameraPosition(e,t){this.camera.setPosition(e,t)}setCameraScale(e){this.camera.scale=e}getCameraScale(){return this.camera.scale}shows(e){return this.camera.getClipBounds().intersects(e)}getCanvas(){return this.canvas}beginRender(e){return new s.CameraRenderContext({canvas:this.canvas,ctx:this.ctx},e,this.renderScaleMultiplier,this.getCameraScale(),this.getRenderingMatrixInverse(),this.camera.getClipBounds(),this.clear.bind(this),this.clearRegion.bind(this))}copyImageFromContext(e){this.ctx.save(),this.ctx.resetTransform(),this.ctx.drawImage(e.nativeCanvas,0,0),this.ctx.restore()}reset(){this.ctx.resetTransform(),this.clear()}}},6089:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CameraRenderContext=void 0;const r=i(3993);class CameraRenderContext extends r.RenderContext{constructor(e,t,i,r,n,s,a,o){super(e,t,i,r,n,"white"),this.cameraClipBounds=s,this.clearSurface=a,this.clearSurfaceRegion=o}}t.CameraRenderContext=CameraRenderContext},2439:function(e,t,i){"use strict";var r=this&&this.__awaiter||function(e,t,i,r){return new(i||(i=Promise))((function(n,s){function fulfilled(e){try{step(r.next(e))}catch(e){s(e)}}function rejected(e){try{step(r.throw(e))}catch(e){s(e)}}function step(e){e.done?n(e.value):function adopt(e){return e instanceof i?e:new i((function(t){t(e)}))}(e.value).then(fulfilled,rejected)}step((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.createScreenshotActions=void 0;const n=i(2248),s=i(3037),a=i(2404);function isNotNil(e){return null!=e}function takeScreenshot(e,t,i,s,o,l,d,h,c){return r(this,void 0,void 0,(function*(){const{targetCanvas:r=null}=c,u=r?function getTargetCanvasWithContext(e){return{canvas:e,ctx:e.getContext("2d")}}(r):t.createCanvas(c.outputWidth,c.outputHeight);try{if(!u.ctx)throw new Error("Unable to take screenshot, could be an out-of-memory issue or the requested output size could be too big");const g=new a.RenderSurface(u,i.screen.gpu.bugs,1,c.backgroundColor||"white");g.clear(),g.camera.setFullViewport(s,o,l),g.resetTransform();const f=new n.ScreenshotStrategy(d,h,e.root);e.renderCustom(f,g);const m=c.outputMimeType||"image/png",v=c.outputQuality||.92;return{dataURL:r?"":g.getCanvas().toDataURL(m,v),mimeType:m}}finally{r||t.destroyCanvas(u.canvas)}}))}t.createScreenshotActions=(e,t,i)=>({viewport:(r,n,s,a,o)=>takeScreenshot(e,t,i,r,n,s,a,[],o),only:(r,n,a,o)=>{e.applyPendingChanges();const l=r.map((t=>e.findNodeByExternalId(t))).filter(isNotNil).map((e=>e.aabbSelfOnlyWithoutRenderOverflow)).reduce(((e,t)=>e.isEmpty()?e.copy(t):e.union(t)),new s.Rectangle);l.expand(2*n,2*n),0!==l.width&&0!==l.height||l.setBounds(0,0,10,10);const d=Math.min(o.outputWidth/l.width,o.outputHeight/l.height),h=l.x-.5*(o.outputWidth-l.width*d)/d,c=l.y-.5*(o.outputHeight-l.height*d)/d;return takeScreenshot(e,t,i,h,c,d,a,r,o)}})},6892:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MIN_TOUCH_HANDLER_SIZE=t.TOUCH_HANDLER_SIZE=t.SELECTION_SHAPE_SMALL_BORDER=t.DISABLED_SHADOW=t.MIN_HEIGHT_FOR_HANDLERS_WHEN_RESIZE_EAST_ACTIVE=t.MIN_SIZE_FOR_HANDLERS=t.ROTATION_HANDLER_MAX_HIT_SIZE=t.RESIZE_HANDLER_EXPLICIT_SHADOW_COLOR=void 0,t.RESIZE_HANDLER_EXPLICIT_SHADOW_COLOR="rgba(0,0,0,1)",t.ROTATION_HANDLER_MAX_HIT_SIZE=92,t.MIN_SIZE_FOR_HANDLERS=18,t.MIN_HEIGHT_FOR_HANDLERS_WHEN_RESIZE_EAST_ACTIVE=36,t.DISABLED_SHADOW="rgba(0,0,0,0)",t.SELECTION_SHAPE_SMALL_BORDER=.5,t.TOUCH_HANDLER_SIZE=40,t.MIN_TOUCH_HANDLER_SIZE=20},3966:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.drawSelectionShape=t.drawResizeHandlerCapsule=t.drawQuickAddHandler=t.drawResizeHandler=t.drawBox=t.debugDrawHandlerHoverFeedback=t.drawHandlerHoverFeedback=void 0;const r=i(5672),n=i(6892),s=i(1487),drawRoundedRectangleByCenterPoint=(e,t,i,r,a,o,l,d,h,c,u,g,f,m,v)=>{r<2*l&&(l=r/2),a<2*l&&(l=a/2);const y=o*s.DegToRad,w=c%2==0?0:.5;e.save(),e.translate(t,i),e.rotate(y);const x=-r/2,b=-a/2,C=(0,s.calculateBorderOffset)(c,u),A=b+w-C,I=b+a-w+C,S=x+w-C,T=x+r-w+C;e.lineWidth=c,e.beginPath(),e.moveTo(S+l,A),e.arcTo(T,A,T,A+l,l),e.arcTo(T,I,T-l,I,l),e.arcTo(S,I,S,I-l,l),e.arcTo(S,A,S+l,A,l),e.closePath(),e.shadowBlur=f,e.shadowColor=g,e.shadowOffsetX=m,e.shadowOffsetY=v,e.fillStyle=d,e.fill(),c>0&&(e.lineWidth=c,e.strokeStyle=h,e.stroke()),e.shadowBlur=0,e.shadowColor=n.DISABLED_SHADOW,e.shadowOffsetX=0,e.shadowOffsetY=0,e.fillStyle=d,e.fill(),c>0&&(e.lineWidth=c,e.strokeStyle=h,e.stroke()),e.restore()};t.drawHandlerHoverFeedback=(e,t,i)=>{const r=t.rotation*s.DegToRad;switch(i.save(),i.translate(e.x,e.y),i.rotate(r),t.type){case"path":{const e=t.path,r=e.rotation*s.DegToRad;i.translate(e.x,e.y),i.rotate(r),e.fillColor&&(i.fillStyle=e.fillColor,i.fill(e.path)),e.strokeWidth>0&&e.strokeColor&&(i.strokeStyle=e.strokeColor,i.lineWidth=e.strokeWidth,i.stroke(e.path));break}case"circle":{const e=t.circle;i.beginPath(),i.ellipse(e.x,e.y,e.radius,e.radius,0,0,2*Math.PI),e.fillColor&&(i.fillStyle=e.fillColor,i.fill()),e.strokeWidth>0&&e.strokeColor&&(i.strokeStyle=e.strokeColor,i.lineWidth=e.strokeWidth,i.stroke());break}}i.restore()};t.debugDrawHandlerHoverFeedback=(e,t,i)=>{const r=t.rotation*s.DegToRad;switch(i.save(),i.translate(e.x,e.y),i.rotate(r),t.rects.forEach(((e,t)=>{i.fillStyle=t%2==0?"rgba(255,0,0,0.5)":"rgba(0,255,0,0.5)",i.fillRect(e.x,e.y,e.width,e.height)})),t.type){case"path":{const e=t.path,r=e.rotation*s.DegToRad;i.translate(e.x,e.y),i.rotate(r),e.fillColor&&(i.fillStyle="rgba(0,0,255,0.5)",i.fill(e.path)),e.strokeWidth>0&&e.strokeColor&&(i.strokeStyle="rgba(0,0,255,0.5)",i.lineWidth=e.strokeWidth,i.stroke(e.path));break}case"circle":{const e=t.circle;i.beginPath(),i.ellipse(e.x,e.y,e.radius,e.radius,0,0,2*Math.PI),e.fillColor&&(i.fillStyle="rgba(0,0,255,0.5)",i.fill()),e.strokeWidth>0&&e.strokeColor&&(i.strokeStyle="rgba(0,0,255,0.5)",i.lineWidth=e.strokeWidth,i.stroke());break}}i.restore()};t.drawBox=(e,t)=>{const i=t||new Path2D;return i.rect(e.x,e.y,e.width,e.height),i};t.drawResizeHandler=(e,t,i,r,n,s,a)=>{const o=s.playing?s.timeNormalized:1,l=n.size*o,d=a.x*n.size*.5*(1-o),h=a.y*n.size*.5*(1-o);drawRoundedRectangleByCenterPoint(r,e.x-d,e.y-h,l,l,t,n.cornerRadius,n.backgroundColor,n.borderColor,n.borderThickness,n.borderGrowth,i,n.shadow.blur,n.shadow.offsetX,n.shadow.offsetY)};t.drawQuickAddHandler=(e,t,i,n,s,a)=>{const o=n.playing?n.timeNormalized:1,l=i.size/2*o,d=s.x*i.size*.5*(1-o),h=s.y*i.size*.5*(1-o),c=0===o?a:1===o?e:{x:(0,r.linear)(a.x,e.x,o),y:(0,r.linear)(a.y,e.y,o)};t.strokeStyle=i.borderColor,t.lineWidth=i.borderThickness,t.fillStyle=i.backgroundColor,t.beginPath(),t.ellipse(c.x-d,c.y-h,l,l,0,0,2*Math.PI),t.fill(),t.stroke()};t.drawResizeHandlerCapsule=(e,t,i,r,n,s,a)=>{const o=s.playing?s.timeNormalized:1,l=n.width*o,d=n.height*o,h=a.x*n.width*.5*(1-o),c=a.y*n.height*.5*(1-o);drawRoundedRectangleByCenterPoint(r,e.x-h,e.y-c,l,d,t,n.cornerRadius,n.backgroundColor,n.borderColor,n.borderThickness,n.borderGrowth,i,n.shadow.blur,n.shadow.offsetX,n.shadow.offsetY)};const a=[0,0];t.drawSelectionShape=function drawSelectionShape(e,t,i,r,s,o){const l=e.selectionShapes;if(null===l)return;const d=o.scale,h=((e,t)=>{const i=e.scale,r=e.getClipBounds().x,n=e.getClipBounds().y;return t.x=(t.x-r)*i,t.y=(t.y-n)*i,t})(o,null===e.parent?{x:e.x,y:e.y}:e.localToGlobalTransform({x:0,y:0}));s.translate(h.x,h.y),e.rotation&&s.rotate(e.rotation*Math.PI/180),s.scale(d,d);let c=!1;if(l.length>0&&"path"===l[0].type){const e=l[0];c=e.strokeWidth>0&&e.strokeWidth*d<1}const u=c?n.SELECTION_SHAPE_SMALL_BORDER:i,g=r?u:u/d;s.lineJoin="round",s.lineCap="round";for(let e=0;e<l.length;e++){const i=l[e];switch(i.type){case"path":{const e=0!==i.x||0!==i.y||0!==i.rotation||1!==i.scale;let r=1;e&&(s.translate(i.x,i.y),s.rotate(i.rotation*Math.PI/180),s.scale(i.scale,i.scale),r=i.scale),s.strokeStyle=t,s.lineWidth=(i.strokeWidth+2*g)/r,s.setLineDash(a),s.stroke(i.path),i.backgroundColor&&(s.fillStyle=t,s.fill(i.path)),e&&(s.scale(1/i.scale,1/i.scale),s.rotate(-i.rotation*Math.PI/180),s.translate(-i.x,-i.y));break}}}if(s.lineCap="butt",!c)for(let e=0;e<l.length;e++){const t=l[e];switch(t.type){case"path":{const e=0!==t.x||0!==t.y||0!==t.rotation||1!==t.scale;e&&(s.translate(t.x,t.y),t.rotation&&s.rotate(t.rotation*Math.PI/180),s.scale(t.scale,t.scale));const i=s.globalAlpha;s.globalAlpha=1,s.lineWidth=t.strokeWidth,t.strokeWidth>0&&(s.strokeStyle=t.strokeColor,s.setLineDash(t.strokePattern),s.lineDashOffset=t.strokeLineDashOffset,s.stroke(t.path)),t.backgroundColor&&(s.fillStyle=t.backgroundColor,s.fill(t.path)),e&&(s.scale(1/t.scale,1/t.scale),t.rotation&&s.rotate(-t.rotation*Math.PI/180),s.translate(-t.x,-t.y)),s.globalAlpha=i;break}}}s.setLineDash(a),s.lineDashOffset=0,s.scale(1/d,1/d),e.rotation&&s.rotate(-e.rotation*Math.PI/180),s.translate(-h.x,-h.y)}},2360:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.copyAndTransformHandlersFromCameraSpaceToGlobalSpace=t.getHandlers=t.isInsideHandlerHover=t.isInsideHandler=void 0;const r=i(3152),n=i(3037),s=i(6892),a=i(3966),o=i(1487),l=i(1487),getTouchHandlerSize=(e,t,i)=>e<2*s.MIN_TOUCH_HANDLER_SIZE||t<2*s.MIN_TOUCH_HANDLER_SIZE?i:e<2*s.TOUCH_HANDLER_SIZE||t<2*s.TOUCH_HANDLER_SIZE?s.MIN_TOUCH_HANDLER_SIZE:s.TOUCH_HANDLER_SIZE;t.isInsideHandler=(e,t,i)=>{switch(i.type){case"square":return i.x-i.halfSize<=e&&e<=i.x+i.halfSize&&i.y-i.halfSize<=t&&t<=i.y+i.halfSize;case"rotatedRect":{const r=(0,l.transformPointToLocalPoint)({x:e,y:t},i,i.rotation);return r.x<=i.halfWidth&&r.x>=-i.halfWidth&&r.y<=i.halfHeight&&r.y>=-i.halfHeight}}};t.isInsideHandlerHover=(e,t,i)=>{if(!i.hover)return!1;const r=(0,l.transformPointToLocalPoint)({x:e,y:t},i,i.hover.rotation);return i.hover.rects.some((e=>e.containsPoint(r.x,r.y)))};const getPathRotationFromHandlerLocation=e=>{switch(e){case"nw":return 0;case"ne":return 90;case"se":return 180;case"sw":return 270}},getHoverRectsFromHandlerLocation=(e,t,i,a)=>{const o=a.drawing.size,l=Math.SQRT1_2*a.offset+o/2,calcLongSide=e=>(0,r.clamp)(e/2,o,s.ROTATION_HANDLER_MAX_HIT_SIZE),calcShortSide=(e,t)=>{const i=Math.min(t,e);return{side:(0,r.clamp)(t+i,o,e),lengthIn:i}},d=calcLongSide(t),h=calcLongSide(i),c=calcShortSide(h,l),u=calcShortSide(d,l),g=e.includes("n"),f=e.includes("w"),m=f?-1:1,v=g?-1:1,y=f?0:-d,w=g?0:-h,x=f?0:-u.side,b=g?0:-c.side;return[(new n.Rectangle).setBounds(y+m*l/2,b+v*c.lengthIn/2,d,c.side),(new n.Rectangle).setBounds(x+m*u.lengthIn/2,w+v*l/2,u.side,h)]},getHandlerLocationFromHandlerType=e=>{switch(e){case"ne-resize":case"ne-rotate":case"ne-resize-rotate-touch":return"ne";case"nw-resize":case"nw-rotate":case"nw-resize-rotate-touch":return"nw";case"se-resize":case"se-rotate":case"se-resize-rotate-touch":return"se";case"sw-resize":case"sw-rotate":case"sw-resize-rotate-touch":return"sw";case"e-resize":case"e-resize-full":case"e-resize-touch":case"e-quick-add":case"e-quick-add-closer":return"e";case"w-resize":case"w-resize-full":case"w-resize-touch":case"w-quick-add":case"w-quick-add-closer":return"w";case"n-resize-full":case"n-resize-touch":case"n-quick-add":case"n-quick-add-closer":return"n";case"s-resize-full":case"s-resize-touch":case"s-quick-add":case"s-quick-add-closer":return"s"}},getAnimationPivot=e=>{switch(e){case"n":return{x:0,y:-1};case"s":return{x:0,y:1};case"e":return{x:1,y:0};case"w":return{x:-1,y:0};case"ne":return{x:1,y:-1};case"nw":return{x:-1,y:-1};case"se":return{x:1,y:1};case"sw":return{x:-1,y:1}}},getPointInLine=(e,t,i)=>{const r=(0,o.subtractPoints)(e,t),n=(0,o.normalizePoint)(r);return{x:e.x+n.x*i,y:e.y+n.y*i}},getPointAtCornerDirectedOutwardsLine=(e,t,i,r)=>{const n=(0,o.subtractPoints)(e,t),s=(0,o.normalizePoint)(n),a=(0,o.subtractPoints)(e,i),l=(0,o.normalizePoint)(a),d=(0,o.normalizePoint)((0,o.averagePoints)(s,l));return{x:e.x+d.x*r,y:e.y+d.y*r}},getHandlerCoordinates=(e,t,i,r,n)=>{if(!i){const t=Math.sin(Math.PI/4)*n;switch(r){case"nw":return{x:e.x-t,y:e.y-t};case"ne":return{x:e.x1+t,y:e.y-t};case"se":return{x:e.x1+t,y:e.y1+t};case"sw":return{x:e.x-t,y:e.y1+t};case"e":return{x:e.x1+n,y:e.centerY};case"w":return{x:e.x-n,y:e.centerY};case"n":return{x:e.centerX,y:e.y-n};case"s":return{x:e.centerX,y:e.y1+n}}}switch(r){case"nw":return getPointAtCornerDirectedOutwardsLine(t[0],t[1],t[3],n);case"ne":return getPointAtCornerDirectedOutwardsLine(t[1],t[2],t[0],n);case"se":return getPointAtCornerDirectedOutwardsLine(t[2],t[1],t[3],n);case"sw":return getPointAtCornerDirectedOutwardsLine(t[3],t[0],t[2],n);case"e":return getPointInLine((0,o.averagePoints)(t[1],t[2]),(0,o.averagePoints)(t[0],t[3]),n);case"w":return getPointInLine((0,o.averagePoints)(t[0],t[3]),(0,o.averagePoints)(t[1],t[2]),n);case"n":return getPointInLine((0,o.averagePoints)(t[0],t[1]),(0,o.averagePoints)(t[2],t[3]),n);case"s":return getPointInLine((0,o.averagePoints)(t[2],t[3]),(0,o.averagePoints)(t[0],t[1]),n)}},getAvailableHitHeight=(e,t,i,r)=>{switch(getHandlerLocationFromHandlerType(e)){case"e":if(t.has("ne-resize")||t.has("se-resize"))return Math.max(i-r,0);break;case"w":if(t.has("nw-resize")||t.has("sw-resize"))return Math.max(i-r,0)}return i},getAvailableHitWidth=(e,t,i,r)=>{switch(getHandlerLocationFromHandlerType(e)){case"n":if(t.has("ne-resize")||t.has("nw-resize"))return Math.max(i-r,0);break;case"s":if(t.has("se-resize")||t.has("sw-resize"))return Math.max(i-r,0)}return i};let d=null;const getRotationHandlerPath=e=>(null===d&&(d=new Path2D(e)),d),getHandler=(e,t,i,r,o,l,d,h,c)=>{const u=0!==o;switch(e){case"e-resize":case"e-resize-full":case"w-resize":case"w-resize-full":{const n=!e.endsWith("-full"),l=getHandlerCoordinates(i,r,u,getHandlerLocationFromHandlerType(e),0),g=getAvailableHitHeight(e,t,d,c.resizeCorner.size)/2;return Object.assign(Object.assign({type:"rotatedRect",id:e,inputType:"mouse",rotation:o,halfWidth:c.resizeCapsule.width,halfHeight:g},l),{draw:n?(t,i)=>{(0,a.drawResizeHandlerCapsule)(l,o,h?s.RESIZE_HANDLER_EXPLICIT_SHADOW_COLOR:c.resizeCapsule.shadow.color,t,c.resizeCapsule,i,getAnimationPivot(getHandlerLocationFromHandlerType(e)))}:void 0})}case"n-resize-full":case"s-resize-full":{const n=getHandlerCoordinates(i,r,u,getHandlerLocationFromHandlerType(e),0),s=getAvailableHitWidth(e,t,l,c.resizeCorner.size)/2;return Object.assign({type:"rotatedRect",id:e,inputType:"mouse",rotation:o,halfHeight:c.resizeCapsule.width,halfWidth:s},n)}case"ne-resize":case"nw-resize":case"se-resize":case"sw-resize":{const t=getHandlerCoordinates(i,r,u,getHandlerLocationFromHandlerType(e),0),n=getAnimationPivot(getHandlerLocationFromHandlerType(e));return Object.assign(Object.assign({type:"square",id:e,inputType:"mouse",halfSize:c.resizeCorner.size/2},t),{draw:(e,i)=>{(0,a.drawResizeHandler)(t,o,h?s.RESIZE_HANDLER_EXPLICIT_SHADOW_COLOR:c.resizeCorner.shadow.color,e,c.resizeCorner,i,n)}})}case"ne-rotate":case"nw-rotate":case"se-rotate":case"sw-rotate":{const t=(e=>{switch(e){case"ne-resize":case"ne-rotate":return"ne";case"nw-resize":case"nw-rotate":return"nw";case"se-resize":case"se-rotate":return"se";case"sw-resize":case"sw-rotate":return"sw"}})(e),n=getHandlerCoordinates(i,r,u,t,c.rotationHandler.offset),s={type:"path",path:{path:getRotationHandlerPath(c.rotationHandler.drawing.path),fillColor:c.rotationHandler.drawing.color,strokeColor:"",strokeWidth:0,x:0,y:0,rotation:c.rotationHandler.drawing.topLeftRotation+getPathRotationFromHandlerLocation(t)},rotation:o,rects:getHoverRectsFromHandlerLocation(t,l,d,c.rotationHandler)};return Object.assign({type:"square",id:e,inputType:"mouse",halfSize:c.rotationHandler.drawing.size/2,hover:s},n)}case"nw-resize-rotate-touch":case"ne-resize-rotate-touch":case"sw-resize-rotate-touch":case"se-resize-rotate-touch":{const t=getTouchHandlerSize(l,d,c.resizeCorner.size),n=getHandlerCoordinates(i,r,u,getHandlerLocationFromHandlerType(e),0);return Object.assign({type:"square",id:e,inputType:"touch",halfSize:t/2},n)}case"e-resize-touch":case"w-resize-touch":{const n=getTouchHandlerSize(l,d,c.resizeCorner.size),s=getHandlerCoordinates(i,r,u,getHandlerLocationFromHandlerType(e),0),a=getAvailableHitHeight(e,t,d,n)/2;return Object.assign({type:"rotatedRect",id:e,inputType:"touch",rotation:o,halfWidth:n/2,halfHeight:a},s)}case"n-resize-touch":case"s-resize-touch":{const n=getTouchHandlerSize(l,d,c.resizeCorner.size),s=getHandlerCoordinates(i,r,u,getHandlerLocationFromHandlerType(e),0),a=getAvailableHitWidth(e,t,l,n)/2;return Object.assign({type:"rotatedRect",id:e,inputType:"touch",rotation:o,halfHeight:n/2,halfWidth:a},s)}case"e-quick-add":case"w-quick-add":case"n-quick-add":case"s-quick-add":case"e-quick-add-closer":case"w-quick-add-closer":case"n-quick-add-closer":case"s-quick-add-closer":{const t=e.endsWith("-closer")?0:c.quickAddHandler.offset+c.quickAddHandler.size/2+c.quickAddHandler.borderThickness,s=getHandlerLocationFromHandlerType(e),o=getHandlerCoordinates(i,r,u,s,t),l=0===t?o:getHandlerCoordinates(i,r,u,s,0),d=getAnimationPivot(s),h={type:"circle",circle:{radius:c.quickAddHandler.hover.size/2,fillColor:c.quickAddHandler.hover.backgroundColor,strokeColor:c.quickAddHandler.borderColor,strokeWidth:c.quickAddHandler.borderThickness,x:0,y:0},rotation:0,rects:[(new n.Rectangle).setBounds(-c.quickAddHandler.hover.size/2,-c.quickAddHandler.hover.size/2,c.quickAddHandler.hover.size,c.quickAddHandler.hover.size)]};return Object.assign(Object.assign({type:"square",id:e,inputType:"mouse",halfSize:Math.max(c.quickAddHandler.size,c.quickAddHandler.hover.size)/2,hover:h},o),{draw:(e,t)=>{(0,a.drawQuickAddHandler)(o,e,c.quickAddHandler,t,d,l)}})}}};t.getHandlers=(e,t,i,r,n,a,l)=>{const d=(0,o.distancePoints)(i[0],i[1]),h=(0,o.distancePoints)(i[1],i[2]),c=((e,t,i)=>{const r=new Set,n=e.has("e-resize")?"e-resize":null,addVisibleHandlerIfActive=t=>{e.has(t)&&r.add(t)};return t<s.MIN_SIZE_FOR_HANDLERS||i<s.MIN_SIZE_FOR_HANDLERS?(n?(addVisibleHandlerIfActive("nw-resize"),addVisibleHandlerIfActive("nw-rotate"),addVisibleHandlerIfActive("nw-resize-rotate-touch")):(addVisibleHandlerIfActive("se-resize"),addVisibleHandlerIfActive("se-rotate"),addVisibleHandlerIfActive("se-resize-rotate-touch")),r):n&&i<s.MIN_HEIGHT_FOR_HANDLERS_WHEN_RESIZE_EAST_ACTIVE?(r.add(n),addVisibleHandlerIfActive("nw-resize"),addVisibleHandlerIfActive("nw-rotate"),addVisibleHandlerIfActive("nw-resize-rotate-touch"),r):e})(e,r.width,r.height),u=[];for(const e of c)u.push(getHandler(e,c,t,i,n,d,h,a,l));return u};t.copyAndTransformHandlersFromCameraSpaceToGlobalSpace=(e,t,i,r)=>{const s=[];for(let a=0;a<e.length;a++){const o=e[a],l=Object.assign(Object.assign({},o),{x:o.x/r+t,y:o.y/r+i});if(o.hover){switch(l.hover=Object.assign({},o.hover),l.hover.type){case"path":l.hover.path=Object.assign(Object.assign({},l.hover.path),{x:l.hover.path.x/r,y:l.hover.path.y/r});break;case"circle":l.hover.circle=Object.assign(Object.assign({},l.hover.circle),{x:l.hover.circle.x/r,y:l.hover.circle.y/r})}l.hover.rects=l.hover.rects.map((e=>(new n.Rectangle).setBounds(e.x/r,e.y/r,e.width/r,e.height/r)))}switch(l.type){case"square":l.halfSize/=r;break;case"rotatedRect":l.halfWidth/=r,l.halfHeight/=r}s.push(l)}return s}},6923:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createSelectionActions=void 0;const r=i(3037),n=i(3966),s=i(2360),a=i(1487);t.createSelectionActions=(e,t=!1,i)=>{const o=i.padding+(0,a.calculateBorderOffset)(i.thickness,i.thicknessGrowth),l=new Set;let d=[];const h=new Set;let c,u=!1,g=0,f=null;const m={x:0,y:0};let v=!1,y=!0,w=!1,x=i.color;const updateHover=e=>{let t=null;if(!v)return!1;for(const i of e)if((0,s.isInsideHandlerHover)(m.x,m.y,i)){t=i.id;break}return t!==f&&(f=t,!0)},setShowHandlers=t=>{y!==t&&(y=t,e.invalidateViewport())},addIds=e=>{let t=!1;return e.forEach((e=>{l.add(e),t=!0})),t};return{api:{add:(...t)=>{addIds(t)&&e.invalidateViewport()},set:t=>{const i=l.size>0;i&&l.clear();const r=addIds(t);(i||r)&&e.invalidateViewport()},remove:(...t)=>{let i=!1;t.forEach((e=>{i=i||l.has(e),l.delete(e)})),i&&e.invalidateViewport()},clear:()=>{l.size&&(l.clear(),e.invalidateViewport())},handler:{show:()=>setShowHandlers(!0),hide:()=>setShowHandlers(!1),setHandlers:(...t)=>{let i=!1;for(const e of h)t.includes(e)||(h.delete(e),i=!0);for(const e of t)h.has(e)||(h.add(e),i=!0);i&&(updateHover(d),e.invalidateViewport())},setColor:t=>{x!==t&&(x=t,e.invalidateViewport())},getAt:(e,t,i="mouse")=>{for(let r=0,n=d.length;r<n;++r){const{id:n}=d[r];if(d[r].inputType===i&&(0,s.isInsideHandler)(e,t,d[r]))return n}return null},hoverAt:(t,i)=>{m.x===t&&m.y===i||(m.x=t,m.y=i,v=!0,updateHover(d)&&e.invalidateViewport())},playEaseInAnimation:()=>{y&&0!==h.size&&l.size&&(i.animation.easeInSeconds<=0||(u=!0,g=performance.now()/1e3,e.invalidateViewport()))}}},toggleDrawDebug:()=>{w=!w,e.invalidateViewport()},draw:a=>{if(!l.size||!y)return;const m=new Path2D,v=new r.Rectangle,b=[{x:0,y:0},{x:0,y:0},{x:0,y:0},{x:0,y:0}],C={width:0,height:0},A=[];let I=!0,S=0,T=0;const _=a.surface.camera.scale,M=a.surface.camera.getClipBounds().x,O=a.surface.camera.getClipBounds().y,R=a.surface.renderScaleMultiplier,E=Math.min(Math.round(o*_),o),P=E/_,transformBoxToCamera=e=>{const t=e.x,i=e.y,r=e.x1,n=e.y1,s=Math.round((t-M)*_),a=Math.round((i-O)*_),o=Math.round((r-M)*_),l=Math.round((n-O)*_);e.setBounds(s,a,o-s,l-a)},transformSizeToCamera=e=>{e.width=Math.round(e.width*_),e.height=Math.round(e.height*_)},transformPointToCamera=e=>(e.x=Math.round((e.x-M)*_),e.y=Math.round((e.y-O)*_),e),L=new r.Rectangle;for(const t of l){const i=e.findNodeByExternalId(t);if(i)if(T++,i.selectionShapes&&A.push(i),i.axisAligned)L.copy(i.aabbSelfOnlyWithoutRenderOverflow),transformBoxToCamera(L),L.expand(2*E,2*E),null===i.selectionShapes&&(0,n.drawBox)(L,m),I?(v.copy(L),I=!1):v.union(L);else{const{border:e}=i;S=i.rotation,i.getNonRotatedGlobalSizeWithBorder(C),transformSizeToCamera(C),C.width+=2*E,C.height+=2*E,b[0].x=-e-P,b[0].y=-e-P,b[1].x=i.width+e+P,b[1].y=-e-P,b[2].x=i.width+e+P,b[2].y=i.height+e+P,b[3].x=-e-P,b[3].y=i.height+e+P,i.transformPoints(b);for(let e=0;e<b.length;e++)transformPointToCamera(b[e]);null===i.selectionShapes&&(m.moveTo(b[0].x,b[0].y),m.lineTo(b[1].x,b[1].y),m.lineTo(b[2].x,b[2].y),m.lineTo(b[3].x,b[3].y),m.closePath()),I?(v.fromPoints(...b),I=!1):v.unionPoints(...b)}}if(0===T)return void(d.length=0);const k=void 0===c?performance.now()/1e3:g+c,N={playing:u,timeNormalized:u?Math.min((k-g)/i.animation.easeInSeconds,1):1},F=a.surface;if(a.setDirty(),F.ctx.globalAlpha=N.playing?N.timeNormalized:1,A.length>0){F.ctx.save(),F.ctx.resetTransform(),F.ctx.scale(R,R);for(let e=0;e<A.length;e++){const t=A[e];(0,n.drawSelectionShape)(t,i.color,i.thickness,!1,F.ctx,F.camera)}F.ctx.restore()}if(F.ctx.resetTransform(),F.ctx.scale(R,R),F.ctx.strokeStyle=x,F.ctx.lineWidth=i.thickness,F.ctx.stroke(m),T>1){S=0,F.ctx.setLineDash([i.dashLength,i.gapLength]);const e=(0,n.drawBox)(v);F.ctx.stroke(e),F.ctx.setLineDash([])}0===S&&(b[0].x=v.x,b[0].y=v.y,b[1].x=v.x1,b[1].y=v.y,b[2].x=v.x1,b[2].y=v.y1,b[3].x=v.x,b[3].y=v.y1,C.width=v.width,C.height=v.height),d.length=0,d.push(...(0,s.getHandlers)(h,v,b,C,S,t,i));for(const e of d)e.draw&&e.draw(F.ctx,N);const B=(0,s.copyAndTransformHandlersFromCameraSpaceToGlobalSpace)(d,M,O,_);updateHover(B);const z=d.find((e=>e.id===f));z&&z.hover&&(0,n.drawHandlerHoverFeedback)(z,z.hover,F.ctx),w&&d.forEach((e=>{e.hover&&(0,n.debugDrawHandlerHoverFeedback)(e,e.hover,F.ctx)})),d=B,N.playing&&(N.timeNormalized>=1?u=!1:e.invalidateViewport()),F.ctx.globalAlpha=1},animationsDone:()=>!(u&&y&&h.size>0&&l.size>0&&i.animation.easeInSeconds>0),setDebugAnimationTime:e=>{c=e}}}},1487:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.calculateBorderOffset=t.transformPointToLocalPoint=t.distancePoints=t.averagePoints=t.addPoints=t.subtractPoints=t.multiplyPoint=t.normalizePointInPlace=t.normalizePoint=t.DegToRad=void 0,t.DegToRad=Math.PI/180;t.normalizePoint=e=>{const t=Math.sqrt(e.x*e.x+e.y*e.y);return 0===t?{x:0,y:0}:{x:e.x/t,y:e.y/t}};t.normalizePointInPlace=e=>{const t=Math.sqrt(e.x*e.x+e.y*e.y);return 0===t?(e.x=0,e.y=0):(e.x/=t,e.y/=t),e};t.multiplyPoint=(e,t)=>({x:e.x*t,y:e.y*t});t.subtractPoints=(e,t)=>({x:e.x-t.x,y:e.y-t.y});t.addPoints=(e,t)=>({x:e.x+t.x,y:e.y+t.y});t.averagePoints=(e,t)=>({x:(e.x+t.x)/2,y:(e.y+t.y)/2});t.distancePoints=(e,t)=>{const i=e.x-t.x,r=e.y-t.y;return Math.sqrt(i*i+r*r)};t.transformPointToLocalPoint=(e,i,r)=>{const n=-r*t.DegToRad,s=e.x-i.x,a=e.y-i.y;return{x:Math.cos(n)*s-Math.sin(n)*a,y:Math.sin(n)*s+Math.cos(n)*a}};t.calculateBorderOffset=(e,t)=>"inwards-outwards"===t?0:Math.floor(e/2)*("outwards"===t?1:-1)},8121:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createViewportActions=void 0;t.createViewportActions=e=>{const t={get:()=>{const{x:t,y:i}=e.camera.getClipBounds();return{x:t,y:i,zoom:e.camera.scale}},getSize:()=>({width:e.cameraWidth,height:e.cameraHeight}),fromScreenPos:(e,i)=>{const{x:r,y:n,zoom:s}=t.get();return{x:e/s+r,y:i/s+n}},toScreenPos:(e,i)=>{const{x:r,y:n,zoom:s}=t.get();return{x:(e-r)*s,y:(i-n)*s}},goTo:(i,r)=>{t.set(i,r,e.camera.scale)},resize:(t,i)=>{e.viewportResize(t,i)},set:(t,i,r)=>{e.camera.setFullViewport(t,i,r),e.invalidateViewport()},setBackground:t=>{e.setClearColor(t)},setZoomCenter:(t,i)=>{e.camera.setupZoomAtScreenPos(t,i,!0)},zoom:t=>{e.cameraScale=t},zoomAt:(e,i,r)=>{t.setZoomCenter(e,i),t.zoom(r)},zoomTo:()=>{console.error("zoomTo is no longer supported")}};return t}},5693:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.octetStream=void 0,t.octetStream="application/octet-stream"},5759:function(e,t,i){"use strict";var r=this&&this.__awaiter||function(e,t,i,r){return new(i||(i=Promise))((function(n,s){function fulfilled(e){try{step(r.next(e))}catch(e){s(e)}}function rejected(e){try{step(r.throw(e))}catch(e){s(e)}}function step(e){e.done?n(e.value):function adopt(e){return e instanceof i?e:new i((function(t){t(e)}))}(e.value).then(fulfilled,rejected)}step((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.isSvgImage=t.isIconId=t.toIconUrl=t.getAssetFromCache=t.getFontCache=t.getAssetCache=t.getMimeType=t.getMimeExtension=t.validImageMimeTypes=t.mimeMap=void 0;const n=i(5074),s=i(5693);t.mimeMap={png:"image/png",jpg:"image/jpeg",jpeg:"image/jpeg",svg:"image/svg+xml",gif:"image/gif",json:"application/json",ico:"image/x-icon",bmp:"image/bmp",webp:"image/webp"},t.validImageMimeTypes=new Set(Object.values(t.mimeMap).filter((e=>e.startsWith("image"))));t.getMimeExtension=e=>Object.keys(t.mimeMap).find((i=>t.mimeMap[i]===e));t.getMimeType=e=>(e.replace(/\/phantomjs\/.*$/,"").replace(/^.*\/([^/]+)$/,"$1").toLowerCase().match(/\.\w+/g)||[]).map((e=>t.mimeMap[e.slice(1)])).filter((e=>!!e))[0]||s.octetStream;const scaleSize=(e,t)=>e&&{width:e.width*t,height:e.height*t},scaleAsset=e=>t=>Object.assign(Object.assign({},t),{opts:t.opts&&Object.assign(Object.assign({},t.opts),{fit:scaleSize(t.opts.fit,e),bound:scaleSize(t.opts.bound,e)})}),fetchAssets=(e,t,i)=>Promise.all(i.map(e)).then((e=>i.reduce(((i,r,n)=>{const s=e[n];return s.data.byteLength>0&&(i[t(r)]=s),i}),{}))),groupAssetsSlices=(e,t,i,r,n)=>{const merge=e=>Object.assign(Object.assign({},n),e);if(r.length<i)return fetchAssets(e,t,r).then(merge);const s=r.slice(0,i),a=r.slice(i);return fetchAssets(e,t,s).then((r=>groupAssetsSlices(e,t,i,a,merge(r))))};t.getAssetCache=(e,t,i=1,r)=>((e,t,i,r)=>groupAssetsSlices(e,t,i,r,{}))(e,n.getCacheKey,r||1/0,(0,n.getAssets)(t).map(scaleAsset(i)));const a=new Map;t.getFontCache=(e,t)=>r(void 0,void 0,void 0,(function*(){const i=new Map;for(let r=0;r<t.length;r++){const n=t[r];if(!a.has(n)){const t=yield e(n);a.set(n,t)}i.set(n,a.get(n))}return i}));t.getAssetFromCache=(e,t)=>i=>e[(0,n.getCacheKey)(scaleAsset(t)(i))];t.toIconUrl=e=>`/api/v0/noun/id/${e}.svg`;t.isIconId=e=>!e.startsWith("/")&&!e.includes("://")&&!e.includes("base64");t.isSvgImage=e=>e.includes(t.mimeMap.svg)||e.includes(".svg")},4886:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isRTLFontFamily=t.aliasMap=t.semiBoldMap=t.boldMap=void 0;t.boldMap={"proxima-nova":"proxima-nova-bold","museo-slab":"museo-slab-bold","noto-sans":"noto-sans-bold","noto-sans-cjk":"noto-sans-cjk-bold","noto-sans-hebrew":"noto-sans-hebrew-bold","noto-sans-devanagari":"noto-sans-devanagari-bold","noto-sans-thai":"noto-sans-thai-bold","noto-naskh-arabic":"noto-naskh-arabic-bold",adelle:"adelle-bold","ey-interstate":"ey-interstate-bold"},t.semiBoldMap={"proxima-nova":"proxima-nova-semibold"},t.aliasMap={"tk-proxima-nova-eb":"proxima-nova-bold","tk-blambot-casual":"blambot-casual",markerfelt:"marker-felt"};t.isRTLFontFamily=e=>"noto-sans-hebrew"===e||"noto-sans-hebrew-bold"===e||"noto-naskh-arabic"===e||"noto-naskh-arabic-bold"===e,t.default={"proxima-nova":"proximanova-regular-webfont.ttf","proxima-nova-bold":"proximanova-bold-webfont.ttf","proxima-nova-semibold":"proximanova-semibold-webfont.ttf","museo-slab":"museo_slab_300-webfont.ttf","museo-slab-bold":"museo_slab_700-webfont.ttf",adelle:"adelle_reg-webfont.ttf","adelle-bold":"adelle_extrabold-webfont.ttf","marker-felt":"marker_felt-webfont.ttf","shark-water":"shark_in_the_water__bold-webfont.ttf","blambot-casual":"blambotcasual-webfont.ttf","blambot-pro":"blambotprolite-webfont.ttf","lint-mccree":"lint-mccree2-webfont.ttf","noto-sans-hebrew":"NotoSansHebrew-Regular.ttf","noto-sans-hebrew-bold":"NotoSansHebrew-Bold.ttf","noto-sans-devanagari":"NotoSansDevanagari-Regular.ttf","noto-sans-devanagari-bold":"NotoSansDevanagari-Bold.ttf","noto-sans-thai":"NotoSansThai-Regular.ttf","noto-sans-thai-bold":"NotoSansThai-Bold.ttf","noto-naskh-arabic":"NotoNaskhArabic-Regular.ttf","noto-naskh-arabic-bold":"NotoNaskhArabic-Bold.ttf","noto-sans-cjk":"NotoSansCJKsc-Regular.otf","noto-sans-cjk-bold":"NotoSansCJKsc-Bold.otf","noto-sans":"NotoSans-Regular.ttf","noto-sans-bold":"NotoSans-Bold.ttf",stickers:"murally-stickers.ttf","ey-interstate":"EYInterstate-Regular.ttf","ey-interstate-bold":"EYInterstate-Bold.ttf","emoji-fallback":"TwitterColorEmoji-SVGinOT.ttf"}},5694:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default={"proxima-nova":{lineHeight:1.2177734375,ascent:.919921875,descent:-.2978515625},"proxima-nova-bold":{lineHeight:1.2177734375,ascent:.919921875,descent:-.2978515625},"proxima-nova-semibold":{lineHeight:1.2177734375,ascent:.919921875,descent:-.2978515625},"museo-slab":{lineHeight:1.12744140625,ascent:.89111328125,descent:-.236328125},"museo-slab-bold":{lineHeight:1.16650390625,ascent:.9130859375,descent:-.25341796875},adelle:{lineHeight:1.28173828125,ascent:.97021484375,descent:-.3115234375},"adelle-bold":{lineHeight:1.3232421875,ascent:1.005859375,descent:-.3173828125},"marker-felt":{lineHeight:1.31591796875,ascent:1.0771484375,descent:-.23876953125},"shark-water":{lineHeight:1.44921875,ascent:1.02734375,descent:-.421875},"blambot-casual":{lineHeight:1.2470703125,ascent:1.0009765625,descent:-.24609375},"blambot-pro":{lineHeight:1.232421875,ascent:.9560546875,descent:-.2763671875},"lint-mccree":{lineHeight:1.2158203125,ascent:1.0244140625,descent:-.19140625},"noto-sans-hebrew":{lineHeight:1.362,ascent:1.069,descent:-.293},"noto-sans-hebrew-bold":{lineHeight:1.362,ascent:1.069,descent:-.293},"noto-sans-devanagari":{lineHeight:1.304,ascent:.896,descent:-.408},"noto-sans-devanagari-bold":{lineHeight:1.304,ascent:.896,descent:-.408},"noto-sans-thai":{lineHeight:1.511,ascent:1.061,descent:-.45},"noto-sans-thai-bold":{lineHeight:1.511,ascent:1.061,descent:-.45},"noto-naskh-arabic":{lineHeight:1.70263671875,ascent:1.06884765625,descent:-.6337890625},"noto-naskh-arabic-bold":{lineHeight:1.70263671875,ascent:1.06884765625,descent:-.6337890625},"noto-sans-cjk":{lineHeight:1.48,ascent:1.16,descent:-.32},"noto-sans-cjk-bold":{lineHeight:1.48,ascent:1.16,descent:-.32},"noto-sans":{lineHeight:1.362,ascent:1.069,descent:-.293},"noto-sans-bold":{lineHeight:1.362,ascent:1.069,descent:-.293},stickers:{lineHeight:1,ascent:1,descent:0},"ey-interstate":{lineHeight:1.2001953125,ascent:.9599609375,descent:-.240234375},"ey-interstate-bold":{lineHeight:1.2001953125,ascent:.9599609375,descent:-.240234375},"emoji-fallback":{lineHeight:1.05908203125,ascent:.958984375,descent:-.10009765625}}},6541:function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i);var n=Object.getOwnPropertyDescriptor(t,i);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,r,n)}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),n=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&r(t,e,i);return n(t,e),t},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.normalizeFont=t.areAllFontFamilyCharactersHyphenableCandidates=t.makeSemiBold=t.makeBold=t.getUnifiedLineMetrics=t.getFontMetrics=void 0;const o=s(i(4886)),l=a(i(5694));t.default=o.default;t.getFontMetrics=(e,t,i)=>{const r=l.default[e];return{lineHeight:r.lineHeight*t*i,ascent:r.ascent*t*i,descent:r.descent*t*i}};const mergeMetrics=(e,t)=>({ascent:Math.max(e.ascent,t.ascent),descent:Math.min(e.descent,t.descent),lineHeight:Math.max(e.lineHeight,t.lineHeight)}),d={ascent:0,descent:0,lineHeight:0},foldMetrics=e=>e.reduce(mergeMetrics,d);t.getUnifiedLineMetrics=(e,i,r)=>foldMetrics(e.map((e=>((e,i,r)=>foldMetrics(e.map((e=>(0,t.getFontMetrics)(e.fontFamily,i,r)))))(e,i,r))));const makeFontVariant=(e,t)=>e[t]||t;t.makeBold=e=>makeFontVariant(o.boldMap,e);t.makeSemiBold=e=>makeFontVariant(o.semiBoldMap,e);t.areAllFontFamilyCharactersHyphenableCandidates=e=>(e=>"noto-sans-cjk"===e||"noto-sans-cjk-bold"===e)(e)||(e=>"noto-sans-thai"===e)(e);t.normalizeFont=e=>{const i=(e=>{let t=(e||"").toLowerCase();return o.default[t]?t:(t=o.aliasMap[t],o.default[t]?t:(console.log(`Error: cannot find font '${e}'`),t=Object.keys(o.default).filter((t=>-1!==e.indexOf(t)))[0],o.default[t]?t:"proxima-nova"))})(e.fontFamily);return e.bold?(0,t.makeBold)(i):i}},377:function(e,t,i){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.getCubicBezierLookupTable=t.getCubicBezierEvaluatorAtX=void 0;const n=r(i(5874)),isNearZero=e=>Math.abs(e)<1e-6,crt=e=>e<0?-Math.pow(-e,1/3):Math.pow(e,1/3),s=2*Math.PI;t.getCubicBezierEvaluatorAtX=(e,t,i,r)=>{const a=((e,t)=>{const i=3*e,r=3*t,n=i-r+1;let a=-2*i+r,o=i;if(isNearZero(n))return isNearZero(a)?isNearZero(o)?()=>[]:e=>[- -e/o]:e=>{const t=-e,i=Math.sqrt(o*o-4*a*t),r=2*a;return[(i-o)/r,(-o-i)/r]};a/=n,o/=n;const l=a/3,d=(3*o-a*a)/3,h=d/3,c=2*a*a*a/27-9*a*o/27;return e=>{const t=c+-e/n,i=t/2,r=i*i+h*h*h;if(r<0){const e=-d/3,i=Math.sqrt(e*e*e),r=-t/(2*i),n=r<-1?-1:r>1?1:r,a=Math.acos(n),o=2*crt(i);return[o*Math.cos(a/3)-l,o*Math.cos((a+s)/3)-l,o*Math.cos((a+2*s)/3)-l]}if(0===r){const e=i<0?crt(-i):-crt(i);return[2*e-l,-e-l]}{const e=Math.sqrt(r);return[crt(-i+e)-crt(i+e)-l]}}})(e,i),o=new n.default(0,0,e,t,i,r,1,1);return e=>{if(e<=0)return 0;if(e>=1)return 1;const t=a(e);let i=0;if(t.length>0)for(const e of t)if(!(e<0||e>1)){i=e;break}return o.get(i).y}};t.getCubicBezierLookupTable=(e,i,r,n,s)=>{const a=(0,t.getCubicBezierEvaluatorAtX)(e,i,r,n),o=[];for(let e=0;e<s;e++){const t=e/(s-1);o.push(a(t))}return o}},4258:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getCSSCubicBezierEasing=void 0;const r=i(377),n=new Map;class EasingLerpedLookupTable{constructor(e){this.ys=e}getValue(e){const t=this.ys.length-1,i=e*t,r=i%1;let n=Math.floor(i);n<0&&(n=0),n>t&&(n=t);let s=n+1;s>t&&(s=t);return this.ys[n]*(1-r)+this.ys[s]*r}}t.getCSSCubicBezierEasing=(e,t)=>{if(!((e,t)=>{let i=!0;4!=e.length&&(console.error("Not enough control points for easing"),i=!1),t<2&&(console.error("Not enough levels of detail for easing"),i=!1);const r=e[0],n=e[1],s=e[2],a=e[3];return 0<=r&&r<=1&&0<=s&&s<=1||(console.error("Control point X outside [0,1] range"),i=!1),(Number.isNaN(n)||Number.isNaN(a))&&(console.error("Control point Y is NaN"),i=!1),i})(e,t))return(()=>new EasingLerpedLookupTable([0,1]))();const i=((e,t)=>`${e[0]}-${e[1]}-${e[2]}-${e[3]}-${t}`)(e,t),s=n.get(i);if(s)return s;const a=(0,r.getCubicBezierLookupTable)(e[0],e[1],e[2],e[3],t),o=new EasingLerpedLookupTable(a);return n.set(i,o),o}},6369:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.splitTextItem=void 0;const r=i(9494);t.splitTextItem=e=>{const t=(0,r.unicodeSplitByCJK)(e);return null===t?null:{texts:t}}},4313:function(e,t,i){"use strict";var r=this&&this.__awaiter||function(e,t,i,r){return new(i||(i=Promise))((function(n,s){function fulfilled(e){try{step(r.next(e))}catch(e){s(e)}}function rejected(e){try{step(r.throw(e))}catch(e){s(e)}}function step(e){e.done?n(e.value):function adopt(e){return e instanceof i?e:new i((function(t){t(e)}))}(e.value).then(fulfilled,rejected)}step((r=r.apply(e,t||[])).next())}))},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const s=n(i(6541)),a=i(6369),o=i(6785),l={},arrayBuffer2Base64=e=>btoa(String.fromCharCode.apply(null,new Uint8Array(e))),mapResponse=e=>({ok:e.ok,arrayBuffer:()=>e.arrayBuffer(),text:()=>e.text(),status:e.status,location:e.headers.get("location")||"",contentType:e.headers.get("content-type")||""}),fetchFn=(e,t)=>fetch(e,t).then(mapResponse);t.default=e=>({arrayBuffer2Base64,config:e,buildMeasureText:o.buildMeasureText,buildSplitTextItem:()=>a.splitTextItem,arrayBuffer2String:e=>new TextDecoder("utf-8").decode(new Uint8Array(e)),string2ArrayBuffer:e=>(new TextEncoder).encode(e),fetchFn,stringToBase64:btoa,base64ToString:atob,readFontFn:e=>{if(void 0!==l[e])return l[e];const t=`/res/fonts/${s.default[e]}`;return l[e]=(()=>r(void 0,void 0,void 0,(function*(){const e=yield fetchFn(t);return{data:yield e.arrayBuffer(),url:t}})))(),l[e]}})},6785:function(e,t,i){"use strict";var r=this&&this.__awaiter||function(e,t,i,r){return new(i||(i=Promise))((function(n,s){function fulfilled(e){try{step(r.next(e))}catch(e){s(e)}}function rejected(e){try{step(r.throw(e))}catch(e){s(e)}}function step(e){e.done?n(e.value):function adopt(e){return e instanceof i?e:new i((function(t){t(e)}))}(e.value).then(fulfilled,rejected)}step((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.getCanvasImageFromUrl=t.getImageFromUrl=t.buildMeasureText=void 0;const n=i(5759),s=i(6541),a=i(1106);class FontCache{constructor(e){this.cache=new Map,this.lruCounter=0,this.maxSize=0,this.maxSize=e}measureText(e,t,i){if(e&&i){const r=this.getCacheEntry(e,Math.round(100*t)/100);if(r){const e=r.cachedMeasures.get(i);if(void 0!==e)return e;const t=r.context.measureText(i).width;return r.cachedMeasures.set(i,t),r.cachedSize+=i.length,(r.cachedSize>524288||r.cachedMeasures.size>1e4)&&(r.cachedMeasures.clear(),r.cachedSize=0),t}}return 0}getCacheEntry(e,t){const{cache:i,maxSize:r}=this,n=-1!==e.indexOf("bold"),a=-1!==e.indexOf("italic"),o=`${e}/${t}/${n}/${a}`,l=i.get(o);if(l)return l.lastUsed=this.lruCounter++,l;const d=`${a?"italic ":""}${t}px ${n?(0,s.makeBold)(e):e}`;if(i.size<r){const e=document.createElement("canvas").getContext("2d");if(e){e.font=d;const t={context:e,lastUsed:this.lruCounter++,cachedMeasures:new Map,cachedSize:0};return i.set(o,t),t}}const h=Array.from(i.entries()).reduce(((e,t)=>e&&e[1].lastUsed<=t[1].lastUsed?e:t),null);if(!h)return null;const[c,{context:u}]=h;i.delete(c),u.font=d;const g={context:u,lastUsed:this.lruCounter++,cachedMeasures:new Map,cachedSize:0};return i.set(o,g),g}}t.buildMeasureText=()=>{const e=new FontCache(4);return(t,i,r)=>e.measureText(t,i,r)};t.getImageFromUrl=(e,t,i,s)=>(o,l,d)=>{const h=(({dataUrl:e,url:t,levelOfDetail:i,opts:{color:r}={}})=>({id:`${r||"default"}|${e||t}`,levelOfDetail:i||0}))(o);return l.get(h,(l=>((e,t,i,{dataUrl:s,url:o,levelOfDetail:l,opts:{color:d,isIcon:h}={}},c)=>r(void 0,void 0,void 0,(function*(){const r=s||(yield i(o,{levelOfDetail:l,isIcon:h,progressCb:c}));if("string"!=typeof r||!r.includes(n.mimeMap.svg))return r;const{base64Content:u}=(0,a.fromDataUrl)(r),g=e(u),f=(0,a.sanitizeSvg)(g,{color:d});return(0,a.toDataUrl)(n.mimeMap.svg,t(f))})))(e,t,i,o,l).then((e=>s(e,o,l)))),d)};t.getCanvasImageFromUrl=(e,i=null)=>(0,t.getImageFromUrl)(atob,btoa,e,((e,t,r)=>"string"!=typeof e?{type:"simple",image:e,vectorial:!1}:null!==i&&(t.url.endsWith(".gif")||e.includes(n.mimeMap.gif))?i(e,r):((e,t)=>new Promise((i=>{const r=new Image;t&&t(0,!0),r.onload=()=>{t&&t(1,!0),i({type:"simple",image:r,vectorial:(0,n.isSvgImage)(e)})},r.onerror=()=>i({type:"error"}),r.src=e})))(e,r)))},3260:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CLASSIC_MURAL_STYLE=t.CLASSIC_DRAGGING_SHADOW_ANIMATION=t.CLASSIC_ROTATION_HANDLER_PATH=t.CLASSIC_LINE_HEIGHT_MULTIPLIER=void 0;t.CLASSIC_LINE_HEIGHT_MULTIPLIER=1,t.CLASSIC_ROTATION_HANDLER_PATH="M 10.154 5.253 l -1.6 -1.6 l -3.3 -3.3 v 3.9 c -5.2 0 -9.5 -4.3 -9.5 -9.5 h 3.9 l -3.3 -3.3 l -1.5 -1.5 l -0.1 -0.1 l -4.9 4.9 h 3.9 c 0 6.3 5.2 11.5 11.5 11.5 v 3.9 l 4.9 -4.9 z";const i={"-":{1:{dashLength:2,gapLength:2},3:{dashLength:6,gapLength:6},5:{dashLength:10,gapLength:10},7:{dashLength:14,gapLength:14}},".":{1:{dashLength:1,gapLength:1},3:{dashLength:3,gapLength:3},5:{dashLength:5,gapLength:5},7:{dashLength:7,gapLength:7}},". ":{1:{dashLength:2,gapLength:6},3:{dashLength:6,gapLength:18},5:{dashLength:10,gapLength:60},7:{dashLength:14,gapLength:84}}};t.CLASSIC_DRAGGING_SHADOW_ANIMATION={animate:{easeInCurveControlPoints:[.17,0,0,1],easeInDelay:0,easeInSeconds:.667,easeOutCurveControlPoints:[.17,0,0,1],easeOutDelay:0,easeOutSeconds:.667},blurOverride:12,offsetDownPixels:16},t.CLASSIC_MURAL_STYLE={selection:{color:"#69a8f6",dashLength:3,gapLength:3,padding:3,animation:{easeInSeconds:0},quickAddHandler:{backgroundColor:"rgba(255,255,255,0.8)",borderColor:"#69A8F6",borderThickness:2,hover:{backgroundColor:"#69A8F6",size:10},offset:10,size:8},resizeCapsule:{backgroundColor:"#fafafa",borderColor:"#b7b7b7",borderGrowth:"inwards-outwards",borderThickness:1,cornerRadius:3,height:18,shadow:{blur:3,color:"rgba(0,0,0,0.3)",offsetX:0,offsetY:1},width:6},resizeCorner:{backgroundColor:"#fafafa",borderColor:"#b7b7b7",borderGrowth:"inwards-outwards",borderThickness:1,cornerRadius:2,shadow:{blur:3,color:"rgba(0,0,0,0.3)",offsetX:0,offsetY:1},size:12},rotationHandler:{drawing:{color:"#69A8F6",path:t.CLASSIC_ROTATION_HANDLER_PATH,size:22,topLeftRotation:90},offset:20},thickness:2,thicknessGrowth:"outwards"},widgets:{label:{height:18,maxIconHeight:14,fontFamily:"proxima-nova-semibold",fontSize:13,borderThickness:1,paddingHorizontal:5,iconOffsetY:1.5,textOffsetY:1,iconPaddingRight:2,cornerRadius:3,spacingBetweenLabels:5,fallbacks:{backgroundColor:"#F9F9F9",borderColor:"#D8D8D8",textColor:"#393939"},burger:{height:18,width:18,dotSize:2,dotDistance:4,idle:{backgroundColor:"#FFFFFF",borderColor:"#D5D5D5",dotColor:"#2F2F2F"},hover:{backgroundColor:"#393939",borderColor:"#393939",dotColor:"#FFFFFF"}}},comment:{mode:"classic",inner:{backgroundColor:{type:"user"},textColor:{type:"hex",hex:"#FFFFFF"}},outer:{backgroundColor:{type:"hex",hex:"#FFFFFF"}},unreadBorder:{growth:"inwards-outwards",color:"#FF0066",strokeWidth:1.5},selectedBorder:{growth:"outwards",color:"#4a90e2",strokeWidth:3}},area:{boldTitle:!1,cornerRadius:0,padding:30,lineHeightMultiplier:t.CLASSIC_LINE_HEIGHT_MULTIPLIER,shadow:{alwaysVisible:!1,blur:4,color:"#00000018",cornerRadius:4,height:3,whileDragging:t.CLASSIC_DRAGGING_SHADOW_ANIMATION},strokeOverrides:i,titleOffsetX:30,titleOffsetY:20,titlePaddingBottom:10},arrow:{strokeOverrides:i,tip:{shape:"latex",sizeBasePixelGrowth:0,sizeScaledFromStrokeWidth:4}},file:{cornerRadius:0,generic:{borderColor:"#e3e3e3",borderThickness:1,caption:{verticalAlign:"bottom"},title:{verticalAlign:"top"}},iconStyle:"classic",preview:{borderColor:"transparent",borderThickness:0,informationBoxPadding:{bottom:20,left:20,right:20,top:20},title:{verticalAlign:"middle"},widgetPadding:0},shadow:{alwaysVisible:!1,blur:4,color:"#00000018",cornerRadius:4,height:3,whileDragging:t.CLASSIC_DRAGGING_SHADOW_ANIMATION}},framework:{cornerRadius:0,strokeOverrides:i},image:{borderColor:"#e2e2e2",borderPadding:4,borderThickness:1,cornerRadius:0,objectFit:"fit",shadow:{alwaysVisible:!1,blur:4,color:"#00000018",cornerRadius:4,height:3,whileDragging:t.CLASSIC_DRAGGING_SHADOW_ANIMATION}},openButton:{bold:!1,borderThickness:1,cornerRadius:4,externalIconOffsetVertical:4,fontSize:12,height:24,hover:{backgroundColor:"#393939",borderColor:"#393939",externalIcon:{source:"data:image/png;base64,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",type:"image",actionScale:1,width:8.5},textColor:"#FFFFFF"},idle:{backgroundColor:"#F9F9F9",borderColor:"#D8D8D8",externalIcon:{source:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACIAAAAiCAYAAAA6RwvCAAAMYGlDQ1BJQ0MgUHJvZmlsZQAASImVVwdYU8kWnltSSWiBCEgJvYkiNYCUEFoEAamCqIQkkFBiTAgqdnRRwbWLKFZ0VUTR1RWQtSBid1HsfbGgoqyLBRsqb0ICuvrK9w7f3Plz5sx/CjP3zgCg08aXyXJRXQDypPnyuPBg1piUVBbpEcABBf4NBi58gULGiY2NAlD6+3/K22sAUfWXXVRcP47/V9EXihQCAJA0iDOECkEexI0A4EUCmTwfAGII1FtPzpepsBhiAzkMEOLpKpylxktVOEONt/bZJMRxIa4HgEzj8+VZAGg3Qz2rQJAFebQfQewqFUqkAOgYQBwgEPOFECdAPCQvb6IKz4bYAdrLIN4BMTvjG86sf/BnDPDz+VkDWJ1Xn5BDJApZLn/q/1ma/y15ucp+H3aw0cTyiDhV/rCGN3ImRqowDeJOaUZ0jKrWEL+XCNV1BwClipURiWp71FSg4ML6ASbErkJ+SCTEphCHSXOjozT6jExJGA9iuFrQKZJ8XoJm7gKRIjRew7lOPjEuph9nyrkczdwavrzPr8q+WZmTyNHw3xCLeP38bwrFCckQUwHAqAWSpGiItSE2UOTER6ptMKtCMTe630aujFPFbwMxWyQND1bzY2mZ8rA4jb0sT9GfL1YslvCiNbg8X5wQoa4PtlPA74vfCOJakZST2M8jUoyJ6s9FKAoJVeeOtYikiZp8sXuy/OA4zdwuWW6sxh4ni3LDVXoriE0UBfGaufiIfLg41fx4lCw/NkEdJ56ezR8Zq44HLwBRgAtCAAsoYcsAE0E2kLR01nXCX+qRMMAHcpAFRMBFo+mfkdw3IoXPeFAI/oJIBBQD84L7RkWgAOo/D2jVTxeQ2Tda0DcjBzyGOA9Eglz4W9k3SzrgLQk8ghrJD94FMNZc2FRjP+o4UBOl0Sj7eVk6/ZbEUGIIMYIYRnTETfAA3A+Pgs8g2NxwNu7TH+1Xe8JjQivhAeEqoY1wc4KkSP5dLKNAG+QP02Sc8W3GuB3k9MSDcX/IDplxJm4CXHAP6IeDB0LPnlDL1cStyp31b/IcyOCbmmvsKK4UlDKIEkRx+H6mtpO25wCLqqLf1kcda8ZAVbkDI9/7535TZyHsI7+3xBZg+7FT2DHsDHYIqwMs7ChWj53HDqvwwBp61LeG+r3F9cWTA3kkP/jja3yqKqlwrXbtcP2kGQP5oin5qg3GnSibKpdkifNZHPgVELF4UsHQISw3VzdXAFTfFPVr6jWz71uBMM9+1c21BMB/am9v76GvusiLAOw/DLf5ra86+3b4OjgLwOnVAqW8QK3DVQ8CfBvowB1lDMyBNXCAGbkBL+AHgkAoGAliQAJIAeNhncVwPcvBZDAdzAHFoBQsBavAWrARbAE7wG6wD9SBQ+AYOAnOgYvgKrgN1087eA66wFvQgyAICaEjDMQYsUBsEWfEDWEjAUgoEoXEISlIOpKFSBElMh2Zi5Qiy5G1yGakCvkVOYgcQ84grchN5D7SgbxCPqIYSkMNUDPUDh2GslEOGokmoOPQLHQSWojOQxej5WglugutRY+h59CraBv6HO3GAKaFMTFLzAVjY1wsBkvFMjE5NhMrwcqwSqwGa4D/6ctYG9aJfcCJOANn4S5wDUfgibgAn4TPxBfha/EdeC3ejF/G7+Nd+BcCnWBKcCb4EniEMYQswmRCMaGMsI1wgHAC7qZ2wlsikcgk2hO94W5MIWYTpxEXEdcT9xAbia3Eh8RuEolkTHIm+ZNiSHxSPqmYtIa0i3SUdInUTnpP1iJbkN3IYeRUspRcRC4j7yQfIV8iPyH3UHQpthRfSgxFSJlKWULZSmmgXKC0U3qoelR7qj81gZpNnUMtp9ZQT1DvUF9raWlZaflojdaSaM3WKtfaq3Va677WB5o+zYnGpaXRlLTFtO20RtpN2ms6nW5HD6Kn0vPpi+lV9OP0e/T32gztodo8baH2LO0K7VrtS9ovdCg6tjocnfE6hTplOvt1Luh06lJ07XS5unzdmboVugd1r+t26zH0huvF6OXpLdLbqXdG76k+Sd9OP1RfqD9Pf4v+cf2HDIxhzeAyBIy5jK2ME4x2A6KBvQHPINug1GC3QYtBl6G+oYdhkuEUwwrDw4ZtTIxpx+Qxc5lLmPuY15gfB5kN4gwSDVo4qGbQpUHvjAYbBRmJjEqM9hhdNfpozDIONc4xXmZcZ3zXBDdxMhltMtlkg8kJk87BBoP9BgsGlwzeN/iWKWrqZBpnOs10i+l5024zc7NwM5nZGrPjZp3mTPMg82zzleZHzDssGBYBFhKLlRZHLZ6xDFkcVi6rnNXM6rI0tYywVFputmyx7LGyt0q0KrLaY3XXmmrNts60XmndZN1lY2Ezyma6TbXNLVuKLdtWbLva9pTtOzt7u2S7+XZ1dk/tjex59oX21fZ3HOgOgQ6THCodrjgSHdmOOY7rHS86oU6eTmKnCqcLzqizl7PEeb1z6xDCEJ8h0iGVQ6670Fw4LgUu1S73hzKHRg0tGlo39MUwm2Gpw5YNOzXsi6una67rVtfbw/WHjxxeNLxh+Cs3JzeBW4XbFXe6e5j7LPd695cezh4ijw0eNzwZnqM853s2eX728vaSe9V4dXjbeKd7r/O+zjZgx7IXsU/7EHyCfWb5HPL54Ovlm++7z/dvPxe/HL+dfk9H2I8Qjdg64qG/lT/ff7N/WwArID1gU0BboGUgP7Ay8EGQdZAwaFvQE44jJ5uzi/Mi2DVYHnwg+B3XlzuD2xiChYSHlIS0hOqHJoauDb0XZhWWFVYd1hXuGT4tvDGCEBEZsSziOs+MJ+BV8bpGeo+cMbI5khYZH7k28kGUU5Q8qmEUOmrkqBWj7kTbRkuj62JADC9mRczdWPvYSbG/jyaOjh1dMfpx3PC46XGn4hnxE+J3xr9NCE5YknA70SFRmdiUpJOUllSV9C45JHl5ctuYYWNmjDmXYpIiSalPJaUmpW5L7R4bOnbV2PY0z7TitGvj7MdNGXdmvMn43PGHJ+hM4E/Yn05IT07fmf6JH8Ov5Hdn8DLWZXQJuILVgufCIOFKYYfIX7Rc9CTTP3N55tMs/6wVWR3iQHGZuFPClayVvMyOyN6Y/S4nJmd7Tm9ucu6ePHJeet5Bqb40R9o80XzilImtMmdZsaxtku+kVZO65JHybQpEMU5Rn28AD+/nlQ7Kn5T3CwIKKgreT06avH+K3hTplPNTnaYunPqkMKzwl2n4NMG0pumW0+dMvz+DM2PzTGRmxsymWdaz5s1qnx0+e8cc6pycOX8UuRYtL3ozN3luwzyzebPnPfwp/KfqYu1iefH1+X7zNy7AF0gWtCx0X7hm4ZcSYcnZUtfSstJPiwSLzv48/Ofyn3sXZy5uWeK1ZMNS4lLp0mvLApftWK63vHD5wxWjVtSuZK0sWflm1YRVZ8o8yjaupq5Wrm4rjyqvX2OzZumaT2vFa69WBFfsWWe6buG6d+uF6y9tCNpQs9FsY+nGj5skm25sDt9cW2lXWbaFuKVgy+OtSVtP/cL+pWqbybbSbZ+3S7e37Yjb0VzlXVW103Tnkmq0WlndsStt18XdIbvra1xqNu9h7indC/Yq9z77Nf3Xa/si9zXtZ++v+c32t3UHGAdKapHaqbVddeK6tvqU+taDIw82Nfg1HPh96O/bD1keqjhseHjJEeqReUd6jxYe7W6UNXYeyzr2sGlC0+3jY45faR7d3HIi8sTpk2Enj5/inDp62v/0oTO+Zw6eZZ+tO+d1rva85/kDf3j+caDFq6X2gveF+os+FxtaR7QeuRR46djlkMsnr/CunLsafbX1WuK1G9fTrrfdEN54ejP35stbBbd6bs++Q7hTclf3btk903uVfzr+uafNq+3w/ZD75x/EP7j9UPDw+SPFo0/t8x7TH5c9sXhS9dTt6aGOsI6Lz8Y+a38ue97TWfyX3l/rXji8+O3voL/Pd43pan8pf9n7atFr49fb33i8aeqO7b73Nu9tz7uS98bvd3xgfzj1Mfnjk57Jn0ifyj87fm74EvnlTm9eb6+ML+f3HQUw2NDMTABebQeAngIAA54hqGPVd74+QdT31D4E/hNW3wv7xAuAGtipjuvcRgD2wmY3G3LDXnVUTwgCqLv7QNOIItPdTc1Fgzcewvve3tdmAJAaAPgs7+3tWd/b+xneUbGbADROUt81VUKEd4NNASp01ShuNvhO1PfQb3L8vgeqCDzA9/2/AOk0ijp5+c9oAAAAlmVYSWZNTQAqAAAACAAFARIAAwAAAAEAAQAAARoABQAAAAEAAABKARsABQAAAAEAAABSASgAAwAAAAEAAgAAh2kABAAAAAEAAABaAAAAAAAAAJAAAAABAAAAkAAAAAEAA5KGAAcAAAASAAAAhKACAAQAAAABAAAAIqADAAQAAAABAAAAIgAAAABBU0NJSQAAAFNjcmVlbnNob3Rfk37EAAAACXBIWXMAABYlAAAWJQFJUiTwAAACcWlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iWE1QIENvcmUgNS40LjAiPgogICA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPgogICAgICA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIgogICAgICAgICAgICB4bWxuczpleGlmPSJodHRwOi8vbnMuYWRvYmUuY29tL2V4aWYvMS4wLyIKICAgICAgICAgICAgeG1sbnM6dGlmZj0iaHR0cDovL25zLmFkb2JlLmNvbS90aWZmLzEuMC8iPgogICAgICAgICA8ZXhpZjpVc2VyQ29tbWVudD5TY3JlZW5zaG90PC9leGlmOlVzZXJDb21tZW50PgogICAgICAgICA8ZXhpZjpQaXhlbFhEaW1lbnNpb24+NTQ8L2V4aWY6UGl4ZWxYRGltZW5zaW9uPgogICAgICAgICA8ZXhpZjpQaXhlbFlEaW1lbnNpb24+NTg8L2V4aWY6UGl4ZWxZRGltZW5zaW9uPgogICAgICAgICA8dGlmZjpPcmllbnRhdGlvbj4xPC90aWZmOk9yaWVudGF0aW9uPgogICAgICAgICA8dGlmZjpSZXNvbHV0aW9uVW5pdD4yPC90aWZmOlJlc29sdXRpb25Vbml0PgogICAgICA8L3JkZjpEZXNjcmlwdGlvbj4KICAgPC9yZGY6UkRGPgo8L3g6eG1wbWV0YT4KBVOGuQAAAM5JREFUWAntlcEOxCAIRNfN/pT/f/Cz2syezJTUAqPpQW60Mj6GhpZPMmqtR1LiX/5ViCg0Ngi7WKIzbq0VFhvld3ctG80dBBpYAjKCWAJiQVhj/fFcrUN85mn+FGKqIx6IaSBeiCkgEQg5SBRCCpKBkIFkISQgCog0iAoiBaKEAMhls+LhKBQQvMHdPz0FhNWo2xF00sNwZ9YleNbXIOc6tyO9CIvhXTRCILhMCQG9MAiKlbFB2M3tyHaEHeD8sll5A3LBrHx/rOzsaxw5AXT3VqECa67cAAAAAElFTkSuQmCC",type:"image",actionScale:1,width:8.5},textColor:"#393939"},marginHorizontal:5.5,marginVertical:4.5,paddingHorizontal:4,paddingVertical:4,small:{height:21,paddingHorizontal:7.7,paddingVertical:6,width:24.7},sourceIconOffsetVertical:2,textMarginHorizontal:2,textOffsetVertical:.5},shape:{lineHeightMultiplier:t.CLASSIC_LINE_HEIGHT_MULTIPLIER,padding:{measurementUnit:"pixels",value:8},strokeOverrides:i,verticalAlign:"middle"},sticky:{circular:{labelPaddingTop:{measurementUnit:"pixels",value:4.5},padding:{measurementUnit:"height-percentage",value:1/7},verticalAlign:"middle"},cornerRadius:0,lineHeightMultiplier:t.CLASSIC_LINE_HEIGHT_MULTIPLIER,rectangular:{labelPaddingTop:{measurementUnit:"pixels",value:4.5},padding:{measurementUnit:"pixels",value:8},verticalAlign:"middle"},shadow:{alwaysVisible:!1,blur:4,color:"#00000018",cornerRadius:0,height:4,whileDragging:t.CLASSIC_DRAGGING_SHADOW_ANIMATION},whenTranslucent:{showStrokeBorder:!1,strokeColor:"#00000028",strokeWidth:2}},drawing:{cornerRadius:0,shadow:{alwaysVisible:!1,blur:4,color:"#00000018",cornerRadius:0,height:4,whileDragging:t.CLASSIC_DRAGGING_SHADOW_ANIMATION},whenTranslucent:{showStrokeBorder:!1,strokeColor:"#00000028",strokeWidth:2}},tableCell:{lineHeightMultiplier:t.CLASSIC_LINE_HEIGHT_MULTIPLIER},textbox:{lineHeightMultiplier:t.CLASSIC_LINE_HEIGHT_MULTIPLIER,padding:{measurementUnit:"font-size-percentage",value:.27}}},minimap:{border:{lineColor:"rgba(136,136,136,1)",lineWidth:1,cornerRadius:0},muralBackground:{color:"white",padding:0},muralBorder:{lineColor:"rgba(136,136,136,1)",lineWidth:1},outsideMural:{color:"white",lineColor:"rgba(204,204,204,1)",lineSpacing:5,lineWidth:1},widget:{lineWidth:1,lineColor:"black"},viewport:{lineWidth:1,cornerRadius:0}}}},4086:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.validateMuralStyleStructure=t.fillPartialMuralStyleWithDefaults=t.replaceUndefinedPropertiesWithDefaultsRecursively=t.CLASSIC_LINE_HEIGHT_MULTIPLIER=void 0;const r=i(3260);var n=i(3260);Object.defineProperty(t,"CLASSIC_LINE_HEIGHT_MULTIPLIER",{enumerable:!0,get:function(){return n.CLASSIC_LINE_HEIGHT_MULTIPLIER}});t.replaceUndefinedPropertiesWithDefaultsRecursively=(e,i)=>{if(void 0===i)return e;if(Array.isArray(e))return e.map(((e,t)=>{var r;return null!==(r=i[t])&&void 0!==r?r:e}));if("object"==typeof e){const r=Object.assign({},i);for(const n of Object.keys(e))r[n]=(0,t.replaceUndefinedPropertiesWithDefaultsRecursively)(e[n],i[n]);return r}return null!=i?i:e};const s={"MuralStyle.widgets.comment.inner.backgroundColor":["hex"],"MuralStyle.widgets.comment.outer.backgroundColor":["hex","blendFactor"],"MuralStyle.widgets.comment.inner.textColor":["hex","blendFactor"]},validateObjectPropertiesStructureRecursively=(e,t,i)=>{if(void 0===i)return!0;if("object"!=typeof i)return!0;let r=!0;for(const n of Object.keys(i)){const a=s[e],o=a&&a.includes(n);n in t||"NOTE"===n||o||(console.error(`Unexpected style parameter "${n}".\nDid you rename a field in "${e}"?`),r=!1),validateObjectPropertiesStructureRecursively(`${e}.${n}`,t[n],i[n])||(r=!1)}return r};t.fillPartialMuralStyleWithDefaults=e=>(0,t.replaceUndefinedPropertiesWithDefaultsRecursively)(r.CLASSIC_MURAL_STYLE,e);t.validateMuralStyleStructure=e=>validateObjectPropertiesStructureRecursively("MuralStyle",r.CLASSIC_MURAL_STYLE,e)},2575:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isColorTranslucent=t.isTransparent=t.white=t.black=t.transparent=t.hasChildren=t.isTableCell=t.isTable=t.isEmbedly=t.isFile=t.isComment=t.isInking=t.isDrawing=t.isGroup=t.isGrid=t.isAreaGrid=t.isArea=t.isPhoto=t.isSticker=t.isFramework=t.isShape=t.isArrow=t.isTitle=t.isText=t.isSticky=t.areArrowLabelsEqual=t.isSolidStroke=t.SOLID_STROKE_PATTERN=t.normalizeStrokeStyle=t.dottedSpacedStroke=t.dashedStroke=t.dottedStroke=t.solidStroke=t.doubleTipArrow=t.singleTipArrow=t.noTipArrow=t.orthogonalArrow=t.curvedArrow=t.straightArrow=void 0,t.straightArrow=0,t.curvedArrow=1,t.orthogonalArrow=2,t.noTipArrow=0,t.singleTipArrow=1,t.doubleTipArrow=2,t.solidStroke="",t.dottedStroke=".",t.dashedStroke="-",t.dottedSpacedStroke=". ";t.normalizeStrokeStyle=e=>"dotted"===e?".":"solid"===e?"":e,t.SOLID_STROKE_PATTERN=[0,0];t.isSolidStroke=e=>0===e[0]&&0===e[1];t.areArrowLabelsEqual=(e,t)=>e.x===t.x&&e.y===t.y&&e.width===t.width&&e.height===t.height&&e.text===t.text;t.isSticky=e=>"murally.widget.TextWidget"===e.type&&"realNote"===e.properties.textType;t.isText=e=>"murally.widget.TextWidget"===e.type;t.isTitle=e=>(0,t.isText)(e)&&("stickyNote"===e.properties.textType||"freeText"===e.properties.textType);t.isArrow=e=>"murally.widget.arrow"===e.type;t.isShape=e=>"murally.widget.ShapeWidget"===e.type;t.isFramework=e=>"murally.widget.StickerWidget"===e.type&&!!e.properties.stickerURL;t.isSticker=e=>"murally.widget.StickerWidget"===e.type&&!!e.properties.name;t.isPhoto=e=>"murally.widget.PhotoWidget"===e.type;t.isArea=e=>"murally.widget.ClusterWidget"===e.type&&!e.properties.group;t.isAreaGrid=e=>"row"===e.properties.layout;t.isGrid=e=>(0,t.isArea)(e)&&(0,t.isAreaGrid)(e);t.isGroup=e=>"murally.widget.ClusterWidget"===e.type&&e.properties.group;t.isDrawing=e=>"murally.widget.DrawWidget"===e.type;t.isInking=e=>"murally.widget.InkingWidget"===e.type;t.isComment=e=>"murally.widget.ThreadWidget"===e.type;t.isFile=e=>"murally.widget.FileWidget"===e.type;t.isEmbedly=e=>"murally.widget.EmbedlyWidget"===e.type;t.isTable=e=>"murally.widget.TableWidget"===e.type;t.isTableCell=e=>"murally.widget.TableCellWidget"===e.type;t.hasChildren=e=>(0,t.isFramework)(e)||(0,t.isArea)(e)||(0,t.isGroup)(e)||(0,t.isTableCell)(e)||(0,t.isTable)(e),t.transparent="transparent",t.black="#000000",t.white="#FFFFFF";t.isTransparent=e=>!e||e===t.transparent||!!e.replace(/ /g,"").match(/rgba\(\d+,\d+,\d+,0\)/);t.isColorTranslucent=e=>{const t=e.trim();if("transparent"===t)return!0;if("#"!=t[0]){const e=t.match(/rgba?\s*?\((?:\s*?[0-9.,]+\s*?,\s*?){3}([0-9.,]+)\s*?\)/);return!!e&&parseFloat(e[1])<1}if(5===t.length){const e=t[3];return"f"!==e&&"F"!==e}if(9===t.length){const e=t[7],i=t[8];return"f"!==e&&"F"!==e||"f"!==i&&"F"!==i}return!1}},3152:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.clamp=t.mapWidgetsIds=t.computeSize=t.degSin=t.degCos=void 0;const i=Math.PI/180;t.degCos=e=>e%360==0?1:Math.cos(e*i);t.degSin=e=>e%360==0?0:Math.sin(e*i);t.computeSize=function computeSize(e){let i=1/0,r=0,n=1/0,s=0;return e.map((e=>{const a=(({x:e,y:i,width:r,height:n,rotation:s})=>{const a=((s||0)%360+360)%360;if(!a)return{minX:e,minY:i,maxX:e+r,maxY:i+n};const o=(0,t.degCos)(a),l=(0,t.degSin)(a),d=[{x:r,y:0},{x:r,y:n},{x:0,y:n}].map((({x:e,y:t})=>({x:o*e-l*t,y:l*e+o*t}))),h=d.map((e=>e.x)),c=d.map((e=>e.y));return{minX:e+Math.min(0,...h),minY:i+Math.min(0,...c),maxX:e+Math.max(0,...h),maxY:i+Math.max(0,...c)}})(e);i=Math.min(i,a.minX),n=Math.min(n,a.minY),r=Math.max(r,a.maxX),s=Math.max(s,a.maxY)})),{offsetX:i,offsetY:n,width:Math.max(0,r-i),height:Math.max(0,s-n)}};t.mapWidgetsIds=(e,t)=>e.map((e=>{const i=Object.assign(Object.assign({},e),{id:t(e.id)});if(i.properties.parentId&&(i.properties=Object.assign(Object.assign({},i.properties),{parentId:t(i.properties.parentId)})),"murally.widget.arrow"===i.type)i.properties=Object.assign(Object.assign({},i.properties),{endRefId:i.properties.endRefId?t(i.properties.endRefId):i.properties.endRefId,startRefId:i.properties.startRefId?t(i.properties.startRefId):i.properties.startRefId});return i})),t.clamp=function clamp(e,t,i){const r=Math.min(t,i),n=Math.max(t,i);return e<r?r:e>n?n:e}},8667:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getAreaHeight=t.getAreaChildrenOffsetX=t.getAreaChildrenOffsetY=void 0;const r=i(6541),n=i(2575),s=i(1106),a=i(9609),o=i(7206),l=i(45),d=i(4424),h="proxima-nova",c=23;t.getAreaChildrenOffsetY=(e,{padding:t,titleOffsetY:i,titlePaddingBottom:s,lineHeightMultiplier:a})=>(0,n.isGrid)(e)?e.properties.showTitle?i+(0,r.getFontMetrics)(h,e.properties.titleFontSize||c,a).lineHeight+s:t:0;t.getAreaChildrenOffsetX=(e,{padding:t})=>(0,n.isGrid)(e)?t:0;t.getAreaHeight=(e,t,i,r,{padding:s})=>(0,n.isGrid)(e)&&i?t+r+s:e.height,t.default=function renderArea({id:e,x:t,y:i,height:u,width:g,rotation:f,stackingOrder:m,properties:v},y,{strokeOverrides:w,cornerRadius:x,boldTitle:b,padding:C,titleOffsetX:A,titleOffsetY:I,shadow:S,lineHeightMultiplier:T}){const{background:_,layout:M,showTitle:O,strokeColor:R,strokeStyle:E,strokeWidth:P,title:L,titleFontSize:k=c}=v,N="row"===M,F=(0,r.getFontMetrics)(h,k,T).lineHeight,B=g-2*C,z=L||"Unnamed area",D=L?"#393939":"#B7B7B7",H=R||"#eaeaea",W=P/2,j=!(0,n.isTransparent)(_),G=(0,s.getStrokePattern)(E,P,w),U=(0,d.drawRectangle)(0,0,g,u,_,n.transparent,0,void 0,void 0,x);return(0,d.drawWidget)(e,v.parentId,t,i,g,u,f,m,[(0,o.drawShadow)(`${e}-shadow`,U,y,S),j?U:d.noop,(0,d.drawHint)(e,"border",(0,d.drawRectangle)(W,W,g-2*W,u-2*W,n.transparent,H,P,G,void 0,Math.max(0,x-W))),y&&!N?(0,a.drawDragOver)(`${e}-drag-over`,g,u,(0,n.isTransparent)(H)?2:P):d.noop,(0,d.drawWidgetsContainer)(e,0,0,g,u),O?(0,d.drawHint)(e,"title",(0,d.drawTextBox)({x:A,y:I,width:B,height:F},k,"left","top",1,(0,l.formatHighlightableText)({fontFamily:b?(0,r.makeBold)(h):(0,r.makeSemiBold)(h),color:D},z),void 0,!0)):d.noop])}},8548:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.renderCurvedArrow=void 0;const r=i(4343),n=i(1159),s=i(7483),a=i(1745),clamp=(e,t,i)=>Math.min(Math.max(e,t),i),quadBbox=(e,t,i)=>{const r=Math.min(e.x,i.x),n=Math.min(e.y,i.y),s=Math.max(e.x,i.x),a=Math.max(e.y,i.y);if(r<=t.x&&t.x<=s&&n<=t.y&&t.y<=a)return{minX:r,minY:n,maxX:s,maxY:a};const o=e.x-2*t.x+i.x,l=e.y-2*t.y+i.y,d=0!==o?clamp((e.x-t.x)/o,0,1):0,h=0!==l?clamp((e.y-t.y)/l,0,1):0,c=1-d,u=1-h,g=c*c*e.x+2*c*d*t.x+d*d*i.x,f=u*u*e.y+2*u*h*t.y+h*h*i.y;return{minX:Math.min(r,g),minY:Math.min(n,f),maxX:Math.max(s,g),maxY:Math.max(a,f)}};t.renderCurvedArrow=(e,t,i)=>{const{points:o}=t.properties;if(2===o.length)return(0,s.renderStraightArrow)(e,t,i);if(o.length<3)return void console.error(`Error: arrow ${t.id} has curved type but not enough points`);const[l,d,h]=o,{c1:c,c2:u,startAngle:g,endAngle:f}=((e,t,i)=>{const r=.25*(i.x-e.x),n=.25*(i.y-e.y),s={x:t.x-r,y:t.y-n},o={x:t.x+r,y:t.y+n};return{c1:s,c2:o,startAngle:(0,a.getArrowRotation)(s,e),endAngle:(0,a.getArrowRotation)(o,i)}})(l,d,h),m=(0,r.maxBoundingBox)(quadBbox(l,c,d),quadBbox(d,u,h)),v={type:"curved-arrow",from:l,to:h,middle:d,c1:c,c2:u,styleOffset:0};return(0,n.drawArrowWidget)(e,t,g,f,m,[v],i)}},1159:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.drawArrowWidget=void 0;const r=i(2575),n=i(1106),s=i(4343),a=i(45),o=i(4424),l=i(1046),d=i(8490),h=i(8394),c=i(5189),drawLabels=(e,t,i)=>t.map(((t,r)=>((e,t,i,r)=>{const n=(0,o.drawTextBox)({x:5,y:0,width:i.width-10,height:i.height},r.fontSize,r.textAlign,"top",0,(0,a.formatHighlightableText)({fontFamily:r.fontFamily,color:r.color,bold:r.bold,italic:r.italic},i.text));return(0,o.drawGroup)(e,i.x,i.y,i.width,i.height,0,[n],void 0,void 0,t,void 0,void 0,void 0,!0)})(`${e}-label-${r}`,`label-${r}`,t,i))),applyArrowLabels=(e,t,i,r,n,s,a,o)=>{const d=e.getHoles(t);if(!(a&&o||d&&0!==d.length))return{cutArrow:s,labelsPrimitives:[]};const h=i/2,c=[];let u=[];if(a&&o){const e=a.map((e=>Object.assign(Object.assign({},e),{x:e.x+r,y:e.y+n}))),i=e.map((e=>({minX:e.x-h,minY:e.y-h,maxX:e.x+e.width+h,maxY:e.y+e.height+h})));c.push(...i),u=drawLabels(t,e,o)}if(d&&d.length>0){const e=d.map((e=>({minX:e.x+r-h,minY:e.y+n-h,maxX:e.x+r+e.width+h,maxY:e.y+n+e.height+h})));c.push(...e)}const g=((e,t)=>({shaftSegments:(0,l.cutHoles)(e.shaftSegments,t),hitSegments:e.hitSegments,tips:e.tips.map(((i,r)=>(0,l.cutHolesInFilled)(i,e.tipsBBoxes[r],t))),tipsBBoxes:e.tipsBBoxes}))(s,c);return{cutArrow:g,labelsPrimitives:u}};t.drawArrowWidget=(e,t,i,a,l,u,g,f)=>{var m,v;const{id:y,x:w,y:x,properties:b}=t,{points:C,strokeColor:A,strokeWidth:I,tip:S,strokeStyle:T}=b,[_]=C,M=C[C.length-1],O=I/2,R=(0,c.renderArrowTips)(S,I,_,i,M,a,g.tip),E=R.map((e=>(0,h.getSegmentsBbox)(e,!0))),P=E.reduce(s.maxBoundingBox,(0,s.padBox)(l,O)),L=-P.minX,k=-P.minY,N=((e,t,i,r)=>({shaftSegments:e,hitSegments:t,tips:i,tipsBBoxes:r}))(u,f,R,E),F=((e,t,i)=>({shaftSegments:e.shaftSegments.map((e=>(0,h.offsetSegment)(e,t,i))),hitSegments:void 0!==e.hitSegments?e.hitSegments.map((e=>(0,h.offsetSegment)(e,t,i))):void 0,tips:e.tips.map((e=>e.map((e=>(0,h.offsetSegment)(e,t,i))))),tipsBBoxes:e.tipsBBoxes.map((e=>(0,s.offsetBox)(e,t,i)))}))(N,L,k),{cutArrow:B,labelsPrimitives:z}=applyArrowLabels(e,y,I,L,k,F,null===(m=b.label)||void 0===m?void 0:m.labels,null===(v=b.label)||void 0===v?void 0:v.format),D=(0,d.renderSegmentsToPath)(F.shaftSegments),H=(0,h.groupSegmentsByContinuity)(B.shaftSegments),W=H.map((e=>({path:(0,d.renderSegmentsToPath)(e),styleOffset:e[0].styleOffset}))),j=(0,n.getStrokePattern)(T,I,g.strokeOverrides),G=((e,t,i,n,s,a)=>{const l=void 0===i?2:4,h=`${e}-hit`,c=(i||[]).map(((e,t)=>(0,o.drawHint)(h,`segment-${t}`,(0,o.drawLine)(e.from.x,e.from.y,e.to.x,e.to.y,"transparent",s,r.SOLID_STROKE_PATTERN,2))));return[...t.map((e=>{if(1===e.length&&"line"===e[0].type){const t=e[0];return(0,o.drawLine)(t.from.x,t.from.y,t.to.x,t.to.y,n,s,a,l,t.styleOffset)}return(0,o.drawPath)((0,d.renderSegmentsToPath)(e),n,s,void 0,void 0,a,"butt","round",l,void 0,e[0].styleOffset)})),...c]})(y,H,B.hitSegments,A,I,j),U=w-L,V=x-k,Y=P.maxX-P.minX,X=P.maxY-P.minY,q=B.tips.map((e=>(0,d.renderSegmentsToPath)(e))),Z=((e,t,i,n)=>[...t.map((e=>(0,o.drawPath)(e,"transparent",0,n,void 0,void 0,"butt",void 0,4))),...i.map(((t,i)=>(0,o.drawGroup)(`${e}-tip-${i}`,t.minX,t.minY,t.maxX-t.minX,t.maxY-t.minY,0,[(0,o.drawRectangle)(0,0,t.maxX-t.minX,t.maxY-t.minY,"transparent","transparent",0,r.SOLID_STROKE_PATTERN,void 0,void 0,0)],void 0,void 0,0===i?"tip-start":"tip-end")))])(y,q,B.tipsBBoxes,A),Q=[...G,...Z,...z],J=((e,t,i,n,s)=>{const a=[...e.map((e=>({path:e.path,strokeWidth:i,strokeColor:n,strokePattern:s,strokeStyleOffset:e.styleOffset}))),...t.map((e=>({path:e,strokeWidth:0,strokeColor:"transparent",strokePattern:r.SOLID_STROKE_PATTERN,backgroundColor:n,strokeStyleOffset:0})))];return a.length>0?a:void 0})(W,q,I,A,j);return(0,o.drawWidget)(y,b.parentId,U,V,Y,X,0,t.stackingOrder,Q,void 0,D,J)}},1345:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.cutHolesInArc=void 0;const r=i(1745),n=i(9618),s=i(4947);t.cutHolesInArc=(e,t)=>{let i=!1;const a=Math.min(e.from.x,e.to.x),o=Math.min(e.from.y,e.to.y),l=Math.max(e.from.x,e.to.x),d=Math.max(e.from.y,e.to.y);for(let e=0;e<t.length;e++){const r=t[e];if(r.maxX>a&&r.maxY>o&&r.minX<l&&r.minY<d){i=!0;break}}if(!i)return n.NO_CLIP;const h=Math.min(Math.max(Math.ceil(e.radius/2),4),10),c=(0,r.generateEvalArc)(e.from.x,e.from.y,e.to.x,e.to.y,e.radius,!!e.sweepFlag),u=(0,s.cutHolesInInterpolated)(h,c,t);if(null===u)return n.NO_CLIP;if(0===u.length)return n.ALL_CLIPPED;const arcLenFromInterval=(t,i)=>Math.abs(t-i)*(Math.PI/2)*e.radius;let g=0,f=0;const m=u.map((t=>{t.fromT>f&&(g+=arcLenFromInterval(t.fromT,f));const i=(0,r.pointBuild)(0,0),n=(0,r.pointBuild)(0,0);c(t.fromT,i),c(t.toT,n);const s={type:"arc-quarter-circle",from:i,to:n,radius:e.radius,sweepFlag:e.sweepFlag,styleOffset:e.styleOffset+g};return g+=arcLenFromInterval(t.fromT,t.toT),f=t.toT,s}));return(0,n.CLIP)(m)}},6129:function(e,t,i){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.cutHolesInBezier=void 0;const n=r(i(5874)),s=i(1745),a=i(9618),o=i(4947);t.cutHolesInBezier=(e,t)=>{if(0===t.length)return a.NO_CLIP;const i=new n.default(e.from,e.c1,e.c2,e.to),r=i.length(),l=Math.min(Math.max(Math.ceil(r/16),10),100),d=(0,s.generateEvalBezier)(e.from.x,e.from.y,e.c1.x,e.c1.y,e.c2.x,e.c2.y,e.to.x,e.to.y),h=(0,o.cutHolesInInterpolated)(l,d,t);if(null===h)return a.NO_CLIP;if(0===h.length)return a.ALL_CLIPPED;let c=0,u=0;const g=h.map((t=>{t.fromT>u&&(c+=((e,t)=>i.split(e,t).length())(u,t.fromT));const r=i.split(t.fromT,t.toT),n={type:"bezier",from:r.points[0],c1:r.points[1],c2:r.points[2],to:r.points[3],styleOffset:e.styleOffset+c};return c+=r.length(),u=t.toT,n}));return(0,a.CLIP)(g)}},5769:function(e,t,i){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.cutHolesInCurvedArrow=void 0;const n=r(i(5874)),s=i(1745),a=i(6129),o=i(9618);t.cutHolesInCurvedArrow=(e,t)=>{if(0===t.length)return o.NO_CLIP;const i=(0,s.getCurvedArrowBeziers)(e),r={type:"bezier",from:i.moveTo,c1:i.cubicBezier1[0],c2:i.cubicBezier1[1],to:i.cubicBezier1[2],styleOffset:0},l=[r,{type:"bezier",from:i.cubicBezier1[2],c1:i.cubicBezier2[0],c2:i.cubicBezier2[1],to:i.cubicBezier2[2],styleOffset:0}],d=[];let h=!1;for(let e=0;e<l.length;e++){const i=l[e],r=(0,a.cutHolesInBezier)(i,t);switch(r.type){case"no-clip":d.push([i]);break;case"all-clipped":h=!0,d.push([]);break;case"clip":h=!0,d.push(r.segments)}}if(!h)return o.NO_CLIP;if(d[0].length+d[1].length===0)return o.ALL_CLIPPED;const c=d[0];if(d[1].length>0){const e=new n.default(r.from,r.c1,r.c2,r.to).length();d[1].forEach((t=>t.styleOffset+=e)),c.push(...d[1])}return(0,o.CLIP)(c)}},9618:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CLIP=t.ALL_CLIPPED=t.NO_CLIP=void 0,t.NO_CLIP={type:"no-clip"},t.ALL_CLIPPED={type:"all-clipped"};t.CLIP=e=>({type:"clip",segments:e})},4947:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.cutHolesInInterpolated=void 0;const r=i(1745),n=i(5930);t.cutHolesInInterpolated=(e,t,i)=>{if(0===i.length)return null;const s=[],a=1/e,o={type:"line",from:(0,r.pointBuild)(0,0),to:(0,r.pointBuild)(0,0),styleOffset:0};let l=null,d=0,h=!1;const endInterval=()=>{l=null},newInterval=(e,t)=>{l={fromT:e,toT:t},s.push(l)},addToInterval=e=>{null===l?newInterval(d,e):l.toT=e},normalizedDistanceToLineFrom=e=>{const t=(0,r.pointDist)(o.from,o.to);return d+(t>0?a*(0,r.pointDist)(o.from,e)/t:0)};t(0,o.from);for(let s=1;s<=e;s++){const a=s/e;t(a,o.to);const l=(0,n.cutHolesInLine)(o,i);switch(l.type){case"all-clipped":endInterval(),h=!0;break;case"no-clip":addToInterval(a);break;case"clip":{h=!0;const e=l.segments;for(let t=0;t<e.length;t++){const i=e[t];(0,r.pointEqual)(i.from,o.from)?addToInterval(normalizedDistanceToLineFrom(i.to)):newInterval(normalizedDistanceToLineFrom(i.from),normalizedDistanceToLineFrom(i.to))}0!==e.length&&(0,r.pointEqual)(e[e.length-1].to,o.to)||endInterval();break}}o.from.x=o.to.x,o.from.y=o.to.y,d=a}return h?s:null}},5930:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.cutHolesInLine=void 0;const r=i(1745),n=i(9618),computeOutCode=(e,t)=>{let i=0;return e.x<t.minX?i|=1:e.x>t.maxX&&(i|=2),e.y<t.minY?i|=4:e.y>t.maxY&&(i|=8),i};t.cutHolesInLine=(e,t)=>{if(0===t.length)return n.NO_CLIP;const i=e.styleOffset,s=e.from,a=e.to;let o=!0;for(let e=0;e<t.length&&o;e++){const i=t[e],r=computeOutCode(s,i),l=computeOutCode(a,i);if(!(r|l))return n.ALL_CLIPPED;r&l||(o=!1)}if(o)return n.NO_CLIP;const l=[];l.push({type:"line",from:(0,r.pointClone)(e.from),to:(0,r.pointClone)(e.to),styleOffset:e.styleOffset});const d=(0,r.pointBuild)(0,0);for(let e=0;e<t.length;e++){const n=t[e];let a=l.length;for(let e=0;e<a;e++){const t=l[e];let o=computeOutCode(t.from,n),h=computeOutCode(t.to,n),c=!0;for(;c;)if(o|h)if(o&h)c=!1;else{d.x=0,d.y=0;const e=h>o?h:o;8&e?(d.x=t.from.x+(t.to.x-t.from.x)*(n.maxY-t.from.y)/(t.to.y-t.from.y),d.y=n.maxY):4&e?(d.x=t.from.x+(t.to.x-t.from.x)*(n.minY-t.from.y)/(t.to.y-t.from.y),d.y=n.minY):2&e?(d.y=t.from.y+(t.to.y-t.from.y)*(n.maxX-t.from.x)/(t.to.x-t.from.x),d.x=n.maxX):1&e&&(d.y=t.from.y+(t.to.y-t.from.y)*(n.minX-t.from.x)/(t.to.x-t.from.x),d.x=n.minX),e===o?(l.push({type:"line",from:(0,r.pointClone)(t.from),to:(0,r.pointClone)(d),styleOffset:i+(0,r.pointDist)(t.from,s)}),t.from.x=d.x,t.from.y=d.y,o=computeOutCode(t.from,n)):(l.push({type:"line",from:(0,r.pointClone)(d),to:(0,r.pointClone)(t.to),styleOffset:i+(0,r.pointDist)(d,s)}),t.to.x=d.x,t.to.y=d.y,h=computeOutCode(t.to,n))}else l.splice(e,1),e--,a--,c=!1}}if(0===l.length)return n.ALL_CLIPPED;l.sort(((e,t)=>{const i=(0,r.pointDist2)(e.from,s),n=(0,r.pointDist2)(t.from,s);return i>n?1:i<n?-1:0}));for(let e=0;e<l.length-1;e++){const t=l[e],i=l[e+1];(0,r.pointEqual)(t.to,i.from)&&(t.to.x=i.to.x,t.to.y=i.to.y,l.splice(e+1,1),e--)}return 1===l.length&&(0,r.pointEqual)(l[0].from,s)&&(0,r.pointEqual)(l[0].to,a)?(l.length=0,n.NO_CLIP):(0,n.CLIP)(l)}},1046:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.cutHolesInFilled=t.cutHoles=t.cutHolesInSegmentSequence=void 0;const r=i(4343),n=i(8394),s=i(1345),a=i(6129),o=i(5769),l=i(9618),d=i(5930);t.cutHolesInSegmentSequence=(e,t)=>{if(0===t.length)return l.NO_CLIP;const i=e.reduce(((e,i)=>{const r=((e,t)=>{switch(e.type){case"line":return(0,d.cutHolesInLine)(e,t);case"bezier":return(0,a.cutHolesInBezier)(e,t);case"curved-arrow":return(0,o.cutHolesInCurvedArrow)(e,t);case"arc-quarter-circle":return(0,s.cutHolesInArc)(e,t)}})(i,t);return((e,t,i)=>{switch(t.type){case"no-clip":return[...i,e];case"all-clipped":return i;case"clip":return[...i,...t.segments]}})(i,r,e)}),[]);return 0===i.length?l.ALL_CLIPPED:((e,t)=>{if(e.length!==t.length)return!1;for(let i=0;i<e.length;++i)if(e[i]!==t[i])return!1;return!0})(e,i)?l.NO_CLIP:(0,l.CLIP)(i)};t.cutHoles=(e,i)=>{const r=(0,t.cutHolesInSegmentSequence)(e,i);switch(r.type){case"all-clipped":return[];case"no-clip":return e;case"clip":return r.segments}};t.cutHolesInFilled=(e,i,s)=>{if(0===s.length)return e;let a;for(const o of s){if(!(0,r.boundingBoxOverlaps)(o,i))continue;const s=(0,t.cutHolesInSegmentSequence)(void 0!==a?a:e,[o]);switch(s.type){case"all-clipped":return[];case"no-clip":break;case"clip":a=s.segments,(0,n.rejoinSegments)(a)}}return void 0!==a?a:e}},3202:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=i(2575),n=i(8548),s=i(7103),a=i(7483);t.default=function renderArrow(e,t,i){switch(t.properties.arrowType){case r.straightArrow:return(0,a.renderStraightArrow)(e,t,i);case r.curvedArrow:return(0,n.renderCurvedArrow)(e,t,i);case r.orthogonalArrow:return(0,s.renderOrthogonalArrow)(e,t,i);default:return}}},7103:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.renderOrthogonalArrow=void 0;const r=i(1159),n=i(1745);t.renderOrthogonalArrow=(e,t,i)=>{const{points:s}=t.properties;if(s.length<2)return void console.error(`Error: arrow ${t.id} has orthogonal type but not enough points`);const a=s[1],o=s[0],l=s[s.length-2],d=s[s.length-1],h=(0,n.getArrowRotation)(a,o),c=(0,n.getArrowRotation)(l,d),u=s.map((e=>e.x)),g=s.map((e=>e.y)),f={maxX:Math.max(...u),maxY:Math.max(...g),minX:Math.min(...u),minY:Math.min(...g)},m=[];for(let e=1;e<s.length;e++){const t=s[e-1],i=s[e];m.push({type:"line",from:t,to:i,styleOffset:0})}const v=(e=>{const t=[];let i=e[0].x,r=e[0].y,s=0;const addLine=(e,a)=>{t.push({type:"line",from:(0,n.pointBuild)(i,r),to:(0,n.pointBuild)(e,a),styleOffset:s}),s+=(0,n.pointLen)(e-i,a-r),i=e,r=a},addCorner=(e,a,o,l)=>{t.push({type:"arc-quarter-circle",from:(0,n.pointBuild)(i,r),to:(0,n.pointBuild)(o,l),radius:e,sweepFlag:a,styleOffset:s}),s+=e*Math.PI/2,i=o,r=l};for(let t=1;t<e.length;t++){const i=e[t-1],r=e[t],n=t+1<e.length,s=1===t,a=t+1===e.length-1;if(!n){addLine(r.x,r.y);continue}const o=e[t+1],l=r.x-i.x,d=r.y-i.y,h=Math.abs(l)-Math.abs(d),c=h>0?Math.sign(l):0,u=h<0?Math.sign(d):0,g=h>0?Math.abs(l):Math.abs(d),f=o.x-r.x,m=o.y-r.y,v=Math.abs(f)-Math.abs(m),y=v>0?Math.sign(f):0,w=v<0?Math.sign(m):0,x=v>0?Math.abs(f):Math.abs(m);if(0===c&&0===u||0===y&&0===w)continue;const b=s?g:g/2,C=a?x:x/2,A=Math.min(6,b,C),I=r.x-c*A,S=r.y-u*A,T=r.x+y*A,_=r.y+w*A;addLine(I,S),addCorner(A,u-y+(c+w)===0?0:1,T,_)}return t})(s);return(0,r.drawArrowWidget)(e,t,h,c,f,v,i,m)}},9533:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseSVGPathIntoSegments=void 0;const r=i(1745);t.parseSVGPathIntoSegments=(e,t,i)=>{const n=e.split(/([A-Z]|[ ]+)/).map((e=>e.trim())).filter((e=>!!e)),s=[];for(let e=0;e<n.length;e++){const t=n[e];/[A-Z]/.test(t)?s.push({instruction:t,args:[]}):s[s.length-1].args.push(parseFloat(t))}const point=(e,n)=>(0,r.pointBuild)(e+t,n+i),a=[];let o=0,l=0;for(const e of s){const t=e.args,expectArgCount=i=>t.length==i||(console.error(`Bad argument length for SVG path instruction ${e.instruction}, actual ${t.length} expected ${i}`),!1);switch(e.instruction){case"M":if(!expectArgCount(2))break;o=t[0],l=t[1];break;case"L":{if(!expectArgCount(2))break;const e=t[0],i=t[1];a.push({type:"line",from:point(o,l),to:point(e,i),styleOffset:0}),o=e,l=i;break}case"C":{if(!expectArgCount(6))break;const e=t[0],i=t[1],r=t[2],n=t[3],s=t[4],d=t[5];a.push({type:"bezier",from:point(o,l),c1:point(e,i),c2:point(r,n),to:point(s,d),styleOffset:0}),o=s,l=d;break}case"Z":if(!expectArgCount(0))break;break;default:console.error(`Skipping unsupported SVG path instruction ${e.instruction}`)}}return a}},8490:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.renderSegmentsToPath=void 0;const r=i(1745),p=({x:e,y:t})=>`${e},${t}`,pa=e=>e.map((e=>p(e))).join(" "),renderMoveToPath=e=>`M ${p(e.from)}`;t.renderSegmentsToPath=e=>{let t="";for(let i=0;i<e.length;i++){const n=e[i];switch(i>0&&(0,r.pointEqual)(e[i-1].to,n.from)||(t.length>0&&(t+=" "),t+=renderMoveToPath(n)),n.type){case"line":t+=` L${p(n.to)}`;break;case"arc-quarter-circle":t+=` A${n.radius},${n.radius}\n          0 0 ${n.sweepFlag} ${p(n.to)}`;break;case"bezier":t+=` C${p(n.c1)} ${p(n.c2)} ${p(n.to)}`;break;case"curved-arrow":{const e=(0,r.getCurvedArrowBeziers)(n);t+=` C${pa(e.cubicBezier1)}\n                  C${pa(e.cubicBezier2)}`;break}}}return t}},8394:function(e,t,i){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.rejoinSegments=t.getSegmentsBbox=t.offsetSegment=t.cloneSegment=t.groupSegmentsByContinuity=void 0;const n=r(i(5874)),s=i(1745);t.groupSegmentsByContinuity=e=>{const t=[];let i=[];for(let r=0;r<e.length;r++){const n=e[r];i.length>0&&(n.from.x!==i[i.length-1].to.x||n.from.y!==i[i.length-1].to.y)&&(t.push(i),i=[]),i.push(n)}return i.length>0&&t.push(i),t};t.cloneSegment=(e,t)=>{const i=Object.assign({},e),r=t?e=>{const i=(0,s.pointClone)(e);return t(i),i}:e=>(0,s.pointClone)(e);switch(i.from=r(i.from),i.to=r(i.to),i.type){case"bezier":i.c1=r(i.c1),i.c2=r(i.c2);break;case"curved-arrow":i.middle=r(i.middle),i.c1=r(i.c1),i.c2=r(i.c2)}return i};t.offsetSegment=(e,i,r)=>(0,t.cloneSegment)(e,(e=>{e.x+=i,e.y+=r}));t.getSegmentsBbox=(e,t=!1)=>{if(0===e.length)return{minX:0,minY:0,maxX:0,maxY:0};let i=e[0].from.x,r=e[0].from.y,a=e[0].from.x,o=e[0].from.y;for(let l=0;l<e.length;l++){const d=e[l];if(i=Math.min(d.from.x,d.to.x,i),r=Math.min(d.from.y,d.to.y,r),a=Math.max(d.from.x,d.to.x,a),o=Math.max(d.from.y,d.to.y,o),!t)switch(d.type){case"bezier":{const e=new n.default(d.from,d.c1,d.c2,d.to).bbox();i=Math.min(i,e.x.min),r=Math.min(r,e.y.min),a=Math.max(a,e.x.max),o=Math.max(o,e.y.max);break}case"curved-arrow":{const e=(0,s.getCurvedArrowBeziers)(d);[new n.default(e.moveTo,e.cubicBezier1[0],e.cubicBezier1[1],e.cubicBezier1[2]),new n.default(e.cubicBezier1[2],e.cubicBezier2[0],e.cubicBezier2[1],e.cubicBezier2[2])].forEach((e=>{const t=e.bbox();i=Math.min(i,t.x.min),r=Math.min(r,t.y.min),a=Math.max(a,t.x.max),o=Math.max(o,t.y.max)}))}}}return{minX:i,minY:r,maxX:a,maxY:o}};t.rejoinSegments=e=>{if(0===e.length)return e;for(let t=0;t<e.length;t++){const i=e[t],r=e[(t+1)%e.length];(0,s.pointEqual)(i.to,r.from)||(e.splice(t+1,0,{type:"line",from:(0,s.pointClone)(i.to),to:(0,s.pointClone)(r.from),styleOffset:i.styleOffset+(0,s.pointDist)(i.to,r.from)}),t++)}return e}},7483:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.renderStraightArrow=void 0;const r=i(1159),n=i(1745);t.renderStraightArrow=(e,t,i)=>{const{points:s}=t.properties;if(s.length<2)return void console.error(`Error: arrow ${t.id} has orthogonal type but not enough points`);const[a]=s,o=s[s.length-1],l=(0,n.getArrowRotation)(o,a),d=(0,n.getArrowRotation)(a,o),h={maxX:Math.max(a.x,o.x),maxY:Math.max(a.y,o.y),minX:Math.min(a.x,o.x),minY:Math.min(a.y,o.y)},c={type:"line",from:a,to:o,styleOffset:0};return(0,r.drawArrowWidget)(e,t,l,d,h,[c],i)}},5189:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.renderArrowTips=void 0;const r=i(2575),n=i(3152),s=i(9533),a=i(8394),o={latex:{scaleAdjust:1/16,segments:(()=>(0,s.parseSVGPathIntoSegments)("M4.042 9.121C4.042 12.121 3.054 14.891 1.406 17.121L22.406 9.121L1.406 1.121C3.054 3.35 4.042 6.113 4.042 9.121Z",-17.6,-9.1))()},"rounded-triangle":{scaleAdjust:1/18,segments:(()=>(0,s.parseSVGPathIntoSegments)("M13.6708 8.15585C14.2893 8.54867 14.2893 9.45133 13.6708 9.84415L1.53611 17.5507C0.870344 17.9735 1.05518e-06 17.4953 1.08966e-06 16.7066L1.76339e-06 1.29343C1.79786e-06 0.504749 0.870344 0.0264618 1.53611 0.449279L13.6708 8.15585Z",-5,-9))()}},drawArrowTip=(e,t,i,r,s)=>{const l=o[s.shape],d=l.scaleAdjust*(s.sizeBasePixelGrowth+r*s.sizeScaledFromStrokeWidth),h=(0,n.degCos)(i),c=(0,n.degSin)(i);return l.segments.map((i=>(0,a.cloneSegment)(i,(i=>{i.x*=d,i.y*=d;const r=i.x*h-i.y*c,n=i.x*c+i.y*h;i.x=r,i.y=n,i.x+=e,i.y+=t}))))};t.renderArrowTips=(e,t,i,n,s,a,o)=>{const l=[];return e!==r.singleTipArrow&&e!==r.doubleTipArrow||l.push(drawArrowTip(i.x,i.y,n,t,o)),e===r.doubleTipArrow&&l.push(drawArrowTip(s.x,s.y,a,t,o)),l}},1745:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.generateEvalArc=t.generateEvalBezier=t.getCurvedArrowBeziers=t.pointEqual=t.pointDist2=t.pointDist=t.pointLen2=t.pointLen=t.pointClone=t.pointBuild=t.padPoint=t.getArrowRotation=t.debugDrawBbox=void 0;const r=i(4424);t.debugDrawBbox=(e,t=!1)=>(0,r.drawRectangle)(t?0:e.minX,t?0:e.minY,e.maxX-e.minX,e.maxY-e.minY,"transparent",t?"blue":"red",1);t.getArrowRotation=(e,t)=>180*Math.atan2(t.y-e.y,t.x-e.x)/Math.PI%360;t.padPoint=(e,t)=>i=>({x:i.x+e,y:i.y+t});t.pointBuild=(e,t)=>({x:e,y:t});t.pointClone=e=>({x:e.x,y:e.y});t.pointLen=(e,t)=>Math.sqrt(e*e+t*t);t.pointLen2=(e,t)=>e*e+t*t;t.pointDist=(e,i)=>(0,t.pointLen)(e.x-i.x,e.y-i.y);t.pointDist2=(e,i)=>(0,t.pointLen2)(e.x-i.x,e.y-i.y);t.pointEqual=(e,t)=>e.x===t.x&&e.y===t.y;const quad2cub=(e,t,i)=>[e,{x:e.x+2/3*(t.x-e.x),y:e.y+2/3*(t.y-e.y)},{x:i.x+2/3*(t.x-i.x),y:i.y+2/3*(t.y-i.y)},i];t.getCurvedArrowBeziers=e=>{const t=[e.from,e.c1,e.middle],i=[e.middle,e.c2,e.to],r=quad2cub(t[0],t[1],t[2]),n=quad2cub(i[0],i[1],i[2]);return{moveTo:r[0],cubicBezier1:[r[1],r[2],r[3]],cubicBezier2:[n[1],n[2],n[3]]}};t.generateEvalBezier=(e,t,i,r,n,s,a,o)=>(l,d)=>{const h=1-l,c=l*l,u=h*h,g=u*h,f=3*l*u,m=3*h*c,v=c*l;d.x=g*e+f*i+m*n+v*a,d.y=g*t+f*r+m*s+v*o};const angleBetween=(e,t,i,r)=>{const n=e*i+t*r,s=Math.sqrt((e*e+t*t)*(i*i+r*r));return(e*r-t*i<0?-1:1)*Math.acos(n/s)};t.generateEvalArc=(e,t,i,r,n,s)=>{if(e===i&&t===r)return(i,r)=>{r.x=e,r.y=t};if(0===n)return(n,s)=>{s.x=e+(i-e)*n,s.y=t+(r-t)*n};const a=(e-i)/2,o=(t-r)/2,l=a*a,d=o*o,h=l/(n*n)+d/(n*n);h>1&&(n=Math.sqrt(h)*n);const c=n*n,u=c*c-c*d-c*l,g=c*d+c*l,f=Math.max(u/g,0),m=(s?1:-1)*Math.sqrt(f),v=m*o,y=m*-a,w=v+(e+i)/2,x=y+(t+r)/2,b=(a-v)/n,C=(o-y)/n,A=angleBetween(1,0,b,C);let I=angleBetween(b,C,(-a-v)/n,(-o-y)/n);return!s&&I>0?I-=2*Math.PI:s&&I<0&&(I+=2*Math.PI),I%=2*Math.PI,(s,a)=>{if(s<=0)return a.x=e,void(a.y=t);if(s>=1)return a.x=i,void(a.y=r);const o=A+I*s;a.x=w+n*Math.cos(o),a.y=x+n*Math.sin(o)}}},4343:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.computeWidgetsBoundingBox=t.computeBoundingBox=t.mergeBoundingBoxes=t.boundingBoxOverlaps=t.maxBoundingBox=t.offsetBox=t.padBox=t.computeGroupBoundingBox=void 0;const r=i(1033),n=Math.PI/180;t.computeGroupBoundingBox=({x:e,y:t,width:i,height:r,scale:s,rotation:a,border:o})=>{const l=((a||0)%360+360)%360,d=o*s;if(!l)return{minX:e-d,minY:t-d,maxX:e+i*s+d,maxY:t+r*s+d};const h=(e=>Math.cos(e*n))(l),c=(e=>Math.sin(e*n))(l),u=[{x:-d,y:-d},{x:i*s+d,y:-d},{x:i*s+d,y:r*s+d},{x:-d,y:r*s+d}].map((({x:e,y:t})=>({x:h*e-c*t,y:c*e+h*t}))),g=u.map((e=>e.x)),f=u.map((e=>e.y));return{minX:e+Math.min(0,...g),minY:t+Math.min(0,...f),maxX:e+Math.max(0,...g),maxY:t+Math.max(0,...f)}};t.padBox=({maxX:e,maxY:t,minX:i,minY:r},n)=>({maxX:e+n,maxY:t+n,minX:i-n,minY:r-n});t.offsetBox=({maxX:e,maxY:t,minX:i,minY:r},n,s)=>({maxX:e+n,maxY:t+s,minX:i+n,minY:r+s});t.maxBoundingBox=(e,t)=>({maxX:Math.max(e.maxX,t.maxX),maxY:Math.max(e.maxY,t.maxY),minX:Math.min(e.minX,t.minX),minY:Math.min(e.minY,t.minY)});t.boundingBoxOverlaps=(e,t)=>!!e&&!!t&&e.minX<=t.maxX&&t.minX<=e.maxX&&e.minY<=t.maxY&&t.minY<=e.maxY;t.mergeBoundingBoxes=(e,i)=>e&&i?(0,t.maxBoundingBox)(e,i):e||i;t.computeBoundingBox=e=>e.reduce(((e,i)=>(0,t.mergeBoundingBoxes)(e,"Group"===i.type?(0,t.computeGroupBoundingBox)(i):"WidgetPrimitive"===i.type?(0,t.computeGroupBoundingBox)(Object.assign(Object.assign({},i),{scale:1})):void 0)),void 0);t.computeWidgetsBoundingBox=(e,i)=>e.reduce(((e,n)=>(0,t.mergeBoundingBoxes)(e,(0,t.computeGroupBoundingBox)(Object.assign(Object.assign({},n),{scale:1,border:(0,r.getWidgetBorder)(n,i),rotation:n.rotation||0})))),void 0)},1033:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getWidgetBorder=void 0;const r=i(2575),n=i(9563),s=i(1043);t.getWidgetBorder=(e,t)=>(0,r.isShape)(e)?(0,s.getShapeWidgetBorder)(e):(0,r.isPhoto)(e)?(0,n.getPhotoWidgetBorder)(e,t.image):0},8018:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.padBox=t.padBox2=t.box=void 0;t.box=(e,t)=>({width:e,height:t,x:0,y:0});t.padBox2=(e,t)=>({x:i,y:r,width:n,height:s})=>({x:i+e,y:r+t,width:n-2*e,height:s-2*t});t.padBox=e=>(0,t.padBox2)(e,e)},4191:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.renderCommentClassic=void 0;const r=i(2575),n=i(45),s=i(4424),a=i(7232),o=46,group=(e,t,i,r,n)=>(0,s.drawGroup)(e,0,0,o,o,0,t,void 0,void 0,i,r,void 0,void 0,n),border=(e,t)=>{const i="outwards"===e.growth?1:"inwards"===e.growth?-1:0,n=null!=t?t:i*e.strokeWidth;return(0,s.drawEllipse)(-n/2,-n/2,o+n,o+n,"transparent",e.color,e.strokeWidth,r.SOLID_STROKE_PATTERN)},unreadGlow=e=>(0,s.drawGroup)(e,-25,-25,96,96,0,[],void 0,void 0,"_unread"),common=(e,t,i)=>[(0,s.drawEllipse)(1.5,1.5,43,43,"transparent",e.outer,3,r.SOLID_STROKE_PATTERN,void 0,.9),(0,s.drawEllipse)(3,3,40,40,e.inner,"transparent",0,r.SOLID_STROKE_PATTERN,void 0,.9),i?(0,s.drawEllipse)(.5,.5,45,45,"transparent","#B0B0B0",1,r.SOLID_STROKE_PATTERN):s.noop,(0,s.drawTextBox)({x:0,y:0,width:o,height:o},16,"center","middle",1,(0,n.formatText)({color:e.text,fontFamily:"proxima-nova"},`${(0,a.getCommentReplyCount)(t)+1}`))],drawComment=(e,t,i)=>group(e,common(t,i,!0),"comment"),drawSelectedComment=(e,t,i,r)=>group(e,[...common(t,i,!1),border(r.selectedBorder,1)],"comment","selected"),drawUnreadComment=(e,t,i,r)=>group(e,[unreadGlow(`${e}-glow`),group(`${e}-unread-circle`,[...common(t,i,!1),border(r.unreadBorder)],"_unread_circle")],"comment","unread",!0);t.renderCommentClassic=(e,t)=>{const{id:i,x:r,y:n,rotation:l,owner:d,properties:h,stackingOrder:c}=e,u=r-1,g=n-1,f=(0,a.getCommentColors)(d,t);return(0,s.drawWidget)(i,h.parentId,u,g,o,o,l,c,[group(`${i}-scale-container`,[drawComment(i+"-comment",f,h.replies),drawUnreadComment(i+"-unread",f,h.replies,t),drawSelectedComment(i+"-selected",f,h.replies,t)],"comment","scale")])}},7232:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getCommentColors=t.getCommentReplyCount=void 0;const r=i(6916),n="default";t.getCommentReplyCount=e=>e.reduce(((e,t,i,r)=>0===i||t.user!==r[i-1].user?e+1:e),0);t.getCommentColors=(e,t)=>{const i="user"===t.inner.backgroundColor.type?(0,r.colorForUser)(e):t.inner.backgroundColor.hex,s="black"===(0,r.getContrastYIQ)(i);return{inner:i,outer:"blend-to-contrast"===t.outer.backgroundColor.type?s?(0,r.darkenHex)(i,t.outer.backgroundColor.blendFactor,n):(0,r.lightenHex)(i,t.outer.backgroundColor.blendFactor):t.outer.backgroundColor.hex,text:"blend-to-contrast"===t.inner.textColor.type?s?(0,r.darkenHex)(i,t.inner.textColor.blendFactor,n):(0,r.lightenHex)(i,t.inner.textColor.blendFactor):t.inner.textColor.hex}}},2794:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.renderCommentHana=void 0;const r=i(2575),n=i(45),s=i(4424),a=i(7232),o=48,l=24,group=(e,t,i,r)=>(0,s.drawGroup)(e,0,0,o,o,0,t,void 0,void 0,i,r),unreadGlow=e=>(0,s.drawGroup)(e,-23,-23,94,94,0,[],void 0,void 0,"_unread"),innerBorder=(e,t)=>{const i=("outwards"===e.growth?1:"inwards"===e.growth?-1:0)*e.strokeWidth;return(0,s.drawEllipse)(-i/2+4,-i/2+4,40+i,40+i,"transparent",t,e.strokeWidth,r.SOLID_STROKE_PATTERN)},drawComment=(e,t,i)=>group(e,((e,t,i)=>[(0,s.drawEllipse)(0,0,o,o,t.outer,"transparent",0),(0,s.drawGroup)(e+"-diamond",24,24,l,l,45,[(0,s.drawRectangle)(0,0,l,l,t.outer,"transparent",0,void 0,void 0,4)]),(0,s.drawEllipse)(4,4,40,40,t.inner,"transparent",0,r.SOLID_STROKE_PATTERN,void 0),(0,s.drawTextBox)({x:0,y:0,width:o,height:o},16,"center","middle",1,(0,n.formatText)({color:t.text,fontFamily:"proxima-nova",bold:!0},`${(0,a.getCommentReplyCount)(i)+1}`))])(e,t,i),"comment"),drawSelectedCommentFauxBorder=(e,t)=>{const i=2*t.selectedBorder.strokeWidth,r=t.selectedBorder.strokeWidth,n=t.selectedBorder.color;return group(e,[(0,s.drawEllipse)(0,0,o,o,n,n,i),(0,s.drawGroup)(e+"-selected-diamond",24,24,l,l,45,[(0,s.drawRectangle)(0,0,l,l,n,n,i,void 0,void 0,4)]),(0,s.drawEllipse)(0,0,o,o,"#FFFFFF","#FFFFFF",r),(0,s.drawGroup)(e+"-selected-diamond-inner",24,24,l,l,45,[(0,s.drawRectangle)(0,0,l,l,"#FFFFFF","#FFFFFF",r,void 0,void 0,4)])],"comment","selected")},drawUnreadCommentRing=(e,t,i)=>group(e,[unreadGlow(`${e}-glow`),group(`${e}-unread-circle`,[innerBorder(t.unreadBorder,i)],"_unread_circle")],"comment","unread");t.renderCommentHana=({id:e,x:t,y:i,rotation:r,owner:n,properties:l,stackingOrder:d},h)=>{const c=(0,a.getCommentColors)(n,h);return(0,s.drawWidget)(e,l.parentId,t,i,o,o,r,d,[group(`${e}-scale-container`,[drawSelectedCommentFauxBorder(e+"-selected",h),drawComment(e+"-comment",c,l.replies),drawUnreadCommentRing(e+"-unread",h,c.text)],"comment","scale")])}},718:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=i(4191),n=i(2794);t.default=function renderComment(e,t,i){if(t)return"hana"===i.mode?(0,n.renderCommentHana)(e,i):(0,r.renderCommentClassic)(e,i)}},3923:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ICON_PATHS_HOVER=t.ICON_PATHS=void 0,t.ICON_PATHS={export:{source:"data:image/png;base64,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",type:"image",actionScale:1,width:8.5},github:{source:"M7.99297466,0 C3.57967577,0 0,3.57967577 0,7.99297466 C0,11.5236138 2.30472275,14.5148497 5.44306863,15.5936561 C5.83536187,15.6426927 5.98247183,15.3975095 5.98247183,15.2013628 C5.98247183,15.0052162 5.98247183,14.5148497 5.98247183,13.8283365 C3.77582238,14.3187031 3.28545584,12.7495301 3.28545584,12.7495301 C2.94219926,11.8178337 2.40279606,11.5726504 2.40279606,11.5726504 C1.66724625,11.0822839 2.45183272,11.0822839 2.45183272,11.0822839 C3.23641919,11.1313205 3.67774908,11.915907 3.67774908,11.915907 C4.41329889,13.1418234 5.54114194,12.7985668 5.98247183,12.6024202 C6.03150848,12.063017 6.27669176,11.7197604 6.47283837,11.5236138 C4.70751882,11.3274672 2.84412595,10.640954 2.84412595,7.55164477 C2.84412595,6.66898499 3.13834588,5.98247183 3.67774908,5.39403198 C3.62871242,5.24692201 3.3344925,4.41329889 3.77582238,3.3344925 C3.77582238,3.3344925 4.46233555,3.13834588 5.98247183,4.16811562 C6.61994834,3.971969 7.3064615,3.92293235 7.99297466,3.92293235 C8.67948782,3.92293235 9.36600098,4.02100566 10.0034775,4.16811562 C11.5236138,3.13834588 12.2101269,3.3344925 12.2101269,3.3344925 C12.6514568,4.41329889 12.3572369,5.24692201 12.3082002,5.44306863 C12.7985668,5.98247183 13.1418234,6.71802164 13.1418234,7.60068142 C13.1418234,10.6899906 11.2784305,11.3274672 9.51311094,11.5236138 C9.80733087,11.768797 10.0525141,12.2591636 10.0525141,12.9947134 C10.0525141,14.0735198 10.0525141,14.9071429 10.0525141,15.2013628 C10.0525141,15.3975095 10.1996241,15.6426927 10.5919173,15.5936561 C13.7792999,14.5148497 16.034986,11.5236138 16.034986,7.99297466 C15.9859493,3.57967577 12.4062735,0 7.99297466,0 Z",type:"path",actionScale:.75,width:13},jira:{source:"data:image/png;base64,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",type:"image",actionScale:1,width:13},edit:{source:"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZlcnNpb249IjEuMSIgeD0iMHB4IiB5PSIwcHgiIHZpZXdCb3g9IjAgMCA1MCA1MCI+ICA8cGF0aCBmaWxsPSIjODg4ODg4IiBkPSJNMTAuODc3LDI3LjgxNEwzOC42OTUsMEw1MCwxMS4zMTJMMjIuMTkzLDM5LjEyNUwxMC44NzcsMjcuODE0eiIgLz4gIDxwb2x5Z29uIGZpbGw9IiM4ODg4ODgiIHBvaW50cz0iOC4xMDIsMzAuNTkgNC4xMjcsNDUuODc3IDE5LjQxMiw0MS45MDQgIi8+PC9zdmc+",type:"image",actionScale:1,width:18},editHover:{source:"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZlcnNpb249IjEuMSIgeD0iMHB4IiB5PSIwcHgiIHZpZXdCb3g9IjAgMCA1MCA1MCI+ICA8cGF0aCBmaWxsPSIjMzkzOTM5IiBkPSJNMTAuODc3LDI3LjgxNEwzOC42OTUsMEw1MCwxMS4zMTJMMjIuMTkzLDM5LjEyNUwxMC44NzcsMjcuODE0eiIgLz4gIDxwb2x5Z29uIGZpbGw9IiMzOTM5MzkiIHBvaW50cz0iOC4xMDIsMzAuNTkgNC4xMjcsNDUuODc3IDE5LjQxMiw0MS45MDQgIi8+PC9zdmc+",type:"image",actionScale:1,width:18}},t.ICON_PATHS_HOVER={export:{source:"data:image/png;base64,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",type:"image",actionScale:1,width:8.5},github:{source:"M7.99297466,0 C3.57967577,0 0,3.57967577 0,7.99297466 C0,11.5236138 2.30472275,14.5148497 5.44306863,15.5936561 C5.83536187,15.6426927 5.98247183,15.3975095 5.98247183,15.2013628 C5.98247183,15.0052162 5.98247183,14.5148497 5.98247183,13.8283365 C3.77582238,14.3187031 3.28545584,12.7495301 3.28545584,12.7495301 C2.94219926,11.8178337 2.40279606,11.5726504 2.40279606,11.5726504 C1.66724625,11.0822839 2.45183272,11.0822839 2.45183272,11.0822839 C3.23641919,11.1313205 3.67774908,11.915907 3.67774908,11.915907 C4.41329889,13.1418234 5.54114194,12.7985668 5.98247183,12.6024202 C6.03150848,12.063017 6.27669176,11.7197604 6.47283837,11.5236138 C4.70751882,11.3274672 2.84412595,10.640954 2.84412595,7.55164477 C2.84412595,6.66898499 3.13834588,5.98247183 3.67774908,5.39403198 C3.62871242,5.24692201 3.3344925,4.41329889 3.77582238,3.3344925 C3.77582238,3.3344925 4.46233555,3.13834588 5.98247183,4.16811562 C6.61994834,3.971969 7.3064615,3.92293235 7.99297466,3.92293235 C8.67948782,3.92293235 9.36600098,4.02100566 10.0034775,4.16811562 C11.5236138,3.13834588 12.2101269,3.3344925 12.2101269,3.3344925 C12.6514568,4.41329889 12.3572369,5.24692201 12.3082002,5.44306863 C12.7985668,5.98247183 13.1418234,6.71802164 13.1418234,7.60068142 C13.1418234,10.6899906 11.2784305,11.3274672 9.51311094,11.5236138 C9.80733087,11.768797 10.0525141,12.2591636 10.0525141,12.9947134 C10.0525141,14.0735198 10.0525141,14.9071429 10.0525141,15.2013628 C10.0525141,15.3975095 10.1996241,15.6426927 10.5919173,15.5936561 C13.7792999,14.5148497 16.034986,11.5236138 16.034986,7.99297466 C15.9859493,3.57967577 12.4062735,0 7.99297466,0 Z",type:"path",actionScale:.75,width:13},jira:{source:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAS2SURBVHgB7VpLjhRHEH2F59NtyzJL72i89MYgr7zyeOGlZXMAy9zAPsLgE8AJPJwAW/Ke4gIwSGxYMRwAMQgJhuFTxFNF0FFBdlXPTFYXmqknhbKyPlkZryIjX2Y3MGLEiBEjRowYsWJUVTWr+sUjsa2ufhQYCNK581I8Rb/YK4riYtsN5zAQpGP7UuxhYAxGgOI/DIyhCbiOgTEoATIM9qS4gQExdAQQ2xgwFwxOgCbDnzAQCZ9CBNhQIAk3cdZB8SJ2u8qDR13vG0wIdUGF0iWxWeLyr2K/oRudQmgNGSGdZqe+c6dI8Fux12Jv1F67ejyO5YHYAzat7dGhJ/KeGZYjoBNZCRD8KPYnascrVx6KvQz2IlE/cOetPFBjO9+L8/8jI3IT8BhN56HlRrivWvB8EcpzaJL4TuxrZERuAkotY25hfTNc82WBdD4qwvEBMuetrATI+NyVEC3lcGvBLYyERQ5YVLQ5aETtIxNyRwDBuXzL1f1wIPxw8F8+RkEqKlhfR0bRlJ0AiYIdiYI/MCch9UU3wrUqcZ/PE54MElAiE/qIAOKK2D2xC5gnMaDp5Hp4Jt63KC+sUT53DLWl0YsUDvrevq530MBImIp9rvaF1qfhvD9nxF1DBvS2FqC+F/tGDv9Gk4gPt2hJh7qc9ufWtf0SGZbSfQ2BD5CObku47qAOV0rYmRqlrpHCfkyXbNIPnW3U4usSjoneCSB0tbejloSQRJFDElKZ39uaa5e5gEPtFo6ZDzoJ4JLKVdnJV6gFiZepqWOTuFRwLxL3sa3nYnfFkYfavv+6i/RAI3lavpFu/oVahs9wBCwTAXuuUa/orF6hmdxiokslP4IkfCn2gy5bfU5I6QGz9URbJIL7i9elrauYD7Xz6MAyBOyiySoTp5FgzvsOV+EaQt2fIwkbaJJaoT0ntPaZOgQtQ+1IjSlK1EtPv7ozEryzyf6446gFjIxDrTOUv0Kzb5YT2vTDibAMATdRZ1sLJ79Sm7j7YqhH59uGCbGP+cxg+Cy8g8hKQKcO0CSTEh0WCRM1m7OtvulsEq5NwnMk607q9ZhHgmmBrDPXUkJIE0wZT7s2zGHv6DTYZEG5qW2Vod1UJHglmAVHUYLU97t6HBOd5QT/xdss3kOn/8V8mevzjYEkDEeA0/c38PGmBmFfKeVkDP9pOC60/e0Fr6/cO1Y/BAzspBgFx2XUXyxOgT5UY06IzvtrhbZPckukd42A9LL5RDgWm9z5keKK27rmTrCfJbgT/K3Yz4nH44wQpzkOtduY6/u4v5gVJwonDdsSiQ0KIed3KX5B0+HU9Nf4qtrmZXmeidfvMAM9ENDnT2N+OCwaBmYf9UOH2kXUOsRHSYWM6Hs1SBK8YiSW/oq6iryqCx0baveREatYDvMdUc3FdUErKW1D7aTok4Cn4T1GQsrxwX6l7pMAhqpPcCldD/QwtR0FvRHA8Stj9xnqFV7h3mc5IbU/uHL0HXqcymwas5JSNi6WTi0BnMKYwLyQ8SSYWjydBOg0dk2rcffISJhgQAJWAskF/7T8jeVQ7AJOOyhtufUdnLf6DGcB3LGt6n9xR8xwlqBE3BK7dyYJGDFixIgRI0Z8EngPs0RKfkKA7ZoAAAAASUVORK5CYII=",type:"image",actionScale:1,width:13},edit:{source:"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZlcnNpb249IjEuMSIgeD0iMHB4IiB5PSIwcHgiIHZpZXdCb3g9IjAgMCAxMDAgOTkuOTk5IiBlbmFibGUtYmFja2dyb3VuZD0ibmV3IDAgMCAxMDAgOTkuOTk5Ij4JPGc+CQk8cGF0aCBmaWxsPSIjMzkzOTM5IiBkPSJNMzUuODc3LDUyLjgxNEw2My42OTUsMjVMNzUsMzYuMzEyTDQ3LjE5Myw2NC4xMjVMMzUuODc3LDUyLjgxNHoiPgkJPC9wYXRoPgk8L2c+CTxwb2x5Z29uIGZpbGw9IiMzOTM5MzkiIHBvaW50cz0iMzMuMTAyLDU1LjU5IDI5LjEyNyw3MC44NzcgNDQuNDEyLDY2LjkwNCAiPgk8L3BvbHlnb24+PC9zdmc+",type:"image",actionScale:1.75,width:14}}},6891:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=i(2575),n=i(7770),s=i(7206),a=i(7784),o=i(4424);t.default=function renderDrawing({id:e,x:t,y:i,width:l,height:d,rotation:h,stackingOrder:c,properties:u},g,f){const m=u.border||!(0,r.isTransparent)(u.color),v=u.border?{height:d-3,width:l-3}:{height:d,width:l},y=Math.max(v.width/u.originalWidth,v.height/u.originalHeight),w={newSize:v,originalSize:{width:u.originalWidth,height:u.originalHeight},clipBorder:0},x=(0,o.drawRectangle)(0,0,v.width,v.height,u.color,u.border?r.black:r.transparent,u.border?3:0,r.SOLID_STROKE_PATTERN,void 0,f.cornerRadius),b=(0,r.isColorTranslucent)(u.color);return(0,o.drawWidget)(e,u.parentId,t,i,l,d,h,c,[(0,o.drawGroup)(`${e}-content`,u.border?1.5:0,u.border?1.5:0,v.width,v.height,0,[g?(0,n.drawHighlight)(`${e}-highlight`,x):o.noop,(0,s.drawShadow)(`${e}-shadow`,x,g,f.shadow),m?x:o.noop,b?(0,a.translucentRectangleBorder)(`${e}-translucent-border`,x,f):o.noop,(0,o.drawGroup)(`${e}-content-path`,0,0,v.width,v.height,0,[u.filledPath?(0,o.drawPath)(u.filledPath,u.strokeColor,0,u.strokeColor,w,void 0,"round","round"):o.noop,(0,o.drawPath)(u.path,u.strokeColor,u.strokeWidth*y,u.filled?u.strokeColor:r.transparent,w,void 0,"round","round")],void 0,void 0,"path")])])}},1654:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ArrowLabelOverlapHolesEffect=void 0;const r=i(2575),n=i(8921),s=i(4468),a=i(6782);t.ArrowLabelOverlapHolesEffect=class ArrowLabelOverlapHolesEffect{constructor(){this._overlapDetection=new n.ArrowLabelOverlapDetection,this._hierarchyCache=new s.HierarchyCache(r.isArrow)}apply(e){let t=e;if(t.toRemove){const e=this.onDelete(t.toRemove);t=(0,a.addReparseToOperations)(t,e)}if(t.toAddOrUpdate){const e=this.onUpdate(t.toAddOrUpdate);t=(0,a.addReparseToOperations)(t,e)}return t}onUpdate(e){const t=this._hierarchyCache.updateHierarchyReturnElementsInsideUpdatedParents(e),i=[],n=[];e.forEach((e=>{(0,r.isArrow)(e)?i.push(e):n.push(e)}));const s=i.concat(t).map((e=>{const{x:t,y:i}=this._hierarchyCache.absolutePosition(e.id);return{arrow:e,arrowAbsX:t,arrowAbsY:i}}));return[...this._overlapDetection.setArrowsAndGetModified(s)].map((e=>e.id))}onDelete(e){this._hierarchyCache.delete(e);return[...this._overlapDetection.deleteAndGetModified(e)].map((e=>e.id))}getHoles(e){const t=this._overlapDetection.getNotOwnedOverlappingLabelProxies(e);if(void 0===t||0===t.size)return;const{x:i,y:r}=this._hierarchyCache.absolutePosition(e),n=[];for(const s of t){if(!s.alive||s.group.id===e)continue;const t={x:s.x-i,y:s.y-r,width:s.x1-s.x,height:s.y1-s.y};n.push(t)}return n}}},51:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WidgetsEffectComposite=void 0;t.WidgetsEffectComposite=class WidgetsEffectComposite{constructor(e){this.effects=e}apply(e){let t=e;for(const e of this.effects)t=e.apply(t);return t}}},9412:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FixGridEffect=void 0;const r=i(2575),n=i(1106),s=i(8667),a=i(4343),o=i(3041),l=i(6782);t.FixGridEffect=class FixGridEffect{constructor(e){this.knownWidgets=new Map,this.knownGrids=new Set,this.childrenIdsByParentId=new Map,this.containerIdByWidgetId=new Map,this.widgetsStyle=e}apply(e){let t=e;if(t.toAddOrUpdate){const e=this.onAddOrUpdate(t.toAddOrUpdate);t=(0,l.addAddOrUpdateToOperations)(t,e,"prioritize-added")}if(t.toRemove){const e=this.onDelete(t.toRemove);t=(0,l.addAddOrUpdateToOperations)(t,e,"prioritize-added")}return t}onAddOrUpdate(e){const t=new Set,i=[];for(const t of e)this.knownWidgets.set(t.id,t);for(const s of e){const e=(0,r.hasChildren)(s),a=this.knownGrids.has(s.id);if(e){if(this.addContainer(s.id),(0,r.isGrid)(s))a||this.knownGrids.add(s.id);else if(a){this.knownGrids.delete(s.id);const e=this.childrenIdsByParentId.get(s.id);e&&i.push(...e.map((e=>this.knownWidgets.get(e))).filter(n.isNotNil))}this.knownGrids.has(s.id)&&t.add(s.id)}const o=this.containerIdByWidgetId.get(s.id)||null,l=s.properties.parentId;o!==l?(o&&(this.deleteWidgetFromContainer(s.id),this.knownGrids.has(o)&&t.add(o)),l&&(this.addWidgetToContainer(l,s),this.knownGrids.has(l)&&t.add(l))):o&&(this.knownWidgets.set(s.id,s),this.knownGrids.has(o)&&t.add(o))}if(0===t.size&&0===i.length)return[];const s=this.buildUpdatedWidgets(t);return[...i,...s]}buildUpdatedWidgets(e){const t=[];return e.forEach((e=>{const i=this.buildUpdatedGrid(e);t.push(...i)})),t}buildUpdatedGrid(e){const t=this.knownWidgets.get(e);if(!t||!(0,r.isGrid)(t))return[];const i=(this.childrenIdsByParentId.get(e)||[]).map((e=>this.knownWidgets.get(e))).filter(n.isNotNil),l=(0,o.computeGrid)(t.width,i),d=(0,s.getAreaChildrenOffsetX)(t,this.widgetsStyle.area),h=(0,s.getAreaChildrenOffsetY)(t,this.widgetsStyle.area),c=(0,a.computeWidgetsBoundingBox)(l,this.widgetsStyle),u=(0,s.getAreaHeight)(t,h,l.length>0,c?c.maxY-c.minY:0,this.widgetsStyle.area);return[Object.assign(Object.assign({},t),{height:u}),...l.map((e=>Object.assign(Object.assign({},e),{x:e.x+d,y:e.y+h})))]}addContainer(e){this.childrenIdsByParentId.has(e)||this.childrenIdsByParentId.set(e,[])}deleteContainer(e){const t=this.childrenIdsByParentId.get(e);t&&(this.childrenIdsByParentId.delete(e),t.forEach((e=>this.containerIdByWidgetId.delete(e))),this.knownGrids.delete(e))}addWidgetToContainer(e,t){const i=this.childrenIdsByParentId.get(e),r=i||[];i||this.childrenIdsByParentId.set(e,r),this.containerIdByWidgetId.set(t.id,e),r.push(t.id),this.knownWidgets.set(t.id,t)}deleteWidgetFromContainer(e){const t=this.containerIdByWidgetId.get(e);if(t){this.containerIdByWidgetId.delete(e);const i=this.childrenIdsByParentId.get(t);if(i){const t=i.indexOf(e);t>=0&&i.splice(t,1)}}return t}onDelete(e){const t=new Set;e.forEach((e=>{this.knownWidgets.delete(e),this.deleteContainer(e);const i=this.deleteWidgetFromContainer(e);i&&this.knownGrids.has(i)&&t.add(i)}));return this.buildUpdatedWidgets(t)}}},6782:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.addAddOrUpdateToOperations=t.addReparseToOperations=void 0;t.addReparseToOperations=(e,t)=>0===t.length?e:Object.assign(Object.assign({},e),{toReparse:(e.toReparse||[]).filter((e=>!t.includes(e))).concat(t)});t.addAddOrUpdateToOperations=(e,t,i)=>{if(0===t.length)return e;const r=e.toAddOrUpdate||[];return Object.assign(Object.assign({},e),{toAddOrUpdate:"prioritize-added"===i?r.filter((e=>t.every((t=>t.id!==e.id)))).concat(t):r.concat(t.filter((e=>r.every((t=>t.id!==e.id)))))})}},3097:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TrackTableCellsEffect=void 0;const r=i(2575),n=i(6782);function tableCellUpdateRequiresTableUpdate(e,t){return e.properties.backgroundColor!==t.properties.backgroundColor||e.x!==t.x||e.y!==t.y||e.width!==t.width||e.height!==t.height||e.properties.rowSpan!==t.properties.rowSpan||e.properties.colSpan!==t.properties.colSpan}const clampValue=(e,t,i)=>Math.min(Math.max(e,t),i);function updateCellInCache(e,t){const i=t.rowById.get(e.properties.rowId),r=t.columnById.get(e.properties.columnId);if(void 0===i||void 0===r)return;const n=clampValue(e.properties.colSpan||1,1,t.columnById.size-r),s=clampValue(e.properties.rowSpan||1,1,t.rowById.size-i);for(let a=1;a<=s;a++)for(let s=1;s<=n;s++)t.cellsGrid[i+a-1][r+s-1]=e}t.TrackTableCellsEffect=class TrackTableCellsEffect{constructor(){this.tables=new Map,this.cells=new Map,this.tablesCellsIds=new Map,this.cachedTableInfo=new Map}getTableCellsGrid(e){const t=this.tables.get(e);if(!t)return[];const i=this.cachedTableInfo.get(e);if(i)return i.cellsGrid;const r=t.properties.rows,n=t.properties.columns,s=new Map,a=new Map;for(let e=0;e<t.properties.rows.length;e++)s.set(t.properties.rows[e].rowId,e);for(let e=0;e<t.properties.columns.length;e++)a.set(t.properties.columns[e].columnId,e);const o=[],l=[];for(let e=0;e<n.length;e++)l.push(null);for(let e=0;e<r.length;e++)o.push(l.slice());const d={cellsGrid:o,rowById:s,columnById:a};this.cachedTableInfo.set(e,d);const h=this.tablesCellsIds.get(e);if(!h)return o;for(const e of h){const t=this.cells.get(e);t&&updateCellInCache(t,d)}return o}replaceCellInCachedGrid(e){const t=this.cachedTableInfo.get(e.properties.parentId||"");if(!t)return;this.tables.get(e.properties.parentId||"")&&updateCellInCache(e,t)}apply(e){let t=e;if(t.toAddOrUpdate){const e=this.onAddOrUpdate(t.toAddOrUpdate);t=(0,n.addReparseToOperations)(t,e)}if(t.toRemove){const e=this.onDelete(t.toRemove);t=(0,n.addReparseToOperations)(t,e)}return t}getTablesIds(e){return 0===e.size?[]:new Array(...e).filter((e=>this.tables.has(e)))}onAddOrUpdate(e){var t;const i=new Set;for(const n of e)if((0,r.isTable)(n))this.tables.set(n.id,n),i.add(n.id),this.cachedTableInfo.delete(n.id);else if((0,r.isTableCell)(n)){if(!n.properties.parentId||!n.properties.columnId||!n.properties.rowId){console.warn(`Table cell ${n.id} is missing parentId / columnId / rowId properties`);continue}let e=this.tablesCellsIds.get(n.properties.parentId);e||(e=new Set,this.tablesCellsIds.set(n.properties.parentId,e));const r=this.cells.get(n.id);this.cells.set(n.id,n),r?(r.properties.parentId!==n.properties.parentId?(null===(t=this.tablesCellsIds.get(r.properties.parentId||""))||void 0===t||t.delete(r.id),e.add(n.id),this.cachedTableInfo.delete(n.properties.parentId)):r.properties.columnId===n.properties.columnId&&r.properties.rowId===n.properties.rowId&&r.properties.colSpan===n.properties.colSpan&&r.properties.rowSpan===n.properties.rowSpan||this.cachedTableInfo.delete(n.properties.parentId),this.replaceCellInCachedGrid(n),tableCellUpdateRequiresTableUpdate(r,n)&&i.add(n.properties.parentId)):(e.add(n.id),this.cachedTableInfo.delete(n.properties.parentId),i.add(n.properties.parentId))}return this.getTablesIds(i)}onDelete(e){const t=new Set;return e.forEach((e=>{var i;const r=this.cells.get(e),n=this.tables.get(e);r&&(this.cells.delete(r.id),null===(i=this.tablesCellsIds.get(r.properties.parentId||""))||void 0===i||i.delete(r.id),t.add(r.properties.parentId||"")),n&&(this.tables.delete(n.id),this.tablesCellsIds.delete(n.id),this.cachedTableInfo.delete(n.id))})),t.forEach((e=>this.cachedTableInfo.delete(e))),this.getTablesIds(t)}}},8316:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=i(6470),n=i(2575),s=i(9557),a=i(2730),o=i(7206),l=i(45),d=i(4424),h="#393939",c=10,drawTitle=(e,t,i,r,n,s,a,o,c)=>(0,d.drawGroup)(`${e}-title`,t,i,r,n,0,[(0,d.drawTextBox)({x:0,y:0,width:r,height:n},16,"left",c,0,(0,l.formatHighlightableText)({fontFamily:o?"proxima-nova":"proxima-nova-semibold",bold:o,color:a?h:void 0},s),void 0,!0)],void 0,void 0,"title"),drawFileTypeIconClassic=(e,t,i)=>{const r="generic"===i?1:0;return[(0,d.drawRectangle)(t.x+r,t.y+r,t.width-r,t.height-r,e.color,n.transparent,0),(0,d.drawTextBox)(t,12,"center","middle",1,(0,l.formatText)({fontFamily:"proxima-nova",color:"#FFFFFF"},e.shortName),void 0,!0)]},drawFileTypeIconHana=(e,t)=>[(0,d.drawImage)(t,{url:e.iconImagePath},void 0)],u=40,g=[(0,d.drawLine)(c,68,145,68,"#E2E2E2",2),(0,d.drawLine)(c,80,124,80,"#E2E2E2",2),(0,d.drawLine)(c,92,170,92,"#E2E2E2",2)];t.default=function renderFile({id:e,x:t,y:i,width:f,height:m,rotation:v,stackingOrder:y,properties:w},x,b,C){const A=w.link?(0,r.extname)(w.link).slice(1).toLowerCase():"",I=s.fileTypes[A]||s.DEFAULT_FILETYPE,S=w.previewUrl?((e,t,i,r,s,h,c,u,{cornerRadius:g,preview:f,shadow:m,iconStyle:v},y,w)=>{const x=t?{url:t,opts:{bound:{width:r,height:s}}}:void 0,b=r-2*f.widgetPadding,C=s-2*f.widgetPadding-f.informationBoxPadding.top-f.informationBoxPadding.bottom-32,A=f.widgetPadding+f.informationBoxPadding.left+32+19,I=f.widgetPadding+C+f.informationBoxPadding.top,S=r-f.widgetPadding-f.informationBoxPadding.right-A,T=(0,d.drawRectangle)(0,0,r,s,n.white,f.borderColor,f.borderThickness,n.SOLID_STROKE_PATTERN,void 0,g),_={x:f.widgetPadding+f.informationBoxPadding.left,y:I,width:32,height:32},M="hana"===v?drawFileTypeIconHana(h,_):drawFileTypeIconClassic(h,_,"preview");return[(0,o.drawShadow)(`${e}-shadow`,T,u,m),T,x?(0,d.drawImage)({x:f.widgetPadding,y:f.widgetPadding,width:b,height:C},x,{centerX:!0,centerY:!1}):(0,d.drawRectangle)(0,0,b,C,"#cccccc",n.transparent,0),...M,w?(0,d.drawTextBox)({x:f.widgetPadding,y:s/2-30,width:b,height:60},16,"center","middle",1,(0,l.formatText)({fontFamily:"proxima-nova",color:"#737373"},"Guests are restricted from viewing or\n  downloading this file type")):d.noop,drawTitle(e,A,I,S,30.5,i,!1,!0,f.title.verticalAlign),u&&c&&r>100&&!w?(0,a.drawActionButton)(`${e}-open`,r,s,"Open",55,"open",y,{onlyDrawOnHover:!0},"right",u):d.noop]})(e,w.previewUrl,w.title,f,m,I,w.link,x,b,C,w.dlpDownloadRestricted):((e,t,i,r,s,f,m,{cornerRadius:v,generic:y,shadow:w,iconStyle:x},b,C)=>{const A=t-20-40-10,I=(0,d.drawRectangle)(0,0,t,i,n.white,y.borderColor,y.borderThickness,n.SOLID_STROKE_PATTERN,void 0,v),S={x:c,y:c,width:40,height:u},T="hana"===x?drawFileTypeIconHana(s,S):drawFileTypeIconClassic(s,S,"generic");return[(0,o.drawShadow)(`${e}-shadow`,I,m,w),I,...T,drawTitle(e,60,c,A,u,r,!0,!1,y.title.verticalAlign),...g,(0,d.drawTextBox)({x:11,y:112,width:t-20,height:19.5},12,"left",y.caption.verticalAlign,1,(0,l.formatHighlightableText)({fontFamily:"proxima-nova-semibold",color:h},s.longName),void 0,!0),m&&f&&!C?(0,a.drawActionButton)(`${e}-open`,t,i,"Open",55,"open",b,{onlyDrawOnHover:!0},"right",m):d.noop]})(e,f,m,w.title,I,w.link,x,b,C,w.dlpDownloadRestricted);return(0,d.drawWidget)(e,w.parentId,t,i,f,m,v,y,S)}},3751:function(e,t,i){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=i(6541),s=r(i(5694)),a=i(2575),o=i(1106),l=i(9609),d=i(7206),h=i(45),c=i(4424),u=16,g=s.default["proxima-nova-semibold"].lineHeight;t.default=function renderFramework(e,t,{strokeOverrides:i,cornerRadius:r}){const{id:s,x:f,y:m,width:v,rotation:y,stackingOrder:w,properties:x}=e,{aspectRatio:b,background:C,showTitle:A,stickerURL:I,strokeColor:S,strokeStyle:T,strokeWidth:_,title:M,titleFontSize:O}=x,R=Math.ceil(A?Math.max(g*O,43):0),E=e.width/(b||1),P=(A?E+32+(8+R+-1):E+32)+5,L=I?{url:I,opts:{bound:{width:v,height:P}}}:void 0,k=A?u+(R+2+4+1):u,N=v-40,F=(0,o.getStrokePattern)(T,_,i),B=(0,c.drawRectangle)(_/2,_/2,v-_,P-_,C,a.transparent,_,F,void 0,r);return(0,c.drawWidget)(s,x.parentId,f,m,v,P,y,w,[t?(0,d.drawClassicDragShadow)(`${s}-shadow`,B):c.noop,B,L?(0,c.drawGroup)(`${s}-img`,20,k,N,E,0,[(0,c.drawImage)({height:E,width:N,x:0,y:0},L,{centerX:!0,centerY:!0})]):c.noop,(0,c.drawHint)(s,"border",Object.assign(Object.assign({},B),{width:v-_,height:P-_,backgroundColor:a.transparent,strokeColor:S||"#eaeaea",hitTest:1,cornerRadius:r})),t?(0,l.drawDragOver)(`${s}-drag-over`,v,P,_):c.noop,(0,c.drawWidgetsContainer)(s,0,0,v,P),A?(0,c.drawHint)(s,"title",(0,c.drawTextBox)({x:30,y:20,width:N-20,height:P-E-32},O,"left","top",1,(0,h.formatHighlightableText)({fontFamily:(0,n.makeSemiBold)("proxima-nova"),color:M?"#393939":"#B7B7B7"},M||"Unnamed"),void 0,!0)):c.noop])}},3041:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.computeGrid=void 0;const r=i(1106);t.computeGrid=(e,t)=>{const i=(e=>e.sort(((e,t)=>e.stackingOrder-t.stackingOrder)))(t),n=((e,t)=>{let i=0;return t.reduce(((t,r)=>{const{width:n}=r;return!t.length||i+n>e?(i=n+20,t.push([r]),t):(i+=n+20,t[t.length-1].push(r),t)}),[])})(e,i),s=(e=>{let t=0;return e.map((e=>{let i=0,r=0;const n=e.map((e=>{e.height>r&&(r=e.height);const n=Object.assign(Object.assign({},e),{x:i,y:t});return i+=e.width+20,n}));return t+=r+20,n}))})(n);return(0,r.flatten)(s)}},9325:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=i(4424);t.default=function renderGroup({id:e,x:t,y:i,height:n,width:s,rotation:a,stackingOrder:o,properties:l}){return(0,r.drawWidget)(e,l.parentId,t,i,s,n,a,o,[(0,r.drawWidgetsContainer)(e,0,0,s,n)])}},3178:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getFaviconUrl=t.FAVICON_FETCH_URL=t.getLinkProvider=void 0;const i={mural:"MURAL","mur.al":"MURAL","mural.al":"MURAL","onedrive.live.com":"OneDrive"},getLinkDomain=e=>{try{return e&&new URL(e).hostname}catch(e){return""}};t.getLinkProvider=e=>{const t=getLinkDomain(e);if(!t)return"";const r=(e=>i[e])(t);if(r)return r;const n=t.toLowerCase().split(".").reverse().filter((e=>"www"!==e)),s=n.find((e=>e.length>=4))||n[n.length-1];return s?`${s[0].toUpperCase()}${s.substring(1)}`:""},t.FAVICON_FETCH_URL="https://www.google.com/s2/favicons?domain=";t.getFaviconUrl=e=>{const i=getLinkDomain(e);return i&&`${t.FAVICON_FETCH_URL}${i}`}},9557:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.fileTypes=t.DEFAULT_FILETYPE=void 0;const i="/static/images/filetype/";t.DEFAULT_FILETYPE={shortName:"",longName:"File",color:"#4c85e1",iconImagePath:i+"file-generic.svg"},t.fileTypes={txt:{shortName:"TXT",longName:"TXT Document",color:"#4c85e1",iconImagePath:i+"file-txt.svg"},xls:{shortName:"X",longName:"Excel File",color:"#207247",iconImagePath:i+"file-xls.svg"},xlsx:{shortName:"X",longName:"Excel File",color:"#207247",iconImagePath:i+"file-xls.svg"},doc:{shortName:"W",longName:"Word Document",color:"#004a7f",iconImagePath:i+"file-doc.svg"},docx:{shortName:"W",longName:"Word Document",color:"#004a7f",iconImagePath:i+"file-doc.svg"},pdf:{shortName:"PDF",longName:"PDF Document",color:"#BA2700",iconImagePath:i+"file-pdf.svg"},ppt:{shortName:"P",longName:"PowerPoint Presentation",color:"#E24E2D",iconImagePath:i+"file-ppt.svg"},pptx:{shortName:"P",longName:"PowerPoint Presentation",color:"#E24E2D",iconImagePath:i+"file-ppt.svg"},zip:{shortName:"ZIP",longName:"ZIP File",color:"#BDBDBD",iconImagePath:i+"file-zip.svg"}}},8012:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=i(4086),n=i(2575),s=i(5347),a=i(45),o=i(4424),l=(0,a.formatText)({fontFamily:"proxima-nova",color:"#4C4C4C"},["This content will be hidden until it's revealed by a facilitator.","No peeking!"].join("\n")),d={url:"",dataUrl:"data:image/svg+xml;base64,PHN2ZyB2ZXJzaW9uPSIxLjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeD0iMHB4IiB5PSIwcHgiIHdpZHRoPSI1MHB4IiBoZWlnaHQ9IjQwcHgiIHZpZXdCb3g9IjAgMCA1MCA0MCI+PGcgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+PHBhdGggZD0iTTI1LDMxLjEyNSBDMTguMTA2MjUsMzEuMTI1IDEyLjUsMjUuNTE4NzUgMTIuNSwxOC42MjUgQzEyLjUsMTEuNzMxMjUgMTguMTA2MjUsNi4xMjUgMjUsNi4xMjUgQzMxLjg5Mzc1LDYuMTI1IDM3LjUsMTEuNzMxMjUgMzcuNSwxOC42MjUgQzM3LjUsMjUuNTE4NzUgMzEuODkzNzUsMzEuMTI1IDI1LDMxLjEyNSBNMjUsMyBDOS4zNzUsMyAwLDE4LjYyNSAwLDE4LjYyNSBDMCwxOC42MjUgOS4zNzUsMzQuMjUgMjUsMzQuMjUgQzQwLjYyNSwzNC4yNSA1MCwxOC42MjUgNTAsMTguNjI1IEM1MCwxOC42MjUgNDAuNjI1LDMgMjUsMyIgZmlsbD0iI0Q4RDhEOCIgZmlsbC1ydWxlPSJub256ZXJvIi8+PHBhdGggZD0iTTMxLjI1LDE4LjYyNSBDMzEuMjUsMjIuMDc1IDI4LjQ1LDI0Ljg3NSAyNSwyNC44NzUgQzIxLjU0Njg3NSwyNC44NzUgMTguNzUsMjIuMDc1IDE4Ljc1LDE4LjYyNSBDMTguNzUsMTUuMTcxODc1IDIxLjU0Njg3NSwxMi4zNzUgMjUsMTIuMzc1IEMyOC40NSwxMi4zNzUgMzEuMjUsMTUuMTcxODc1IDMxLjI1LDE4LjYyNSIgZmlsbD0iI0Q4RDhEOCIgZmlsbC1ydWxlPSJub256ZXJvIi8+PHBhdGggZD0iTTQyLjE4NzUsNC41NjI1IEwxMC45Mzc1LDM1LjgxMjUiIHN0cm9rZT0iI0Q4RDhEOCIgc3Ryb2tlLXdpZHRoPSI2IiBzdHJva2UtbGluZWNhcD0ic3F1YXJlIi8+PC9nPjwvc3ZnPgo="},clipLine=(e,t,i)=>{if(e.x2>t){const i=e.x2-t;e.x2-=i,e.y2-=i}if(e.y2>i){const t=e.y2-i;e.x2-=t,e.y2-=t}},drawLines=(e,t,i)=>{const r=Math.max(e,t),n=[],s=Math.max(e-2,0),a=Math.max(t-2,0);if(0==s||0==a)return n;const l={x1:0,y1:0,x2:0,y2:0},d=i?"#000000":"#ececec";for(let t=0;t<e-2;t+=25)l.x1=t,l.y1=0,l.x2=t+r,l.y2=r,clipLine(l,s,a),n.push((0,o.drawLine)(l.x1+.8,l.y1+.8,l.x2+1.2,l.y2+1.2,d,2));for(let e=25;e<t-2;e+=25)l.x1=0,l.y1=e,l.x2=r,l.y2=e+r,clipLine(l,s,a),n.push((0,o.drawLine)(l.x1+.8,l.y1+.8,l.x2+1.2,l.y2+1.2,d,2));return n},drawBackgroundShape=(e,t,i,r)=>{const s=i?o.drawEllipse:o.drawRectangle;return[s(0,0,e,t,"#f9f9f9",n.transparent,0),...drawLines(e,t,r),s(.5,.5,e-1,t-1,n.transparent,r?"#000000":"#d8d8d8",1)]},drawTitle=(e,t,i)=>i.map(((i,r)=>(0,o.drawTextBox)({width:e,y:t+33*r,x:10,height:32},32,"center","middle",1,i)));t.default=function renderHidden(e,t,i){const{id:h,x:c,y:u,width:g,height:f,stackingOrder:m,properties:v,rotation:y}=t,{iconHeight:w,isBiggest:x}=((e,t)=>{const i=Math.min(e,t);return i<=60?{iconHeight:16,isBiggest:!1}:i<=210?{iconHeight:50,isBiggest:!1}:{iconHeight:80,isBiggest:!0}})(g,f),b=x?v.title:"",C=x,A=!!v.round,I=1.25*w,S=b?(0,s.collectTextItemsFromHtml)((0,s.parseHtmlFromText)("proxima-nova",32,"black",b)):void 0,T=C?((e,t,i)=>{const{lineHeight:n,lines:s}=(0,a.wrapText)(e,t-60,i,18,"center","top",1,0,(0,a.processText)(e,l),r.CLASSIC_LINE_HEIGHT_MULTIPLIER);return n*s.length+20})(e,g,f):0,{titleHeight:_,titleLines:M}=S?((e,t,i,n)=>{const{lines:s}=(0,a.wrapText)(e,t-20,i,32,"center","top",1,0,(0,a.processText)(e,n),r.CLASSIC_LINE_HEIGHT_MULTIPLIER);return{titleHeight:33*s.length+20-10,titleLines:s}})(e,g,f,S):{titleHeight:0,titleLines:[]},O=f/2-(w+_+T)/2,R=(0,n.hasChildren)(t);return(0,o.drawWidget)(h,v.parentId,c,u,g,f,y,m,[(0,o.drawGroup)(`${h}-content`,0,0,g,f,0,[R?(0,o.drawWidgetsContainer)(h,0,0,g,f):o.noop,...drawBackgroundShape(g,f,A,i),(0,o.drawImage)({x:(g-I)/2,y:O,width:I,height:w},d,{centerX:!0,centerY:!0}),...S?drawTitle(g-20,O+w+20+-3,M):[],C?(0,o.drawTextBox)({x:30,y:O+w+_+10+.2,width:g-60,height:T},18,"center","middle",1,l):o.noop],A?"ellipse":"rectangle",void 0,"hidden")])}},9337:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseHtml=void 0;const r=i(6676),n=i(5554),s=i(5056),parseHtmlListItem=(e,i,a,o)=>{const l=e.nextTokenWithTag(s.TAG_OPEN_LIST_ITEM);if(!l)return;const d=(0,n.buildChildHtmlTextContext)(i,l),h={prefix:"ordered"===a?{type:"text",text:(0,r.buildTextItemCollection)().add(Object.assign({},d.textItemFormat),`${o+1}.`)}:{type:"bullet",color:d.textItemFormat.color||d.defaultColor,fontSize:d.defaultFontSize},content:(0,t.parseHtml)(e,d)};return e.skipTokenWithTag(s.TAG_CLOSE_LIST_ITEM),h},parseHtmlList=(e,t)=>{const i=e.nextTokenWithTag(s.TAG_OPEN_LIST_ORDERED,s.TAG_OPEN_LIST_UNORDERED);if(!i)return;const r=(0,n.buildChildHtmlTextContext)(t,i),a={type:"list",items:[]},o=i.tag===s.TAG_OPEN_LIST_ORDERED?"ordered":"unordered";for(;e.hasNextToken();){const t=parseHtmlListItem(e,r,o,a.items.length);if(t)a.items.push(t);else{if(e.nextTokenWithTag(s.TAG_CLOSE_LIST_ORDERED,s.TAG_CLOSE_LIST_UNORDERED))break;e.skipNextToken()}}return a};t.parseHtml=(e,t)=>{const i=[],r=(0,n.buildChildHtmlTextContext)(t);for(;e.hasNextToken();){const t=e.currentToken(),s=parseHtmlList(e,r);if(s){i.push(s);continue}const a=(0,n.parseHtmlText)(e,r);if(a.size()>0)i.push({type:"text",text:a});else if(e.currentToken()===t)break}return 0===i.length?{type:"empty"}:1===i.length?i[0]:{type:"collection-vertical",elements:i}}},3155:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.drawHtmlTextboxFromHtmlCode=t.drawHtmlTextbox=void 0;const r=i(2575),n=i(45),s=i(2105),a=i(4424),o=i(5347);t.drawHtmlTextbox=(e,t,i,r,o,l,d,h)=>{const c=(0,n.processText)(d,t),u=void 0!==o?o:Math.ceil((0,s.getTextWidth)(d,i,c)),{height:g,horizontalOverflow:f,wrappedText:m}=(0,n.getTextHeight)(d,u,i,0,1,c,h),v=l&&void 0!==o?o:Math.min(u,Math.ceil((()=>m.lines.reduce(((e,t)=>Math.max(e,t.getTotalWidth())),0))())),y="left"===r&&v===u?m:(0,n.wrapText)(d,v,0,i,r,"top",0,1,c,h),w=(0,a.drawTextBox)({x:0,y:0,width:v,height:g},i,r,"top",0,c,f?{id:`${e}-clip`,clipHeight:g,clipWidth:u,clipX:0,clipY:0,shape:"rectangle"}:void 0);return Object.assign(Object.assign({},w),{type:"WrappedTextBox",wrappedText:y,lineHeight:y.lineHeight})};const drawHtml=(e,i,r)=>{switch(i.type){case"text":return((e,i,r)=>(0,t.drawHtmlTextbox)(e,i.text,r.fontSize,r.align,r.fixedWidth,r.boxShouldMatchFixedWidth,r.textFunctions,r.lineHeightMultiplier))(e,i,r);case"list":return((e,t,i)=>{const r=Object.assign(Object.assign({},i),{fixedWidth:void 0,boxShouldMatchFixedWidth:!1}),n=t.items.reduce(((e,t)=>Math.max(e,Math.ceil(drawHtml("tmp",t.prefix,r).width))),(e=>1.4*e)(i.fontSize)),s=void 0!==i.fixedWidth?Math.min(n,i.fixedWidth):n,o=((e,t,i)=>i.measureText(t,e," "))(i.fontSize,i.fontFamily,i.textFunctions),l=Object.assign(Object.assign({},i),{fixedWidth:s,boxShouldMatchFixedWidth:!1}),d=Object.assign(Object.assign({},i),{fixedWidth:void 0!==i.fixedWidth?Math.max(i.fixedWidth-(s+o),0):void 0,boxShouldMatchFixedWidth:!1}),h=t.items.map(((t,i)=>({prefix:drawHtml(`${e}-p-${i}`,t.prefix,l),content:drawHtml(`${e}-i-${i}`,t.content,d)}))),c=h.reduce(((e,t)=>e+Math.max(t.prefix.height,t.content.height)),0),u=h.reduce(((e,t)=>Math.max(e,s+o+t.content.width)),0),g=i.boxShouldMatchFixedWidth&&void 0!==i.fixedWidth?i.fixedWidth:u,f=s+o;let m=0;h.forEach((e=>{e.prefix.y=m,e.content.y=m,m+=Math.max(e.prefix.height,e.content.height),e.content.x="left"===i.align?f:"right"===i.align?g-e.content.width:(g-e.content.width)/2+f/2,"WrappedTextBox"===e.content.type&&void 0!==e.content.clipArgs&&(e.content.clipArgs.clipX=e.content.x,e.content.clipArgs.clipY=e.content.y);const t=((e,t)=>{if("left"===e)return 0;if("WrappedTextBox"===t.type&&t.wrappedText.lines.length>0){const i=t.wrappedText.lines[0].getTotalWidth();switch(e){case"right":return t.width-i;case"center":return(t.width-i)/2}}return 0})(i.align,e.content);e.prefix.x=e.content.x-o-e.prefix.width+t}));const v=[];return h.forEach((e=>{v.push(e.prefix),v.push(e.content)})),(0,a.drawGroup)(e,0,0,g,c,0,v)})(e,i,r);case"bullet":return((e,t)=>{const i=t.fontSize,r=.11*i,n=.17*i,s=.14*i;return(0,a.drawGroup)(e,0,0,i,i,0,[(0,a.drawEllipse)(i/2-r+s,i/2-r+n,2*r,2*r,t.color,"",0)])})(e,i);case"collection-vertical":return drawHtmlCollectionVertical(e,i.elements,r);case"empty":return((e,t)=>{const i=t.boxShouldMatchFixedWidth&&void 0!==t.fixedWidth?t.fixedWidth:0;return(0,a.drawGroup)(e,0,0,i,0,0,[])})(e,r)}},drawHtmlCollectionVertical=(e,t,i)=>{const r=Object.assign(Object.assign({},i),{boxShouldMatchFixedWidth:!1}),n=t.map(((t,i)=>drawHtml(`${e}-${i}`,t,r))),s=n.reduce(((e,t)=>e+t.height),0),o=n.reduce(((e,t)=>Math.max(e,t.x+t.width)),0),l=i.boxShouldMatchFixedWidth&&void 0!==i.fixedWidth?i.fixedWidth:o;let d=0;return n.forEach((e=>{e.y=d,d+=e.height,e.x="left"===i.align?0:"right"===i.align?l-e.width:(l-e.width)/2,"WrappedTextBox"===e.type&&void 0!==e.clipArgs&&(e.clipArgs.clipX=e.x,e.clipArgs.clipY=e.y)})),(0,a.drawGroup)(e,0,0,l,s,0,n)};t.drawHtmlTextboxFromHtmlCode=(e,t,i,n,s,l,d,h,c)=>{const u=(0,o.parseHtmlFromText)(n,i,s,t),g=((e,t)=>{if("left"!==t.align&&void 0===t.fixedWidth){const i=Object.assign(Object.assign({},t),{align:"left",boxShouldMatchFixedWidth:!1}),r=drawHtml("id",e,i);return Object.assign(Object.assign({},t),{fixedWidth:r.width})}return t})(u,{fontSize:i,fontFamily:n,lineHeightMultiplier:c,textFunctions:h,align:l,fixedWidth:d,boxShouldMatchFixedWidth:!0}),f=drawHtml(e,u,g);return"Group"===f.type&&f.children.push((0,a.drawRectangle)(0,0,f.width,f.height,"transparent","transparent",0,r.SOLID_STROKE_PATTERN,void 0,void 0,0)),f}},5554:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseHtmlText=t.buildChildHtmlTextContext=t.buildHtmlTextContext=void 0;const r=i(6676),n=i(2829),s=i(5056),fixHorizontalWhitespace=e=>e&&e.replace(/\t/g,"    ").replace(/&nbsp;/g," ");t.buildHtmlTextContext=(e,t,i)=>({defaultFontFamily:e,defaultFontSize:t,defaultColor:i,textItemFormat:{fontFamily:e},colorStack:[]});t.buildChildHtmlTextContext=(e,t)=>{const i=Object.assign(Object.assign({},e),{textItemFormat:Object.assign({},e.textItemFormat),colorStack:[]});return t&&t.style&&t.style.color&&(i.textItemFormat.color=t.style.color),i};t.parseHtmlText=(e,t)=>{const i={fontFamily:t.defaultFontFamily};let a=!1;const o=(0,r.buildTextItemCollection)(),{textItemFormat:l}=t;let d;for(let r=e.nextToken();void 0!==r;d=r,r=e.nextToken()){if((0,s.isText)(r)){const e=fixHorizontalWhitespace(r.text);if(e){a&&(o.add(i,"\n"),a=!1);const t=o.size()>0?o.getFormat(o.size()-1):null;null!==t&&(0,n.sameFormat)(t,l)?o.add(t,e):o.add(Object.assign({},l),e)}continue}if(!(0,s.isTextItemTag)(r)){e.returnToken();break}if((0,s.isBlockEndTag)(r)&&(!d||!(0,s.isTag)(d)||"br"!==d.tag&&!(0,s.isBlockEndTag)(d))){a&&o.add(i,"\n"),a=!0;continue}if("br"===r.tag){!d||(0,s.isBlockStartTag)(d)||"br"===d.tag?o.add(i,"\n"):a=!0;continue}const{tag:h,style:c}=r;switch(h){case"b":l.bold=!0;break;case"/b":delete l.bold;break;case"i":l.italic=!0;break;case"/i":delete l.italic;break;case"mark":l.markHighlightColor=(null==c?void 0:c.backgroundColor)||"black",l.markTextColor=(null==c?void 0:c.color)||"white";break;case"/mark":delete l.markHighlightColor,delete l.markTextColor;break;case"u":l.underline=!0;break;case"/u":delete l.underline;break;case"s":l.strike=!0;break;case"/s":delete l.strike}if(c&&c.color)t.colorStack.push({color:l.color,tag:`/${h}`}),l.color=c.color;else if(t.colorStack.length>0){const e=t.colorStack[t.colorStack.length-1];e.tag===h&&(t.colorStack.pop(),e.color?l.color=e.color:delete l.color)}}return o.filter(((e,t)=>!!t))}},5056:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.buildTokenIterator=t.TokenIterator=t.isBlockStartTag=t.isBlockEndTag=t.isTextItemTag=t.TAG_CLOSE_LIST_ITEM=t.TAG_OPEN_LIST_ITEM=t.TAG_CLOSE_LIST_UNORDERED=t.TAG_OPEN_LIST_UNORDERED=t.TAG_CLOSE_LIST_ORDERED=t.TAG_OPEN_LIST_ORDERED=t.isText=t.isTag=void 0;t.isTag=e=>!!e.tag;t.isText=e=>!(0,t.isTag)(e),t.TAG_OPEN_LIST_ORDERED="ol",t.TAG_CLOSE_LIST_ORDERED="/ol",t.TAG_OPEN_LIST_UNORDERED="ul",t.TAG_CLOSE_LIST_UNORDERED="/ul",t.TAG_OPEN_LIST_ITEM="li",t.TAG_CLOSE_LIST_ITEM="/li";const i=new Set([t.TAG_OPEN_LIST_ORDERED,t.TAG_CLOSE_LIST_ORDERED,t.TAG_OPEN_LIST_UNORDERED,t.TAG_CLOSE_LIST_UNORDERED,t.TAG_OPEN_LIST_ITEM,t.TAG_CLOSE_LIST_ITEM]);t.isTextItemTag=e=>!i.has(e.tag);t.isBlockEndTag=e=>"/div"===e.tag;t.isBlockStartTag=e=>"div"===e.tag;const getStyleAttributeValue=(e,t)=>{const i=RegExp(`.*[ "';]${t}:([^;"]+)[;"].*`),r=e.replace(i,"$1");return r!==e?r.trim():void 0};const splitIntoTokens=e=>Array.from(function*tokenize(e){const t=/<\s*(\/?[0-9a-zA-Z]+).*?(?:\/>|>)/g,i=e.length;let r=0;for(;;){const n=t.exec(e);if(!n){r<i&&(yield{text:e.substring(r)});break}n.index>r&&(yield{text:e.substring(r,n.index)}),r=t.lastIndex;const s=n[1].toLowerCase(),a=getStyleAttributeValue(n[0],"color"),o={backgroundColor:getStyleAttributeValue(n[0],"background-color"),color:a};yield{tag:s,style:o}}}((e=>e.replace(/<\/div><\/span>/g,"</span>"))((e=>e.replace(/<br>(<\/span><\/div>)/g,"$1").replace(/<span><\/span>/g,"").replace(/<div>\s*?<\/div>/g,""))((e=>e.replace(/\n/g," "))(e)))));class TokenIterator{constructor(e){this.index=0,this.tokens=e}nextToken(){if(this.index===this.tokens.length)return;const e=this.tokens[this.index];return this.index++,e}currentToken(){if(this.index!==this.tokens.length)return this.tokens[this.index]}returnToken(){this.index>0&&this.index--}hasNextToken(){return this.index<this.tokens.length}skipNextToken(){this.index<this.tokens.length&&this.index++}skipTokenWithTag(e){if(!this.hasNextToken())return;const i=this.tokens[this.index];(0,t.isTag)(i)&&i.tag===e&&this.index++}nextTokenWithTag(...e){if(!this.hasNextToken())return;const i=this.tokens[this.index];return(0,t.isTag)(i)&&e.includes(i.tag)?(this.index++,i):void 0}}t.TokenIterator=TokenIterator;t.buildTokenIterator=e=>new TokenIterator(splitIntoTokens(e))},5347:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.collectTextItemsFromHtml=t.collectTextItemsInternal=t.parseHtmlFromText=void 0;const r=i(6676),n=i(9337),s=i(5554),a=i(5056);t.parseHtmlFromText=(e,t,i,r)=>{const o=(0,a.buildTokenIterator)(r);return(0,n.parseHtml)(o,(0,s.buildHtmlTextContext)(e,t,i))};t.collectTextItemsInternal=(e,i)=>{switch(e.type){case"text":for(let t=0;t<e.text.size();t++)i.add(e.text.getFormat(t),e.text.getText(t));break;case"list":e.items.forEach((e=>{(0,t.collectTextItemsInternal)(e.prefix,i),(0,t.collectTextItemsInternal)(e.content,i)}));break;case"collection-vertical":e.elements.forEach((e=>(0,t.collectTextItemsInternal)(e,i)))}};t.collectTextItemsFromHtml=e=>{if("text"===e.type)return e.text;const i=(0,r.buildTextItemCollection)();return(0,t.collectTextItemsInternal)(e,i),i}},3645:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=i(2575),n=i(4424);t.default=function renderDrawing({id:e,x:t,y:i,width:s,height:a,rotation:o,stackingOrder:l,properties:d}){const h=Object.keys(d.paths).map((e=>d.paths[e])).map((({path:e,strokeColor:t,strokeWidth:i,filled:s})=>(0,n.drawPath)(e,t,i,s?t:r.transparent,void 0,void 0,"round","round")));return(0,n.drawWidget)(e,d.parentId,t,i,s,a,o,l,h)}},7201:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.drawLabelsInWidget=t.LABEL_LINK_SPACING=void 0;const r=i(2946);t.LABEL_LINK_SPACING=2;t.drawLabelsInWidget=(e,i,n,s,a,o,l,d,h,c,u,g)=>{if(!a||0===a.length||!g)return;const f=o+5.5,m=s-o-h-c.height-Math.abs(c.height-d)/2,v=n-(u?u.width+t.LABEL_LINK_SPACING:0)-2*(o+5.5);return(0,r.drawLabels)(`${i}-labels`,e,a,g,f,m,v,l,c)}},2946:function(e,t,i){"use strict";var r=this&&this.__rest||function(e,t){var i={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(i[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(r=Object.getOwnPropertySymbols(e);n<r.length;n++)t.indexOf(r[n])<0&&Object.prototype.propertyIsEnumerable.call(e,r[n])&&(i[r[n]]=e[r[n]])}return i};Object.defineProperty(t,"__esModule",{value:!0}),t.drawLabels=t.getVisibleLabels=t.measureLabel=t.fitIcon=void 0;const n=i(2575),s=i(249),a=i(45),o=i(2105),l=i(4424),collapseLabel=(e,t,i)=>{if(!e.collapse)return null;const{text:n,icon:s}=e,a=r(e,["text","icon"]);switch(e.collapse){case"text":if(n){const e=Object.assign(Object.assign({},a),{text:n}),i=t(e);return Object.assign(Object.assign({},e),{width:i})}break;case"icon":if(s){const e=Object.assign(Object.assign({},a),{icon:s}),i=t(e);return Object.assign(Object.assign({},e),{width:i})}break;case"ellipsis":return((e,t,i)=>{if(!e.text)return null;if(e.text.length<5)return null;const r=e.text;let n=r.substring(0,r.length-3),s=t(Object.assign(Object.assign({},e),{text:n+"..."}));for(;s>i&&n.length>=2;)n=n.substring(0,n.length-1),s=t(Object.assign(Object.assign({},e),{text:n+"..."}));return n.length<2?null:Object.assign(Object.assign({},e),{text:n+"...",width:s})})(e,t,i)}return null},cropLabels=(e,t,i,r)=>{const n=[];let s=i;for(const i of e){const e=t(i),a=i.maxWidth,o=void 0===a||e<=a,l=(void 0!==a?Math.min(e,a):e)<=s;if(o&&l)n.push(Object.assign(Object.assign({},i),{width:e})),s-=e+r;else{const e=void 0!==a?Math.min(s,a):s,o=collapseLabel(i,t,e);if(o&&o.width<=s&&(n.push(o),s-=o.width+r),!l)break}if(s<0)break}return n};t.fitIcon=(e,t)=>{if(t)return t.height<=e?t:{url:t.url,height:e,width:t.width/t.height*e,isIcon:t.isIcon}};t.measureLabel=(e,i)=>r=>{let n=0;if(r.text){const t=(0,o.buildMeasureTextFormat)(e,i.fontSize);n=(0,a.formatText)({fontFamily:i.fontFamily},r.text).reduce(((e,i,r)=>t(i,r)+e),0)}const s=(0,t.fitIcon)(i.maxIconHeight,r.icon),l=s?s.width:0,d=r.text&&s?i.iconSpacing:0;return i.leftSpacing+l+d+n+i.rightSpacing};t.getVisibleLabels=(e,t,i,r,n,s)=>{const a=t.filter((e=>!!i[e.type])).map((e=>Object.assign(Object.assign({},e),i[e.type]))),o=cropLabels(a,e,r,n);return o.length<a.length?cropLabels(o,e,r-n-s,n):o};const drawBurger=(e,t,i,{cornerRadius:r,borderThickness:s,burger:{width:a,height:o,dotDistance:d,dotSize:h}})=>{const c=(o-s-h)/2,u=(a-h)/2;return[(0,l.drawRectangle)(0,0,a,o-s,e,t,s,n.SOLID_STROKE_PATTERN,void 0,r,0),(0,l.drawEllipse)(u-d,c,h,h,i,"transparent",0),(0,l.drawEllipse)(u,c,h,h,i,"transparent",0),(0,l.drawEllipse)(u+d,c,h,h,i,"transparent",0)]};t.drawLabels=(e,i,r,o,d,h,c,u,g)=>{if(0===r.length)return l.noop;const f=((e,{fontSize:i,fontFamily:r,iconPaddingRight:n,paddingHorizontal:s,maxIconHeight:a})=>(0,t.measureLabel)(e,{leftSpacing:s,rightSpacing:s,fontSize:i,iconSpacing:n,fontFamily:r,maxIconHeight:a}))(i,g),m=(0,t.getVisibleLabels)(f,r,o,c,g.spacingBetweenLabels,g.burger.width);let v=0;const y=m.map(((i,r)=>{const s=((e,i,r,s,{height:o,fontSize:d,fontFamily:h,paddingHorizontal:c,iconOffsetY:u,textOffsetY:g,iconPaddingRight:f,maxIconHeight:m,cornerRadius:v,borderThickness:y,fallbacks:w},x=c)=>{const b=(0,t.fitIcon)(m,s.icon),C=x+(b?b.width+f:0),A=s.text,I=s.width-C-x;return(0,l.drawGroup)(e,i,r,s.width,o,0,[(0,l.drawRectangle)(0,0,s.width,o-y,s.backgroundColor||w.backgroundColor,s.borderColor||s.backgroundColor||w.borderColor,y,n.SOLID_STROKE_PATTERN,void 0,v,0),A?(0,l.drawTextBox)({x:C,y:g,height:o-g,width:I},d,"left","top",1,(0,a.formatText)({fontFamily:h,color:s.color||w.textColor},A)):l.noop,b?(0,l.drawImage)({x,y:u,height:b.height,width:b.width},{url:b.url,hint:"image",opts:{color:b.isIcon?s.color:"",isIcon:b.isIcon}},{centerX:!0,centerY:!0},void 0,void 0,void 0,"high"):l.noop],void 0,void 0,`label-${s.id}`)})(`${e}-label-${r}`,v,g.borderThickness,i,g);return v+=i.width+g.spacingBetweenLabels,s}));return m.length<r.length&&v+g.burger.width<=c&&(y.push(((e,t,i,r,n)=>(0,l.drawGroup)(`${e}-label-ellipsis`,t,i,n.burger.width,n.burger.height,0,[...drawBurger(n.burger.idle.backgroundColor,n.burger.idle.borderColor,n.burger.idle.dotColor,n),r?(0,s.drawHover)(`${e}-label-ellipsis-hover`,0,0,n.burger.width,n.burger.height,drawBurger(n.burger.hover.backgroundColor,n.burger.hover.borderColor,n.burger.hover.dotColor,n)):l.noop],void 0,void 0,"label-ellipsis"))(e,v,g.borderThickness,u,g)),v+=g.burger.width),(0,l.drawGroup)(e,d,h-g.borderThickness,v,g.height+g.borderThickness,0,y)}},8748:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.visit=t.forEach=t.mapChildrenFirst=t.map=t.traverseMap=void 0;const r=i(1106),isDrawingPrimitive=e=>"WidgetPrimitive"!==e.type,NoOpFn=e=>e,n={type:"NoOp"};function traverseMap(e,t){const i=void 0!==t?t:NoOpFn,traverse=t=>{const s=void 0!==e?e(t):t;if("Image"===s.type&&s.errorFallback){const e=traverse(s.errorFallback);return i(e!==s.errorFallback?Object.assign(Object.assign({},s),{errorFallback:isDrawingPrimitive(e)?e:void 0}):s)}if("Group"===s.type||"WidgetPrimitive"===s.type){const e=s.children,t=(0,r.mapOnlyIfChanges)(s.children,traverse);return i(t!==e?Object.assign(Object.assign({},s),{children:t.map((e=>isDrawingPrimitive(e)?e:n))}):s)}return i(s)};return traverse}t.traverseMap=traverseMap,t.map=function map(e){return traverseMap(e)},t.mapChildrenFirst=function mapChildrenFirst(e){return traverseMap(void 0,e)},t.forEach=function forEach(e){return t=>{e(t),"Image"===t.type&&t.errorFallback&&forEach(e)(t.errorFallback),"Group"!==t.type&&"WidgetPrimitive"!==t.type||t.children.forEach(forEach(e))}},t.visit=function visit(e,t,i){const r=e[i.type];return r&&r(i,t),"Image"===i.type&&i.errorFallback&&visit(e,t,i.errorFallback),"Group"!==i.type&&"WidgetPrimitive"!==i.type||i.children.forEach((i=>visit(e,t,i))),t}},8921:function(e,t,i){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.ArrowLabelOverlapDetection=void 0;const n=i(2575),s=i(484),a=r(i(876)),o=i(5014),l=i(325),d=i(3669),cmpMarker=(e,t)=>e.value-t.value,sweep=(e,t,i)=>{const r=i.release(),n=e.length;for(let i=0;i<n;i++){const s=e[i],a=s.proxy;if(a.alive&&!s.isEnd)if(0===a.type){if(!t.overlaps(a))continue;for(let s=i+1;s<n;s++){const i=e[s],n=i.proxy;if(i.isEnd&&n===a)break;n.alive&&1===n.type&&t.overlaps(n)&&r.add(a,n)}}else{if(!t.overlaps(a))continue;for(let s=i+1;s<n;s++){const i=e[s],n=i.proxy;if(i.isEnd&&n===a)break;n.alive&&0===n.type&&t.overlaps(n)&&r.add(n,a)}}}return r},filterMarkersInPlace=e=>{const t=e.length;let i=0;for(let r=0;r<t;r++){const t=e[r];t.proxy.alive&&(e[i++]=t)}e.length=i};t.ArrowLabelOverlapDetection=class ArrowLabelOverlapDetection{constructor(){this._arrowGroups=new Map,this._axisX=[],this._axisY=[],this._reuse={xCandidates:new o.PairSet,yCandidates:new o.PairSet,previouslyOverlapping:new o.PairSet,currentlyOverlapping:new o.PairSet},this._invalidationHull=new s.Hull,this._markersSortDirty=!1,this._changedArrows=0,this.clearInvalidation()}setArrowsAndGetModified(e){for(const t of e)this.setArrow(t.arrow,t.arrowAbsX,t.arrowAbsY);return this.applyPendingOverlapsAndGetModifiedArrows()}deleteAndGetModified(e){for(const t of e)this.delete(t);return this.applyPendingOverlapsAndGetModifiedArrows()}getNotOwnedOverlappingLabelProxies(e){var t;return null===(t=this._arrowGroups.get(e))||void 0===t?void 0:t.notOwnOverlappingLabels}setArrow(e,t,i){const r=e.id;let n=this._arrowGroups.get(r);n||(n={id:r,arrowProxy:new l.ProxyArrow(e),ownLabels:[],notOwnOverlappingLabels:new Set,removedLabels:new Set},this.addProxyToAxes(n.arrowProxy),this._arrowGroups.set(r,n));const s=n.arrowProxy;this.growInvalidationHull(s);const a=s.x!==t||s.y!==i;s.update(n,t,i,e.width,e.height),s.widget=e,this.growInvalidationHull(s),this.updateLabels(e,n,t,i,a),s.justChanged=!0,this._changedArrows++,this._markersSortDirty=!0}updateLabels(e,t,i,r,s){var a;const o=t.ownLabels,d=null===(a=e.properties.label)||void 0===a?void 0:a.labels,h=o.length,c=(null==d?void 0:d.length)||0;let u=!1;if(d){for(let e=h;e<c;e++){const e=new l.ProxyLabel;this.addProxyToAxes(e),o.push(e)}for(let e=0;e<c;e++){const a=o[e],l=d[e],h=void 0===a.realCopy||!(0,n.areArrowLabelsEqual)(a.realCopy,l);a.justChanged=s||h,a.justChanged&&(u=!0,this.growInvalidationHull(a),a.update(t,l.x+i,l.y+r,l.width,l.height),h&&(a.realCopy=Object.assign({},l)),this.growInvalidationHull(a))}}for(let e=c;e<h;e++)u=!0,o[e].alive=!1,o[e].realCopy=void 0;return o.length=c,u}delete(e){const t=this._arrowGroups.get(e);t&&(this._changedArrows++,this.growInvalidationHull(t.arrowProxy),t.arrowProxy.alive=!1,t.arrowProxy.justChanged=!0,t.ownLabels.forEach((e=>{this.growInvalidationHull(e),e.alive=!1,e.justChanged=!0})))}clearInvalidation(){this._changedArrows=0,this._invalidationHull.clear()}growInvalidationHull(e){this._invalidationHull.grow(e)}addProxyToAxes(e){this._axisX.push(e.xStart),this._axisX.push(e.xEnd),this._axisY.push(e.yStart),this._axisY.push(e.yEnd)}applyPendingOverlapsAndGetModifiedArrows(){const e=new Set;if(!this._changedArrows)return e;const t=this.resetReuseResources();this._markersSortDirty&&(this._markersSortDirty=!1,this.sortAxesMarkersInPlace());const i=sweep(this._axisX,this._invalidationHull,t.xCandidates),r=sweep(this._axisY,this._invalidationHull,t.yCandidates),n=((e,t)=>{const i=[];for(const r of e){const e=r.arrowProxy;t.overlaps(e)&&i.push(e)}return i})(this._arrowGroups.values(),this._invalidationHull),s=d.Unique.make(((e,t,i)=>{const r=i.release();for(const i of e){const e=i.group;for(const n of e.notOwnOverlappingLabels)t.overlaps(n)&&r.add(i,n)}return r})(n,this._invalidationHull,t.previouslyOverlapping)),a=t.currentlyOverlapping.release();(0,o.setIntersectionForEach)(i,r,((e,t)=>{((e,t)=>e.group===t.group)(e,t)||a.add(e,t)}));((e,t,i,r,n)=>{const s=t.release();e.forEach(((e,t)=>{s.has(e,t)?(s.delete(e,t),(t.justChanged||e.justChanged)&&n(e,t)):i(e,t)})),s.forEach(r)})(a,s.give(),((t,i)=>{t.group.notOwnOverlappingLabels.add(i),e.add(t.widget)}),((t,i)=>{t.group.notOwnOverlappingLabels.delete(i),e.add(t.widget)}),(t=>{e.add(t.widget)}));for(const t of n)t.justChanged&&e.add(t.widget);return this.clearChangedFlags(n),this.unpersistDeadProxies(),this.clearInvalidation(),e}sortAxesMarkersInPlace(){(0,a.default)(this._axisX,cmpMarker),(0,a.default)(this._axisY,cmpMarker)}clearChangedFlags(e){e.forEach((e=>{const t=e.group;t.arrowProxy.justChanged=!1,t.ownLabels.forEach((e=>e.justChanged=!1))}))}unpersistDeadProxies(){filterMarkersInPlace(this._axisX),filterMarkersInPlace(this._axisY);for(const e of this._arrowGroups.keys()){const t=this._arrowGroups.get(e);t&&t.arrowProxy.alive||this._arrowGroups.delete(e)}}resetReuseResources(){const{xCandidates:e,yCandidates:t,previouslyOverlapping:i,currentlyOverlapping:r}=this._reuse;return e.clear(),t.clear(),i.clear(),r.clear(),{xCandidates:d.Unique.make(e),yCandidates:d.Unique.make(t),previouslyOverlapping:d.Unique.make(i),currentlyOverlapping:d.Unique.make(r)}}}},4468:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HierarchyCache=void 0;const r=i(2575);class Node{constructor(){this.parentNodeId=null,this.x=0,this.y=0,this.element=null,this.children=new Set,this.recursiveElementCount=0}}t.HierarchyCache=class HierarchyCache{constructor(e){this._nodeMap=new Map,this._isElement=e,this._nodeMap.set(null,new Node)}getOrCreateNode(e){let t=this._nodeMap.get(e);return t||(t=new Node,this._nodeMap.set(e,t)),t}setNode(e,t){const i=e.properties.parentId,r=this.getOrCreateNode(e.id);if(null!==t&&(r.recursiveElementCount=1,r.element=t),r.x=e.x,r.y=e.y,r.parentNodeId!==i){this.getOrCreateNode(r.parentNodeId).children.delete(e.id);let t=r;for(;t.parentNodeId;)t=this.getOrCreateNode(t.parentNodeId),t.recursiveElementCount-=r.recursiveElementCount;r.parentNodeId=i;this.getOrCreateNode(i).children.add(e.id);let n=r;for(;n.parentNodeId;)n=this.getOrCreateNode(n.parentNodeId),n.recursiveElementCount+=r.recursiveElementCount}return r}updateHierarchyReturnElementsInsideUpdatedParents(e){const t=new Set;for(const i of e)this._isElement(i)?this.setNode(i,i):(0,r.hasChildren)(i)&&(this.setNode(i,null),t.add(i.id));return this.getNodeElementsTraversal(t)}getNodeElementsTraversal(e){const t=new Set,i=[];for(const r of e){const e=[r];for(;e.length>0;){const r=e.pop();if(!r||t.has(r))continue;t.add(r);const n=this.getOrCreateNode(r);0!==n.recursiveElementCount&&(n.element&&i.push(n.element),e.push(...n.children))}}return i}delete(e){const t=new Set;for(const i of e){null===this.getOrCreateNode(i).element&&t.add(i)}const i=this.getNodeElementsTraversal(t);for(const t of e){const e=this.getOrCreateNode(t);this.getOrCreateNode(e.parentNodeId).children.delete(t);let i=e;for(;i.parentNodeId;)i=this.getOrCreateNode(i.parentNodeId),i.recursiveElementCount-=e.recursiveElementCount;this._nodeMap.delete(t)}return i}absolutePosition(e){let t=0,i=0,r=e,n=100;for(;r;){const s=this.getOrCreateNode(r);if(t+=s.x,i+=s.y,r=s.parentNodeId,n--<=0)return console.error(`HierarchyCache possibly cyclic hierarchy chain for widget id ${e}`),{x:0,y:0}}return{x:t,y:i}}}},484:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Hull=void 0;t.Hull=class Hull{constructor(){this.x=Number.MAX_SAFE_INTEGER,this.y=Number.MAX_SAFE_INTEGER,this.x1=Number.MIN_SAFE_INTEGER,this.y1=Number.MIN_SAFE_INTEGER,this.clear()}clear(){this.x=Number.MAX_SAFE_INTEGER,this.y=Number.MAX_SAFE_INTEGER,this.x1=Number.MIN_SAFE_INTEGER,this.y1=Number.MIN_SAFE_INTEGER}set(e){this.clear(),this.grow(e)}grow({x:e,y:t,x1:i,y1:r}){e-=1,t-=1,i+=1,r+=1,this.x>e&&(this.x=e),this.y>t&&(this.y=t),this.x1<i&&(this.x1=i),this.y1<r&&(this.y1=r)}overlaps({x:e,y:t,x1:i,y1:r}){return e<=this.x1&&i>=this.x&&t<=this.y1&&r>=this.y}toString(){const{x:e,y:t,x1:i,y1:r}=this;return JSON.stringify({x:e,y:t,x1:i,y1:r})}}},876:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function insertionSort(e,t){let i,r=null,n=null,s=0,a=0,o=0;for(;s<e.length;){if(n=r,i=r=e[s],null!==n){for(o=a=s-1;a>=0&&t(i,e[a])<0;)e[a+1]=e[a],o=a--;a!==o&&(e[o]=i)}++s}}},5014:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setIntersectionForEach=t.PairSet=void 0;t.PairSet=class PairSet{constructor(){this._elements=new Map,this._setPool=[],this._last1=void 0,this._last2Set=void 0,this._allSets=[]}add(e,t){let i=this._last1===e?this._last2Set:this._elements.get(e);i||(i=this._setPool.pop(),i||(i=new Set,this._allSets.push(i)),this._elements.set(e,i)),this._last1=e,this._last2Set=i,i.add(t)}delete(e,t){const i=this._last1===e?this._last2Set:this._elements.get(e);i&&(i.delete(t),0===i.size&&(this._elements.delete(e),this._setPool.push(i),this._last1===e&&(this._last1=void 0,this._last2Set=void 0)))}has(e,t){const i=this._last1===e?this._last2Set:this._elements.get(e);return this._last1=e,this._last2Set=i,!!i&&i.has(t)}forEach(e){for(const[t,i]of this._elements.entries())for(const r of i)e(t,r)}clear(){this._last1=void 0,this._last2Set=void 0,this._elements.clear(),this._allSets.forEach((e=>e.clear())),this._setPool=[...this._allSets]}slowCount(){let e=0;for(const t of this._elements.values())e+=t.size;return e}};t.setIntersectionForEach=(e,t,i)=>{e.forEach(((e,r)=>{t.has(e,r)&&i(e,r)}))}},325:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ProxyLabel=t.ProxyArrow=void 0;class ProxyBase{constructor(){this.x=Number.NaN,this.y=Number.NaN,this.x1=Number.NaN,this.y1=Number.NaN,this.alive=!1,this.justChanged=!1}createMarkers(e){this.xEnd={isEnd:!0,proxy:e,value:0},this.xStart={isEnd:!1,proxy:e,value:0},this.yEnd={isEnd:!0,proxy:e,value:0},this.yStart={isEnd:!1,proxy:e,value:0}}update(e,t,i,r,n){this.alive=!0,this.x=t,this.y=i,this.group=e,this.x1=this.x+r,this.y1=this.y+n,this.xStart.value=this.x,this.xEnd.value=this.x1,this.yStart.value=this.y,this.yEnd.value=this.y1}initMarkers(e){this.xStart=e.xStart,this.xEnd=e.xEnd,this.yStart=e.yStart,this.yEnd=e.yEnd}}t.ProxyArrow=class ProxyArrow extends ProxyBase{constructor(e){super(),this.type=0,this.widget=e,this.createMarkers(this)}toString(){var e;return`[Arrow ${null===(e=this.widget)||void 0===e?void 0:e.id}  ${this.alive?"^v^":"X_X"}]`}};t.ProxyLabel=class ProxyLabel extends ProxyBase{constructor(){super(),this.type=1,this.realCopy=void 0,this.createMarkers(this)}toString(){return`[Label from ${this.group.id} ${this.alive?"^v^":"X_X"}]`}}},3669:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Unique=void 0;class Unique{constructor(e){this._ref=e,this._valid=!0}static make(e){return new Unique(e)}give(){return this._check(),this._valid=!1,new Unique(this._ref)}release(){return this._check(),this._valid=!1,this._ref}_check(){this._valid||console.error("Trying to use a released Unique<> reference")}}t.Unique=Unique},5877:function(e,t,i){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=i(4086),s=i(2575),a=i(3178),o=r(i(4506)),l=i(45),d=i(4424),h=i(6844),generateTitle=(e,t,i,r,s)=>{const a=i-2,h=((e,t,i)=>{const{lines:r}=(0,l.wrapText)(e,t,0,16,"left","top",0,0,(0,l.formatHighlightableText)({fontFamily:"proxima-nova",bold:!0},i),n.CLASSIC_LINE_HEIGHT_MULTIPLIER);return 20*r.length})(e,a,r);return{node:(0,d.drawGroup)(`${t}-title`,1,3,a,h,0,[(0,d.drawHint)(`${t}-title-text`,"title",(0,d.drawTextBox)({height:h,x:0,y:0,width:a},16,"left","top",0,(0,l.formatHighlightableText)({fontFamily:"proxima-nova",bold:!0},r))),s?(0,o.default)(`${t}-title-edit`,a-22,2,"title.edit"):d.noop]),height:h+6}},generateFooter=(e,t,i,r,s,a)=>{const h=r-2,c=((e,t,i)=>{const{lines:r}=(0,l.wrapText)(e,t,0,14,"left","top",0,0,(0,l.formatHighlightableText)({fontFamily:"proxima-nova"},i),n.CLASSIC_LINE_HEIGHT_MULTIPLIER);return 18*r.length})(e,h,s);return{node:(0,d.drawGroup)(`${t}-footer`,1,i+3,h,c,0,[(0,d.drawHint)(`${t}-footer-text`,"caption",(0,d.drawTextBox)({x:0,y:0,width:h,height:c},14,"left","top",0,(0,l.formatHighlightableText)({fontFamily:"proxima-nova",color:"#888"},s),void 0,!1,18)),a?(0,o.default)(`${t}-footer-edit`,h-22,0,"caption.edit"):d.noop]),height:c+6}},c=2.5,u={node:d.noop,height:0};t.default=(e,t,i,r,n,o,g,f)=>{const m=r-28,{node:v,height:y}=n?generateTitle(e,t,m,n,f):u,{node:w,height:x}=o?generateFooter(e,t,y,m,o,f):u,{node:b,height:C}=g?((e,t,i,r)=>({node:(0,d.drawGroup)(`${e}-link`,11.5,t+9+12-c+1,i+c,21,0,[(0,d.drawImage)({x:c,y:c,width:16,height:16},{hint:"mural",url:(0,a.getFaviconUrl)(r)||""},{centerX:!0,centerY:!0},h.DEFAULT_LOADING_COLOR),(0,d.drawEllipse)(0,0,21,21,s.transparent,"#ffffff",5),(0,d.drawTextBox)({x:25.5,y:3.5,width:i-23,height:15},13,"left","middle",1,(0,l.formatText)({fontFamily:"proxima-nova"},(0,a.getLinkProvider)(r)))],void 0,void 0,"link"),height:28}))(t,y+x+(n&&!o?-2:0),m,g):u,A=y+x+C+(!g||n&&!o?0:2);return{node:(0,d.drawGroup)(`${t}-info`,0,i,r,A+18,0,[(0,d.drawGroup)(`${t}-caption`,14,9,m,y+x,0,[v,w]),b]),height:A+18}}},5304:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.errorFallback=void 0;const r=i(2575),n=i(45),s=i(4424),a={dataUrl:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAD4AAAA+CAAAAABWqveYAAAAAmJLR0QA/4ePzL8AAAAJcEhZcwAAFiUAABYlAUlSJPAAAAAHdElNRQfkBA4TCjsB2j5AAAABrUlEQVRIx+3Wy26CQBQG4F9L7cVL2tSViSZNF01c9v2folWriPfWK4riBRWRLqgV5GBmmE3T9KzOMPMlPzowRCo6wldK0lUBjqgIBiQAsWQoOt86PJkPxUtj4fD//M/zPXVRYqOd6dK6SWTjofiisgJgGGouG+Hnm7ed09gt5Pjvvbr7adtLbj7Xjr3d4eaLwAET9+Q19rz80j24iPLyeOCAiafca+64eezx2N9muTkyD4dOeo7yc+SfnGX3L4mTGbZHJpPWl2Y84T8P2Dhi6TR5/Te9bbozEb5uypYAl611IzzvzoDeNCxfN50EIbkDN/Vw/PCr9zV6pX2WO9EBz5vRVb2CfY4f75mM31Om1TPcvWEGE0IDg3YgP0Yn4/cUAGgNg7j379rWKA3IM5qf7vXhmNKwSwbFvdEBQDEJDewKJsH9O80V36WBdcl/TGjEYzpSKQ3oso+T3w3f8U80MGqccrJMhdTAR5+FQx2RGlA0Fo6aSWrY70sWbr4q9IRV3DJwrIImNkWLgQfXoizEMakJcXQ/ATCfcf6qXwtxlK8EwgN7Q4gD4lxKiejUF6ILsFCtt3bBAAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDIwLTA0LTE0VDE5OjEwOjU5KzAzOjAworo80wAAACV0RVh0ZGF0ZTptb2RpZnkAMjAyMC0wNC0xNFQxOToxMDo1OSswMzowMNPnhG8AAAAodEVYdGljYzpjb3B5cmlnaHQAQ29weXJpZ2h0IEFwcGxlIEluYy4sIDIwMjAKut6wAAAAF3RFWHRpY2M6ZGVzY3JpcHRpb24ARGlzcGxheRcblbgAAAAYdEVYdGljYzptYW51ZmFjdHVyZXIARGlzcGxheZka6dkAAAARdEVYdGljYzptb2RlbABEaXNwbGF5+JycIAAAAABJRU5ErkJggg==",url:""};t.errorFallback=(e,t,i,o,l,d,h="Picture not available")=>{if(o<=112)return((e,t,i,n,o,l)=>(0,s.drawGroup)(`${e}-small-fallback`,t,i,n,o,0,[(0,s.drawRectangle)(0,0,n,o,l,r.transparent,1),(0,s.drawImage)({width:20,height:20,x:n/2-10,y:o/2-10},a,{centerX:!0,centerY:!0})]))(e,t,i,o,l,d);const c=l/2-46.5+3,u=o/2-15.5,g=c+31+7;return(0,s.drawGroup)(`${e}-fallback`,t,i,o,l,0,[(0,s.drawRectangle)(0,0,o,l,d,r.transparent,1),(0,s.drawImage)({width:31,height:31,x:u,y:c},a,{centerX:!0,centerY:!0}),(0,s.drawTextBox)({x:0,y:g,width:o,height:30},16,"center","middle",0,(0,n.formatText)({fontFamily:"proxima-nova",color:"#B7B7B7"},h))])}},9563:function(e,t,i){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.getPhotoWidgetBorder=void 0;const n=i(2575),s=r(i(1683)),a=i(7770),o=i(7206),l=r(i(6973)),d=i(4424),h=r(i(5877)),c=i(5304),u=i(6844),generateImage=(e,t,i,r,a,o,h,g,f,m,v,y,w,x,b,C)=>{let A;A=m?C?(0,c.errorFallback)(i,r,r,a,o,u.DEFAULT_LOADING_COLOR):((e,t,i,r,n,s,a,o,l)=>{if(!l||!o||!a)return(0,d.drawImage)({width:r,height:n,x:t,y:i},s,void 0,u.DEFAULT_LOADING_COLOR,(0,c.errorFallback)(e,t,i,r,n,u.DEFAULT_LOADING_COLOR),void 0,void 0,!0,e);const h=r/l.width,g=n/l.height,f=a*h,m=o*g,v=-l.left*h,y=-l.top*g;return(0,d.drawGroup)(`${e}-mask`,t,i,r,n,0,[(0,d.drawImage)({width:f,height:m,x:v,y},s,void 0,u.DEFAULT_LOADING_COLOR,(0,c.errorFallback)(e,t,i,r,n,u.DEFAULT_LOADING_COLOR),void 0,void 0,void 0,e)],"rectangle")})(i,r,r,a,o,m,h,g,x):f?Object.assign(Object.assign({},l.default),{id:`${i}-photo-private`}):(0,d.drawRectangle)(r,r,a,o,"#EDEDED",n.transparent,0);const I=v||(m?m.url:null);let S;if(y&&I&&a>=100){const n={in:{delay:.1,duration:.1},out:{delay:0,duration:.1}},l={in:{delay:0,duration:.1},out:{delay:0,duration:.1}};S=C?void 0:(0,s.default)(e,`${i}-open${b?"-always":""}`,a+r,o+r,t,I,"Open",void 0,!0,!b,"right","open",y,w,n,l)}const T=S?a+2*r:A.width,_=S?o+2*r:A.height,M=S?0:A.x,O=S?0:A.y;return A.x-=M,A.y-=O,(0,d.drawGroup)(`${i}-content`,M,O,T,_,0,[A,S||d.noop],void 0,void 0,"_loading_progress",void 0,void 0,v)},g={node:d.noop,height:0};t.getPhotoWidgetBorder=(e,t)=>e.properties.border?t.borderThickness:0,t.default=(e,t,i,r,s,c,u)=>{var f;const{id:m,x:v,y,rotation:w,stackingOrder:x}=i,{cornerRadius:b,borderColor:C,borderThickness:A,shadow:I,borderPadding:S}=c,{aspectRatio:T,border:_,contentPrivate:M,footer:O,link:R,mask:E,naturalHeight:P,naturalWidth:L,privateImage:k,showCaption:N,title:F,parentId:B,dlpDownloadRestricted:z}=i.properties,D=null!==(f=i.properties.objectFit)&&void 0!==f?f:c.objectFit,H=!!k||!!M,W=((e,t,i)=>!e||0===e.left&&0===e.top&&e.width===t&&e.height===i?void 0:e)(E,L,P),j=((e,t)=>{const i=e.properties.photoURL||e.properties.thumbURL;if(i)return t?{url:i,opts:{bound:{width:e.width,height:e.height}}}:{url:i}})(i,!!r),G=_?S:0,U=i.width-2*G,V=((e,t,i,r,n,s,a,o,d)=>{const h=i/(d?d.width/d.height:o||(s||r)/(a||n));return e?h:t?l.default.height:Math.max(h,120)})(!!j,H,"fit"===D?i.width:U,i.width,i.height,L,P,T,W)-("fit"===D?2*G:0),Y=i.width>=138&&N&&(!!F||!!O||!!R),{node:X,height:q}=Y?(0,h.default)(e,m,V+G+("fit"===D?G:0),i.width,F,O,R,s):g,Z=G+V+q+G-("enlarge"===D&&q?G:0),Q=((e,t,i,r,s,{borderColor:a,borderThickness:o,cornerRadius:l})=>r?(0,d.drawRectangle)(0,0,e,t,n.white,a,o,n.SOLID_STROKE_PATTERN,void 0,l):s?(0,d.drawRectangle)(0,i,e,t-i,n.white,n.transparent,0,n.SOLID_STROKE_PATTERN,void 0,l):void 0)(i.width,Z,V,_,Y,c),J=null!=Q?Q:(0,d.drawRectangle)(0,0,i.width,Z,n.transparent,n.transparent,0,n.SOLID_STROKE_PATTERN,void 0,b),K=Y&&b,$=_?A:0;return(0,d.drawWidget)(m,B,v,y,i.width,Z,w,x,[s?(0,a.drawHighlight)(`${m}-highlight`,J):d.noop,(0,o.drawShadow)(`${m}-shadow`,J,s,I),null!=Q?Q:d.noop,K?(0,d.drawRectangle)($,V,i.width-$,b,n.white,n.transparent,0):d.noop,K&&_?(0,d.drawLine)(0,V,0,V+b,C,$):d.noop,K&&_?(0,d.drawLine)(i.width,V,i.width,V+b,C,$):d.noop,generateImage(e,t,m,G,U,V,L,P,H,j,R,s,u,W,Y,z),X],void 0,void 0,void 0,_?1:0)}},6844:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DEFAULT_LOADING_COLOR=void 0,t.DEFAULT_LOADING_COLOR="#f4f4f4"},1043:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getShapeWidgetBorder=void 0;const r=i(9787),n=i(1106),s=i(7770),a=i(7652),o=i(249),l=i(45),d=i(4424),getHoverTextBox=(e,t,i,r,n)=>(0,d.drawTextBox)({width:e,height:t,x:0,y:0},23,"center",r,1,(0,l.formatText)({fontFamily:"proxima-nova",italic:!0,color:i},e>110?"Add text":"+"),void 0,void 0,void 0,void 0,n),drawText=(e,t,i,r,n,s,a)=>{var h;const c=(0,d.calculatePadding)(r.padding,i,n.fontSize),u=null!==(h=n.verticalAlign)&&void 0!==h?h:r.verticalAlign;return n.text||a?(0,d.drawHint)(e,"text",n.text?(0,d.drawTextBox)({height:i-2*c,width:t-2*c,x:c,y:c},n.fontSize,n.textAlign||"center",u,0,(({bold:e,color:t,italic:i,strike:r,underline:n,fontFamily:s,text:a=""})=>(0,l.formatHighlightableText)({bold:e,color:t,fontFamily:s,italic:i,strike:r,underline:n},a))(n),{id:e,clipWidth:t-2*c,clipHeight:i-2*c,shape:"Ellipse"===s.type?"ellipse":"rectangle"},void 0,void 0,void 0,r.lineHeightMultiplier):((e,t,i,r,n,s)=>{const a=i/2-23+10;if(a<0)return;const l=t-12,h=`${e}-selected`;return(0,d.drawGroup)(h,0,0,t,i,0,[Object.assign(Object.assign({},r),{backgroundColor:"transparent",hitTest:0,strokeColor:"transparent"}),(0,o.drawHover)(`${h}-text`,6,a,l,23,[getHoverTextBox(l,23,"#B7B7B7",n,s),(0,o.drawHover)(`${h}-text-hover`,0,0,l,23,[getHoverTextBox(l,23,"#000000",n,s)])],"edit")],void 0,void 0,void 0,"selected")})(e,t,i,s,u,r.lineHeightMultiplier)||(0,d.drawRectangle)(0,0,0,0,"transparent","transparent",0)):d.noop};t.getShapeWidgetBorder=e=>e.properties.strokeSize/2;t.default=function renderShape(e,t,i){const{shapeType:o}=e.properties;return"Circle"===o?(({id:e,x:t,y:i,width:r,height:o,rotation:l,stackingOrder:h,properties:c},u,g)=>{const f=(0,d.drawEllipse)(0,0,r,o,c.background,c.strokeColor,c.strokeSize,(0,n.getStrokePattern)(c.strokeStyle,c.strokeSize,g.strokeOverrides));return(0,d.drawWidget)(e,c.parentId,t,i,r,o,l,h,[u?(0,s.drawHighlight)(`${e}-highlight`,f):d.noop,f,u?(0,a.drawShapeOutline)(`${e}-outline`,f):d.noop,drawText(e,r,o,g,c,f,u)],void 0,void 0,void 0,c.strokeSize/2)})(e,t,i):"Square"===o?(({id:e,x:t,y:i,width:r,height:o,rotation:l,stackingOrder:h,properties:c},u,g)=>{const f=(0,d.drawRectangle)(0,0,r,o,c.background,c.strokeColor,c.strokeSize,(0,n.getStrokePattern)(c.strokeStyle,c.strokeSize,g.strokeOverrides));return(0,d.drawWidget)(e,c.parentId,t,i,r,o,l,h,[u?(0,s.drawHighlight)(`${e}-highlight`,f):d.noop,f,u?(0,a.drawShapeOutline)(`${e}-outline`,f):d.noop,drawText(e,r,o,g,c,f,u)],void 0,void 0,void 0,c.strokeSize/2)})(e,t,i):o?(({id:e,x:t,y:i,width:o,height:l,rotation:h,stackingOrder:c,properties:u},g,f)=>{const{shapeType:m,strokeColor:v,strokeSize:y,strokeStyle:w,background:x}=u,b=r.svgShapes[((e="")=>`${e[0].toLowerCase()}${e.substring(1)}`)(m)],C=b.svg,A=(0,d.drawPath)(C,v,y,x,{newSize:{width:o,height:l},originalSize:{width:b.width,height:b.height},clipBorder:y/2+1},(0,n.getStrokePattern)(w,y,f.strokeOverrides),"butt");return(0,d.drawWidget)(e,u.parentId,t,i,o,l,h,c,[g?(0,s.drawPathHighlight)(`${e}-highlight`,A,o,l):d.noop,A,g?(0,a.drawShapeOutlineWithBounds)(`${e}-outline`,o,l,[A],!1):d.noop,drawText(e,o,l,f,u,A,g)],void 0,void 0,void 0,y/2)})(e,t,i):void 0}},4506:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=i(3923),n=i(4424),s=i(249),a=i(437);t.default=(e,t,i,o)=>(0,s.drawHover)(e,t,i,r.ICON_PATHS.edit.width,r.ICON_PATHS.edit.width,[a.EDIT_ICON,(0,s.drawHover)(`${e}-hover`,0,0,r.ICON_PATHS.editHover.width,r.ICON_PATHS.editHover.width,[(0,n.drawImage)({x:0,y:0,height:r.ICON_PATHS.editHover.width,width:r.ICON_PATHS.editHover.width},{url:r.ICON_PATHS.editHover.source,dataUrl:r.ICON_PATHS.editHover.source,hint:"image"},{centerX:!0,centerY:!0})])],o)},437:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EDIT_ICON=t.drawSourceIcon=t.drawExternalIcon=void 0;const r=i(3923),n=i(4424);t.drawExternalIcon=(e,t,i,r)=>(0,n.drawGroup)(e,t,i,r.width,r.width,void 0,[(0,n.drawImage)({x:0,y:0,width:r.width,height:r.width},{url:"",dataUrl:r.source},void 0,"transparent",void 0,void 0,"high")]);t.drawSourceIcon=(e,t,i,r,s,a)=>(0,n.drawGroup)(e,t,i,r.width,s,void 0,["path"===r.type?(0,n.drawPath)(r.source,a,0,a):(0,n.drawImage)({x:0,y:0,height:r.width,width:r.width},{url:r.source,dataUrl:r.source,hint:"image"},{centerX:!0,centerY:!0},void 0,void 0,void 0,"high")],void 0,r.actionScale),t.EDIT_ICON=(0,n.drawImage)({x:0,y:0,height:r.ICON_PATHS.edit.width,width:r.ICON_PATHS.edit.width},{url:r.ICON_PATHS.edit.source,dataUrl:r.ICON_PATHS.edit.source,hint:"image"},{centerX:!0,centerY:!0},void 0,void 0,void 0,"high")},2730:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.drawActionButton=void 0;const r=i(2575),n=i(3923),s=i(45),a=i(4424),o=i(249),l=i(437),drawButton=(e,t,i,o,{paddingHorizontal:d,paddingVertical:h,height:c,small:u,fontSize:g,bold:f,externalIconOffsetVertical:m,textOffsetVertical:v,sourceIconOffsetVertical:y,borderThickness:w,cornerRadius:x},{backgroundColor:b,borderColor:C,textColor:A,externalIcon:I},S,T,_)=>{const M=o>0,O=_?M?(0,l.drawExternalIcon)(`${e}-external-icon`,t-2*d-n.ICON_PATHS.export.width,h+m,I):(0,l.drawExternalIcon)(`${e}-external-icon`,u.paddingHorizontal,u.paddingVertical,I):a.noop;return[(0,a.drawRectangle)(0,0,M?t:u.width,M?c:u.height,b,C,w,r.SOLID_STROKE_PATTERN,void 0,x,0),M?(0,a.drawTextBox)({x:i,y:h+v,height:c-2*h,width:o},g,"left","top",1,(0,s.formatText)({fontFamily:"proxima-nova",color:A,bold:f},S)):a.noop,T?(0,l.drawSourceIcon)(e,d+2,h+y,T,c-2*h,A):a.noop,O]};t.drawActionButton=(e,t,i,r,s,l,d,{buttonWidthIncludesIcons:h=!0,onlyDrawOnHover:c=!0,showExternalIcon:u=!0,source:g}={},f="right",m,v,y)=>{const w=g?n.ICON_PATHS[g]:null,x=w?w.width+4:0,b=u?n.ICON_PATHS.export.width+4+2*d.paddingHorizontal:d.paddingHorizontal,C=x+2*d.textMarginHorizontal+b,A=h?s-C:s,I="right"===f?A>0?-(d.marginHorizontal+d.paddingHorizontal+d.textMarginHorizontal-1.5):-d.marginHorizontal:0,S=s+(h?0:C),T=S-I<t?S:d.small.width,_=T>=S?A:0,M=T>=S?r:"",O=Math.max("right"===f?t-T+I:(t-T)/2,0),R=i-d.height-d.marginVertical,E=d.paddingHorizontal+x+d.textMarginHorizontal,P=m?((e,t,i,r,s,a,l,d,h)=>{const c=a?n.ICON_PATHS_HOVER[a]:null;return(0,o.drawHover)(e,0,0,t,d.height,drawButton(`${e}-button-hover`,t,i,r,d,d.hover,s,c,l),void 0,h)})(`${e}-hover`,T+d.paddingHorizontal,E,_,M,g,u,d,y):a.noop;return(0,a.drawGroup)(e,O,R,T+d.paddingHorizontal,d.height,0,[...drawButton(`${e}-button`,T+d.paddingHorizontal,E,_,d,d.idle,M,w,u),P],void 0,void 0,l,c?"hover":void 0,v)}},1683:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isValidLocalOrRemoteURL=void 0;const r=i(2730),n="Go to >";t.isValidLocalOrRemoteURL=e=>{if(e.startsWith("/"))return!0;try{return new URL(e),!0}catch(e){return!1}};t.default=(e,i,s,a,o,l,d,h,c,u,g,f,m,v,y,w)=>{const x=(e=>e?(0,t.isValidLocalOrRemoteURL)(e)?e:"":e)(l),{isInternal:b,title:C,source:A,isSmall:I}=((e,t,i,r,s,a)=>{if(!i||i.startsWith("/"))return{isInternal:!!i,source:s,title:"Open"};const{pathname:o,hostname:l,search:d}=new URL(i),h=!!e&&o.includes(e.replace(".","/"))&&!!d,c=l.endsWith("mural.co")||"localhost"===l;return{isInternal:h,source:c?h?"mural-content":"mural":s,title:h?t>=60?n:">":c?"Open mural":a?"Open":r||"Open link",isSmall:h&&t<60}})(o,s,x,d,h,c),S=e.measureText(v.bold?"proxima-nova-bold":"proxima-nova",v.fontSize,C),T=!b||x.startsWith("/"),_=b&&!T?e.measureText(v.bold?"proxima-nova-bold":"proxima-nova",v.fontSize,I?">":n):S<=s?S:0;return(0,r.drawActionButton)(i,s,a,C,_,f,v,{source:A,onlyDrawOnHover:u,showExternalIcon:T,buttonWidthIncludesIcons:!1},g,m,y,w)}},9609:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.drawDragOver=void 0;const r=i(2575),n=i(1106),s=i(4424);t.drawDragOver=(e,t,i,a)=>{const o=a/2;return(0,s.drawGroup)(e,0,0,t,i,0,[(0,s.drawRectangle)(0,0,t,i,"rgba(28, 126, 249, 0.2)",r.transparent,0),(0,s.drawRectangle)(o,o,t-2*o,i-2*o,r.transparent,"#1c7ef9",a,(0,n.getStrokePatternClassic)("-",a))],void 0,void 0,void 0,"drag-over")}},7770:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.drawPathHighlight=t.drawHighlight=void 0;const r=i(7206);t.drawHighlight=(e,t)=>(0,r.drawClassicDragShadow)(e,t,"highlight");t.drawPathHighlight=(e,t,i,n)=>(0,r.drawPathShadow)(e,t,i,n,"highlight")},7652:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.drawShapeOutline=t.drawShapeOutlineWithBounds=void 0;const r=i(2575),n=i(4424),s=i(249),a="#1C7EF9",outline=(e,t,i)=>{switch(i.type){case"Ellipse":case"Rectangle":return Object.assign(Object.assign({},i),{strokeColor:a,backgroundColor:r.transparent});case"Line":return Object.assign(Object.assign({},i),{strokeColor:a});case"Path":return Object.assign(Object.assign({},i),{backgroundColor:t&&void 0!==i.backgroundColor&&!(0,r.isTransparent)(i.backgroundColor)?a:void 0,strokeColor:a});case"Group":return Object.assign(Object.assign({},i),{id:`${e}-${i.id}`,children:i.children.map((i=>outline(e,t,i)))});default:return i}};t.drawShapeOutlineWithBounds=(e,t,i,r,s=!1)=>(0,n.drawGroup)(e,0,0,t,i,void 0,r.map((t=>outline(e,s,t))),void 0,void 0,void 0,"dragging-visual-feedback");t.drawShapeOutline=(e,t)=>(0,s.drawState)(e,"dragging-visual-feedback",outline(e,!1,t))},7206:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.drawPathShadow=t.drawShadow=t.drawClassicDragShadow=void 0;const r=i(2575),n=i(4424),s=i(249);t.drawClassicDragShadow=(e,t,i="dragging-visual-feedback")=>(0,s.drawState)(e,i,Object.assign(Object.assign({},t),{shadow:1}));t.drawShadow=(e,i,s,a)=>{if(a.alwaysVisible){if(!(0,r.isColorTranslucent)(i.backgroundColor))return((e,t,i)=>{const r=i.cornerRadius&&"Rectangle"===t.type?Object.assign(Object.assign({},t),{cornerRadius:i.cornerRadius}):t,{easeInDelay:s,easeOutDelay:a,easeInSeconds:o,easeOutSeconds:l}=i.whileDragging.animate,d={"drag-begin":{delay:s,duration:o},"drag-end":{delay:a,duration:l}},h=Object.assign(Object.assign({},r),{shadow:2,x:0,y:0,strokeWidth:0,shadowStyle:i}),c=(0,n.drawGroup)(e+"-offset",0,0,t.width,t.height,0,[h],void 0,void 0,void 0,void 0,d);return(0,n.drawGroup)(e,t.x,t.y,t.width,t.height,0,[c])})(e,i,a)}else if(s)return(0,t.drawClassicDragShadow)(e,i);return n.noop};t.drawPathShadow=(e,t,i,s,a="dragging-visual-feedback")=>(0,n.drawGroup)(e,0,0,i,s,0,[Object.assign(Object.assign({},t),{backgroundColor:r.transparent,shadow:1})],void 0,void 0,void 0,a)},249:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.drawState=t.drawHover=void 0;const r=i(4424);t.drawHover=(e,t,i,n,s,a,o,l)=>(0,r.drawGroup)(e,t,i,n,s,0,a,void 0,void 0,o,"hover",l);t.drawState=(e,t,i)=>(0,r.drawGroup)(e,i.x,i.y,i.width,i.height,0,[Object.assign(Object.assign({},i),{x:0,y:0})],void 0,void 0,void 0,t)},6973:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=i(2575),n=i(4424);t.default=(0,n.drawGroup)("photo-private",0,0,230,210,0,[(0,n.drawRectangle)(0,0,230,210,"#ffffff","transparent",0),(0,n.drawPath)("M146.5,54.5c0-1.4-1.1-2.5-2.5-2.5c-1.4,0-2.5,1.1-2.5,2.5v1.9h5.1V54.5z",r.transparent,0,"#B7B7B7"),(0,n.drawPath)("M156,58c0-6.6-5.4-12-12-12c-4.4,0-8.3,2.4-10.4,6H85.8c-3.2,0-5.8,2.6-5.8,5.8v46.7c0,3.2,2.6,5.8,5.8,5.8h58.3c3.2,0,5.8-2.6,5.8-5.8V68.4C153.6,66.3,156,62.4,156,58z M138.3,57.3c0-0.5,0.4-1,1-1h0.3v-1.9c0-2.4,2-4.5,4.5-4.5c2.4,0,4.5,2,4.5,4.5v1.9h0.3c0.5,0,1,0.4,1,1V63c0,0.5-0.4,1-1,1h-9.5c-0.5,0-1-0.4-1-1V57.3z M147.1,104.5c0,1.5-1.2,2.8-2.7,2.9l-23.7-22.9l-12.5,11.6L94.5,81.2L82.9,96.1V57.8c0-1.6,1.3-2.9,2.9-2.9h46.6c-0.3,1-0.4,2-0.4,3.1c0,6.6,5.4,12,12,12c1.1,0,2.1-0.2,3.1-0.4V104.5z",r.transparent,0,"#B7B7B7"),(0,n.drawPath)("M48.3,138.3v-4l-3.7-5.4H46l2.9,4.3l2.9-4.3h1.4l-3.7,5.4v4H48.3z",r.transparent,0,"#888888"),(0,n.drawPath)("M52.2,134.9c0-2,1.3-3.5,3.3-3.5s3.3,1.6,3.3,3.5s-1.3,3.6-3.3,3.6S52.2,136.9,52.2,134.9zM57.8,134.9c0-1.4-0.8-2.6-2.2-2.6c-1.4,0-2.3,1.2-2.3,2.6c0,1.4,0.8,2.6,2.3,2.6C57,137.6,57.8,136.3,57.8,134.9z",r.transparent,0,"#888888"),(0,n.drawPath)("M65.1,138.3v-1c-0.5,0.6-1.4,1.1-2.4,1.1c-1.4,0-2.2-0.7-2.2-2.2v-4.8h1.1v4.5c0,1.2,0.6,1.5,1.5,1.5c0.8,0,1.6-0.5,2-1v-5h1.1v6.8H65.1z",r.transparent,0,"#888888"),(0,n.drawPath)("M71.5,134.9c0-2,1.4-3.5,3.4-3.5c1.2,0,2,0.5,2.5,1.2l-0.7,0.6c-0.4-0.6-1-0.9-1.7-0.9c-1.4,0-2.3,1.1-2.3,2.6c0,1.5,0.9,2.6,2.3,2.6c0.7,0,1.3-0.3,1.7-0.9l0.7,0.6c-0.5,0.7-1.2,1.2-2.5,1.2C72.9,138.5,71.5,137,71.5,134.9z",r.transparent,0,"#888888"),(0,n.drawPath)("M83.1,138.3v-0.8c-0.6,0.6-1.3,0.9-2.2,0.9c-1.1,0-2.4-0.8-2.4-2.2c0-1.5,1.2-2.2,2.4-2.2c0.9,0,1.7,0.3,2.2,0.9v-1.2c0-0.9-0.7-1.4-1.7-1.4c-0.8,0-1.5,0.3-2.1,0.9l-0.5-0.7c0.7-0.8,1.6-1.1,2.7-1.1c1.4,0,2.6,0.6,2.6,2.3v4.7H83.1z M83.1,136.9v-1.3c-0.4-0.6-1.1-0.8-1.9-0.8c-1,0-1.7,0.6-1.7,1.5c0,0.9,0.7,1.5,1.7,1.5C81.9,137.7,82.7,137.5,83.1,136.9z",r.transparent,0,"#888888"),(0,n.drawPath)("M90.8,138.3v-4.4c0-1.2-0.6-1.6-1.5-1.6c-0.8,0-1.6,0.5-2,1.1v4.9h-1.1v-6.8h1.1v1c0.5-0.6,1.4-1.1,2.4-1.1c1.4,0,2.2,0.7,2.2,2.2v4.7H90.8z",r.transparent,0,"#888888"),(0,n.drawPath)("M93.9,132.6c0,0-0.4-2.9-0.4-3.1c0-0.3,0.3-0.6,0.6-0.6c0.4,0,0.6,0.3,0.6,0.6c0,0.2-0.4,3.1-0.4,3.1H93.9z",r.transparent,0,"#888888"),(0,n.drawPath)("M96.8,136.9v-4.4h-1.1v-0.9h1.1v-1.8h1.1v1.8h1.4v0.9h-1.4v4.2c0,0.5,0.2,0.9,0.7,0.9c0.3,0,0.6-0.1,0.7-0.3l0.3,0.8c-0.3,0.3-0.6,0.4-1.3,0.4C97.3,138.5,96.8,137.9,96.8,136.9z",r.transparent,0,"#888888"),(0,n.drawPath)("M103.8,137.4l0.5-0.8c0.4,0.5,1.3,1,2.2,1c1,0,1.6-0.5,1.6-1.2c0-1.6-4.2-0.6-4.2-3.1c0-1,0.9-1.9,2.5-1.9c1.1,0,2,0.4,2.5,1l-0.5,0.7c-0.4-0.5-1.1-0.9-2-0.9c-0.9,0-1.5,0.5-1.5,1.1c0,1.5,4.2,0.5,4.2,3.1c0,1.1-0.9,2-2.7,2C105.4,138.5,104.5,138.2,103.8,137.4z",r.transparent,0,"#888888"),(0,n.drawPath)("M110.5,134.9c0-2,1.4-3.5,3.3-3.5c2,0,3.2,1.6,3.2,3.6v0.3h-5.5c0.1,1.3,1,2.3,2.4,2.3c0.8,0,1.6-0.3,2.1-0.9l0.5,0.7c-0.7,0.7-1.6,1-2.7,1C111.9,138.5,110.5,137.1,110.5,134.9z M113.8,132.3c-1.4,0-2.2,1.2-2.2,2.3h4.4C116,133.5,115.3,132.3,113.8,132.3z",r.transparent,0,"#888888"),(0,n.drawPath)("M118.4,134.9c0-2,1.4-3.5,3.3-3.5c2,0,3.2,1.6,3.2,3.6v0.3h-5.5c0.1,1.3,1,2.3,2.4,2.3c0.8,0,1.6-0.3,2.1-0.9l0.5,0.7c-0.7,0.7-1.6,1-2.7,1C119.8,138.5,118.4,137.1,118.4,134.9z M121.7,132.3c-1.4,0-2.2,1.2-2.2,2.3h4.4C123.9,133.5,123.2,132.3,121.7,132.3z",r.transparent,0,"#888888"),(0,n.drawPath)("M130.5,136.9v-4.4h-1.1v-0.9h1.1v-1.8h1v1.8h1.4v0.9h-1.4v4.2c0,0.5,0.2,0.9,0.7,0.9c0.3,0,0.6-0.1,0.7-0.3l0.3,0.8c-0.3,0.3-0.6,0.4-1.3,0.4C131,138.5,130.5,137.9,130.5,136.9z",r.transparent,0,"#888888"),(0,n.drawPath)("M138.9,138.3v-4.5c0-1.2-0.6-1.5-1.5-1.5c-0.8,0-1.6,0.5-2,1.1v4.9h-1V129h1v3.6c0.5-0.6,1.4-1.1,2.4-1.1c1.4,0,2.2,0.7,2.2,2.2v4.8H138.9z",r.transparent,0,"#888888"),(0,n.drawPath)("M141.9,129.9c0-0.4,0.3-0.7,0.7-0.7c0.4,0,0.7,0.3,0.7,0.7s-0.3,0.7-0.7,0.7C142.2,130.6,141.9,130.3,141.9,129.9z M142.1,138.3v-6.8h1.1v6.8H142.1z",r.transparent,0,"#888888"),(0,n.drawPath)("M144.6,137.4l0.5-0.8c0.4,0.5,1.3,1,2.2,1c1,0,1.6-0.5,1.6-1.2c0-1.6-4.2-0.6-4.2-3.1c0-1,0.9-1.9,2.5-1.9c1.1,0,2,0.4,2.5,1l-0.5,0.7c-0.4-0.5-1.1-0.9-2-0.9c-0.9,0-1.5,0.5-1.5,1.1c0,1.5,4.2,0.5,4.2,3.1c0,1.1-0.9,2-2.7,2C146.3,138.5,145.3,138.2,144.6,137.4z",r.transparent,0,"#888888"),(0,n.drawPath)("M155.2,129.9c0-0.4,0.3-0.7,0.7-0.7c0.4,0,0.7,0.3,0.7,0.7s-0.3,0.7-0.7,0.7C155.5,130.6,155.2,130.3,155.2,129.9z M155.4,138.3v-6.8h1.1v6.8H155.4z",r.transparent,0,"#888888"),(0,n.drawPath)("M166.7,138.3v-4.6c0-0.9-0.4-1.4-1.2-1.4c-0.7,0-1.4,0.5-1.8,1v5h-1.1v-4.6c0-0.9-0.4-1.4-1.2-1.4c-0.7,0-1.4,0.5-1.8,1.1v4.9h-1.1v-6.8h1.1v1c0.3-0.4,1.2-1.1,2.2-1.1c1,0,1.6,0.6,1.8,1.3c0.4-0.6,1.3-1.3,2.3-1.3c1.2,0,1.9,0.7,1.9,2v4.9H166.7z",r.transparent,0,"#888888"),(0,n.drawPath)("M174,138.3v-0.8c-0.6,0.6-1.3,0.9-2.2,0.9c-1.1,0-2.4-0.8-2.4-2.2c0-1.5,1.2-2.2,2.4-2.2c0.9,0,1.7,0.3,2.2,0.9v-1.2c0-0.9-0.7-1.4-1.7-1.4c-0.8,0-1.5,0.3-2.1,0.9l-0.5-0.7c0.7-0.8,1.6-1.1,2.7-1.1c1.4,0,2.6,0.6,2.6,2.3v4.7H174z M174,136.9v-1.3c-0.4-0.6-1.1-0.8-1.9-0.8c-1,0-1.7,0.6-1.7,1.5c0,0.9,0.7,1.5,1.7,1.5C172.9,137.7,173.6,137.5,174,136.9z",r.transparent,0,"#888888"),(0,n.drawPath)("M177.2,140.1l0.5-0.8c0.6,0.7,1.2,0.9,2.2,0.9c1.1,0,2.2-0.5,2.2-2v-1c-0.5,0.7-1.3,1.2-2.3,1.2c-1.8,0-3-1.3-3-3.5c0-2.2,1.2-3.5,3-3.5c0.9,0,1.7,0.4,2.3,1.2v-1h1.1v6.6c0,2.2-1.6,2.9-3.2,2.9C178.8,141.1,178,140.8,177.2,140.1z M182.1,136.4v-3c-0.4-0.6-1.2-1.1-2-1.1c-1.4,0-2.2,1.1-2.2,2.6c0,1.5,0.8,2.6,2.2,2.6C180.9,137.5,181.7,137,182.1,136.4z",r.transparent,0,"#888888"),(0,n.drawPath)("M184.8,134.9c0-2,1.4-3.5,3.3-3.5c2,0,3.2,1.6,3.2,3.6v0.3h-5.5c0.1,1.3,1,2.3,2.4,2.3c0.8,0,1.6-0.3,2.1-0.9l0.5,0.7c-0.7,0.7-1.6,1-2.7,1C186.3,138.5,184.8,137.1,184.8,134.9z M188.2,132.3c-1.4,0-2.2,1.2-2.2,2.3h4.4C190.4,133.5,189.7,132.3,188.2,132.3z",r.transparent,0,"#888888"),(0,n.drawPath)("M65.6,155.3V146h1.1v3.6c0.5-0.7,1.4-1.2,2.3-1.2c1.8,0,3,1.4,3,3.6c0,2.2-1.2,3.5-3,3.5c-1,0-1.8-0.5-2.3-1.2v1H65.6z M68.7,154.6c1.4,0,2.2-1.1,2.2-2.6c0-1.5-0.8-2.6-2.2-2.6c-0.8,0-1.7,0.5-2,1.1v3.1C67,154.1,67.9,154.6,68.7,154.6z",r.transparent,0,"#888888"),(0,n.drawPath)("M73.3,151.9c0-2,1.4-3.5,3.3-3.5c2,0,3.2,1.6,3.2,3.6v0.3h-5.5c0.1,1.3,1,2.3,2.4,2.3c0.8,0,1.6-0.3,2.1-0.9l0.5,0.7c-0.7,0.7-1.6,1-2.7,1C74.7,155.5,73.3,154.1,73.3,151.9z M76.6,149.3c-1.4,0-2.2,1.2-2.2,2.3h4.4C78.8,150.5,78.1,149.3,76.6,149.3z",r.transparent,0,"#888888"),(0,n.drawPath)("M81.2,151.9c0-2,1.4-3.5,3.4-3.5c1.2,0,2,0.5,2.5,1.2l-0.7,0.6c-0.4-0.6-1-0.9-1.7-0.9c-1.4,0-2.3,1.1-2.3,2.6c0,1.5,0.9,2.6,2.3,2.6c0.7,0,1.3-0.3,1.7-0.9l0.7,0.6c-0.5,0.7-1.2,1.2-2.5,1.2C82.5,155.5,81.2,154,81.2,151.9z",r.transparent,0,"#888888"),(0,n.drawPath)("M92.7,155.3v-0.8c-0.6,0.6-1.3,0.9-2.2,0.9c-1.1,0-2.4-0.8-2.4-2.2c0-1.5,1.2-2.2,2.4-2.2c0.9,0,1.7,0.3,2.2,0.9v-1.2c0-0.9-0.7-1.4-1.7-1.4c-0.8,0-1.5,0.3-2.1,0.9l-0.5-0.7c0.7-0.8,1.6-1.1,2.7-1.1c1.4,0,2.6,0.6,2.6,2.3v4.7H92.7z M92.7,153.9v-1.3c-0.4-0.6-1.1-0.8-1.9-0.8c-1,0-1.7,0.6-1.7,1.5c0,0.9,0.7,1.5,1.7,1.5C91.6,154.7,92.3,154.5,92.7,153.9z",r.transparent,0,"#888888"),(0,n.drawPath)("M100.4,155.3v-1c-0.5,0.6-1.4,1.1-2.4,1.1c-1.4,0-2.2-0.7-2.2-2.2v-4.8h1.1v4.5c0,1.2,0.6,1.5,1.5,1.5c0.8,0,1.6-0.5,2-1v-5h1.1v6.8H100.4z",r.transparent,0,"#888888"),(0,n.drawPath)("M103,154.4l0.5-0.8c0.4,0.5,1.3,1,2.2,1c1,0,1.6-0.5,1.6-1.2c0-1.6-4.2-0.6-4.2-3.1c0-1,0.9-1.9,2.5-1.9c1.1,0,2,0.4,2.5,1l-0.5,0.7c-0.4-0.5-1.1-0.9-2-0.9c-0.9,0-1.5,0.5-1.5,1.1c0,1.5,4.2,0.5,4.2,3.1c0,1.1-0.9,2-2.7,2C104.6,155.5,103.7,155.2,103,154.4z",r.transparent,0,"#888888"),(0,n.drawPath)("M109.7,151.9c0-2,1.4-3.5,3.3-3.5c2,0,3.2,1.6,3.2,3.6v0.3h-5.5c0.1,1.3,1,2.3,2.4,2.3c0.8,0,1.6-0.3,2.1-0.9l0.5,0.7c-0.7,0.7-1.6,1-2.7,1C111.1,155.5,109.7,154.1,109.7,151.9z M113,149.3c-1.4,0-2.2,1.2-2.2,2.3h4.4C115.2,150.5,114.5,149.3,113,149.3z",r.transparent,0,"#888888"),(0,n.drawPath)("M121.4,146.9c0-0.4,0.3-0.7,0.7-0.7c0.4,0,0.7,0.3,0.7,0.7s-0.3,0.7-0.7,0.7C121.7,147.6,121.4,147.3,121.4,146.9z M121.6,155.3v-6.8h1v6.8H121.6z",r.transparent,0,"#888888"),(0,n.drawPath)("M124.9,153.9v-4.4h-1.1v-0.9h1.1v-1.8h1v1.8h1.4v0.9H126v4.2c0,0.5,0.2,0.9,0.7,0.9c0.3,0,0.6-0.1,0.7-0.3l0.3,0.8c-0.3,0.3-0.6,0.4-1.3,0.4C125.4,155.5,124.9,154.9,124.9,153.9z",r.transparent,0,"#888888"),(0,n.drawPath)("M132.1,151.9c0-2,1.4-3.5,3.4-3.5c1.2,0,2,0.5,2.5,1.2l-0.7,0.6c-0.4-0.6-1-0.9-1.7-0.9c-1.4,0-2.3,1.1-2.3,2.6c0,1.5,0.9,2.6,2.3,2.6c0.7,0,1.3-0.3,1.7-0.9l0.7,0.6c-0.5,0.7-1.2,1.2-2.5,1.2C133.4,155.5,132.1,154,132.1,151.9z",r.transparent,0,"#888888"),(0,n.drawPath)("M139,151.9c0-2,1.3-3.5,3.3-3.5s3.3,1.6,3.3,3.5s-1.3,3.6-3.3,3.6S139,153.9,139,151.9zM144.6,151.9c0-1.4-0.8-2.6-2.2-2.6s-2.3,1.2-2.3,2.6c0,1.4,0.8,2.6,2.3,2.6S144.6,153.3,144.6,151.9z",r.transparent,0,"#888888"),(0,n.drawPath)("M155.6,155.3v-4.6c0-0.9-0.4-1.4-1.2-1.4c-0.7,0-1.4,0.5-1.8,1v5h-1.1v-4.6c0-0.9-0.4-1.4-1.2-1.4c-0.7,0-1.4,0.5-1.8,1.1v4.9h-1.1v-6.8h1.1v1c0.3-0.4,1.2-1.1,2.2-1.1c1,0,1.6,0.6,1.8,1.3c0.4-0.6,1.3-1.3,2.3-1.3c1.2,0,1.9,0.7,1.9,2v4.9H155.6z",r.transparent,0,"#888888"),(0,n.drawPath)("M158.3,151.9c0-2,1.4-3.5,3.3-3.5c2,0,3.2,1.6,3.2,3.6v0.3h-5.5c0.1,1.3,1,2.3,2.4,2.3c0.8,0,1.6-0.3,2.1-0.9l0.5,0.7c-0.7,0.7-1.6,1-2.7,1C159.7,155.5,158.3,154.1,158.3,151.9z M161.6,149.3c-1.4,0-2.2,1.2-2.2,2.3h4.4C163.8,150.5,163.2,149.3,161.6,149.3z",r.transparent,0,"#888888"),(0,n.drawPath)("M166,154.4l0.5-0.8c0.4,0.5,1.3,1,2.2,1c1,0,1.6-0.5,1.6-1.2c0-1.6-4.2-0.6-4.2-3.1c0-1,0.9-1.9,2.5-1.9c1.1,0,2,0.4,2.5,1l-0.5,0.7c-0.4-0.5-1.1-0.9-2-0.9c-0.9,0-1.5,0.5-1.5,1.1c0,1.5,4.2,0.5,4.2,3.1c0,1.1-0.9,2-2.7,2C167.6,155.5,166.7,155.2,166,154.4z",r.transparent,0,"#888888"),(0,n.drawPath)("M53.2,172.3v-5.8h-1.1v-0.9h1.1V165c0-1.4,0.8-2.2,2-2.2c0.5,0,1,0.1,1.4,0.5l-0.4,0.7c-0.2-0.2-0.5-0.3-0.8-0.3c-0.7,0-1.1,0.5-1.1,1.3v0.5h1.4v0.9h-1.4v5.8H53.2z",r.transparent,0,"#888888"),(0,n.drawPath)("M56.9,172.3v-6.8h1.1v1.1c0.5-0.7,1.3-1.2,2.3-1.2v1.1c-0.1,0-0.3,0-0.4,0c-0.6,0-1.5,0.5-1.8,1.1v4.8H56.9z",r.transparent,0,"#888888"),(0,n.drawPath)("M61.1,168.9c0-2,1.3-3.5,3.3-3.5s3.3,1.6,3.3,3.5s-1.3,3.6-3.3,3.6S61.1,170.9,61.1,168.9z M66.7,168.9c0-1.4-0.8-2.6-2.2-2.6c-1.4,0-2.3,1.2-2.3,2.6c0,1.4,0.8,2.6,2.3,2.6C65.9,171.6,66.7,170.3,66.7,168.9z",r.transparent,0,"#888888"),(0,n.drawPath)("M77.6,172.3v-4.6c0-0.9-0.4-1.4-1.2-1.4c-0.7,0-1.4,0.5-1.8,1v5h-1.1v-4.6c0-0.9-0.4-1.4-1.2-1.4c-0.7,0-1.4,0.5-1.8,1.1v4.9h-1.1v-6.8h1.1v1c0.3-0.4,1.2-1.1,2.2-1.1c1,0,1.6,0.6,1.8,1.3c0.4-0.6,1.3-1.3,2.3-1.3c1.2,0,1.9,0.7,1.9,2v4.9H77.6z",r.transparent,0,"#888888"),(0,n.drawPath)("M88.6,172.3v-0.8c-0.6,0.6-1.3,0.9-2.2,0.9c-1.1,0-2.4-0.8-2.4-2.2c0-1.5,1.2-2.2,2.4-2.2c0.9,0,1.7,0.3,2.2,0.9v-1.2c0-0.9-0.7-1.4-1.7-1.4c-0.8,0-1.5,0.3-2.1,0.9l-0.5-0.7c0.7-0.8,1.6-1.1,2.7-1.1c1.4,0,2.6,0.6,2.6,2.3v4.7H88.6z M88.6,170.9v-1.3c-0.4-0.6-1.1-0.8-1.9-0.8c-1,0-1.7,0.6-1.7,1.5c0,0.9,0.7,1.5,1.7,1.5C87.5,171.7,88.2,171.5,88.6,170.9z",r.transparent,0,"#888888"),(0,n.drawPath)("M96.4,171.3v3.6h-1.1v-9.3h1.1v1c0.5-0.7,1.3-1.2,2.3-1.2c1.8,0,3,1.3,3,3.5c0,2.2-1.2,3.6-3,3.6C97.8,172.5,97,172.1,96.4,171.3z M100.6,168.9c0-1.5-0.8-2.6-2.2-2.6c-0.8,0-1.7,0.5-2,1.1v3.1c0.4,0.6,1.2,1.1,2,1.1C99.8,171.6,100.6,170.4,100.6,168.9z",r.transparent,0,"#888888"),(0,n.drawPath)("M103.4,172.3v-6.8h1.1v1.1c0.5-0.7,1.3-1.2,2.3-1.2v1.1c-0.1,0-0.3,0-0.4,0c-0.6,0-1.5,0.5-1.8,1.1v4.8H103.4z",r.transparent,0,"#888888"),(0,n.drawPath)("M107.8,163.9c0-0.4,0.3-0.7,0.7-0.7c0.4,0,0.7,0.3,0.7,0.7s-0.3,0.7-0.7,0.7C108.2,164.6,107.8,164.3,107.8,163.9z M108,172.3v-6.8h1.1v6.8H108z",r.transparent,0,"#888888"),(0,n.drawPath)("M113,172.3l-2.8-6.8h1.1l2.3,5.5l2.2-5.5h1.1l-2.8,6.8H113z",r.transparent,0,"#888888"),(0,n.drawPath)("M122.3,172.3v-0.8c-0.6,0.6-1.3,0.9-2.2,0.9c-1.1,0-2.4-0.8-2.4-2.2c0-1.5,1.2-2.2,2.4-2.2c0.9,0,1.7,0.3,2.2,0.9v-1.2c0-0.9-0.7-1.4-1.7-1.4c-0.8,0-1.5,0.3-2.1,0.9l-0.5-0.7c0.7-0.8,1.6-1.1,2.7-1.1c1.4,0,2.6,0.6,2.6,2.3v4.7H122.3z M122.3,170.9v-1.3c-0.4-0.6-1.1-0.8-1.9-0.8c-1,0-1.7,0.6-1.7,1.5c0,0.9,0.7,1.5,1.7,1.5C121.1,171.7,121.9,171.5,122.3,170.9z",r.transparent,0,"#888888"),(0,n.drawPath)("M125.6,170.9v-4.4h-1.1v-0.9h1.1v-1.8h1v1.8h1.4v0.9h-1.4v4.2c0,0.5,0.2,0.9,0.7,0.9c0.3,0,0.6-0.1,0.7-0.3l0.3,0.8c-0.3,0.3-0.6,0.4-1.3,0.4C126.1,172.5,125.6,171.9,125.6,170.9z",r.transparent,0,"#888888"),(0,n.drawPath)("M129.1,168.9c0-2,1.4-3.5,3.3-3.5c2,0,3.2,1.6,3.2,3.6v0.3h-5.5c0.1,1.3,1,2.3,2.4,2.3c0.8,0,1.6-0.3,2.1-0.9l0.5,0.7c-0.7,0.7-1.6,1-2.7,1C130.6,172.5,129.1,171.1,129.1,168.9z M132.5,166.3c-1.4,0-2.2,1.2-2.2,2.3h4.4C134.7,167.5,134,166.3,132.5,166.3z",r.transparent,0,"#888888"),(0,n.drawPath)("M140.4,171.4l0.5-0.8c0.4,0.5,1.3,1,2.2,1c1,0,1.6-0.5,1.6-1.2c0-1.6-4.2-0.6-4.2-3.1c0-1,0.9-1.9,2.5-1.9c1.1,0,2,0.4,2.5,1l-0.5,0.7c-0.4-0.5-1.1-0.9-2-0.9c-0.9,0-1.5,0.5-1.5,1.1c0,1.5,4.2,0.5,4.2,3.1c0,1.1-0.9,2-2.7,2C142.1,172.5,141.1,172.2,140.4,171.4z",r.transparent,0,"#888888"),(0,n.drawPath)("M147.1,168.9c0-2,1.3-3.5,3.3-3.5s3.3,1.6,3.3,3.5s-1.3,3.6-3.3,3.6S147.1,170.9,147.1,168.9z M152.7,168.9c0-1.4-0.8-2.6-2.2-2.6s-2.3,1.2-2.3,2.6c0,1.4,0.8,2.6,2.3,2.6S152.7,170.3,152.7,168.9z",r.transparent,0,"#888888"),(0,n.drawPath)("M160.1,172.3v-1c-0.5,0.6-1.4,1.1-2.4,1.1c-1.4,0-2.2-0.7-2.2-2.2v-4.8h1.1v4.5c0,1.2,0.6,1.5,1.5,1.5c0.8,0,1.6-0.5,2-1v-5h1.1v6.8H160.1z",r.transparent,0,"#888888"),(0,n.drawPath)("M163.3,172.3v-6.8h1v1.1c0.5-0.7,1.3-1.2,2.3-1.2v1.1c-0.1,0-0.3,0-0.4,0c-0.6,0-1.5,0.5-1.8,1.1v4.8H163.3z",r.transparent,0,"#888888"),(0,n.drawPath)("M167.5,168.9c0-2,1.4-3.5,3.4-3.5c1.2,0,2,0.5,2.5,1.2l-0.7,0.6c-0.4-0.6-1-0.9-1.7-0.9c-1.4,0-2.3,1.1-2.3,2.6c0,1.5,0.9,2.6,2.3,2.6c0.7,0,1.3-0.3,1.7-0.9l0.7,0.6c-0.5,0.7-1.2,1.2-2.5,1.2C168.8,172.5,167.5,171,167.5,168.9z",r.transparent,0,"#888888"),(0,n.drawPath)("M174.4,168.9c0-2,1.4-3.5,3.3-3.5c2,0,3.2,1.6,3.2,3.6v0.3h-5.5c0.1,1.3,1,2.3,2.4,2.3c0.8,0,1.6-0.3,2.1-0.9l0.5,0.7c-0.7,0.7-1.6,1-2.7,1C175.9,172.5,174.4,171.1,174.4,168.9z M177.7,166.3c-1.4,0-2.2,1.2-2.2,2.3h4.4C179.9,167.5,179.3,166.3,177.7,166.3z",r.transparent,0,"#888888"),(0,n.drawPath)("M182.4,171.7c0-0.4,0.3-0.8,0.8-0.8s0.8,0.4,0.8,0.8c0,0.4-0.3,0.8-0.8,0.8S182.4,172.1,182.4,171.7z",r.transparent,0,"#888888")])},6306:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=i(8018),n=i(4424);t.default=function renderSticker(e){const{id:t,x:i,y:s,width:a,rotation:o,stackingOrder:l,properties:d}=e,h=(e=>e.properties.name?{url:e.properties.name,opts:{color:e.properties.color,fit:{width:e.width,height:e.height},isIcon:!0}}:void 0)(e);return(0,n.drawWidget)(t,d.parentId,i,s,a,a,o,l,h?[(0,n.drawImage)((0,r.box)(a,a),h,{centerX:!0,centerY:!1})]:[])}},7784:function(e,t,i){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.translucentRectangleBorder=void 0;const n=i(6916),s=i(2575),a=i(7201),o=r(i(1683)),l=i(7770),d=i(7206),h=i(249),c=i(45),u=i(4424),hasOpacity=e=>!!e.replace(/ /g,"").match(/^rgba\(.*,0\.\d+\)$/),drawText=(e,t,i,r,s,a,o,l,d)=>(0,u.drawHint)(e,"text",(0,u.drawTextBox)({x:a,y:r,width:t-2*a,height:i-r-s},o.fontSize,o.textAlign,l,1,(({backgroundColor:e,bold:t,fontFamily:i,italic:r,strike:s,underline:a,text:o})=>(0,c.formatHighlightableText)({bold:t,fontFamily:i,italic:r,strike:s,underline:a,color:hasOpacity(e)?"#000000":(0,n.stickyTextColor)(e)},o))(o),void 0,void 0,void 0,void 0,d));t.translucentRectangleBorder=(e,t,{whenTranslucent:i,cornerRadius:r})=>{if(!i.showStrokeBorder)return u.noop;const{strokeWidth:n}=i,s=0==r?0:r-n/2;return(0,h.drawState)(e,"dragging-visual-feedback",Object.assign(Object.assign({},t),{x:n/2,y:n/2,width:t.width-n,height:t.height-n,cornerRadius:s,backgroundColor:"transparent",strokeColor:i.strokeColor,strokeWidth:i.strokeWidth}))};const translucentEllipseBorder=(e,t,{whenTranslucent:i})=>{if(!i.showStrokeBorder)return u.noop;const{strokeWidth:r}=i;return(0,h.drawState)(e,"dragging-visual-feedback",Object.assign(Object.assign({},t),{x:r/2,y:r/2,width:t.width-r,height:t.height-r,backgroundColor:"transparent",strokeColor:i.strokeColor,strokeWidth:i.strokeWidth}))};t.default=function renderSticky(e,i,r,n,h,c,g,f){return i.properties.round?((e,{id:t,x:i,y:r,width:n,height:h,rotation:c,stackingOrder:g,properties:f},m,v,y,w,x,b)=>{var C,A;const I=f.border?1.5:0,S=(0,u.calculatePadding)(v.circular.padding,h,f.fontSize),T=null!==(C=f.verticalAlign)&&void 0!==C?C:v.circular.verticalAlign,_=(0,u.drawEllipse)(I,I,n-2*I,h-2*I,f.backgroundColor,f.border?s.black:s.transparent,f.border?3:0),M=f.link?(0,o.default)(e,`${t}-open`,n-3,h,x,f.link.url,f.link.title,f.link.source,!1,!1,"center","open",m,y):void 0,O=(0,a.drawLabelsInWidget)(e,t,n,h,f.labels,I,m,y.height,y.marginVertical,w,M,b);if(O&&"Group"===O.type){const e=(n-(O.width+(M?M.width:0)))/2;O.x=e,M&&(M.x=O.x+O.width+a.LABEL_LINK_SPACING)}const R=(0,u.calculatePadding)(v.circular.labelPaddingTop,h,f.fontSize),E=M||O,P=E?h-I-R-y.marginVertical-y.height:h,L=S,k=S,N=E?0:S,F=(0,s.isColorTranslucent)(f.backgroundColor);return(0,u.drawWidget)(t,f.parentId,i,r,n,h,c,g,[m?(0,l.drawHighlight)(`${t}-highlight`,_):u.noop,(0,d.drawShadow)(`${t}-shadow`,_,m,v.shadow),_,F?translucentEllipseBorder(`${t}-translucent-border`,_,v):u.noop,drawText(t,n,P,k,N,L,f,T,v.lineHeightMultiplier),O||u.noop,M||u.noop],null===(A=f.link)||void 0===A?void 0:A.url)})(e,i,r,h,c,g,n,f):((e,{id:i,x:r,y:n,width:h,height:c,rotation:g,stackingOrder:f,properties:m},v,y,w,x,b,C)=>{var A,I;const S=m.border?1.5:0,T=(0,u.drawRectangle)(S,S,h-2*S,c-2*S,m.backgroundColor,m.border?s.black:s.transparent,m.border?3:0,s.SOLID_STROKE_PATTERN,void 0,y.cornerRadius),_=(0,u.calculatePadding)(y.rectangular.padding,c,m.fontSize),M=(m.border?3:0)+_,O=null!==(A=m.verticalAlign)&&void 0!==A?A:y.rectangular.verticalAlign,R=m.link?(0,o.default)(e,`${i}-open`,h,c,b,m.link.url,m.link.title,m.link.source,!1,!1,"right","open",v,w):void 0,E=(0,a.drawLabelsInWidget)(e,i,h,c,m.labels,S,v,w.height,w.marginVertical,x,R,C),P=(0,u.calculatePadding)(y.rectangular.labelPaddingTop,c,m.fontSize),L=R||E,k=L?c-S-P-w.marginVertical-w.height:c,N=M,F=M,B=L?0:M,z=(0,s.isColorTranslucent)(m.backgroundColor);return(0,u.drawWidget)(i,m.parentId,r,n,h,c,g,f,[v?(0,l.drawHighlight)(`${i}-highlight`,T):u.noop,(0,d.drawShadow)(`${i}-shadow`,T,v,y.shadow),T,z?(0,t.translucentRectangleBorder)(`${i}-translucent-border`,T,y):u.noop,drawText(i,h,k,F,B,N,m,O,y.lineHeightMultiplier),E||u.noop,R||u.noop],null===(I=m.link)||void 0===I?void 0:I.url)})(e,i,r,h,c,g,n,f)}},7006:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=i(2575),n=i(3155),s=i(45),a=i(4424),buildTextbox=(e,t,i)=>{const r=e.properties.textContent;if(!r||!r.text)return;const o=r.padding||0,l=(e=>e?e.replace(/ *$/,""):e)(r.text),d=e.width-2*o,h=r.verticalAlign||"top",c=(0,n.drawHtmlTextboxFromHtmlCode)(`${e.id}-tb`,l,r.fontSize,r.fontFamily,"#000000",r.textAlign,d,t,i),u=c.width,g=c.height||(0,s.getSingleTextLineHeight)(t,r.fontSize,{fontFamily:r.fontFamily},i),f=o,m=((e,t,i,r)=>{switch(e){case"middle":return Math.max((i-2*t-r)/2,0);case"bottom":return Math.max(i-2*t-r,0);default:return 0}})(h,o,e.height,c.height),v=o+m;return g===c.height&&u===c.width&&0===f&&0===v?c:(0,a.drawGroup)(`${e.id}-padding`,f,v,c.width,c.height,0,[c])};t.default=function renderTableCell(e,t,i){const{id:n,x:s,y:o,height:l,width:d,rotation:h,stackingOrder:c,properties:u}=e,g=buildTextbox(e,t,i.lineHeightMultiplier);return(0,a.drawWidget)(n,u.parentId,s,o,d,l,h,c,[(0,a.drawRectangle)(0,0,d,l,r.transparent,r.transparent,0,r.SOLID_STROKE_PATTERN,void 0,void 0,0),g?(0,a.drawHint)(n,"text",g):a.noop,(0,a.drawWidgetsContainer)(n,0,0,d,l)])}},1680:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SPACE_BETWEEN_CELLS=void 0;const r=i(2575),n=i(7206),s=i(4424);t.SPACE_BETWEEN_CELLS=1;function validateCellBounds(e,t,i){return e.x>=0&&e.x<=t&&e.y>=0&&e.y<=i&&e.width>=0&&e.height>=0&&e.x+e.width<=t&&e.y+e.height<=i}t.default=function renderTable({id:e,x:i,y:a,width:o,height:l,rotation:d,stackingOrder:h,properties:c},u,g){const{backgroundColor:f,borderColor:m,borderWidth:v,rows:y,columns:w}=c,x=(0,s.drawRectangle)(0,0,o,l,f||"#FFFFFF",r.transparent,0),b=u.getTableCellsGrid(e),C=[];for(let e=0;e<y.length;e++)for(let t=0;t<w.length;t++){const i=b[e][t];if(i&&i.properties.backgroundColor&&i.properties.rowId===y[e].rowId&&i.properties.columnId===w[t].columnId&&!(0,r.isTransparent)(i.properties.backgroundColor))if(validateCellBounds(i,o,l)){const e=(0,s.drawRectangle)(i.x,i.y,i.width,i.height,i.properties.backgroundColor,r.transparent,0);C.push(e)}else console.warn(`Skipped drawing background of cell ${i.id} because it doesn't fit inside the table bounds`)}const A=m||"#000000",I=v||1,S=[],T=t.SPACE_BETWEEN_CELLS/2,drawRowLine=(t,i,n,a,l)=>{n!==a&&S.push((0,s.drawHint)(`${e}-${S.length}`,`row-${t}`,(0,s.drawLine)(n,i,Math.min(a,o+T),i,l?A:r.transparent,I,r.SOLID_STROKE_PATTERN,2),!0))},drawColumnLine=(t,i,n,a,o)=>{n!==a&&S.push((0,s.drawHint)(`${e}-${S.length}`,`col-${t}`,(0,s.drawLine)(i,n,i,Math.min(a,l+T),o?A:r.transparent,I,r.SOLID_STROKE_PATTERN,2),!0))};let _=T;for(let i=0;i<y.length+1;i++){const r=i<y.length?y[i].rowId:"last",n=i<y.length?y[i].height:0,s=0===i||i===y.length;if(_>l){console.warn(`Skipped drawing some row lines of table ${e} because it doesn't fit inside the table bounds, validate rows`);break}let a=0,o=0;for(let e=0;e<w.length;e++){const n=w[e].width,l=s?null:b[i-1][e],d=s?null:b[i][e];l!==d||null===l||null===d?o+=n+t.SPACE_BETWEEN_CELLS:(drawRowLine(r,_,a,o,!s),o+=n+t.SPACE_BETWEEN_CELLS,a=o)}drawRowLine(r,_,a,o,!s),_+=n+t.SPACE_BETWEEN_CELLS}let M=T;for(let i=0;i<w.length+1;i++){const r=i<w.length?w[i].columnId:"last",n=i<w.length?w[i].width:0,s=0===i||i===w.length;if(M>o){console.warn(`Skipped drawing some column lines of table ${e} because it doesn't fit inside the table bounds, validate columns`);break}let a=0,d=0;for(let e=0;e<y.length;e++){const n=y[e].height,o=s?null:b[e][i-1],l=s?null:b[e][i];o!==l||null===o||null===l?d+=n+t.SPACE_BETWEEN_CELLS:(drawColumnLine(r,M,a,d,!s),d+=n+t.SPACE_BETWEEN_CELLS,a=d)}drawColumnLine(r,M,a,l,!s),M+=n+t.SPACE_BETWEEN_CELLS}return S.push((0,s.drawRectangle)(T,T,o-2*T,l-2*T,r.transparent,A,I,r.SOLID_STROKE_PATTERN,void 0,void 0,4)),(0,s.drawWidget)(e,c.parentId,i,a,o,l,d,h,[g?(0,n.drawClassicDragShadow)(`${e}-shadow`,x):s.noop,x,...C,Object.assign(Object.assign({},(0,s.drawHint)(e,"dragging-border",(0,s.drawRectangle)(0,0,o,l,r.transparent,r.transparent,14,r.SOLID_STROKE_PATTERN,void 0,void 0,3))),{border:24,skipBoundsValidation:!0}),...S,(0,s.drawWidgetsContainer)(e,0,0,o,l)])}},6676:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.buildMeasuredTextItemCollection=t.buildTextItemCollection=void 0;const r=i(2829);function reduceTextItemsCollection(e,t,i){const r=e.size();let n=i;for(let i=0;i<r;i++)n=t(n,e.getFormat(i),e.getText(i));return n}function someTextItemCollection(e,t){const i=e.size();if(0===i)return!1;for(let r=0;r<i;r++)if(t(e.getFormat(r),e.getText(r)))return!0;return!1}function mapTextItemCollection(e,t){const i=[],r=e.size();for(let n=0;n<r;n++)i.push(t(e.getFormat(n),e.getText(n)));return i}function filterTextItemCollection(e,t){const i=e.size();let r=null;for(let n=0;n<i;n++){const i=e.getFormat(n),s=e.getText(n);t(i,s)?null!==r&&r.add(i,s):null===r&&(r=e.subTextItemCollection(0,n))}return r||e}function cloneTextItemCollection(e,t){const i=e.size();for(let r=0;r<i;r++)t.add(e.getFormat(r),e.getText(r));return t}function subTextItemCollection(e,t,i,r){for(let n=i;n<r;n++)t.add(e.getFormat(n),e.getText(n));return t}class TextItemCollectionImpl{constructor(){this.texts=[],this.formats=[]}size(){return this.texts.length}getText(e){return this.texts[e]}getFormat(e){return this.formats[e]}some(e){return someTextItemCollection(this,e)}reduce(e,t){return reduceTextItemsCollection(this,e,t)}map(e){return mapTextItemCollection(this,e)}filter(e){return filterTextItemCollection(this,e)}subTextItemCollection(e,t){return subTextItemCollection(this,new TextItemCollectionImpl,e,t)}cloneAsTextItemCollection(){return cloneTextItemCollection(this,new TextItemCollectionImpl)}add(e,t){const i=this.formats,n=i.length>0?i[i.length-1]:null;return this.texts.push(t),this.formats.push(null!==n&&(0,r.sameFormat)(n,e)?n:e),this}updateText(e,t){this.texts[e]=t}updateFormat(e,t){this.formats[e]=(0,r.sameFormat)(t,this.formats[e])?this.formats[e]:t}}t.buildTextItemCollection=()=>new TextItemCollectionImpl;class MeasuredTextItemCollectionImpl{constructor(){this.texts=[],this.widths=[],this.formats=[]}size(){return this.texts.length}getText(e){return this.texts[e]}getWidth(e){return this.widths[e]}getFormat(e){return this.formats[e]}getTotalWidth(){let e=0;const t=this.widths;for(let i=0;i<t.length;i++)e+=t[i];return e}reduceMeasured(e,t){return function reduceMeasuredTextItemsCollection(e,t,i){const r=e.size();let n=i;for(let i=0;i<r;i++)n=t(n,e.getFormat(i),e.getText(i),e.getWidth(i));return n}(this,e,t)}some(e){return someTextItemCollection(this,e)}reduce(e,t){return reduceTextItemsCollection(this,e,t)}map(e){return mapTextItemCollection(this,e)}mapMeasured(e){return function mapMeasuredTextItemCollection(e,t){const i=[],r=e.size();for(let n=0;n<r;n++)i.push(t(e.getFormat(n),e.getText(n),e.getWidth(n)));return i}(this,e)}filter(e){return filterTextItemCollection(this,e)}filterMeasured(e){return function filterMeasuredTextItemCollection(e,t){const i=e.size();let r=null;for(let n=0;n<i;n++){const i=e.getFormat(n),s=e.getText(n),a=e.getWidth(n);t(i,s,a)?null!==r&&r.add(i,s,a):null===r&&(r=e.subMeasuredTextItemCollection(0,n))}return r||e}(this,e)}cloneAsMeasuredTextItemCollection(){return function cloneMeasuredTextItemCollection(e,t){const i=e.size();for(let r=0;r<i;r++)t.add(e.getFormat(r),e.getText(r),e.getWidth(r));return t}(this,new MeasuredTextItemCollectionImpl)}cloneAsTextItemCollection(){return cloneTextItemCollection(this,new TextItemCollectionImpl)}subTextItemCollection(e,t){return subTextItemCollection(this,new TextItemCollectionImpl,e,t)}subMeasuredTextItemCollection(e,t){return function subMeasuredTextItemCollection(e,t,i,r){for(let n=i;n<r;n++)t.add(e.getFormat(n),e.getText(n),e.getWidth(n));return t}(this,new MeasuredTextItemCollectionImpl,e,t)}reverseMeasured(){return function reverseMeasuredTextItemCollection(e,t){for(let i=e.size()-1;i>=0;i--)t.add(e.getFormat(i),e.getText(i),e.getWidth(i));return t}(this,new MeasuredTextItemCollectionImpl)}add(e,t,i){const n=this.formats,s=n.length>0?n[n.length-1]:null;return this.texts.push(t),this.widths.push(i),this.formats.push(null!==s&&(0,r.sameFormat)(s,e)?s:e),this}updateText(e,t,i){this.texts[e]=t,this.widths[e]=i}updateFormat(e,t){this.formats[e]=(0,r.sameFormat)(t,this.formats[e])?this.formats[e]:t}}t.buildMeasuredTextItemCollection=()=>new MeasuredTextItemCollectionImpl},1824:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.cropSingleLineTextHorizontally=void 0;const r=i(6676),n=i(9494),s=i(2105),cropText=(e,t,i,r)=>{let s=(0,n.unicodeCombinedCharactersSequences)(i),a="";for(;s.length;){const i=Math.ceil(s.length/2),n=s.slice(0,i),o=n.join("");if(e(r,`${a}${o}...`)>t){if(s.length===i)break;s=n}else a+=o,s=s.slice(i)}if(!a)return null;return a+"..."};t.cropSingleLineTextHorizontally=(e,t,i,n)=>((e,t,i)=>{if(0===i.size())return i;let n=i.size();for(;n>0;){let r=0;for(let t=0;t<n-1;t++)r+=e(i.getFormat(t),i.getText(t));const a=i.getText(n-1),o=i.getFormat(n-1),l=e(o,a);if(r+l<=t)return n===i.size()?i:i.subTextItemCollection(0,n);const d=(0,s.rtrim)(a);if(r+(d===a?l:e(o,d))<=t){const e=i.subTextItemCollection(0,n-1);return e.add(o,d),e}const h=cropText(e,t-r,d,o);if(h){const e=i.subTextItemCollection(0,n-1);return e.add(o,h),e}n--}return(0,r.buildTextItemCollection)()})((0,s.buildMeasureTextFormat)(e,i),t,(0,s.mergeSameFormatItems)(n))},2829:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.sameFormat=void 0;t.sameFormat=(e,t)=>e===t||!!e.bold==!!t.bold&&!!e.italic==!!t.italic&&!!e.strike==!!t.strike&&!!e.underline==!!t.underline&&e.markHighlightColor===t.markHighlightColor&&e.markTextColor===t.markTextColor&&e.color===t.color&&e.fontFamily===t.fontFamily},45:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.processText=t.getSingleTextLineHeight=t.getTextHeight=t.formatHighlightableText=t.formatText=t.getTextWidth=t.cropSingleLineTextHorizontally=t.wrapText=void 0;const r=i(6541),n=i(2575),s=i(5347),a=i(6676),o=i(2105),l=i(9480);var d=i(9480);Object.defineProperty(t,"wrapText",{enumerable:!0,get:function(){return d.wrapText}});var h=i(1824);Object.defineProperty(t,"cropSingleLineTextHorizontally",{enumerable:!0,get:function(){return h.cropSingleLineTextHorizontally}});var c=i(2105);Object.defineProperty(t,"getTextWidth",{enumerable:!0,get:function(){return c.getTextWidth}});t.formatText=(e,t)=>(0,o.toItems)(t||"",(e=>e.color?e:Object.assign(Object.assign({},e),{color:n.black}))(e),!1);t.formatHighlightableText=(e,i)=>{if(i&&i.includes("<mark")){const t=(0,s.collectTextItemsFromHtml)((0,s.parseHtmlFromText)(e.fontFamily,24,e.color||n.black,(e=>{let t=e;return t.startsWith("<div>")||t.endsWith("</div>")||(t=`<div>${e}</div>`),e.replace(/\n/g,"<br>")})(i))),r=(0,a.buildTextItemCollection)();for(let i=0;i<t.size();i++){const s=t.getText(i),a=t.getFormat(i),o={fontFamily:a.fontFamily,bold:a.bold||!!e.bold,italic:a.italic||!!e.italic,markHighlightColor:a.markHighlightColor||e.markHighlightColor,markTextColor:a.markTextColor||e.markTextColor,strike:a.strike||!!e.strike,underline:a.underline||!!e.underline,color:a.color||e.color||n.black};r.add(o,s)}return r}return(0,t.formatText)(e,i)};t.getTextHeight=(e,t,i,r,n,s,a)=>{const o=(0,l.wrapText)(e,t,0,i,"left","top",r,n,s,a);return{height:o.lines.length*o.lineHeight,horizontalOverflow:o.horizontalOverflow,wrappedText:o}};t.getSingleTextLineHeight=(e,i,r,n)=>(0,t.getTextHeight)(e,Number.MAX_SAFE_INTEGER,i,0,1,(0,t.formatText)(r,"A"),n).height;t.processText=(e,t)=>{let i=null,n=null;for(let e=0;e<t.size();e++){const s=t.getFormat(e),a=(0,r.normalizeFont)(s);a!==s.fontFamily&&(null===n&&(n=t.cloneAsTextItemCollection(),i=n),n.updateFormat(e,Object.assign(Object.assign({},s),{fontFamily:a})))}return i=null!==i?i:t,i=(0,o.splitItemsIntoWords)(i),i=(0,o.splitTextItems)(e,i),i}},1265:(e,t)=>{"use strict";function minInArray(e){return 0===e.length?0:e.reduce(((e,t)=>Math.min(e,t)),e[0])}function maxInArray(e){return 0===e.length?0:e.reduce(((e,t)=>Math.max(e,t)),e[0])}Object.defineProperty(t,"__esModule",{value:!0}),t.UNICODE_EMOJIS_UNIFIED_SET_MAX=t.UNICODE_EMOJIS_UNIFIED_SET_MIN=t.UNICODE_EMOJIS_UNIFIED_SET=t.UNICODE_EMOJIS_UNIFIED_ARRAY=t.UNICODE_SYMBOLS_AS_EMOJIS_ARRAY=t.UNICODE_EMOJIS_ARRAY=t.UNICODE_EMOJIS_RANGE=t.UNICODE_CJK_IDEOGRAPH_OR_SYMBOL_RANGES_MAX=t.UNICODE_CJK_IDEOGRAPH_OR_SYMBOL_RANGES_MIN=t.UNICODE_CJK_IDEOGRAPH_OR_SYMBOL_RANGES=t.UNICODE_CJK_IDEOGRAPH_OR_SYMBOL_SET=t.UNICODE_ZERO_WIDTH_JOIN=t.UNICODE_ALL_COMBINERS_RANGES_MAX=t.UNICODE_ALL_COMBINERS_RANGES_MIN=t.UNICODE_ALL_COMBINERS_RANGES=t.UNICODE_EMOJI_MODIFIER_FITZPATRICK_RANGES=t.UNICODE_VARIANT_SELECTOR_RANGES=t.UNICODE_COMBINING_CHARACTER_RANGES=void 0,t.UNICODE_COMBINING_CHARACTER_RANGES=[768,879,6832,6911,7616,7664,8400,8432,65056,65071],t.UNICODE_VARIANT_SELECTOR_RANGES=[65024,65039,917760,917999],t.UNICODE_EMOJI_MODIFIER_FITZPATRICK_RANGES=[127995,127999],t.UNICODE_ALL_COMBINERS_RANGES=[...t.UNICODE_COMBINING_CHARACTER_RANGES,...t.UNICODE_VARIANT_SELECTOR_RANGES,...t.UNICODE_EMOJI_MODIFIER_FITZPATRICK_RANGES],t.UNICODE_ALL_COMBINERS_RANGES_MIN=minInArray(t.UNICODE_ALL_COMBINERS_RANGES),t.UNICODE_ALL_COMBINERS_RANGES_MAX=maxInArray(t.UNICODE_ALL_COMBINERS_RANGES),t.UNICODE_ZERO_WIDTH_JOIN=8205,t.UNICODE_CJK_IDEOGRAPH_OR_SYMBOL_SET=new Set([711,714,715,729,8224,8225,8240,8251,8258,8263,8264,8273,8413,8414,8448,8451,8453,8457,8458,8467,8470,8481,8491,8507,8528,8529,8530,8575,8585,8967,8978,9166,9251,9632,9633,9634,9649,9650,9651,9655,9660,9661,9665,9670,9671,9673,9675,9676,9711,9733,9734,9750,9751,10003,10010,10047,10048,11034,65040,65041,65042,65049,65309,127232]),t.UNICODE_CJK_IDEOGRAPH_OR_SYMBOL_RANGES=[11904,12255,12736,12783,13312,19903,19968,40959,63744,64255,131072,196607,8534,8538,8544,8555,8560,8571,9150,9164,9312,9362,9372,9471,9678,9683,9698,9702,9842,9853,10102,10111,12272,12333,12337,12591,12688,12735,12800,13311,19904,19967,63584,63586,65072,65135,65280,65292,65294,65306,65311,65519,94176,94207,94208,100351,100352,101119,110592,110847,110848,110895,110960,111359],t.UNICODE_CJK_IDEOGRAPH_OR_SYMBOL_RANGES_MIN=minInArray(t.UNICODE_CJK_IDEOGRAPH_OR_SYMBOL_RANGES),t.UNICODE_CJK_IDEOGRAPH_OR_SYMBOL_RANGES_MAX=maxInArray(t.UNICODE_CJK_IDEOGRAPH_OR_SYMBOL_RANGES),t.UNICODE_EMOJIS_RANGE=[8986,8987,9193,9196,9725,9726,9748,9749,9800,9811,9898,9899,9917,9918,9924,9925,9970,9971,9994,9995,10067,10069,10133,10135,11035,11036,127377,127386,127538,127542,127544,127546,127568,127569,127744,127756,127757,127758,127763,127765,127766,127768,127773,127774,127775,127776,127789,127791,127792,127793,127794,127795,127796,127797,127799,127818,128023,128041,128043,128062,128066,128100,128102,128107,128108,128109,128110,128172,128174,128181,128182,128183,128184,128235,128236,128237,128240,128244,128246,128247,128249,128252,128255,128258,128260,128263,127820,127823,127825,127867,127870,127871,127872,127891,127904,127940,127951,127955,127968,127971,127973,127984,127992,128007,128009,128011,128012,128014,128015,128016,128017,128018,128266,128276,128278,128299,128300,128301,128302,128317,128331,128334,128336,128347,128348,128359,128405,128406,128507,128511,128513,128518,128519,128520,128521,128525,128530,128532,128540,128542,128544,128549,128550,128551,128552,128555,128558,128559,128560,128563,128567,128576,128577,128580,128581,128591,128641,128642,128643,128645,128650,128651,128657,128659,128665,128666,128667,128673,128676,128677,128679,128685,128686,128689,128691,128693,128695,128696,128697,128702,128705,128709,128721,128722,128726,128727,128733,128735,128747,128748,128756,128758,128759,128760,128763,128764,128992,129003,129293,129295,129296,129304,129305,129310,129312,129319,129320,129327,129329,129330,129331,129338,129340,129342,129344,129349,129351,129355,129357,129359,129360,129374,129375,129387,129388,129392,129395,129398,129399,129400,129404,129407,129408,129412,129413,129425,129426,129431,129432,129442,129443,129444,129445,129450,129451,129453,129454,129455,129456,129465,129466,129471,129473,129474,129475,129482,129485,129487,129488,129510,129511,129535,129648,129651,129656,129658,129659,129660,129664,129666,129667,129670,129680,129685,129686,129704,129705,129708,129712,129718,129719,129722,129728,129730,129731,129733,129744,129750,129751,129753,129760,129767,129776,129782],t.UNICODE_EMOJIS_ARRAY=[9200,9203,9855,9875,9889,9934,9940,9962,9973,9978,9981,9989,10024,10060,10062,10071,10160,10175,11088,11093,126980,127183,127374,127489,127514,127535,127759,127760,127761,127762,127769,127770,127771,127772,127819,127824,127868,127941,127942,127943,127944,127945,127946,127972,127988,128008,128019,128020,128021,128022,128042,128064,128101,128173,128238,128239,128245,128248,128259,128264,128265,128277,128378,128420,128512,128526,128527,128528,128529,128533,128534,128535,128536,128537,128538,128539,128543,128556,128557,128564,128565,128566,128640,128646,128647,128648,128649,128652,128653,128654,128655,128656,128660,128661,128662,128663,128664,128674,128675,128678,128690,128694,128703,128704,128716,128720,128725,128761,128762,129008,129292,129311,129328,129343,129356,129393,129394,129401,129402,129403,129472,129483,129484,129652],t.UNICODE_SYMBOLS_AS_EMOJIS_ARRAY=[169,174,8252,8265,8482,8505,8596,8597,8598,8599,8600,8601,8617,8618,9e3,9167,9197,9198,9199,9201,9202,9208,9209,9210,9410,9642,9643,9654,9664,9723,9724,9728,9729,9730,9731,9732,9742,9745,9752,9757,9760,9762,9763,9766,9770,9774,9775,9784,9785,9786,9792,9794,9823,9824,9827,9829,9830,9832,9851,9854,9874,9876,9877,9878,9879,9881,9883,9884,9888,9895,9904,9905,9928,9935,9937,9939,9961,9968,9969,9972,9975,9976,9977,9986,9992,9993,9996,9997,9999,10002,10004,10006,10013,10017,10035,10036,10052,10055,10083,10084,10145,10548,10549,11013,11014,11015,12336,12349,12951,12953,127344,127345,127358,127359,127490,127543,127777,127780,127781,127782,127783,127784,127785,127786,127787,127788,127798,127869,127894,127895,127897,127898,127899,127902,127903,127947,127948,127949,127950,127956,127957,127958,127959,127960,127961,127962,127963,127964,127965,127966,127967,127987,127989,127991,128063,128065,128253,128329,128330,128367,128368,128371,128372,128373,128374,128375,128376,128377,128391,128394,128395,128396,128397,128400,128421,128424,128433,128434,128444,128450,128451,128452,128465,128466,128467,128476,128477,128478,128481,128483,128488,128495,128499,128506,128715,128717,128718,128719,128736,128737,128738,128739,128740,128741,128745,128752,128755],t.UNICODE_EMOJIS_UNIFIED_ARRAY=[...t.UNICODE_EMOJIS_ARRAY,...t.UNICODE_SYMBOLS_AS_EMOJIS_ARRAY,...t.UNICODE_EMOJIS_RANGE.reduce(((e,t,i,r)=>{if(i%2==1){const n=t;for(let t=r[i-1];t<=n;t++)e.push(t)}return e}),[])],t.UNICODE_EMOJIS_UNIFIED_SET=new Set(t.UNICODE_EMOJIS_UNIFIED_ARRAY),t.UNICODE_EMOJIS_UNIFIED_SET_MIN=minInArray(t.UNICODE_EMOJIS_UNIFIED_ARRAY),t.UNICODE_EMOJIS_UNIFIED_SET_MAX=maxInArray(t.UNICODE_EMOJIS_UNIFIED_ARRAY)},9494:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.unicodeSplitByCJK=t.unicodeSplitByEmojis=t.unicodeTextHasEmoji=t.unicodeCombinedCharactersSequences=t.isUnicodeEmoji=t.isUnicodeCJK=t.isUnicodeCombinerCode=void 0;const r=i(1265),n=i(153);function isUnicodeCombinerCode(e){if(e>=r.UNICODE_ALL_COMBINERS_RANGES_MIN&&e<=r.UNICODE_ALL_COMBINERS_RANGES_MAX){const t=r.UNICODE_ALL_COMBINERS_RANGES;for(let i=0;i<t.length;i+=2)if(e>=t[i]&&e<=t[i+1])return!0}return!1}function isUnicodeCJK(e){if(e>=r.UNICODE_CJK_IDEOGRAPH_OR_SYMBOL_RANGES_MIN&&e<=r.UNICODE_CJK_IDEOGRAPH_OR_SYMBOL_RANGES_MAX){if(r.UNICODE_CJK_IDEOGRAPH_OR_SYMBOL_SET.has(e))return!0;const t=r.UNICODE_CJK_IDEOGRAPH_OR_SYMBOL_RANGES;for(let i=0;i<t.length;i+=2)if(e>=t[i]&&e<=t[i+1])return!0}return!1}function isUnicodeEmoji(e){return e>=r.UNICODE_EMOJIS_UNIFIED_SET_MIN&&e<=r.UNICODE_EMOJIS_UNIFIED_SET_MAX&&r.UNICODE_EMOJIS_UNIFIED_SET.has(e)}function unicodeCharactersSequenceLen(e,t){var i,n;if(e>=t.length)return 0;if(e+1>=t.length)return 1;const s=null!==(i=t[e+1].codePointAt(0))&&void 0!==i?i:0;let a=1;return isUnicodeCombinerCode(s)?(a++,e+a<t.length&&(null!==(n=t[e+a].codePointAt(0))&&void 0!==n?n:0)===r.UNICODE_ZERO_WIDTH_JOIN&&(a++,a+=unicodeCharactersSequenceLen(e+a,t))):s===r.UNICODE_ZERO_WIDTH_JOIN&&(a++,a+=unicodeCharactersSequenceLen(e+a,t)),a}function unicodeCombinedCharactersSequences(e){const t=(0,n.utf16Characters)(e);let i=null;const r=t.length;let s=0;for(;s<r;){const e=t[s],r=unicodeCharactersSequenceLen(s,t);if(1===r)null!==i&&i.push(e);else{null===i&&(i=t.slice(0,s));let n=e;for(let e=1;e<r;e++)n+=t[s+e];i.push(n)}s+=r}return null!=i?i:t}t.isUnicodeCombinerCode=isUnicodeCombinerCode,t.isUnicodeCJK=isUnicodeCJK,t.isUnicodeEmoji=isUnicodeEmoji,t.unicodeCombinedCharactersSequences=unicodeCombinedCharactersSequences,t.unicodeTextHasEmoji=function unicodeTextHasEmoji(e){for(let t=0;t<e.length;t++){let i=e.charCodeAt(t);if((0,n.isHighSurrogatePair)(i)&&t+1<e.length){const r=e.charCodeAt(t+1);i=(0,n.combineSurrogatePairs)(i,r),t++}if(isUnicodeEmoji(i))return!0}return!1},t.unicodeSplitByEmojis=function unicodeSplitByEmojis(e){var t;const i=unicodeCombinedCharactersSequences(e),r=[];let n="";for(let e=0;e<i.length;e++){const s=i[e];isUnicodeEmoji(null!==(t=s.codePointAt(0))&&void 0!==t?t:0)?(n.length>0&&r.push(n),r.push(s),n=""):n+=s}return n.length>0&&r.push(n),r},t.unicodeSplitByCJK=function unicodeSplitByCJK(e){let t=!1;for(let i=0,r=e.length;i<r&&!t;++i){let r=e.charCodeAt(i);if((0,n.isHighSurrogatePair)(r)&&i+1<e.length){const t=e.charCodeAt(i+1);r=(0,n.combineSurrogatePairs)(r,t),i++}t=isUnicodeCJK(r)}if(!t)return null;const i=[];let r="",s=!1;for(let t=0,a=e.length;t<a;++t){let a=e.charCodeAt(t),o=e[t];if((0,n.isHighSurrogatePair)(a)&&t+1<e.length){const i=e.charCodeAt(t+1);a=(0,n.combineSurrogatePairs)(a,i),o+=e[t+1],t++}const l=isUnicodeCJK(a);r?s||l?(i.push(r),r=o,s=l):r+=o:(r+=o,s=l)}return r&&i.push(r),i}},153:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.utf16CharactersValues=t.combineSurrogatePairs=t.isHighSurrogatePair=t.utf16Characters=t.utf16Len=void 0,t.utf16Len=function utf16Len(e){const t=e.length;let i=0;for(let r=0;r<t;r++){const n=e.charCodeAt(r);55296<=n&&n<=56319&&r+1<t&&(i++,r++)}return t-i},t.utf16Characters=function utf16Characters(e){return[...e]},t.isHighSurrogatePair=function isHighSurrogatePair(e){return 55296<=e&&e<=56319},t.combineSurrogatePairs=function combineSurrogatePairs(e,t){return 1024*(e-55296)+(t-56320)+65536},t.utf16CharactersValues=function utf16CharactersValues(e){const t=e.length,i=[];let r=0;for(;r<t;){const n=e.charCodeAt(r);if(55296<=n&&n<=56319&&r+1<t){const t=1024*(n-55296)+(e.charCodeAt(r+1)-56320)+65536;i.push(t),r++}else i.push(n);r++}return i}},2105:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.splitTextItems=t.getTextWidth=t.buildMeasureTextFormat=t.mergeSameFormatItems=t.expandLines=t.splitItemsIntoWords=t.toItems=t.ltrim=t.rtrim=void 0;const r=i(6541),n=i(6676),s=i(2829);t.rtrim=e=>e.replace(/[ \t]*$/,"");t.ltrim=e=>e.replace(/^[ \t]*/,"");const isNonPrintable=e=>void 0!==e&&e<32&&9!==e&&10!==e&&13!==e,removeNonPrintableCharacters=e=>(e=>{const t=e.length;for(let i=0;i<t;i++)if(isNonPrintable(e.charCodeAt(i)))return!0;return!1})(e)?e.replace(/./g,(e=>isNonPrintable(e.codePointAt(0))?"":e)):e;t.toItems=(e,t,i)=>{if(""===e||"\n"===e)return(0,n.buildTextItemCollection)().add(t,e);const r=removeNonPrintableCharacters((e=>e.indexOf("&")<0?e:e.replace(/&nbsp;/g," ").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&").replace(/&quot;/g,'"'))(e)),s=i?r.split(" "):[r],a=s.length-1,o=(0,n.buildTextItemCollection)();for(let e=0;e<s.length;e++)e!==a?o.add(t,s[e]+" "):o.add(t,s[e]);return o};t.splitItemsIntoWords=e=>{const i=(0,n.buildTextItemCollection)();for(let r=0;r<e.size();r++){const n=e.getText(r),s=e.getFormat(r),a=(0,t.toItems)(n,s,!0);for(let e=0;e<a.size();e++)i.add(a.getFormat(e),a.getText(e))}return i};t.expandLines=e=>e.reduce(((e,t,i)=>"\n"===i?(e.add(t,i),e):(i.split("\n").forEach(((i,r)=>{0===r||e.add(t,"\n"),i&&e.add(t,i)})),e)),(0,n.buildTextItemCollection)()).reduce(((e,t,i)=>("\n"===i?e.push((0,n.buildTextItemCollection)().add({fontFamily:t.fontFamily},"")):e[e.length-1].add(t,i),e)),[(0,n.buildTextItemCollection)()]);t.mergeSameFormatItems=e=>{const t=(0,n.buildTextItemCollection)();for(let i=0;i<e.size();i++){const r=e.getText(i),n=e.getFormat(i);if(0===i)t.add(n,r);else{const e=t.size()-1;(0,s.sameFormat)(n,t.getFormat(e))?t.updateText(e,t.getText(e)+r):t.add(n,r)}}return t};t.buildMeasureTextFormat=(e,t)=>(i,n)=>e.measureText(i.bold?(0,r.makeBold)(i.fontFamily):i.fontFamily,t,n);t.getTextWidth=(e,i,r)=>{const n=(0,t.expandLines)(r);if(0===n.length)return 0;const s=(0,t.buildMeasureTextFormat)(e,i);return n.map((e=>t=>t.reduce(((t,i,r)=>t+e(i,r)),0))(s)).reduce(((e,t)=>Math.max(e,t)),0)};t.splitTextItems=(e,t)=>{let i=null;for(let r=0;r<t.size();r++){const n=t.getText(r),s=t.getFormat(r),a=e.splitTextItem(n,s);if(null!==a){null===i&&(i=t.subTextItemCollection(0,r));for(let e=0;e<a.texts.length;e++){const t=a.texts[e],r=void 0!==a.fontFamilies?a.fontFamilies[e]:void 0;void 0===r||r===s.fontFamily?i.add(s,t):i.add(Object.assign(Object.assign({},s),{fontFamily:r}),t)}}else null!==i&&i.add(s,n)}return null!==i?i:t}},9480:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.wrapText=void 0;const r=i(6541),n=i(6676),s=i(2829),a=i(9494),o=i(153),l=i(2105),rtrimLastItem=(e,t,i)=>{if(0===i.size())return i;const n=i.size()-1,s=i.getText(n),a=(0,l.rtrim)(s);if(s===a)return i;const o=i.getFormat(n),d=e.measureText(o.bold?(0,r.makeBold)(o.fontFamily):o.fontFamily,t,a),h=i.cloneAsMeasuredTextItemCollection();return h.updateText(n,a,d),h},splitLongWord=(e,t,i,r,n)=>{const s=[];let o="",l=0;const d=(0,a.unicodeCombinedCharactersSequences)(r);for(let r=0,a=d.length;r<a;++r){const a=o+d[r],h=e(n,a);if(h<=t)o=a,l=h;else if(""!==o){if(s.push({text:o,width:l}),o=d[r],l=e(n,o),l>t&&!i)return[]}else{if(!i)return[];o=a,l=h}}return o&&s.push({text:o,width:l}),s},joinInvalidHyphenationParts=(e,t)=>{if(!t.onlyMidWord)return e;const i=[];for(const r of e)!i.length||r.match(/^\w/)?i.push(r):i[i.length-1]+=`${t.delim}${r}`;return i},hyphenate=(e,t)=>{if(!e.some(((e,i)=>i.includes(t.delim))))return e;const i=(0,n.buildTextItemCollection)();for(let r=0;r<e.size();r++){const n=e.getText(r),s=e.getFormat(r);if(!n.includes(t.delim)){i.add(s,n);continue}const a=n.split(t.delim),o=joinInvalidHyphenationParts(a,t),l=o.length-1;o.forEach(((e,r)=>{t.ownWord?(i.add(s,e),r!==l&&i.add(s,t.delim)):i.add(s,r!==l?e+t.delim:e)}))}return i},d=[{delim:"\n",ownWord:!0},{delim:"-"},{delim:"…"},{delim:"="},{delim:"/"},{delim:"\t"},{delim:"?",onlyMidWord:!0}],createHyphenationOpportunities=e=>{let t=e;for(let e=0;e<d.length;e++)t=hyphenate(t,d[e]);return t=(e=>{let t=null;for(let i=0;i<e.size();i++){const r=e.getText(i),n=e.getFormat(i);if((0,a.unicodeTextHasEmoji)(r)){null===t&&(t=e.subTextItemCollection(0,i));const s=(0,a.unicodeSplitByEmojis)(r);for(let e=0;e<s.length;e++)t.add(n,s[e])}else null!==t&&t.add(n,r)}return null!=t?t:e})(t),t=(e=>{if(!e.some((e=>(0,r.areAllFontFamilyCharactersHyphenableCandidates)(e.fontFamily))))return e;const t=(0,n.buildTextItemCollection)();for(let i=0;i<e.size();i++){const n=e.getFormat(i),s=e.getText(i);if(!(0,r.areAllFontFamilyCharactersHyphenableCandidates)(n.fontFamily)){t.add(n,s);continue}const a=(0,o.utf16Characters)(s);for(let e=0;e<a.length;e++)t.add(n,a[e])}return t})(t),t},h={center:"middle",left:"start",right:"end"};t.wrapText=(e,t,i,a,o,d,c,u,g,f)=>{const{lines:m,horizontalOverflow:v}=((e,t,i,r,a,o)=>{const d=(0,l.buildMeasureTextFormat)(e,i),h=createHyphenationOpportunities(o),c=[];let u=null,g=0;const appendToCurrentLine=(e,t,i)=>{if(null===u)return u=(0,n.buildMeasuredTextItemCollection)(),u.add(e,t,i),g=i,void c.push(u);const r=u.size()-1;if(r>=0&&(0,s.sameFormat)(u.getFormat(r),e)){const n=u.getText(r),s=u.getWidth(r),a=n+t,o=n.endsWith(" ")||t.startsWith(" ")?s+i:d(e,a);u.updateText(r,a,o)}else u.add(e,t,i);g+=i},fits=e=>g+e<t+.1,lineAvailableWidth=()=>t+.1-g,f=h.size()>0?d(h.getFormat(0),"8"):i,widthHeuristic=e=>e.length*f,m=h===o?h.cloneAsTextItemCollection():h;for(let o=0;o<m.size();o++){const h=m.getText(o),f=m.getFormat(o);if(!h)continue;if("\n"===h){if(!u){const e=(0,n.buildMeasuredTextItemCollection)();e.add(f,"",0),c.push(e);continue}c[c.length-1]=rtrimLastItem(e,i,u),u=(0,n.buildMeasuredTextItemCollection)(),g=0,c.push(u);continue}const v=lineAvailableWidth();if(widthHeuristic(h)<v&&o+1<m.size()){let e=h,t=0;for(let i=o+1;i<m.size()&&"\n"!==m.getText(i)&&(0,s.sameFormat)(m.getFormat(i),f)&&widthHeuristic(e)+widthHeuristic(m.getText(i))<v;i++)e+=m.getText(i),t++;if(t>0){const i=d(f,e);if(fits(i)){appendToCurrentLine(f,e,i),o+=t;continue}}}const y=d(f,h);if(fits(y)){appendToCurrentLine(f,h,y);continue}const w=(0,l.rtrim)(h);if(!w)continue;if(w!==h){const e=d(f,w);if(fits(e)){appendToCurrentLine(f,w,e);continue}}if(u&&u.size()>0&&(u=rtrimLastItem(e,i,u),c[c.length-1]=u),y<=t){u=(0,n.buildMeasuredTextItemCollection)(),u.add(f,h,y),g=y,c.push(u);continue}const x=(0,l.ltrim)(w);if(x!==w||!r){const e=d(f,x);if(e<=t||!r){u&&!u.size()?u.add(f,x,e):(u=(0,n.buildMeasuredTextItemCollection)(),u.add(f,h,y),c.push(u)),g=y;continue}}const b=splitLongWord(d,t,a,h,f);if(!b.length)return{lines:[],horizontalOverflow:!1};b.forEach((e=>{const t=(0,n.buildMeasuredTextItemCollection)();t.add(f,e.text,e.width),c.push(t)})),u=c[c.length-1],g=u.getWidth(0)}if(c.length){const t=c.length-1,r=c[t];c[t]=rtrimLastItem(e,i,r)}return{lines:c,horizontalOverflow:!!a&&c.some((e=>e.getTotalWidth()>t))}})(e,t,a,0===c,1===u,g),{lineHeight:y,ascent:w,descent:x}=(0,r.getUnifiedLineMetrics)(m,a,f),b=h[o],C=((e,t)=>"middle"===t?e/2:"start"===t?0:e)(t,b),A=((e,t,i,r,n)=>"top"===e||i*r>n?t:"bottom"===e?n-i*r+t:1===r?n/2+t/2*.730378496982995:n/2-i*r/2+t)(d,w,y,m.length,i);return{lines:m,textX:C,textY:A,anchor:b,lineHeight:y,ascent:w,descent:x,horizontalOverflow:v}}},1305:function(e,t,i){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=i(2575),s=i(3155),a=r(i(1683)),o=i(7770),l=i(45),d=i(4424),buildContent=(e,t,i,r)=>{const n=(e=>e?e.replace(/ *$/,""):e)(e.properties.text),a=e.properties.fixedWidth?e.width-2*t:void 0,o="freeText"===e.properties.textType?(0,s.drawHtmlTextbox)(`${e.id}-tb`,((e,t)=>(0,l.formatHighlightableText)({fontFamily:e.properties.fontFamily,bold:e.properties.bold,italic:e.properties.italic,underline:e.properties.underline,strike:e.properties.strike},t))(e,n),e.properties.fontSize,e.properties.textAlign,a,!0,i,r):(0,s.drawHtmlTextboxFromHtmlCode)(`${e.id}-tb`,n,e.properties.fontSize,e.properties.fontFamily,"#000000",e.properties.textAlign,a,i,r),h=o.width,c=o.height||(0,l.getSingleTextLineHeight)(i,e.properties.fontSize,"freeText"===e.properties.textType?{fontFamily:e.properties.fontFamily,bold:e.properties.bold,italic:e.properties.italic,underline:e.properties.underline,strike:e.properties.strike}:{fontFamily:e.properties.fontFamily},r);return c===o.height&&h===o.width&&0===t?{textBox:o,width:h,height:c}:{textBox:(0,d.drawGroup)(`${e.id}-padding`,t,t,o.width,o.height,0,[o]),width:h+2*t,height:c+2*t}};t.default=function renderTitle(e,t,i,r,s,l){const{id:h,x:c,y:u,rotation:g,properties:f,stackingOrder:m}=t,{fontSize:v,fixedWidth:y,link:w}=f,x=(e=>!!e.properties.backgroundColor&&!(0,n.isTransparent)(e.properties.backgroundColor))(t),b=x?(0,d.calculatePadding)(s.padding,t.height,v):0,{textBox:C,width:A,height:I}=buildContent(t,b,e,s.lineHeightMultiplier),S=!!w,T=!y||A>=l.small.width,_=y||!S?A:S&&x?Math.max(l.small.width,A):Math.max(l.small.width,A)+5,M=S?x?I+24:I+29:I,O=(0,d.drawRectangle)(0,0,_,M,f.backgroundColor,n.transparent,0);return(0,d.drawWidget)(h,f.parentId,c,u,_,M,g,m,[i?(0,o.drawHighlight)(`${h}-highlight`,O):d.noop,x?O:d.noop,(0,d.drawHint)(h,"text",C),w&&T?(0,a.default)(e,`${h}-open`,x?_-8:_,x?M-8:M,r,w.url,w.title,w.source,!1,!1,"right","open",i,l):d.noop],null==w?void 0:w.url)}},3287:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isDrawingPrimitiveSimpleWithSize=void 0;t.isDrawingPrimitiveSimpleWithSize=e=>"Rectangle"===e.type||"TextBox"===e.type||"WrappedTextBox"===e.type||"Ellipse"===e.type||"Image"===e.type},4424:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.calculatePadding=t.isDrawingPrimitive=t.isWidgetPrimitive=t.hookHelpers=t.drawHint=t.shiftPrimitives=t.shift=t.cleanTags=t.getWidgets=t.wrapTextBox=t.noop=t.drawWidgetsContainer=t.getWidgetIdFromWidgetsContainerId=t.generateWidgetsContainerId=t.drawWidget=t.drawTextBox=t.drawRectangle=t.drawPath=t.drawLine=t.drawImage=t.drawGroup=t.drawEllipse=t.WIDGETS_CONTAINER_HINT=t.WIDGET_HINT=void 0;const r=i(4086),n=i(2575),s=i(8748),a=i(45);t.WIDGET_HINT="widget",t.WIDGETS_CONTAINER_HINT="widgets-container";const o=["group",t.WIDGET_HINT,t.WIDGETS_CONTAINER_HINT],defaultHitTest=(e,t)=>void 0!==e?e:(0,n.isTransparent)(t)?1:0;t.drawEllipse=(e,t,i,r,s,a,o,l=n.SOLID_STROKE_PATTERN,d,h=1,c,u=0)=>({backgroundColor:s,clipArgs:d,height:r,hitTest:defaultHitTest(c,s),opacity:h,shadow:u,strokeColor:a,strokePattern:l,strokeWidth:o,type:"Ellipse",width:i,x:e,y:t});t.drawGroup=(e,t,i,r,n,s,a,l,d=1,h,c,u={},g,f=!1)=>({animations:u,border:0,children:a,clip:l,id:e,scale:d,x:t,y:i,width:r,height:n,rotation:s||0,type:"Group",hint:h&&!o.includes(h)?h:null,state:c,url:g,skipBoundsValidation:f});t.drawImage=({height:e,width:t,x:i,y:r},s,a,o=n.transparent,l,d=0,h="low",c=!1,u)=>({errorFallback:l,height:e,hitTest:d,loadingColor:o,preserveAspectRatio:a,type:"Image",urlInfo:s,width:t,x:i,y:r,priority:h,showLoading:c,imageOwnerId:u});t.drawLine=(e,t,i,r,s,a,o=n.SOLID_STROKE_PATTERN,l=1,d=0)=>({hitTest:l,strokeColor:s,strokePattern:o,strokeStyleOffset:d,strokeWidth:a,x1:e,x2:i,y1:t,y2:r,type:"Line"});t.drawPath=(e,t,i,r,s,a=n.SOLID_STROKE_PATTERN,o="round",l="miter",d,h=0,c=0)=>({backgroundColor:r,hitTest:defaultHitTest(d,r||""),lineCap:o,lineJoin:l,path:e,shadow:h,stretch:s,strokeColor:t,strokePattern:a,strokeStyleOffset:c,strokeWidth:i,type:"Path"});t.drawRectangle=(e,t,i,r,s,a,o,l=n.SOLID_STROKE_PATTERN,d,h=0,c,u=0)=>({backgroundColor:s,clipArgs:d,cornerRadius:h,height:r,hitTest:defaultHitTest(c,s),shadow:u,strokeColor:a,strokePattern:l,strokeWidth:o,type:"Rectangle",width:i,x:e,y:t});t.drawTextBox=({height:e,width:t,x:i,y:n},s,a,o,l,d,h,c=!1,u,g=0,f=r.CLASSIC_LINE_HEIGHT_MULTIPLIER)=>({breakWords:l,clipArgs:h,singleLineCropHorizontally:c,fontSize:s,height:e,hitTest:g,lineHeight:u,text:d,textAlign:a,verticalAlign:o,width:t,x:i,y:n,type:"TextBox",lineHeightMultiplier:f});t.drawWidget=(e,t,i,r,n,s,a,o,l,d,h,c,u)=>({type:"WidgetPrimitive",id:e,x:i,y:r,width:n,height:s,rotation:a||0,children:l,stackingOrder:o,url:d,minimapPath:h,selectionPaths:c,border:u||0,parentId:t||""});const l="-widgets-container";t.generateWidgetsContainerId=e=>e+l;t.getWidgetIdFromWidgetsContainerId=e=>e.endsWith(l)?e.substring(0,e.length-l.length):e;t.drawWidgetsContainer=(e,i,r,n,s)=>Object.assign(Object.assign({},(0,t.drawGroup)((0,t.generateWidgetsContainerId)(e),i,r,n,s,0,[])),{hint:t.WIDGETS_CONTAINER_HINT}),t.noop={type:"NoOp"};t.wrapTextBox=(e,t)=>{const i=(0,a.wrapText)(e,t.width,t.height,t.fontSize,t.textAlign,t.verticalAlign,t.breakWords,t.clipArgs?1:0,t.text,t.lineHeightMultiplier),r=t.lineHeight||i.lineHeight,n=i.lines.filter(((e,i)=>r*i<t.height)).map((e=>e.filterMeasured(((e,t)=>!!t))));return Object.assign(Object.assign({},t),{wrappedText:Object.assign(Object.assign({},i),{lines:n,lineHeight:r}),type:"WrappedTextBox"})};const sortWidgets=(e,t)=>(0,n.isArrow)(t)&&!t.properties.stackable?-1:(0,n.isArrow)(e)&&!e.properties.stackable?1:t.properties.parentId?-1:e.properties.parentId?1:e.stackingOrder-t.stackingOrder;t.getWidgets=e=>Object.keys(e.widgets).map((t=>e.widgets[t])).sort(sortWidgets);t.cleanTags=e=>e.replace(/<\/?[^>]+(>|$)/g,"");t.shift=(e,t,i)=>i.map((i=>Object.assign(Object.assign({},i),{x:e+i.x,y:t+i.y})));t.shiftPrimitives=(e,t,...i)=>i.map((i=>{switch(i.type){case"Ellipse":case"Group":case"Image":case"Rectangle":case"TextBox":case"WrappedTextBox":return Object.assign(Object.assign({},i),{x:i.x+e,y:i.y+t});case"Line":case"NoOp":return i;case"Path":return console.warn("\n        !!!!!!!\n        Attempted to shift a Path.\n        This will result in incorrect rendering!\n        !!!!!!!"),i}}));t.drawHint=(e,i,r,n=!1)=>{if("Line"===r.type){const s=r.strokeWidth/2,a=Math.min(r.x1-s,r.x2+s),o=Math.min(r.y1-s,r.y2+s),l=Math.abs(r.x2-r.x1+2*s),d=Math.abs(r.y2-r.y1+2*s);return(0,t.drawGroup)(`${e}-${i}`,a,o,l,d,0,[Object.assign(Object.assign({},r),{x1:r.x1-a,y1:r.y1-o,x2:r.x2-a,y2:r.y2-o})],void 0,void 0,i,void 0,void 0,void 0,n)}return(0,t.drawGroup)(`${e}-${i}`,r.x,r.y,r.width,r.height,0,[Object.assign(Object.assign({},r),{x:0,y:0})],void 0,void 0,i,void 0,void 0,void 0,n)},t.hookHelpers={mapAst:(e,t)=>(0,s.map)(t)(e)};t.isWidgetPrimitive=e=>"WidgetPrimitive"===e.type;t.isDrawingPrimitive=e=>"WidgetPrimitive"!==e.type;t.calculatePadding=(e,t,i)=>{switch(e.measurementUnit){case"pixels":return e.value;case"height-percentage":return Math.round(e.value*t);case"font-size-percentage":return e.value*i}}},1098:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WidgetCache=void 0;t.WidgetCache=class WidgetCache{constructor(){this.widgets=new Map}delete(e){e.forEach((e=>this.widgets.delete(e)))}get(e){return this.widgets.get(e)}set(e){e.forEach((e=>this.widgets.set(e.id,e)))}}},3452:function(e,t,i){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=i(2575),s=i(1106),a=r(i(8667)),o=r(i(3202)),l=r(i(718)),d=r(i(6891)),h=r(i(8316)),c=r(i(3751)),u=r(i(9325)),g=r(i(8012)),f=r(i(3645)),m=r(i(9563)),v=r(i(1043)),y=r(i(6306)),w=r(i(7784)),x=r(i(1680)),b=r(i(7006)),C=r(i(1305)),A=i(4424);function parseWidget(e,t,i,r,s){if((0,n.isEmbedly)(i)||(0,n.isPhoto)(i)&&"string"!=typeof(i.properties.photoURL||i.properties.thumbURL)||(0,n.isText)(i)&&!(0,n.isSticky)(i)&&!(0,n.isTitle)(i))return;const{hideContent:A,darkerHidden:I,labelTypes:S,muralId:T,resizeImages:_,includeStates:M}=r;return A&&i.properties.hidden?(0,g.default)(t,i,!!I):(0,n.isSticky)(i)?(0,w.default)(t,i,!!M,T,s.sticky,s.openButton,s.label,S):(0,n.isArrow)(i)?(0,o.default)(e,i,s.arrow):(0,n.isShape)(i)?(0,v.default)(i,!!M,s.shape):(0,n.isFramework)(i)?(0,c.default)(i,!!M,s.framework):(0,n.isPhoto)(i)?(0,m.default)(t,T,i,!!_,!!M,s.image,s.openButton):(0,n.isTitle)(i)?(0,C.default)(t,i,!!M,T,s.textbox,s.openButton):(0,n.isGroup)(i)?(0,u.default)(i):(0,n.isArea)(i)?(0,a.default)(i,!!M,s.area):(0,n.isDrawing)(i)?(0,d.default)(i,!!M,s.drawing):(0,n.isSticker)(i)?(0,y.default)(i):(0,n.isInking)(i)?(0,f.default)(i):(0,n.isFile)(i)?(0,h.default)(i,!!M,s.file,s.openButton):(0,n.isComment)(i)?(0,l.default)(i,!!M,s.comment):(0,n.isTable)(i)?(0,x.default)(i,e,!!M):(0,n.isTableCell)(i)?(0,b.default)(i,t,s.tableCell):function unknownWidget(e){console.error(`Unknown widget ${e.id}: ${e.type}`)}(i)}const sortWidgets=(e,t)=>(0,n.isComment)(e)?1:(0,n.isComment)(t)||(0,n.isArrow)(t)&&!t.properties.stackable?-1:(0,n.isArrow)(e)&&!e.properties.stackable?1:!e.properties.hidden&&t.properties.hidden?-1:e.properties.hidden&&!t.properties.hidden?1:e.stackingOrder-t.stackingOrder;t.default=function parseWidgets(e,t,i,r,n){return function parseUnsortedWidgets(e,t,i,r,n){return(r.skipSorting?i:[...i].sort(sortWidgets)).map((i=>{const s=parseWidget(e,t,i,r,n);if(s){const e=r.onAfterParse?r.onAfterParse(i,s,A.hookHelpers):s;if("WidgetPrimitive"===e.type)return e}})).filter(s.isNotNil)}(e,t,r.onBeforeParse?i.map(r.onBeforeParse):i,r,n)}},2112:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.profiler=void 0;class EndSentinel{}const i=new EndSentinel;t.profiler=new class Profiler{constructor(){this._counters={},this._store={},this.on=!1,this._times=[],this.reset()}reset(){this._counters={},this._store={},this._times.length=0}count(e,t=1){var i;this.on&&(this._counters[e]=(null!==(i=this._counters[e])&&void 0!==i?i:0)+t)}store(e,t){this.on&&(this._store[e]||(this._store[e]=[]),this._store[e].push(t))}begin(e){this.on&&this._times.push([e,performance.now()])}end(){this.on&&this._times.push([i,performance.now()])}counters(){return Object.keys(this._counters).sort(((e,t)=>e.localeCompare(t))).map((e=>[e,this._counters[e]]))}stored(){return Object.keys(this._store).sort(((e,t)=>e.localeCompare(t))).map((e=>[e,this._store[e]]))}timeDigest(e=!0,t=!0){const r={},n=[];let s=this._times;if(!t){let e=0;s=this._times.map((t=>[t[0]instanceof EndSentinel?i:`${t[0]}${e++}`,t[1]]))}for(const[t,i]of s)if(t instanceof EndSentinel){const t=n.pop();if(!t){console.warn("It seems to be more profiler.end() than profiler.begin() calls.\nCheck your code scopes or missing calls.");continue}const{section:s,start:a,subtract:o}=t,l=i-a,d=l-o;n.length>0&&(n[n.length-1].subtract+=l);const h=e?n.map((e=>e.section)).concat(s).join("."):s;let c=r[h];c||(r[h]=c={id:h,total:0,self:0}),c.total+=l,c.self+=d}else n.push({section:t,start:i,subtract:0});return n.length>0&&console.warn("It seems to be more profiler.begin() than profiler.end() calls.\nCheck your code for early exits or missing calls. Look for:\n"+n.map((e=>e.section)).join("\n")),Object.values(r).sort(((e,t)=>e.id.localeCompare(t.id)))}}},5074:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getAssets=t.getCacheKey=void 0;const r=i(8748);t.getCacheKey=e=>[e.url,e.opts&&e.opts.bound&&e.opts.bound.width,e.opts&&e.opts.bound&&e.opts.bound.height,e.opts&&e.opts.fit&&e.opts.fit.width,e.opts&&e.opts.fit&&e.opts.fit.height,e.opts&&e.opts.color].map((e=>(e||"").toString())).join("_");t.getAssets=e=>{const i=new Map;e.forEach((0,r.forEach)((e=>{if("Image"!==e.type||!e.urlInfo.url)return;const r=(0,t.getCacheKey)(e.urlInfo),n=i.get(r);void 0===n?i.set(r,{url:e.urlInfo,maxSize:e.width*e.height}):n.maxSize=Math.max(n.maxSize,e.width*e.height)})));const n=Array.from(i.values());return n.sort(((e,t)=>e.maxSize-t.maxSize)),n.map((e=>e.url))}},2618:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.dropInvalidPaths=void 0;const r=i(8748),n=i(4424);t.dropInvalidPaths=(0,r.map)((e=>"Path"!==e.type?e:e.path.includes("NaN")?n.noop:e))},4941:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.dropNoOps=void 0;const r=i(8748);t.dropNoOps=(0,r.mapChildrenFirst)((e=>"Group"===e.type&&e.children.some((e=>"NoOp"===e.type))?Object.assign(Object.assign({},e),{children:e.children.filter((e=>"NoOp"!==e.type))}):e))},3295:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.filterStates=void 0;const r=i(8748),n=i(4424);t.filterStates=e=>(0,r.map)((t=>"Group"!==t.type||void 0===t.state||e.includes(t.id)?t:e.includes("debug")?(e=>(console.log("excluded:",e),n.noop))(t.id):n.noop))},6402:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.processTextNode=t.convertTextBoxToWrappedTextBox=void 0;const r=i(8748),n=i(45),s=i(4424);t.convertTextBoxToWrappedTextBox=(e,t)=>{let i=(0,n.processText)(e,t.text);t.singleLineCropHorizontally&&(i=(0,n.cropSingleLineTextHorizontally)(e,t.width,t.fontSize,i)),i!==t.text&&(t=Object.assign(Object.assign({},t),{text:i}));return(0,s.wrapTextBox)(e,t)};t.processTextNode=e=>(0,r.map)((i=>"TextBox"!==i.type?i:(0,t.convertTextBoxToWrappedTextBox)(e,i)))},8094:function(e,t,i){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.stretchPath=void 0;const n=r(i(6721)),s=i(8748);t.stretchPath=(0,s.map)((e=>{if("Path"!==e.type||!e.stretch)return e;const{newSize:t,originalSize:i}=e.stretch,r=t.width/i.width,s=t.height/i.height;return 1===r&&1===s?e:Object.assign(Object.assign({},e),{path:(0,n.default)(e.path).scale(r,s).toString()})}))},9741:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=i(1106),n=i(2618),s=i(4941),a=i(3295),o=i(6402),l=i(8094);t.default=function createProcessorPipeline(e,t){const i=[(0,o.processTextNode)(e),n.dropInvalidPaths,l.stretchPath,t.includeStatesFor?(0,a.filterStates)(t.includeStatesFor):null,s.dropNoOps].filter(r.isNotNil);return e=>i.reduce(((e,t)=>t(e)),e)}},1418:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.drawImageAstToFns=void 0;const i=[{visibleScreenSpacePercent:5,sizeMultiplier:1.5},{visibleScreenSpacePercent:15,sizeMultiplier:1.75},{visibleScreenSpacePercent:25,sizeMultiplier:2},{visibleScreenSpacePercent:50,sizeMultiplier:2,useRenderScaleMultiplier:!0}];function sizeToLod(e){const t=function nextPowerOf2(e){return Math.pow(2,Math.ceil(Math.log(e)/Math.log(2)))}(Math.ceil(e));return Math.min(Math.max(t,32),8192)}t.drawImageAstToFns=function drawImageAstToFns(e,t,r,n){const{x:s,y:a,width:o,height:l,urlInfo:d,loadingColor:h,preserveAspectRatio:c,priority:u,showLoading:g}=e,f=r.options.maxImageFetchScale||2,m=r.options.maxImageLodOutsideViewport;let v=null,y=null,w=0,x=null,b=!1,C=!1,A=!1,I=!1,S=!1,T=!1,_=!1,M=!1,O=!1;n.registerDestroy((()=>{null!==x&&(x.destroy(),x=null)})),n.registerViewportVisibilityChanged((e=>{C=e,null!==x?e?(x.play(),T&&n.invalidate()):x.stop():e&&(I||S)&&(I=!1,S=!1,n.invalidate()),A=A||e}));const clearEverything=()=>{v=null,y=null,w=0,M=!1,O=!1,null==x||x.destroy(),x=null,b=!1,T=!1,S=!1,I=!1},processImage=(e,t)=>{if(e!==y){switch(y=e,e.type){case"simple":v=e.image;break;case"animated":null!==x&&x.destroy(),x=e.buildPlayer(),v=x.image,x.setNewFrameCallback((()=>{b=!0,n.invalidate()})),C?x.play():x.stop();break;case"error":_=!0}t&&n.invalidate()}},loadLod=(e,t)=>{w=e;const i=function buildUrlInfoWithLevelOfDetail(e,t){return Object.assign(Object.assign({},e),{levelOfDetail:t})}(d,e),s=!g||r.options.ignoreDownloadProgress||O?void 0:(e=>{let t,i=!1,r=0,n=!1;const handler=(s,a)=>{i=!0,r=s,t=a,n&&e.setLoadingProgress(a?"downloading-infinite":"downloading",s)};return{enabledReport:()=>{n=!0,i&&handler(r,t)},forceFinish:()=>{n&&i&&1!==r&&handler(1,t)},handler}})(n),a=r.getImageFromUrl(i,r.imageCache,null==s?void 0:s.handler);O||n.hasLoadingProgress()||a.bestImage||null==s||s.enabledReport(),a.bestImage&&processImage(a.bestImage,t),void 0!==a.requestedImagePromise?a.requestedImagePromise.then((e=>{O=!0,null==s||s.forceFinish(),processImage(e,!0)})):a.bestImage&&(O=!0)},getBestSize=e=>{if(0===e.screenPixels)return 1;let t=1;const r=o*e.cameraScale,n=l*e.cameraScale,s=Math.max(r,n);if(e.isViewport){const s=r*n*100/e.screenPixels;let a=null;for(let e=0;e<i.length;e++)if(s<i[e].visibleScreenSpacePercent){a=i[e];break}null===a&&(a=i[i.length-1]),t=Math.min(a.sizeMultiplier,f)*(a.useRenderScaleMultiplier?e.renderScaleMultiplier:1)}else t=1.5;return s*t};return{draw:e=>{if(y&&(e=>"simple"===e.type&&!e.vectorial&&!Number(e.image.width))(y)&&clearEverything(),void 0!==m&&m<=0&&!A)return e.drawRectangle(s,a,o,l,h,"",0),void(I=!0);const i={cameraScale:e.cameraScale,renderScaleMultiplier:e.renderScaleMultiplier,screenPixels:e.targetWidth*e.targetHeight,isViewport:e.isViewport};M||(M=!0,(e=>{const t=!A&&void 0!==m&&m>0?m:Number.MAX_SAFE_INTEGER,i=sizeToLod(getBestSize(e));i>t?(S=!0,loadLod(t,!0)):loadLod(i,!0)})(i)),null!==v&&function isImageVisible(e,t,i,r){return"high"===r||e*i>=4||t*i>=4}(o,l,i.cameraScale*i.renderScaleMultiplier,u)?((e=>{if(!O||null===y||"simple"!==y.type||y.vectorial||S)return;const t=sizeToLod(getBestSize(e));t!==w&&loadLod(t,!1)})(i),e.drawImage(v,s,a,o,l,c),(()=>{b&&null!==x&&(C?(b=!1,x.readyForNextFrame(),T=!1):T=!0)})()):_&&t.length>0?t.forEach((t=>t.draw(e))):e.drawRectangle(s,a,o,l,h,"",0)},disposeCache:()=>{clearEverything(),t.forEach((e=>e.disposeCache()))}}}},9290:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.drawAstToFnsSimple=t.drawAstToFns=t.drawSimpleAstToFns=void 0;const r=i(4258),n=i(2575),s=i(4424),a=i(1418),o=i(1764),l=i(3993),applyClipping=(e,t,i)=>r=>{r.saveClip();const n=e.clipX||0,s=e.clipY||0;if(0!==t){const i=t*Math.PI/180;if(r.translateRotateAndScale(n,s,i,1),"ellipse"===e.shape)r.clipEllipse(0,0,e.clipWidth,e.clipHeight);else r.clipRectangle(0,0,e.clipWidth,e.clipHeight);r.undoTranslateRotateAndScale(n,s,i,1)}else if("ellipse"===e.shape)r.clipEllipse(n,s,e.clipWidth,e.clipHeight);else r.clipRectangle(n,s,e.clipWidth,e.clipHeight);i(r),r.restoreClip()};const noopDisposeCacheFn=()=>{},d={draw:()=>null,disposeCache:noopDisposeCacheFn},buildAstFns=e=>({draw:e,disposeCache:noopDisposeCacheFn}),shouldDrawShadow=(e,t,i)=>t.unitLengthForContext(i)*e>=1.5,drawClassicShadow=(e,t,i)=>{t.setRenderOverflow(30);const r=i.drawExplicitShadows?"rgb(0,0,0)":"rgba(0,0,0,0.2)";return i=>{if(!shouldDrawShadow(4,t,i))return;const n=i.native.globalAlpha;i.native.globalAlpha*=.7,i.native.shadowBlur=Math.min(20,20*i.cameraScale),i.native.shadowOffsetX=0,i.native.shadowOffsetY=Math.max(1,4*i.cameraScale),i.native.shadowColor=r,e(i.shadowColor)(i),i.native.globalAlpha=n,i.native.shadowBlur=0,i.native.shadowOffsetY=0,i.native.shadowColor=""}},drawShapeShadow=(e,t,i,n,s)=>{if(2===n){if(void 0===s)return console.error("Trying to draw Hana shadow with no ShadowStyle present"),()=>{};{t.setRenderOverflow(Math.max(s.blur,s.whileDragging.blurOverride)+s.height+s.whileDragging.offsetDownPixels+6);const i=(0,r.getCSSCubicBezierEasing)(s.whileDragging.animate.easeInCurveControlPoints,40),n=(0,r.getCSSCubicBezierEasing)(s.whileDragging.animate.easeOutCurveControlPoints,40);return r=>{((e,t,i,r,n,s)=>{if(!shouldDrawShadow(r.height,t,i))return;const a=((e,t,i)=>{if(!e)return 0;switch(e.transition){case 1:return t.getValue(e.transitionPercent);case 2:return 1-i.getValue(e.transitionPercent);default:return 0}})(t.getShadowProperties(),n,s),o=r.height+r.whileDragging.offsetDownPixels*a,l=r.blur*(1-a)+r.whileDragging.blurOverride*a;i.native.shadowBlur=Math.min(l,l*i.cameraScale),i.native.shadowOffsetX=0,i.native.shadowOffsetY=Math.max(1,o*i.cameraScale),i.native.shadowColor=r.color,e("#ffffff")(i),i.native.shadowBlur=0,i.native.shadowOffsetY=0,i.native.shadowColor=""})(e,t,r,s,i,n)}}}return drawClassicShadow(e,t,i)},isThereAnythingToDraw=(e,t,i,r)=>0!==i||t>0&&!(0,n.isTransparent)(e)||r&&!(0,n.isTransparent)(r);function drawSimpleAstToFns(e,t,i,r){switch(e.type){case"Rectangle":{const{backgroundColor:t,cornerRadius:n,height:s,shadow:a,strokeColor:o,strokePattern:l,strokeWidth:h,width:c,x:u,y:g,shadowStyle:f}=e;if(!isThereAnythingToDraw(o,h,a,t))return d;h>0&&r.setRenderOverflow(Math.ceil(h/2)+1);const m=n?e=>t=>t.drawRoundedRectangle(u,g,c,s,n,e,o,h,l):e=>t=>t.drawRectangle(u,g,c,s,e,o,h,l);return buildAstFns(0===a?m(t):drawShapeShadow(m,r,i.options,a,f))}case"Ellipse":{const{backgroundColor:t,height:n,opacity:s,shadow:a,strokeColor:o,strokePattern:l,strokeWidth:h,width:c,x:u,y:g,shadowStyle:f}=e;if(!isThereAnythingToDraw(o,h,a,t))return d;h>0&&r.setRenderOverflow(Math.ceil(h/2)+1);const renderFn=e=>t=>t.drawEllipse(u,g,c,n,e,o,h,l,s);return buildAstFns(0===a?renderFn(t):drawShapeShadow(renderFn,r,i.options,a,f))}case"Line":{const{x1:t,y1:i,x2:r,y2:n,strokeColor:s,strokeWidth:a,strokePattern:o,strokeStyleOffset:l}=e;return isThereAnythingToDraw(s,a,0)?buildAstFns((e=>e.drawLine(t,i,r,n,s,a,o,l))):d}case"Path":{const{path:n,strokeColor:s,strokeWidth:a,backgroundColor:l,strokePattern:h,strokeStyleOffset:c,lineCap:u,lineJoin:g,stretch:f,shadow:m}=e;if(!isThereAnythingToDraw(s,a,0,l))return d;const v=l||"",y=Math.ceil(a/2)+1,w=f?{minX:-Math.ceil(f.clipBorder),minY:-Math.ceil(f.clipBorder),maxX:f.newSize.width+2*Math.ceil(f.clipBorder),maxY:f.newSize.height+2*Math.ceil(f.clipBorder)}:{minX:0,minY:0,maxX:t.width,maxY:t.height},x=(0,o.cleanPath)(n),b=new Path2D(x),C=(0,o.getPathPointsPair)(x),A=C?(0,o.getNumberOfRealPointsApprox)(C):0,I=null!==C?(0,o.getPathPointsBounds)(C,y):null;let S=!1;if(f)S=null===I||!(0,o.isBoundsInsideBounds)(I,w),r.setRenderOverflow(Math.ceil(f.clipBorder));else{const e=null!==I?Math.max(-Math.min(I.minX,0),-Math.min(I.minY,0),Math.max(I.maxX-t.width,0),Math.max(I.maxY-t.height,0)):y;r.setRenderOverflow(e)}(function shouldCachePath(e,t){return e||t>64})(S,A)&&r.enableCache();const renderFn=e=>t=>{S&&(t.saveClip(),t.clipRectangle(w.minX,w.minY,w.maxX-w.minX,w.maxY-w.minY)),t.drawPath(b,s,a,e,h,u,g,c),S&&t.restoreClip()};return buildAstFns(0===m?renderFn(v):drawClassicShadow(renderFn,r,i.options))}case"Image":{const n=[];return e.errorFallback&&drawAstToFns(e.errorFallback,t,i,r,n),(0,a.drawImageAstToFns)(e,n,i,r)}case"TextBox":case"WrappedTextBox":{const{x:n,y:a,fontSize:o,clipArgs:d,width:h,height:c}=e,u="WrappedTextBox"===e.type?e.wrappedText:(0,s.wrapTextBox)(i.textFunctions,e).wrappedText,g=n+u.textX,f=a+u.textY,m=[],fn=e=>e.drawTextBox(m,!!i.options.computeSlowItalics),fnSmall=e=>e.drawTextBoxAsLines(m),v=d?applyClipping(d,0,fn):fn,y=d?applyClipping(d,0,fnSmall):fnSmall;let w=!1,x=!0;return buildAstFns((e=>{const n=r.unitLengthForContext(e);if(function isTextVisible(e,t,i){return e*i>=5||t*i>=5}(h,c,n)){if(x&&(x=!1,m.push(...(0,l.getTextLayout)(g,f,o,u.lineHeight,u.ascent,u.descent,u.lines,u.anchor,!!i.options.computeSlowItalics)),!d&&m.length>0)){const e=Math.min(...m.map((e=>e.bounds.x))),i=Math.min(...m.map((e=>e.bounds.y))),n=Math.max(...m.map((e=>e.bounds.x1))),s=Math.max(...m.map((e=>e.bounds.y1))),a=o,l=Math.max(0-e,0-i,n-t.width,s-t.height);l>a?w=!0:l>0&&r.setRenderOverflow(l)}w&&(e.saveClip(),e.clipRectangle(0,0,t.width,t.height)),!function isFontReadable(e,t){return e*t>=4}(o,n)?y(e):v(e),w&&e.restoreClip()}}))}}return d}function drawAstToFns(e,t,i,r,n){switch(e.type){case"Group":{const{id:t,x:s,y:a,width:o,height:l,rotation:d,scale:h,children:c,clip:u}=e,g=[];c.forEach((e=>drawAstToFns(e,{width:o/h,height:l/h},i,r,g)));const draw=e=>{e.saveTransform(),e.translateRotateAndScale(s,a,(d||0)*Math.PI/180,h),g.forEach((t=>t.draw(e))),e.restoreTransform()},disposeCache=()=>{g.forEach((e=>e.disposeCache()))},f=u?applyClipping({id:`${t}-clip`,clipX:s,clipY:a,clipWidth:o,clipHeight:l,shape:u},d,draw):draw;n.push({draw:f,disposeCache});break}default:n.push(drawSimpleAstToFns(e,t,i,r))}}t.drawSimpleAstToFns=drawSimpleAstToFns,t.drawAstToFns=drawAstToFns,t.drawAstToFnsSimple=function drawAstToFnsSimple(e,t){const i=[];return drawAstToFns(e,{width:Number.MAX_SAFE_INTEGER,height:Number.MAX_SAFE_INTEGER},t,{invalidate:()=>{},registerDestroy:()=>{},registerViewportVisibilityChanged:()=>{},unitLengthForContext:t.options.customUnitLength?()=>t.options.customUnitLength||1:()=>1,enableCache:()=>{},setRenderOverflow:()=>{},setLoadingProgress:()=>{},hasLoadingProgress:()=>!1,getShadowProperties:()=>null},i),i.map((e=>e.draw))}},8051:function(e,t){"use strict";var i=this&&this.__awaiter||function(e,t,i,r){return new(i||(i=Promise))((function(n,s){function fulfilled(e){try{step(r.next(e))}catch(e){s(e)}}function rejected(e){try{step(r.throw(e))}catch(e){s(e)}}function step(e){e.done?n(e.value):function adopt(e){return e instanceof i?e:new i((function(t){t(e)}))}(e.value).then(fulfilled,rejected)}step((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.createImageCache=void 0;const r=3e5,n=1024;function shrinkCanvasImage(e,t,r){return i(this,void 0,void 0,(function*(){if("simple"!==e.type||e.vectorial||e.image.width<=t&&e.image.height<=t)return e;const i=e.image,n=i.width,s=i.height;let a=Math.max(n,s),o=1;for(;a>t;)a=Math.ceil(a/2),o*=2;const l=Math.ceil(n/o),d=Math.ceil(s/o),{canvas:h,ctx:c}=r.createCanvas(l,d);c.imageSmoothingEnabled=!0;let u=!1,g=n,f=s,m=i,v=null,y=Math.ceil(g/2),w=Math.ceil(f/2);for(;!u;)if(yield new Promise(requestAnimationFrame),u=y===l||w===d,u)c.drawImage(m,0,0,g,f,0,0,y,w),null!==v&&(r.destroyCanvas(v),v=null);else{const{canvas:e,ctx:t}=r.createCanvas(y,w);t.imageSmoothingEnabled=!0,yield new Promise(requestAnimationFrame),t.drawImage(m,0,0,g,f,0,0,y,w),null!==v&&r.destroyCanvas(v),v=e,m=e,g=y,f=w,y=Math.max(l,Math.ceil(g/2)),w=Math.max(d,Math.ceil(f/2))}return{type:"simple",image:h,destroy:()=>r.destroyCanvas(h),vectorial:!1}}))}class Progress{constructor(){this.valid=!1,this.value=0,this.infinite=!1,this.listeners=[],this.set=(e,t)=>{this.valid=!0,this.value=Math.min(e,.99),this.infinite=null!=t&&t,this.listeners.forEach((e=>{e(this.value,this.infinite)}))}}finish(){this.valid=!0,this.value=1,this.listeners.forEach((e=>e(1,this.infinite))),this.listeners=[]}listen(e){this.valid&&e(this.value,this.infinite),this.value<1&&this.listeners.push(e)}}class InternalCacheEntry{constructor(e,t){this.lod=e,this.image=void 0,this.progress=new Progress,this.lastRequestTime=Date.now(),this.preventGCCounter=0,this.fetching=t(this.progress.set),this.fetching.then((e=>{this.image=e,this.lastRequestTime=Date.now(),this.progress.finish()}))}isReady(){return!!this.image}getImage(e=!0){return e&&(this.lastRequestTime=Date.now()),this.image}getPromise(e=!0){return e&&(this.lastRequestTime=Date.now()),this.fetching}getLastRequestTime(){return this.lastRequestTime}shrink(e,t){return this.preventGCCounter++,new InternalCacheEntry(e,(r=>i(this,void 0,void 0,(function*(){r(0,!0);const i=yield shrinkCanvasImage(this.getImage()||(yield this.getPromise()),e,t);return this.preventGCCounter--,i}))))}addProgressCallback(e){this.progress.listen(e)}isGCPrevented(){return this.preventGCCounter>0}destroy(){var e,t;this.image?null===(t=(e=this.image).destroy)||void 0===t||t.call(e):this.fetching.then((e=>{var t;return null===(t=e.destroy)||void 0===t?void 0:t.call(e)}))}}class ImageLODs{constructor(e,t){this.shrinkBiggerImages=e,this.canvasFactory=t,this.items=[]}getBiggerImage(e){return this.items.find((t=>t.lod>=e))}buildNewLod(e,t,r){var n;const s=this.shrinkBiggerImages&&(null===(n=this.getBiggerImage(e))||void 0===n?void 0:n.shrink(e,this.canvasFactory))||new InternalCacheEntry(e,(r=>i(this,void 0,void 0,(function*(){const i=yield t(r);return this.shrinkBiggerImages?yield shrinkCanvasImage(i,e,this.canvasFactory):i}))));return r&&s.addProgressCallback(r),this.items.push(s),this.items.sort(((e,t)=>e.lod-t.lod)),s}get(e,t,i){var r;const n=this.items.find((t=>t.lod===e));if(n&&i&&n.addProgressCallback(i),null==n?void 0:n.isReady())return{bestImage:n.getImage(),requestedImagePromise:void 0};const s=null!==(r=this.items.find((t=>t.lod>=e&&t.isReady())))&&void 0!==r?r:function findLast(e,t){for(let i=e.length-1;i>=0;i--)if(t(e[i],i,e))return e[i]}(this.items,(t=>t.lod<e&&t.isReady()));return{bestImage:null==s?void 0:s.getImage(),requestedImagePromise:(null!=n?n:this.buildNewLod(e,t,i)).getPromise()}}gc(){return i(this,void 0,void 0,(function*(){const e=Date.now();if(this.items.some((e=>{if(e.isGCPrevented())return!0;const t=e.getImage(!1);return!!t&&("simple"!==t.type||t.vectorial)})))return;if(this.items.length>1&&this.items.every((t=>e-t.getLastRequestTime()>r))){const e=this.items.reduce(((e,t)=>e.lod<t.lod&&e.lod>=n?e:t));e&&(this.items.forEach((t=>{t!==e&&t.destroy()})),this.items=[e])}if(1===this.items.length){const t=this.items[0];if(t.lod>n&&e-t.getLastRequestTime()>r){const e=t.shrink(n,this.canvasFactory);this.items=[e],yield e.getPromise(),t.destroy()}return}const t=this.items,i=t.reduce(((e,t)=>e.getLastRequestTime()>t.getLastRequestTime()?e:t)),s=t[this.items.length-1],a=[];this.items=[];for(const r of t)r===i||r===s&&e-s.getLastRequestTime()<3e5||e-r.getLastRequestTime()<6e4?this.items.push(r):a.push(r);for(const e of a)e.destroy()}))}destroy(){this.items.forEach((e=>e.destroy())),this.items=[]}fetching(){return this.items.some((e=>!e.isReady()))}eachImage(e){new Set(this.items.map((e=>e.getImage(!1)))).forEach((t=>t&&e(t)))}}class MemoryStats{constructor(){this.animateImagesCount=0,this.imagesCount=0,this.pixelsMemorySizeMB=0,this.urlsMemorySizeMB=0,this.vectorialImagesCount=0}appendImage(e){switch(e.type){case"simple":if(this.imagesCount++,e.vectorial)this.vectorialImagesCount++;else if(e.image){const t=e.image;t&&(this.pixelsMemorySizeMB+="naturalWidth"in t&&"naturalHeight"in t?t.naturalWidth*t.naturalHeight*4/1048576:(Number(t.width)*Number(t.height)*4||0)/1048576,"src"in t&&(this.urlsMemorySizeMB+=t.src.length/1048576))}break;case"animated":this.animateImagesCount++}}}t.createImageCache=(e=!0,t)=>{const r=new Map;let n=!1;return{get:(s,a,o)=>{const l=r.get(s.id),d=null!=l?l:new ImageLODs(e,t);return l||(r.set(s.id,d),(()=>{i(void 0,void 0,void 0,(function*(){if(!n){for(n=!0;r.size;){yield new Promise((e=>setTimeout(e,3e4)));for(const e of Array.from(r.values()))yield e.gc()}n=!1}}))})()),d.get(s.levelOfDetail,a,o)},clear:()=>{r.forEach((e=>e.destroy())),r.clear()},fetching:()=>{for(const e of r.values())if(e.fetching())return!0;return!1},memoryStats:()=>{const e=new MemoryStats;for(const t of r.values())t.eachImage((t=>e.appendImage(t)));return e}}}},1764:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.cleanPath=t.isBoundsInsideBounds=t.getPathPointsBounds=t.getNumberOfRealPointsApprox=t.isPathPointsInsideBounds=t.getPathPointsPair=void 0;t.getPathPointsPair=function getPathPointsPair(e){if(!!/[A-KNOPR-Ya-z]/.test(e))return null;const t=e.split(/[^0-9.-]+|(?=-)/g);t.shift(),t[t.length-1]||t.pop();const i=t.map(parseFloat);return i.length%2==1?null:i},t.isPathPointsInsideBounds=function isPathPointsInsideBounds(e,t,i,r,n){const s=t+r,a=i+n,isPointInside=(e,r)=>e>=t&&e<=s&&r>=i&&r<=a;for(let t=0;t+1<e.length;t+=2){if(!isPointInside(e[t],e[t+1]))return!1}return!0},t.getNumberOfRealPointsApprox=function getNumberOfRealPointsApprox(e){return Math.ceil(e.length/4)},t.getPathPointsBounds=function getPathPointsBounds(e,t){if(e.length<2)return{minX:0,minY:0,maxX:0,maxY:0};let i=e[0]-t,r=e[0]+t,n=e[1]-t,s=e[1]+t;for(let a=2;a+1<e.length;a+=2){const o=e[a],l=e[a+1];i=Math.min(i,o-t),r=Math.max(r,o+t),n=Math.min(n,l-t),s=Math.max(s,l+t)}return{minX:i,minY:n,maxX:r,maxY:s}},t.isBoundsInsideBounds=function isBoundsInsideBounds(e,t){return e.maxX<=t.maxX&&e.minX>=t.minX&&e.maxY<=t.maxY&&e.minY>=t.minY};class PathBuilder{constructor(){this.output="",this.previousCommand=null,this.previousX=NaN,this.previousY=NaN}appendString(e){this.output&&(this.output+=" "),this.output+=e}moveTo(e,t){isFinite(e+t)&&(this.previousX===e&&this.previousY===t||(this.previousCommand="M",this.previousX=e,this.previousY=t,this.appendString(`M ${e} ${t}`)))}lineTo(e,t){if(!isFinite(e+t))return;const i=this.previousX===e&&this.previousY===t,r="L"===this.previousCommand?"":"L ";"M"===this.previousCommand&&i?this.appendString(`${r}${e+.01} ${t+.01}`):i||this.appendString(`${r}${e} ${t}`),this.previousCommand="L",this.previousX=e,this.previousY=t}quadTo(e,t,i,r){if(!isFinite(e+t+i+r))return;const{previousCommand:n,previousX:s,previousY:a}=this;if(e===i&&t===r||s===e&&a===t)this.lineTo(i,r);else{if(s===i&&a===r)return this.moveTo(.5*(i+e),.5*(r+t)),void this.lineTo(i,r);this.appendString(`${"Q"===n?"":"Q "}${e} ${t} ${i} ${r}`),this.previousCommand="Q",this.previousX=i,this.previousY=r}}cubicTo(e,t,i,r,n,s){if(!isFinite(e+t+i+r+n+s))return;const a=i===e&&r===e;if((e===this.previousX&&t===this.previousY?1:0)+(a?1:0)+(n===i&&s===r?1:0)>=2)this.lineTo(n,s);else{if(a&&n===this.previousX&&s===this.previousY)return this.moveTo(.75*i+.25*n,.75*r+.25*s),void this.lineTo(n,s);this.appendString(`${"C"===this.previousCommand?"":"C "}${e} ${t} ${i} ${r} ${n} ${s}`),this.previousCommand="C",this.previousX=n,this.previousY=s}}appendCommand(e,t){this.appendString(`${e} ${t.join(" ")}`),this.previousCommand=e,this.previousX=t[t.length-2],this.previousY=t[t.length-1]}toString(){return this.output}}class PathReader{constructor(e){this.index=0,this.items=e.split(/([a-zA-Z]|-?\d+\.?\d*|-?\d*\.?\d+)|[^-A-Za-z0-9.]+/g).filter((e=>!!e)),this.items.length&&!this.items[0]&&this.items.shift(),this.items.length&&!this.items[this.items.length-1]&&this.items.pop()}hasNumber(){return this.index<this.items.length&&this.items[this.index]<"A"}takeCommand(){const{items:e}=this;for(;this.index<e.length;this.index++)if(e[this.index]>="A"){const t=e[this.index];return this.index++,t}return null}takeNumber(){const{items:e}=this;if(this.hasNumber()){const t=parseFloat(e[this.index]);return this.index++,t}return NaN}takeNumbers(){const e=[];for(;this.hasNumber();)e.push(this.takeNumber());return e}}t.cleanPath=function cleanPath(e){const t=new PathReader(e),i=new PathBuilder;for(let e=t.takeCommand();e;e=t.takeCommand())switch(e){case"M":i.moveTo(t.takeNumber(),t.takeNumber());break;case"L":for(;t.hasNumber();)i.lineTo(t.takeNumber(),t.takeNumber());break;case"Q":for(;t.hasNumber();)i.quadTo(t.takeNumber(),t.takeNumber(),t.takeNumber(),t.takeNumber());break;case"C":for(;t.hasNumber();)i.cubicTo(t.takeNumber(),t.takeNumber(),t.takeNumber(),t.takeNumber(),t.takeNumber(),t.takeNumber());break;default:i.appendCommand(e,t.takeNumbers())}return i.toString()}},3993:function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i);var n=Object.getOwnPropertyDescriptor(t,i);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,r,n)}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),n=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&r(t,e,i);return n(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.RenderContext=t.getTextLayout=t.isValidDrawImageSource=void 0;const a=i(2575),o=i(1106),l=s(i(6094)),d=i(7168);class NativeValues{constructor(){this.lastGlobalAlpha=1}}const h={"proxima-nova":-.2,"proxima-nova-semibold":-.2,"proxima-nova-bold":-.2,"museo-slab":0,"museo-slab-bold":0,adelle:0,"adelle-bold":0,"marker-felt":.45,"shark-water":.18,"blambot-casual":.05,"blambot-pro":.4,"lint-mccree":0,"noto-sans-hebrew":0,"noto-sans-hebrew-bold":0,"noto-sans-devanagari":0,"noto-sans-devanagari-bold":0,"noto-sans-thai":0,"noto-sans-thai-bold":0,"noto-naskh-arabic":0,"noto-naskh-arabic-bold":0,"noto-sans-cjk":0,"noto-sans-cjk-bold":0,"noto-sans":0,"noto-sans-bold":0,stickers:0,"ey-interstate":-.2,"ey-interstate-bold":-.2,"emoji-fallback":0};t.isValidDrawImageSource=e=>e.width>0&&e.height>0;t.getTextLayout=(e,t,i,r,n,s,a,o,d)=>{const c=[];for(let u=0;u<a.length;u++){const g=a[u];let f=0,m=0;for(let e=0;e<g.size();e++)m+=g.getWidth(e);const v="middle"===o?e-m/2:"start"===o?e:e-m;for(let e=0;e<g.size();e++){const a=g.getText(e),o=g.getFormat(e),m=g.getWidth(e),y=v+f,w=o.fontFamily,x=`${!d&&o.italic?"italic ":""}${i}px ${w}`,b=r+h[w],C=t+u*b,A={lineHeight:b,ascent:n,descent:s},I=y,S=C-A.ascent,T=y+m+(o.italic?(0,l.extraItalicWidth)(A):0),_=C-A.descent;c.push({format:o,text:a,width:m,draw:{font:x,fontSize:i,x:y,y:C,lineHeight:b},bounds:{x:I,y:S,x1:T,y1:_,width:T-I,height:_-S}}),f+=m}}return c};class RenderContext{constructor(e,t,i,r,n,s){this.cameraTransformMatrixI=new Float32Array(9),this.ctxValues=new NativeValues,this.ctxValuesStack=[],this.nativeCanvas=e.canvas,this.native=e.ctx,this.isViewport=t,this.renderScaleMultiplier=i,this.cameraScale=r,this.cameraTransformMatrixI.set(n),this.shadowColor=s,this.renderScale=this.cameraScale*this.renderScaleMultiplier,this.startRendering()}get targetWidth(){return this.nativeCanvas.width/this.renderScaleMultiplier}get targetHeight(){return this.nativeCanvas.height/this.renderScaleMultiplier}static buildDefault(e,t){return new RenderContext(e,!1,1,1,function buildIdentityMatrix(){const e=new Float32Array(9);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e}(),t)}startRendering(){this.native.imageSmoothingEnabled=!0,this.native.globalAlpha=this.ctxValues.lastGlobalAlpha,this.setupViewportTransform()}setDrawingStyle(e,t,i,r=0){this.native.strokeStyle=e,this.native.lineWidth=t,this.setLineDash(i),this.native.lineDashOffset=r}resetDrawingStyle(){this.native.strokeStyle="#000",this.native.lineWidth=1,this.native.setLineDash([]),this.native.lineCap="butt",this.native.lineDashOffset=0}setLineDash(e){return this.native.setLineDash(e)}setGlobalAlpha(e){this.ctxValues.lastGlobalAlpha!==e&&(this.ctxValues.lastGlobalAlpha=e,this.native.globalAlpha=e)}clear(){this.saveContext(),this.native.resetTransform(),this.native.clearRect(0,0,this.nativeCanvas.width,this.nativeCanvas.height),this.restoreContext()}transform(e,t,i,r,n,s){this.native.transform(e,t,i,r,n,s)}setTransform(e,t,i,r,n,s){this.native.setTransform(e,t,i,r,n,s)}translate(e,t){this.native.translate(e,t)}translateRotateAndScale(e,t,i,r){this.native.translate(e,t),this.native.rotate(i),this.native.scale(r,r)}undoTranslateRotateAndScale(e,t,i,r){this.native.scale(1/r,1/r),this.native.rotate(-i),this.native.translate(-e,-t)}saveContextValues(){this.ctxValuesStack.push(Object.assign({},this.ctxValues))}restoreContextValues(){const e=this.ctxValuesStack;e.length>0&&(this.ctxValues=e.pop())}saveContext(){this.native.save(),this.saveContextValues()}restoreContext(){this.native.restore(),this.restoreContextValues()}saveTransform(){this.saveContext()}restoreTransform(){this.restoreContext()}saveClip(){this.saveContext()}restoreClip(){this.restoreContext()}clipRectangle(e,t,i,r){this.native.beginPath(),this.native.rect(e,t,i,r),this.native.closePath(),this.native.clip()}clipEllipse(e,t,i,r){this.drawEllipseOutline(e+i/2,t+r/2,i,r),this.native.clip()}setupViewportTransform(){const e=this.cameraTransformMatrixI;this.native.setTransform(e[0],e[1],e[3],e[4],e[2],e[5])}finishRendering(){this.native.imageSmoothingEnabled=!0,this.native.globalAlpha=1}drawImage(e,i,r,n,s,a){if(a&&"number"==typeof e.width&&"number"==typeof e.height){const t=n/e.width,o=s/e.height;let l=s,d=n,h=0,c=0;t<o?(l=e.height*t,c=a.centerY?(s-l)/2:0):o<t&&(d=e.width*o,h=a.centerX?(n-d)/2:0),i+=h,r+=c,n=d,s=l}(0,t.isValidDrawImageSource)(e)&&this.native.drawImage(e,i,r,n,s)}drawImageDest(e,i,r,n,s,a,o,l,d){(0,t.isValidDrawImageSource)(e)&&this.native.drawImage(e,i,r,n,s,a,o,l,d)}fillRect(e,t,i,r,n){this.native.fillStyle=n,this.native.fillRect(e,t,i,r)}fillText(e,t,i,r,n,s,a){this.setTextStyle(r,s,a,n),this.native.fillText(e,t,i),this.resetTextStyle()}setTextStyle(e,t,i,r){this.ctxValues.lastFont!==e&&(this.ctxValues.lastFont=e,this.native.font=e),this.ctxValues.lastTextAlign!==t&&(this.ctxValues.lastTextAlign=t,this.native.textAlign=t),this.ctxValues.lastTextBaseline!==i&&(this.ctxValues.lastTextBaseline=i,this.native.textBaseline=i),this.native.fillStyle=r}resetTextStyle(){this.native.fillStyle="#000000"}drawLine(e,t,i,r,n,s,o=a.SOLID_STROKE_PATTERN,l=0){this.setDrawingStyle(n,s,o,l),this.native.beginPath(),this.native.moveTo(e,t),this.native.lineTo(i,r),this.native.stroke(),this.resetDrawingStyle()}drawDotsGrid(e,t,i,r,n,s,o){if(!((0,a.isTransparent)(o)||s<=0)){this.native.fillStyle=o;for(let a=t;a<=r;a+=n)for(let t=e;t<=i;t+=n)this.native.beginPath(),this.native.arc(t,a,s/2,0,2*Math.PI),this.native.fill()}}drawEllipseOutline(e,t,i,r){null===r&&(r=i);const n=i/2,s=r/2;e-=n,t-=s;const a=n*RenderContext.KAPPA,o=s*RenderContext.KAPPA,l=e+i,d=t+r,h=e+n,c=t+s;this.native.beginPath(),this.native.moveTo(e,c),this.native.bezierCurveTo(e,c-o,h-a,t,h,t),this.native.bezierCurveTo(h+a,t,l,c-o,l,c),this.native.bezierCurveTo(l,c+o,h+a,d,h,d),this.native.bezierCurveTo(h-a,d,e,c+o,e,c),this.native.closePath()}createCenteredRadialGradient(e,t,i,r,n){const s=this.native.createRadialGradient(e,t,i,e,t,r),a=Object.keys(n).map(Number);for(let e=0;e<a.length;e++){const t=a[e];s.addColorStop(t/100,n[t])}return s}drawEllipse(e,t,i,r,n,s,o,l,d=1){const h=this.native.globalAlpha;1!==d&&(this.native.globalAlpha=d*h),this.drawEllipseOutline(e+i/2,t+r/2,i,r),(0,a.isTransparent)(n)||(this.native.fillStyle=n,this.native.fill()),o>0&&(this.setDrawingStyle(s,o,l),this.native.stroke(),this.resetDrawingStyle()),1!==d&&(this.native.globalAlpha=h)}drawPartialEllipse(e,t,i,r,n,s,o,l,d,h){this.native.beginPath(),this.native.ellipse(e+i/2,t+r/2,i/2,r/2,-Math.PI/2,d,h),(0,a.isTransparent)(n)||(this.native.fillStyle=n,this.native.fill()),o>0&&(this.setDrawingStyle(s,o,l),this.native.stroke(),this.resetDrawingStyle())}drawRectangle(e,t,i,r,n,s,o,l=a.SOLID_STROKE_PATTERN){(0,a.isTransparent)(n)||(this.native.fillStyle=n,this.native.fillRect(e,t,i,r)),o>0&&(this.setDrawingStyle(s,o,l),this.native.beginPath(),this.native.rect(e,t,i,r),this.native.closePath(),this.native.stroke(),this.resetDrawingStyle())}drawRoundedRectangle(e,t,i,r,n,s,o,l,d){i<2*n&&(n=i/2),r<2*n&&(n=r/2),this.native.beginPath(),this.native.moveTo(e+n,t),this.native.arcTo(e+i,t,e+i,t+r,n),this.native.arcTo(e+i,t+r,e,t+r,n),this.native.arcTo(e,t+r,e,t,n),this.native.arcTo(e,t,e+i,t,n),this.native.closePath(),(0,a.isTransparent)(s)||(this.native.fillStyle=s,this.native.fill()),l>0&&(this.setDrawingStyle(o,l,d),this.native.stroke(),this.resetDrawingStyle())}drawPath(e,t,i,r,n,s="butt",o="miter",l=0){this.setDrawingStyle(t,i,n,l),this.native.lineCap=s,this.native.lineJoin=o,(0,a.isTransparent)(r)||(this.native.fillStyle=r,this.native.fill(e)),i>0&&this.native.stroke(e),this.resetDrawingStyle()}drawTextBox(e,t){if(0!==e.length){for(let i=0;i<e.length;i++){const r=e[i],{bounds:n,format:s,text:o,width:h,draw:c}=r,{x:u,y:g,fontSize:f,lineHeight:m}=c,v=s.markTextColor||s.color||"black";if(s.markHighlightColor){const e=m*d.TEXT_HIGHLIGHT_CORNER_RADIUS_RATIO;this.drawRoundedRectangle(n.x,n.y,h,n.height,e,s.markHighlightColor,a.transparent,0,a.SOLID_STROKE_PATTERN)}if(this.setTextStyle(c.font,"left","alphabetic",v),t&&s.italic&&(this.native.save(),(0,l.default)(this.native,g)),this.native.fillText(o,u,g),t&&s.italic&&this.native.restore(),s.underline||s.strike){const e=.075*f;if(s.underline){const t=g+2*e-1;this.drawLine(u,t,u+h,t,v,e)}if(s.strike){const e=.1*f,t=g-.25793650793650796*f-e/2;this.drawLine(u,t,u+h,t,v,e)}}}this.resetTextStyle()}}drawTextBoxAsLines(e){if(0===e.length)return;const t=.25*e[0].draw.fontSize;this.native.lineWidth=t,this.setLineDash(a.SOLID_STROKE_PATTERN),this.native.beginPath();for(let i=0;i<e.length;i++){const r=e[i];if((0,o.isWhiteSpace)(r.text))continue;this.native.strokeStyle=r.format.color||"black";const n=r.draw.x,s=r.draw.y-t/2,a=r.bounds.width;this.native.moveTo(n,s),this.native.lineTo(n+a,s)}this.native.stroke()}}t.RenderContext=RenderContext,RenderContext.KAPPA=.551784},7168:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createDebugCanvasFactory=t.createCanvasFactory=t.arrowTipPath=t.TEXT_HIGHLIGHT_CORNER_RADIUS_RATIO=t.BORDER_RATIO=void 0,t.BORDER_RATIO=.27,t.TEXT_HIGHLIGHT_CORNER_RADIUS_RATIO=.1429,t.arrowTipPath="\n    m -13.558,0.02130509\n    c 0,3 -0.988,5.77 -2.636,8\n    l 21,-8 -21,-8\n    c 1.648,2.229 2.636,4.992 2.636,8\n    z\n  ";const buildCanvasCollection=()=>new Map,createCanvasFactoryInternal=e=>({getCanvasMemoryStats:()=>{let t=0;const i=e.size;return e.forEach(((e,i)=>{t+=i.width*i.height*4})),{usedMemory:t,count:i}},createCanvas:(t,i,r,n=!0)=>{const s=document.createElement("canvas");s.width=t,s.height=i;const a=s.getContext("2d",{alpha:n});return e.set(s,{hint:r}),{canvas:s,ctx:a}},destroyCanvas:t=>{t.width=0,t.height=0,e.delete(t)}});t.createCanvasFactory=()=>createCanvasFactoryInternal(buildCanvasCollection());t.createDebugCanvasFactory=()=>{const e=buildCanvasCollection(),t=createCanvasFactoryInternal(e);return Object.assign(Object.assign({},t),{getAllCanvases:()=>[...e.keys()],findCanvasByHint:t=>{for(const i of e){const e=i[0];if(i[1].hint===t)return e}return null}})}},6094:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.extraItalicWidth=void 0;const i=-14*Math.PI/180,r=Math.tan(i),n=Math.abs(Math.sin(i));t.default=(e,t)=>{e.transform(1,0,r,1,-t*r,0)};t.extraItalicWidth=e=>e.ascent*n},2807:function(e,t,i){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.convertWidgetsToWidgetPrimitives=void 0;const n=i(4424),s=r(i(3452)),a=r(i(9741));t.convertWidgetsToWidgetPrimitives=function convertWidgetsToWidgetPrimitives(e,t,i,r={},o){const l=(0,a.default)(t,r),d=(0,s.default)(e,t,i,r,o).map(l),{onBeforeRender:h}=r;return(h?d.map(((e,t)=>h(i[t],e,n.hookHelpers))):d).filter(n.isWidgetPrimitive)}},1106:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isWhiteSpace=t.fromDataUrl=t.toDataUrl=t.sanitizeSvg=t.getRuntimeInfo=t.getAspectRatio=t.getStrokePattern=t.getStrokePatternClassic=t.mapOnlyIfChanges=t.getKeys=t.isNotNil=t.flatten=void 0;const r=i(2575),n=["&amp;","&lt;","&gt;","&nbsp;"];t.flatten=function flatten(e){return[].concat(...e)},t.isNotNil=function isNotNil(e){return null!=e},t.getKeys=function getKeys(e){return Object.keys(e)},t.mapOnlyIfChanges=function mapOnlyIfChanges(e,t){let i=null;for(let r=0;r<e.length;r++){const n=e[r],s=t(n);n!==s&&(null===i&&(i=e.slice()),i[r]=s)}return null!==i?i:e};t.getStrokePatternClassic=(e,t)=>{switch(e){case"-":return[2*t,2*t];case".":case"dotted":return[t,t];case". ":return[2*t,6*t];default:return r.SOLID_STROKE_PATTERN}};t.getStrokePattern=(e,i,n)=>{var s;if(n){const t=(0,r.normalizeStrokeStyle)(e);if(""===t)return r.SOLID_STROKE_PATTERN;{const e=null===(s=n[t])||void 0===s?void 0:s[i];if(e)return[e.dashLength,e.gapLength]}}return(0,t.getStrokePatternClassic)(e,i)};t.getAspectRatio=({centerX:e,centerY:t})=>`x${e?"Mid":"Min"}Y${t?"Mid":"Min"}`;const s=[{renderer:"UHD GRAPHICS 620",bugs:["context-lost-detection-hiccups","clear-whole-canvas-before-fill-faster"]}];let a=null;t.getRuntimeInfo=()=>{var e;if(null!==a)return a;if(new Function("try {return this===global;}catch(e){return false;}")())a={runtime:"node",chromiumFlavour:"none",deviceType:"unknown",mobile:!1,screen:{nativeRenderScaleMultiplier:1,resolution:{width:0,height:0},gpu:{vendor:"",renderer:"",bugs:new Set}}};else{const t=navigator.vendor&&navigator.vendor.indexOf("Apple")>-1&&navigator.userAgent&&-1==navigator.userAgent.indexOf("CriOS")&&-1==navigator.userAgent.indexOf("FxiOS")||!1,i=t&&navigator.userAgent&&(!!navigator.userAgent.match(/iPad/i)||!!navigator.userAgent.match(/iPhone/i))||!1,r=t&&navigator.userAgent&&!i&&navigator.maxTouchPoints>1,n=window&&void 0!==window.chrome||navigator.userAgent&&(navigator.userAgent.indexOf("Chromium")>=0||navigator.userAgent.indexOf("Chrome")>=0)||!1,o=n&&navigator.userAgent&&!!navigator.userAgent.match(/Android/i)||!1,l=n&&"function"==typeof(null===(e=null===navigator||void 0===navigator?void 0:navigator.brave)||void 0===e?void 0:e.isBrave),d=n&&navigator.userAgent&&navigator.userAgent.indexOf("Edg/")>=0,h=new Set;let c="",u="";try{const e=document.createElement("canvas").getContext("webgl");if(e){const t=e.getExtension("WEBGL_debug_renderer_info");null!=t?(c=(e.getParameter(t.UNMASKED_VENDOR_WEBGL)||"").toUpperCase(),u=(e.getParameter(t.UNMASKED_RENDERER_WEBGL)||"").toUpperCase()):(c=(e.getParameter(e.VENDOR)||"").toUpperCase(),u=(e.getParameter(e.RENDERER)||"").toUpperCase()),e.canvas.width=0,e.canvas.height=0}}catch(e){console.error("Error retrieving GPU info")}if(u)for(const e of s)u.includes(e.renderer)&&e.bugs.forEach((e=>h.add(e)));const g=(()=>{const e=document.createElement("div");document.body.appendChild(e),e.setAttribute("style","height: 1in; left: -100%; position: absolute; top: -100%; width: 1in;");const t=window.devicePixelRatio||1,i=Math.round(e.offsetWidth*t),r=Math.round(e.offsetHeight*t);return document.body.removeChild(e),i>101||r>101?2:1})(),f=window.screen.width*g,m=window.screen.height*g,v=d&&u.toUpperCase().includes("UHD GRAPHICS 620")&&3840===f&&2560===m;a={runtime:t?"safari":n?"chrome":"unknown",chromiumFlavour:n?l?"brave":d?"edge":"chrome":"none",mobile:i||r||o,debugVendor:navigator&&navigator.vendor?navigator.vendor:void 0,debugUserAgent:navigator&&navigator.userAgent?navigator.userAgent:void 0,deviceType:r?"ipad":v?"SurfaceHub2":"unknown",screen:{nativeRenderScaleMultiplier:g,resolution:{width:f,height:m},gpu:{vendor:c,renderer:u,bugs:h}}}}return a};const setAttribute=(e,t,i)=>void 0!==i?`${e.replace(new RegExp(` ${t}="[^"]*"`),"")} ${t}="${i}"`:e,setViewBoxAttribute=(e,t,i,r)=>setAttribute(e,t,void 0!==i?i:void 0!==r?r:void 0),extractFirstCapture=(e,t)=>(e.match(t)||[])[1]||"",sanitizeSvgDashArrayValues=e=>{if(/[^\d\s.,%]/g.test(e))return"";return e.split(/[\s,]+/).some((e=>0===parseFloat(e)))?"":e};t.sanitizeSvg=(e,i={})=>{const r=e.indexOf("<svg");let s=((e,{x:t,y:i,width:r,height:n,preserveAspectRatio:s})=>{const a=extractFirstCapture(e,/^<svg([^>]*)>/);let[o,l,d,h]=extractFirstCapture(a,/ viewBox="([^"]+)"/).split(/\s+/).map(Number).filter((e=>Number.isFinite(e))),c="";void 0!==o&&void 0!==l&&void 0!==d&&void 0!==h||(o=Number(extractFirstCapture(a,/ x="([^"]+)"/))||0,l=Number(extractFirstCapture(a,/ y="([^"]+)"/))||0,d=Number(extractFirstCapture(a,/ width="([^"]+)"/))||100,h=Number(extractFirstCapture(a,/ height="([^"]+)"/))||100,c=`viewBox="${o} ${l} ${d} ${h}"`);let u=a;return u=setViewBoxAttribute(u,"x",t,o),u=setViewBoxAttribute(u,"y",i,l),u=setViewBoxAttribute(u,"width",r,d),u=setViewBoxAttribute(u,"height",n,h),s&&(u=setAttribute(u,"preserveAspectRatio",s)),`<svg${u} ${c} ${e.substr(a.length+4)}`})(e.substr(r).replace(/&[^;]+;/g,(e=>-1!==n.indexOf(e)?e:e.substring(1,e.length-1))),i);return i.color&&(s=((e,t)=>{const i=e.replace(/(fill|stroke)="([^'";]+)"/g,((e,i,r)=>"none"!==r.trim()?`${i}="${t}"`:e)).replace(/(fill|stroke):([^'";}]+)/gi,((e,i,r)=>"none"!==r.trim()?`${i}:${t}`:e));return i.match(/^<svg[^>]*fill=[^>]*/)?i:i.replace(/^<svg/,`<svg fill="${t}"`)})(s,i.color)),s=(e=>e.replace(/stroke-dasharray="([^'";]+)"/gi,((e,t)=>`stroke-dasharray="${sanitizeSvgDashArrayValues(t)}"`)).replace(/stroke-dasharray:([^'";]+);/gi,((e,t)=>`stroke-dasharray:${sanitizeSvgDashArrayValues(t)};`)))(s),s=(e=>{if(e.indexOf("filter")<0)return e;let i=e.replace(/filter="(.*)"/g,"");if("node"!=(0,t.getRuntimeInfo)().runtime){const e=(new DOMParser).parseFromString(i,"application/xml"),t=e.getElementsByTagName("filter");for(let e=0;e<t.length;e++){const i=t.item(e);null==i||i.remove()}i=(new XMLSerializer).serializeToString(e)}return i})(s),s};t.toDataUrl=(e,t)=>`data:${e};base64,${t}`;t.fromDataUrl=e=>{const[t,i]=(e.match(/data:([^;]+);base64,(.*)/)||[]).slice(1);return{mimeType:t,base64Content:i}};t.isWhiteSpace=e=>{for(let t=0;t<e.length;t++)if(" "!==e[t]&&" "!==e[t])return!1;return!0}},4183:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AstGroupNode=void 0;const r=i(3588),n=i(3287),s=i(9290),a=i(9003),o=i(7111),deepEqual=(e,t)=>{if(e===t)return!0;if(typeof e!=typeof t)return!1;if(Array.isArray(e))return!!Array.isArray(t)&&(e.length===t.length&&e.every(((e,i)=>deepEqual(e,t[i]))));if(Array.isArray(t))return!1;if("object"==typeof e&&e){if("object"!=typeof t||!t)return!1;const i=Object.keys(e),r=Object.keys(t);if(i.length!==r.length)return!1;return new Set([...i,...r]).size===i.length&&i.every((i=>deepEqual(e[i],t[i])))}return!1};function astEqual(e,t){return e===t||null!==e&&null!==t&&(e.type===t.type&&((!(0,n.isDrawingPrimitiveSimpleWithSize)(e)||e.type!==t.type||e.width===t.width&&e.height===t.height)&&deepEqual(e,t)))}class AstPrimitiveState{constructor(e,t,i){this.renderOverflow=0,this.destroyFns=null,this.viewportFns=null,this.ast=e,this.node=t;const r={invalidate:t.invalidate.bind(t),unitLengthForContext:t.unitLengthForContext.bind(t),enableCache:()=>t.enableCache(i.canvasFactory,i.runtimeInfo),setRenderOverflow:e=>{const i=Math.max(this.renderOverflow,e);i>this.renderOverflow&&(this.renderOverflow=i,i>t.renderOverflow&&t.setRenderOverflow(i))},registerDestroy:e=>{null===this.destroyFns&&(this.destroyFns=[]),this.destroyFns.push(e)},registerViewportVisibilityChanged:e=>{t.registerViewportVisibilityChanged(e),null===this.viewportFns&&(this.viewportFns=[]),this.viewportFns.push(e)},setLoadingProgress:(e,t)=>{this.node.animate.setLoadingProgress(e,t)},hasLoadingProgress:()=>this.node.isAnimating()&&this.node.animate.hasLoadingInProgress(),getShadowProperties:()=>this.node.shadowProperties},n=(0,s.drawSimpleAstToFns)(e,{width:t.width/t.scaleX,height:t.height/t.scaleY},i,r);this.draw_=n.draw,this.disposeCache_=n.disposeCache,this.hit_=(0,a.drawSimpleAstToHitFns)(e),this.hitRect_=(0,a.drawSimpleAstToHitRectFns)(e)}draw(e){this.draw_(e)}disposeCache(){this.disposeCache_()}hit(e,t,i,r){return this.hit_(e,t,i,r)}hitRect(e,t,i,r,n,s){return this.hitRect_(e,t,i,r,n,s)}destroy(){var e,t;null===(e=this.destroyFns)||void 0===e||e.forEach((e=>e())),this.destroyFns=null,null===(t=this.viewportFns)||void 0===t||t.forEach((e=>this.node.unregisterViewportVisibilityChanged(e))),this.viewportFns=null}}class AstGroupNode extends r.MNode{constructor(e,t){super(e),this.lastState=null,this.primitives=[],this.clip=null,this.context=t}initInternal(e){const t=this.minimapShape!==e.minimapShape;super.initInternal(e),this.clip=e.clip;let i=t;this.primitives.length!==e.drawingAst.length&&(this.primitives.forEach((e=>e.destroy())),this.primitives.length=0,i=!0);for(let t=0;t<e.drawingAst.length;t++){const r=e.drawingAst[t];if(!astEqual(r,t<this.primitives.length?this.primitives[t].ast:null)){const e=new AstPrimitiveState(r,this,this.context);t<this.primitives.length?(this.primitives[t].destroy(),this.primitives[t]=e):this.primitives.push(e),i=!0}}let r=0;for(let e=0;e<this.primitives.length;e++)r=Math.max(r,this.primitives[e].renderOverflow);this.setRenderOverflow(r),i&&this.invalidate(!0)}willRender(){return this.primitives.length>0}renderImpl(e){const t=this.primitives,i=this.clip;null!==i&&(e.saveClip(),this.setupClipArgs(i,e,this.width,this.height));for(let i=0;i<t.length;i++)t[i].draw(e);null!==i&&e.restoreClip()}disposeCache(){super.disposeCache();const e=this.primitives;for(let t=0;t<e.length;t++)e[t].disposeCache()}hitTest(e,t,i){const r=this.primitives;if(r.length>0){const n=this.initHitTester();let s=!1;for(let a=0;a<r.length;a++)if(r[a].hit(e,t,i,n)){s=!0;break}return s}return!1}hitTestRect(e,t,i,r,n){const s=this.primitives;if(s.length>0){const a=this.initHitTester();let o=!1;for(let l=0;l<s.length;l++)if(s[l].hitRect(e,t,i,r,n,a)){o=!0;break}return o}return!1}initHitTester(){return null===AstGroupNode.hitTester&&(AstGroupNode.hitTester=new o.HitTester),AstGroupNode.hitTester}setupClipArgs(e,t,i,r){if("ellipse"===e)t.clipEllipse(0,0,i,r);else t.clipRectangle(0,0,i,r)}destroy(){this.primitives.forEach((e=>e.destroy())),super.destroy()}}t.AstGroupNode=AstGroupNode,AstGroupNode.hitTester=null},3824:function(e,t,i){"use strict";var r=this&&this.__awaiter||function(e,t,i,r){return new(i||(i=Promise))((function(n,s){function fulfilled(e){try{step(r.next(e))}catch(e){s(e)}}function rejected(e){try{step(r.throw(e))}catch(e){s(e)}}function step(e){e.done?n(e.value):function adopt(e){return e instanceof i?e:new i((function(t){t(e)}))}(e.value).then(fulfilled,rejected)}step((r=r.apply(e,t||[])).next())}))},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.createEngineBrowser=t.createEngine=t.createEngineConfig=void 0;const s=n(i(4313)),a=i(6785),o=i(7168),l=i(1106),d=i(5700),h=i(7794),c=i(392),u=n(i(4642)),g=i(1270),f=i(6605),m=i(9274),v=i(1570),y=i(9285),w=i(7266),createGifsLoader=(e,t,{cacheSizeInMBs:i})=>{const n=new y.GifProfilerImpl({cacheSizeInMBs:i}),s=new c.GifCacheManager(m.createRealWorker,e,i,n),a=new g.GifsManager(new f.FPSPlaybackStrategy);a.initializeAutoUpdate();const o=(0,u.default)(s,a,e,n,(e=>t=>r(void 0,void 0,void 0,(function*(){if((0,w.isBase64DataUrl)(t))return(0,w.getBase64FromDataUrlAsBuffer)(t);const i=yield e(t,{forceBase64:!0});return(0,w.getBase64FromDataUrlAsBuffer)(i)})))(t));return{gifProfiler:n,gifsLoader:o}};t.createEngineConfig=(e,t,i)=>{var r;const n=(0,s.default)({apiHost:"",staticHost:"",jwt:"",toPng:!1}),d=(0,l.getRuntimeInfo)(),c=(0,h.parseGifFeatureFlags)(d,null===(r=e.featureFlags)||void 0===r?void 0:r.gif),u=(0,o.createCanvasFactory)(),{gifsLoader:g,gifProfiler:f}=createGifsLoader(u,e.fetchAssetFn,c),m=Object.assign(Object.assign({},e),{getImageFromUrl:(0,a.getCanvasImageFromUrl)(e.fetchAssetFn,((e,t)=>g.load(e,t))),textFunctions:{measureText:n.buildMeasureText(new Map),splitTextItem:n.buildSplitTextItem(new Map)},renderScaleMultiplier:i||d.screen.nativeRenderScaleMultiplier,runtimeInfo:d,canvasFactory:u,hooks:Object.assign(Object.assign({},e.hooks),{onDestroy:()=>{var t;g.destroyGifLoader(),(null===(t=e.hooks)||void 0===t?void 0:t.onDestroy)&&e.hooks.onDestroy()}}),gifProfiler:f,detectContextLost:t,onContextRestored:()=>g.resetGifLoader()});return m};t.createEngine=(e,t,i)=>{const r=e.detectContextLost?(0,d.buildContextLostListener)(e.runtimeInfo,e.canvasFactory):(0,d.buildDummyContextLostListener)();return(0,v.createMuralEngine)(e,t,r,void 0,void 0,void 0,i)};t.createEngineBrowser=(e,i,r)=>{const n=(0,t.createEngineConfig)(e,!0,r);return(0,t.createEngine)(n,i,e.style)}},8614:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getEngineConfig=void 0;t.getEngineConfig=(e,t,i,r,n,s,a)=>({background:t,bounds:{x:i.x||0,y:i.y||0,width:i.width,height:i.height},canvas:r,canvasOverlay:n,canvasMinimap:s,drawExplicitShadows:e.drawExplicitShadows,maxImageLodOutsideViewport:e.maxImageLodOutsideViewport,layers:e.layers,clearColor:e.ctxBackground,onViewportChange:e.onViewportChange,onContextRestored:e.onContextRestored,renderScaleMultiplier:e.renderScaleMultiplier,viewport:{x:e.viewport.x,y:e.viewport.y,zoom:e.viewport.zoom},runtimeInfo:e.runtimeInfo,contextLostListener:a})},5700:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.buildContextLostListener=t.CONTEXT_LOST_SOURCE_CANVAS_HINT=t.buildDummyContextLostListener=void 0;t.buildDummyContextLostListener=()=>({onContextLost:()=>{},onContextRestored:()=>{},destroy:()=>{}}),t.CONTEXT_LOST_SOURCE_CANVAS_HINT="context-lost-draw-canvas",t.buildContextLostListener=function buildContextLostListener(e,i,r=((e,t)=>setTimeout(e,t))){if("chrome"!==e.runtime||"brave"===e.chromiumFlavour)return(0,t.buildDummyContextLostListener)();if(e.screen.gpu.bugs.has("context-lost-detection-hiccups"))return console.warn("Context lost detection disabled due to GPU bug!!"),(0,t.buildDummyContextLostListener)();let{canvas:n,ctx:s}=i.createCanvas(1,1,t.CONTEXT_LOST_SOURCE_CANVAS_HINT),{canvas:a,ctx:o}=i.createCanvas(1,1);if(!s||!o)return console.error("initContextLostListener(): 2d context initialization failed"),(0,t.buildDummyContextLostListener)();let l=!1,d=!1;const h=[255,0,0],randomColor=()=>Math.floor(245*Math.random())+5,updateSourceCanvas=()=>{h[0]=randomColor(),h[1]=randomColor(),h[2]=randomColor(),s.clearRect(0,0,1,1),s.fillStyle=`rgb(${h[0]},${h[1]},${h[2]})`,s.fillRect(0,0,1,1)},isCanvasContentValid=()=>{o.drawImage(n,0,0);const e=o.getImageData(0,0,1,1);if(4!==e.data.length)return!1;const t=e.data[0]===h[0]&&e.data[1]===h[1]&&e.data[2]===h[2];return updateSourceCanvas(),t},c=[],u=[],detectContextLostAndRecovery=()=>{d||(l?((()=>{const{canvas:e,ctx:r}=i.createCanvas(1,1,t.CONTEXT_LOST_SOURCE_CANVAS_HINT),{canvas:l,ctx:d}=i.createCanvas(1,1);r&&d?(i.destroyCanvas(a),i.destroyCanvas(n),a=l,o=d,n=e,s=r):(i.destroyCanvas(e),i.destroyCanvas(l))})(),updateSourceCanvas(),isCanvasContentValid()&&(l=!1,u.forEach((e=>e())))):isCanvasContentValid()||(l=!0,c.forEach((e=>e()))),r(detectContextLostAndRecovery,1e3))};return updateSourceCanvas(),r(detectContextLostAndRecovery,1e3),{onContextLost:e=>c.push(e),onContextRestored:e=>u.push(e),destroy:()=>{i.destroyCanvas(n),i.destroyCanvas(a),u.length=0,u.length=0,d=!0}}}},7794:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseGifFeatureFlags=void 0;t.parseGifFeatureFlags=(e,t)=>e.mobile?"safari"==e.runtime?{cacheSizeInMBs:t&&Number.isFinite(t.mobileSafariCacheSizeInMBs)?t.mobileSafariCacheSizeInMBs:0}:{cacheSizeInMBs:t&&Number.isFinite(t.mobileCacheSizeInMBs)?t.mobileCacheSizeInMBs:16}:{cacheSizeInMBs:t&&Number.isFinite(t.desktopCacheSizeInMBs)?t.desktopCacheSizeInMBs:256}},2538:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CanvasPool=void 0;t.CanvasPool=class CanvasPool{constructor(e){this.reusableCanvases=[],this.canvasFactory=e}getCanvas(e,t){const i=this.reusableCanvases.pop();return i?(i.width=e,i.height=t,{canvas:i,ctx:i.getContext("2d")}):this.canvasFactory.createCanvas(e,t)}releaseCanvas(e){e.width=0,e.height=0,this.reusableCanvases.push(e)}destroyCanvas(e){this.canvasFactory.destroyCanvas(e)}destroy(){for(const e of this.reusableCanvases)this.canvasFactory.destroyCanvas(e);this.reusableCanvases.length=0}}},392:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GifCacheManager=void 0;const r=i(2538),n=i(5084);t.GifCacheManager=class GifCacheManager{constructor(e,t,i=512,n){this.cacheMap=new Map,this.gifsToRemoveFromCache=new Set,this.spaceToClean=0,this.workerPool=new Array(2),this.createWorker=e,this.reusableCanvasPool=new r.CanvasPool(t),this.gifProfiler=n,this.totalSpaceForCache=i*Math.pow(10,6),this.spaceLeft=this.totalSpaceForCache;for(let e=0;e<2;e++)this.workerPool[e]=this.createWorker(),this.workerPool[e].onmessage=e=>this.onWorkerMessage(e.data)}createImageDecoder(e,t,i){if(this.cacheMap.has(e))return;const r=this.workerPool[e%2];this.cacheMap.set(e,new n.GifFramesCanvasCache(e,r,i,this.gifProfiler,this.reusableCanvasPool)),r.postMessage({arrayBuffer:t,type:"gif-load",gifId:e})}getFrame(e,t){const i=this.cacheMap.get(e);if(!i)return null;this.tryToFlagForCaching(i);let r=i.getFrame(t);return null===r&&(r=i.getFrame(t)),r&&this.gifProfiler.newFrame(e.toString(),r),r}onWorkerMessage(e){const t=this.cacheMap.get(e.gifId);if(t)switch(e.type){case"gif-info":t.setGifInfo(e),this.gifProfiler.initializeGif(e.gifId.toString(),e.width,e.height,e.headers);break;case"frame":t.processDecodedFrameMessage(e)}}markForRemovalFromCache(e){const t=this.cacheMap.get(e);t&&t.shouldCache&&(t.shouldCache=!1,this.spaceToClean+=t.totalSize,this.gifsToRemoveFromCache.add(t))}tryToFlagForCaching(e){if(!e.shouldCache)return this.gifsToRemoveFromCache.has(e)?(e.shouldCache=!0,this.spaceToClean-=e.totalSize,void this.gifsToRemoveFromCache.delete(e)):this.spaceLeft>=e.totalSize?(e.shouldCache=!0,this.gifProfiler.setCached(e.gifId.toString(),!0),void(this.spaceLeft-=e.totalSize)):this.spaceLeft+this.spaceToClean>e.totalSize?(this.cleanUpSpaceMarkedForRemoval(e.totalSize),e.shouldCache=!0,this.gifProfiler.setCached(e.gifId.toString(),!0),void(this.spaceLeft-=e.totalSize)):void 0}cleanUpSpaceMarkedForRemoval(e){let t=0;for(const i of this.gifsToRemoveFromCache)if(i&&(t+=i.totalSize||0,i.cleanCachedFrames()),this.gifProfiler.setCached(i.gifId.toString(),!1),this.gifsToRemoveFromCache.delete(i),this.spaceLeft+t>e)break;this.spaceToClean-=t,this.spaceLeft+=t}calcSpaceUsed(){let e=0;for(const t of this.cacheMap.values())e+=t.usedSpace;return e}destroy(e){var t;null===(t=this.cacheMap.get(e))||void 0===t||t.destroyGifCache(),this.cacheMap.delete(e)}resetGifCacheManager(){this.cacheMap.forEach((e=>e.destroyGifCache())),this.cacheMap.clear(),this.gifsToRemoveFromCache.clear(),this.reusableCanvasPool.destroy()}destroyGifCacheManager(){this.resetGifCacheManager(),this.workerPool.forEach((function terminateWorker(e){e.onmessage=()=>{},e.terminate()})),this.workerPool.length=0}}},5084:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GifFramesCanvasCache=void 0;const r=i(3993);t.GifFramesCanvasCache=class GifFramesCanvasCache{constructor(e,t,i,r,n){this.width=0,this.height=0,this.framesNum=0,this.totalDuration=0,this.totalSize=0,this.usedSpace=0,this.shouldCache=!1,this.framesBeingDecoded=new Set,this.frameHeaders=[],this.decodedFrames=new Map,this.cachedFrames=new Map,this.temporaryCanvas=null,this.gifId=e,this.worker=t,this.initializeGifCb=i,this.reusableCanvasPool=n,this.gifProfiler=r}setGifInfo(e){this.width=e.width,this.height=e.height,this.framesNum=e.headers.length,this.frameHeaders=e.headers,this.totalDuration=e.headers.reduce(((e,t)=>e+t.delayMs),0),this.totalSize=e.headers.reduce(((e,t)=>e+t.width*t.height*4),0);const t=this.createImageData(e.firstFrame,this.width,this.height);this.saveFrameImageData(0,t);const i=this.getFrame(0);this.initializeGifCb(this.width,this.height,this.frameHeaders,i)}processDecodedFrameMessage(e){const t=this.createImageData(e.frame,this.frameHeaders[e.frameIndex].width,this.frameHeaders[e.frameIndex].height);this.saveFrameImageData(e.frameIndex,t)}createImageData(e,t,i){return new ImageData(new Uint8ClampedArray(e),t,i)}saveFrameImageData(e,t){this.framesBeingDecoded.delete(e),this.decodedFrames.set(e,t),this.usedSpace+=t.data.buffer.byteLength}decodeFrame(e){e%=this.framesNum,this.cachedFrames.has(e)||this.decodedFrames.has(e)||this.framesBeingDecoded.has(e)||(this.framesBeingDecoded.add(e),this.gifProfiler.addDecodeRequest(!0),this.worker.postMessage({frames:[e],gifId:this.gifId,type:"decode"}))}getFrame(e){this.temporaryCanvas&&(this.reusableCanvasPool.releaseCanvas(this.temporaryCanvas),this.temporaryCanvas=null);const t=this.cachedFrames.get(e);if(t){if((0,r.isValidDrawImageSource)(t))return this.gifProfiler.addDecodeRequest(!1),Object.assign(Object.assign({},this.frameHeaders[e]),{image:t});this.removeCachedFrame(e,!0)}const i=this.decodedFrames.get(e);if(i){const t=this.frameHeaders[e].width,r=this.frameHeaders[e].height,{canvas:n,ctx:s}=this.reusableCanvasPool.getCanvas(t,r);return s.putImageData(i,0,0),this.shouldCache?this.cachedFrames.set(e,n):this.temporaryCanvas=n,this.decodedFrames.delete(e),this.decodeFrame(e+1),Object.assign(Object.assign({},this.frameHeaders[e]),{image:n})}return this.framesBeingDecoded.has(e)||this.decodeFrame(e),null}removeCachedFrame(e,t=!1){const i=this.cachedFrames.get(e);i&&(t?this.reusableCanvasPool.destroyCanvas(i):this.reusableCanvasPool.releaseCanvas(i),this.cachedFrames.delete(e),this.usedSpace-=this.frameHeaders[e].width*this.frameHeaders[e].height*4||0)}cleanCachedFrames(){for(let e=0;e<this.framesNum;e++)this.removeCachedFrame(e)}destroyGifCache(){this.worker.postMessage({type:"destroy",gifId:this.gifId}),this.temporaryCanvas&&(this.reusableCanvasPool.releaseCanvas(this.temporaryCanvas),this.temporaryCanvas=null),this.cachedFrames.forEach((e=>this.reusableCanvasPool.releaseCanvas(e)))}}},5416:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CanvasFrameRenderer=void 0;const r=i(3993);t.CanvasFrameRenderer=class CanvasFrameRenderer{constructor(e){this._width=0,this._height=0,this._lastFrameDisposal=-1,this._lastFrameBounds={x:0,y:0,width:0,height:0},this._canvasFactory=e;const{canvas:t,ctx:i}=this._canvasFactory.createCanvas(1,1);this._canvas=t,this._ctx=i}initialize(e,t,i){if(this._width=e,this._height=t,this._canvas.width=e,this._canvas.height=t,i.some((e=>3===e.disposal))){const{canvas:i,ctx:r}=this._canvasFactory.createCanvas(e,t);this._lastFrameSavedCanvas=i,this._lastFrameSavedCtx=r}}drawFrame(e){const t=this._ctx;if(0===e.frameIndex)t.clearRect(0,0,this._width,this._height);else switch(this._lastFrameDisposal){case 0:case 1:break;case 2:t.clearRect(this._lastFrameBounds.x,this._lastFrameBounds.y,this._lastFrameBounds.width,this._lastFrameBounds.height);break;case 3:if(this._lastFrameSavedCanvas&&(0,r.isValidDrawImageSource)(this._lastFrameSavedCanvas))t.drawImage(this._lastFrameSavedCanvas,0,0);else{this._canvasFactory.destroyCanvas(this._lastFrameSavedCanvas);const{canvas:e,ctx:t}=this._canvasFactory.createCanvas(this._width,this._height);this._lastFrameSavedCanvas=e,this._lastFrameSavedCtx=t}}this._lastFrameBounds.x=e.x,this._lastFrameBounds.y=e.y,this._lastFrameBounds.width=e.width,this._lastFrameBounds.height=e.height,this._lastFrameDisposal=e.disposal,3===e.disposal&&(0,r.isValidDrawImageSource)(this.canvas)&&this._lastFrameSavedCtx.drawImage(this.canvas,0,0),(0,r.isValidDrawImageSource)(e.image)&&t.drawImage(e.image,e.x,e.y)}destroyCanvasFrameRenderer(){this._lastFrameSavedCanvas&&this._canvasFactory.destroyCanvas(this._lastFrameSavedCanvas),this._canvasFactory.destroyCanvas(this._canvas)}resetCanvasFrameRenderer(){if(this._lastFrameSavedCanvas){this._canvasFactory.destroyCanvas(this._lastFrameSavedCanvas);const{canvas:e,ctx:t}=this._canvasFactory.createCanvas(this._width,this._height);this._lastFrameSavedCanvas=e,this._lastFrameSavedCtx=t}this._canvasFactory.destroyCanvas(this._canvas);const{canvas:e,ctx:t}=this._canvasFactory.createCanvas(1,1);this._canvas=e,this._ctx=t}get canvas(){return this._canvas}}},4642:function(e,t,i){"use strict";var r=this&&this.__awaiter||function(e,t,i,r){return new(i||(i=Promise))((function(n,s){function fulfilled(e){try{step(r.next(e))}catch(e){s(e)}}function rejected(e){try{step(r.throw(e))}catch(e){s(e)}}function step(e){e.done?n(e.value):function adopt(e){return e instanceof i?e:new i((function(t){t(e)}))}(e.value).then(fulfilled,rejected)}step((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const n=i(8124),s=new Set;let a=0;const buildGifOrGetFromCache=(e,t,i,r,o,l,d)=>{const h=e.get(t),c=h||((e,t,i,r,o,l)=>{let d=0;const h=l(e),c=new Map,u=new Set;let g=null;const f=a++,m=new Map,destroyGif=()=>{g&&(r.stop(g),s.delete(g),g.destroy(),g=null)};return{type:"animated",destroy:()=>{c.forEach((e=>e.destroy())),destroyGif()},buildPlayer:()=>{const e=d++;r.unmarkForDestruction(f),g||(o.addGif(f.toString()),g=new n.GifImage(f,i,t,(()=>r.stop(g)),(()=>{for(const e of u){const t=m.get(e);t&&t()}})),h.then((e=>{g?(g.setRawData(e),s.add(g)):console.error("AnimatedImagePlayer Error: GIF fetched after it was destroyed.")})).catch((e=>{console.error(e)}))),o.addGifInstance(f.toString(),e.toString());const a={image:g.canvas,play:()=>{var t;g?(u.add(e),o.setGifInstanceOnScreen(f.toString(),e.toString(),!0),1==u.size?r.play(g):null===(t=m.get(e))||void 0===t||t()):console.error("AnimatedImagePlayer Error: Started a player of an unexistant GIF")},stop:()=>{g?(u.delete(e),o.setGifInstanceOnScreen(f.toString(),e.toString(),!1),0==u.size&&(r.stop(g),i.markForRemovalFromCache(f))):console.error("AnimatedImagePlayer Error: Stopped a player of an unexistant GIF")},setNewFrameCallback:t=>m.set(e,t),readyForNextFrame:()=>{},destroy:()=>{if(a.stop(),c.delete(e),m.delete(e),o.deleteGifInstance(f.toString(),e.toString()),0==c.size){let e=5;r.markForDestruction(f,(()=>{e--,0===e&&destroyGif()}))}}};return c.set(e,a),a}}})(t,i,r,o,l,d);return h||e.set(t,c),c};t.default=function buildGifLoader(e,t,i,n,a){const o=new Map,l=a||(e=>fetch(e).then((e=>{if(e.status>=400)throw new Error("Gif download error");return e.arrayBuffer()})));return{load:(s,a)=>{const d=a?((e,t)=>i=>r(void 0,void 0,void 0,(function*(){t(0,!0);const r=yield e(i);return t(1,!0),r})))(l,a):l;return buildGifOrGetFromCache(o,s,i,e,t,n,d)},resetGifLoader:()=>{s.forEach((e=>e.resetGifImage())),e.resetGifCacheManager()},destroyGifLoader:()=>{t.destroy(),o.forEach((e=>{var t;return null===(t=e.destroy)||void 0===t?void 0:t.call(e)})),o.clear(),s.forEach((e=>e.destroy())),s.clear(),e.destroyGifCacheManager()}}}},8124:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GifImage=void 0;const r=i(5416);t.GifImage=class GifImage{constructor(e,t,i,n,s){this.state=0,this.currentFrame=-1,this.timeLeftTillNextFrame=-1,this.framesNum=-1,this.gifId=e,this.cache=t,this.onFramePaintedCb=s,this.frameRenderer=new r.CanvasFrameRenderer(i),this.stopUpdatingCb=n}setRawData(e){this.cache.createImageDecoder(this.gifId,e,this.initialize.bind(this))}initialize(e,t,i,r){this.frameRenderer.initialize(e,t,i),this.framesNum=i.length,this.drawFrame(r),this.currentFrame=0,1===this.framesNum?(this.state=3,this.stopUpdatingCb()):this.state=1,this.timeLeftTillNextFrame=r.delayMs}advanceTime(e){return 1!==this.state||(this.timeLeftTillNextFrame-=e,this.timeLeftTillNextFrame<=0&&(this.state=2)),this.state}paintNextFrame(){if(2!==this.state)return this.state;const e=(this.currentFrame+1)%this.framesNum,t=this.cache.getFrame(this.gifId,e);return null==t?2:(this.drawFrame(t),this.currentFrame=e,this.timeLeftTillNextFrame=t.delayMs,this.state=1,1)}drawFrame(e){this.frameRenderer.drawFrame(e),this.onFramePaintedCb()}destroy(){this.frameRenderer.destroyCanvasFrameRenderer(),this.cache.destroy(this.gifId)}resetGifImage(){this.frameRenderer.resetCanvasFrameRenderer()}get canvas(){return this.frameRenderer.canvas}get gifReproductionState(){return this.state}}},1270:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GifsManager=void 0;const r=i(6605);t.GifsManager=class GifsManager{constructor(e=new r.NoPlaybackChangeStrategy,t=new r.NoPlaybackChangeStrategy){this.isAutoUpdating=!1,this.requestAnimationFrameHandle=null,this.markedForDestruction=new Map,this.gifsOnScreen=new Set,this.gifsToRedrawQueue=[],this.dtMultiplier=r.MAX_DT_MULTIPLIER,this._lastUpdate=0,this.gifPlaybackDeltaTimeStrategy=e,this.gifPlaybackQueueStrategy=t}initializeAutoUpdate(){this.isAutoUpdating=!0,this.gifsOnScreen.size>0&&this.resumeAutoUpdate()}autoUpdate(e){if(this._lastUpdate){const t=e-this._lastUpdate;this.advanceGifsTimes(t),this.paintGifs(e),this.countdownDestroyed(),this.dtMultiplier=this.gifPlaybackDeltaTimeStrategy.updatePlaybackSpeedFromDeltaTime(this.dtMultiplier,t)}this._lastUpdate=e,this.requestAnimationFrameHandle=requestAnimationFrame((e=>this.autoUpdate(e)))}manualUpdate(e){this.advanceGifsTimes(e),this.paintGifs(),this.countdownDestroyed()}advanceGifsTimes(e){const t=e*this.dtMultiplier;this.gifsOnScreen.forEach((e=>{2===e.advanceTime(t)&&this.gifsToRedrawQueue.push(e)}))}paintGifs(e){if(this.gifsToRedrawQueue.length>0){const t=[],i=[];this.gifsToRedrawQueue.forEach((r=>{e&&performance.now()-e>4?t.push(r):2===r.paintNextFrame()&&i.push(r)})),this.gifsToRedrawQueue=[...t,...i],this.dtMultiplier=this.gifPlaybackQueueStrategy.updatePlaybackSpeedFromQueue(this.dtMultiplier,this.gifsToRedrawQueue.length)}}countdownDestroyed(){for(const e of this.markedForDestruction.values())e()}play(e){3!==e.gifReproductionState&&(this.gifsOnScreen.add(e),this.isAutoUpdating&&this.gifsOnScreen.size>0&&this.resumeAutoUpdate())}stop(e){this.gifsOnScreen.delete(e),this.isAutoUpdating&&0===this.gifsOnScreen.size&&this.pauseAutoUpdate()}resumeAutoUpdate(){null===this.requestAnimationFrameHandle&&(this.requestAnimationFrameHandle=requestAnimationFrame((e=>this.autoUpdate(e))))}pauseAutoUpdate(){null!==this.requestAnimationFrameHandle&&(cancelAnimationFrame(this.requestAnimationFrameHandle),this.requestAnimationFrameHandle=null,this._lastUpdate=0)}markForDestruction(e,t){this.markedForDestruction.set(e,t)}unmarkForDestruction(e){this.markedForDestruction.delete(e)}destroy(){this.pauseAutoUpdate(),this.isAutoUpdating=!1,this.gifsOnScreen.clear(),this.gifsToRedrawQueue.length=0,this.markedForDestruction.clear()}}},6605:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NoPlaybackChangeStrategy=t.FPSPlaybackStrategy=t.MIN_DT_MULTIPLIER=t.MAX_DT_MULTIPLIER=void 0,t.MAX_DT_MULTIPLIER=1,t.MIN_DT_MULTIPLIER=1/Math.pow(2,4);t.FPSPlaybackStrategy=class FPSPlaybackStrategy{constructor(){this.FRAMES_TO_AVERAGE_FAST_FPS=5,this.FAST_FRAMERATE_FPS=40,this.SLOW_FRAMERATE_FPS=29,this.frameCountForAverage=0,this.dtSumForAverage=0}updatePlaybackSpeedFromDeltaTime(e,t){this.frameCountForAverage++,this.dtSumForAverage+=t;const i=1e3*this.frameCountForAverage/this.dtSumForAverage;return i<this.SLOW_FRAMERATE_FPS&&(e=this.slowDownGif(e)),this.frameCountForAverage>=this.FRAMES_TO_AVERAGE_FAST_FPS&&(i>this.FAST_FRAMERATE_FPS&&(e=this.speedUpGif(e)),this.frameCountForAverage=0,this.dtSumForAverage=0),e}slowDownGif(e){return Math.max(e-.2,t.MIN_DT_MULTIPLIER)}speedUpGif(e){return Math.min(e+.1,t.MAX_DT_MULTIPLIER)}};t.NoPlaybackChangeStrategy=class NoPlaybackChangeStrategy{updatePlaybackSpeedFromQueue(e){return e}updatePlaybackSpeedFromDeltaTime(e){return e}}},9274:function(e,t,i){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.createRealWorker=void 0;const n=r(i(1193));t.createRealWorker=()=>new n.default},9003:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.drawSimpleAstToHitRectFns=t.drawSimpleAstToHitFns=void 0;function hitWidthFromZoom(e,t){return t/e}function getHitWidthByHitTest(e,t,i){switch(e){case 1:return function hitWidthMuralCoords(e,t){return t*e>20?20/e:t*e<4?4/e:t}(t,15);case 2:return hitWidthFromZoom(t,10);case 3:return hitWidthFromZoom(t,10+i);default:return 0}}t.drawSimpleAstToHitFns=function drawSimpleAstToHitFns(e){switch(e.type){case"Ellipse":{const{x:t,y:i,width:r,height:n,hitTest:s}=e;return 4===s?()=>!1:(a,o,l,d)=>d.hitTestEllipse(a,o,t,i,r,n,getHitWidthByHitTest(s,l,e.strokeWidth),s)}case"Line":{const{hitTest:t,x1:i,y1:r,x2:n,y2:s}=e;return(a,o,l,d)=>d.hitTestLine(a,o,i,r,n,s,getHitWidthByHitTest(t,l,e.strokeWidth))}case"Path":{const{path:t,hitTest:i}=e;if(4===i)return()=>!1;const r=new Path2D(t);return(t,n,s,a)=>a.hitTestPath(t,n,r,getHitWidthByHitTest(i,s,e.strokeWidth),i)}case"Rectangle":{const{x:t,y:i,width:r,height:n,hitTest:s}=e;return 4===s?()=>!1:(a,o,l,d)=>d.hitTestRectangle(a,o,t,i,r,n,getHitWidthByHitTest(s,l,e.strokeWidth),s)}case"Image":case"TextBox":case"WrappedTextBox":{const{x:t,y:i,width:r,height:n,hitTest:s}=e;return 4===s?()=>!1:(e,a,o,l)=>l.hitTestRectangle(e,a,t,i,r,n,getHitWidthByHitTest(s,o,0),s)}case"NoOp":return()=>!1}},t.drawSimpleAstToHitRectFns=function drawSimpleAstToHitRectFns(e){switch(e.type){case"Line":{const{x1:t,y1:i,x2:r,y2:n,strokeWidth:s}=e;return(e,a,o,l,d,h)=>{const c=s/2;return h.hitTestRectLine(e-c,a-c,o+2*c,l+2*c,t,i,r,n)}}case"Path":{const{path:t,strokeWidth:i,hitTest:r}=e,dummyFn=()=>!0;if(4===r)return()=>!1;if(1!==r&&2!==r)return dummyFn;if(t.length>500)return dummyFn;if(!function isCurvedArrowPath(e){return!e.replace(/[MC]/g,"").match(/[A-Za-z]/)}(t))return dummyFn;const n=t.replace(/[^0-9.-]/g," ").replace(/\s+/g," ").trim().split(" ").map(parseFloat);if(14!==n.length&&8!==n.length)return dummyFn;const s={start:{x:n[0],y:n[1]},c1:{x:n[2],y:n[3]},c2:{x:n[4],y:n[5]},end:{x:n[6],y:n[7]}},a=14===n.length?{start:{x:n[6],y:n[7]},c1:{x:n[8],y:n[9]},c2:{x:n[10],y:n[11]},end:{x:n[12],y:n[13]}}:null;return(e,t,r,n,o,l)=>{const d=i/2,h=e-d/2,c=t-d/2,u=r+d/2*2,g=n+d/2*2,hitTestRect=e=>l.hitTestRectPoint(h,c,u,g,e.x,e.y);return!!(hitTestRect(s.start)||hitTestRect(s.end)||null!==a&&hitTestRect(a.end))||(l.hitTestRectCubicBezier(h,c,u,g,s,o)||null!==a&&l.hitTestRectCubicBezier(h,c,u,g,a,o))}}case"Rectangle":case"Image":case"TextBox":case"WrappedTextBox":case"Ellipse":return()=>4!==e.hitTest;case"NoOp":return()=>!1}}},7111:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HitTester=void 0;const r=i(1745);function distanceBetweenPoints(e,t,i,r){const n=i-e,s=r-t;return Math.sqrt(n*n+s*s)}class HitTester{constructor(){this.canvas=document.createElement("canvas"),this.ctx=this.canvas.getContext("2d"),this.ctx.fillStyle="black",this.ctx.strokeStyle="black",this.canUseCanvasHitTest=!!this.ctx.isPointInPath&&!!this.ctx.isPointInStroke}hitTestLine(e,t,i,r,n,s,a){return function distanceBetweenPointAndSegment(e,t,i,r,n,s){const a=n-i,o=s-r,l=a*a+o*o;if(Math.abs(l)<1e-4)return distanceBetweenPoints(e,t,i,r);let d=((e-i)*a+(t-r)*o)/l;return d=Math.max(0,Math.min(1,d)),distanceBetweenPoints(e,t,i+d*a,r+d*o)}(e,t,i,r,n,s)<a}hitTestRectLine(e,t,i,r,n,s,a,o){return function aabbContainsSegment(e,t,i,r,n,s,a,o){if(e<n&&i<n||t<s&&r<s||e>a&&i>a||t>o&&r>o)return!1;const l=(r-t)/(i-e);let d=l*(n-e)+t;if(d>=s&&d<=o)return!0;if(d=l*(a-e)+t,d>=s&&d<=o)return!0;let h=(s-t)/l+e;return h>=n&&h<=a||(h=(o-t)/l+e,h>=n&&h<=a)}(n,s,a,o,e,t,e+i,t+r)}hitTestPath(e,t,i,r,n){if(!this.canUseCanvasHitTest)return!0;let s=!1;return this.ctx.lineWidth=r,0===n&&(s=this.ctx.isPointInPath(i,e,t)),s=s||this.ctx.isPointInStroke(i,e,t),s}hitTestRectPoint(e,t,i,r,n,s){return n<e+i&&n>e&&s<t+r&&s>t}hitTestRectCubicBezier(e,t,i,n,s,a){let o=0,l=0,d=0;const h=(0,r.generateEvalBezier)(s.start.x,s.start.y,s.c1.x,s.c1.y,s.c2.x,s.c2.y,s.end.x,s.end.y),c={x:0,y:0};for(let r=0;r<=1;r+=.1){if(h(r,c),r>0){const e=c.x-l,t=c.y-d;o+=Math.sqrt(e*e+t*t)}if(l=c.x,d=c.y,c.x<=e+i&&c.x>=e&&c.y<=t+n&&c.y>=t)return!0}const u=Math.min(Math.max(o*a/16,10),200),g=1/u,f=o/u*(2/3),m=e-f,v=t-f,y=e+i+f,w=t+n+f;for(let e=0;e<=1;e+=g)if(h(e,c),c.x<=y&&c.x>=m&&c.y<=w&&c.y>=v)return!0;return!1}createEllipseOutline(e,t,i,r){const n=i/2,s=r/2;e-=n,t-=s;const a=n*HitTester.KAPPA,o=s*HitTester.KAPPA,l=e+i,d=t+r,h=e+n,c=t+s,u=new Path2D;return u.moveTo(e,c),u.bezierCurveTo(e,c-o,h-a,t,h,t),u.bezierCurveTo(h+a,t,l,c-o,l,c),u.bezierCurveTo(l,c+o,h+a,d,h,d),u.bezierCurveTo(h-a,d,e,c+o,e,c),u.closePath(),u}hitTestEllipse(e,t,i,r,n,s,a,o){if(!this.canUseCanvasHitTest)return!0;let l=!1;if(n===s){const s=n/2,d=e-(i+s),h=t-(r+s),c=Math.sqrt(d*d+h*h);0===o&&(l=c<s),l=l||c<s+a&&c>s-a}else{const d=this.createEllipseOutline(i+n/2,r+s/2,n,s);0===o&&(l=this.ctx.isPointInPath(d,e,t)),this.ctx.lineWidth=a,l=l||this.ctx.isPointInStroke(d,e,t)}return l}hitTestRectangle(e,t,i,r,n,s,a,o){if(e<i+n+a&&e>i-a&&t<r+s+a&&t>r-a)switch(o){case 0:return!0;case 1:case 2:return e>i+n-a||e<i+a||t>r+s-a||t<r+a;case 3:return e>i+n||e<i||t>r+s||t<r}return!1}}t.HitTester=HitTester,HitTester.KAPPA=.551784},411:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createHoverActions=void 0;const r=i(1106),n=i(7266);t.createHoverActions=e=>({at:(t,i,r)=>e.nodes.hover(t,i,r),clear:()=>e.nodes.clearHover(),widgets:(t,i={})=>{let s=Number.MAX_SAFE_INTEGER,a=Number.MAX_SAFE_INTEGER,o=Number.MIN_SAFE_INTEGER,l=Number.MIN_SAFE_INTEGER;t.map((t=>e.nodes.getSafe(t))).filter(r.isNotNil).forEach((e=>{s=Math.min(s,e.aabbWithoutRenderOverflow.x),a=Math.min(a,e.aabbWithoutRenderOverflow.y),o=Math.max(o,e.aabbWithoutRenderOverflow.x1),l=Math.max(l,e.aabbWithoutRenderOverflow.y1)}));const draggedWidgetsFitInside=({bbox:e})=>e.x<=s&&o<=e.x1&&e.y<=a&&l<=e.y1,d=new Set(i.excludeIds?[...t,...i.excludeIds]:t);t.forEach((t=>{const i=e.nodes.getUnsafe(t);if(!i)return;let r=i.parent;for(;r;)d.add(r.externalId),r=r.parent}));const h=e.nodes.getAllAt(s,a,0);let c=null;for(const e of h){const t=(0,n.getWidgetForNode)(e);if(t&&!d.has(t.id)){if(draggedWidgetsFitInside(t)){c=t;break}d.add(t.id)}}return c?(e.nodes.hoverOver(c.id),c):(e.nodes.clearHover(),null)}})},1570:function(e,t,i){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.createMuralEngine=void 0;const n=r(i(738)),s=i(1449),a=i(4086),o=i(1654),l=i(51),d=i(9412),h=i(3097),c=i(4424),u=i(8051),g=i(8614),f=i(5700),m=i(411),v=i(800),y=i(3142),w=i(9750),x=i(5156),b=i(7266),C=i(2765),A=i(9118),I=i(1384),addWidgetsToEngine=(e,t,i,r,n,s,a,o,l,d)=>{const h=(0,A.getNodeStatesFromWidgets)(e,t,r,n,s,a,o,d);i.nodes.updateOrBuildNodeFromState((e=>(0,A.buildSingleNodeGroup)(e,l)),(e=>({externalId:e,animations:{},border:0,children:[],hint:null,stackingLayer:0,stackingOrder:0,state:0,minimapShape:null,parentId:null,selectionShapes:null,dontCleanChildrenOnUpdate:!0,dummy:!0,transform:{x:0,y:0,width:0,height:0,scale:1,rotation:0},drawingAst:[],clip:null})),h)},buildCanvasEngine=(e,t,i,r,n,a)=>{const o=e.canvasFactory,l=(0,b.createCanvasFromConfig)(o,e.canvas,!1),d=(0,b.createCanvasFromConfig)(o,Object.assign(Object.assign({},e.canvas),{className:e.canvas.className?`${e.canvas.className}-overlay`:void 0,ariaLabel:void 0,tabIndex:-1}),!0);d.canvas.style.pointerEvents="none";const h=(0,b.createCanvasFromConfig)(o,e.minimap,!0),c=(0,g.getEngineConfig)(e,r,n,l,d,h,t),u=(0,s.createCanvasEngine)([],c,i,o,a);return{engine:u,canvasEngineConfig:c,destroyEngine:()=>{u.destroy(),o.destroyCanvas(l.canvas),o.destroyCanvas(d.canvas),o.destroyCanvas(h.canvas)}}};t.createMuralEngine=(e,t,i,r=(()=>{}),s={},g={},S)=>{const T="safari"!==e.runtimeInfo.runtime,_=(0,u.createImageCache)(T,e.canvasFactory),M=e.imageCacheProxyBuilder?e.imageCacheProxyBuilder(_):_,O=(0,n.default)(t.labelTypes)||{},R=new o.ArrowLabelOverlapHolesEffect,E=new h.TrackTableCellsEffect,P=(0,a.fillPartialMuralStyleWithDefaults)(S),L=new l.WidgetsEffectComposite([new d.FixGridEffect(P.widgets),E,R]),k=(0,c.getWidgets)(t),N={getHoles:e=>R.getHoles(e),getTableCellsGrid:e=>E.getTableCellsGrid(e)},F=Object.assign(Object.assign({},s),{maxImageLodOutsideViewport:e.maxImageLodOutsideViewport,drawExplicitShadows:e.drawExplicitShadows}),B={imageCache:M,runtimeInfo:e.runtimeInfo,canvasFactory:e.canvasFactory,textFunctions:e.textFunctions,getImageFromUrl:e.getImageFromUrl,options:F},{engine:z,destroyEngine:D}=buildCanvasEngine(e,i,M,t.background,{x:t.x,y:t.y,width:t.width,height:t.height},P),H=(0,w.createScreenshotActions)(z,((e,t)=>Object.assign(Object.assign({},buildCanvasEngine(e,(0,f.buildDummyContextLostListener)(),M,void 0,{x:0,y:0,width:256,height:256},P)),{astContext:{imageCache:M,canvasFactory:e.canvasFactory,textFunctions:e.textFunctions,getImageFromUrl:e.getImageFromUrl,options:t,muralStyle:P,runtimeInfo:e.runtimeInfo}})),e,F,((e,i,n,s)=>addWidgetsToEngine(N,e,i,n,r,O,t.id,g,s,P.widgets))),W=(0,I.buildWidgetsProcessor)(z,L,(i=>addWidgetsToEngine(N,i,z,e,r,O,t.id,g,B,P.widgets))),j={debug:z.debug,destroy:()=>{var t;H.onDestroy(),D(),M.clear(),(null===(t=e.hooks)||void 0===t?void 0:t.onDestroy)&&e.hooks.onDestroy()},dom:z.dom,hover:(0,m.createHoverActions)(z),minimap:z.minimap,mural:z.mural,screenshot:H.actions,selection:z.selection,feedback:z.feedback,text:(0,x.createTextActions)(e.textFunctions),viewport:z.viewport,profiler:(0,y.createProfilerActions)(e.gifProfiler),widgets:(0,C.createWidgetActions)(z,W,(i=>{const n=(0,A.getNodeStatesFromWidgets)(N,[i],e,r,O,t.id,Object.assign(Object.assign({},g),{skipChildren:!0}),P.widgets);if(1!==n.length)return console.error("measureWidget: Widget to measure not found after Widget -> States conversion"),null;const s=n[0];return(0,b.getWidgetRefForNodeState)(s)}),O,k),layers:(0,v.createLayerActions)(z),gridlines:z.gridlines,customFeedback:z.customFeedback,customHandle:z.customHandle,__hackEngine:z};j.widgets.add(...k);const G=j.debug.isUseSkipCacheHeuristicOn();return j.debug.setUseSkipCacheHeuristic(!1),z.render.flushRender(),j.debug.setUseSkipCacheHeuristic(G),j}},800:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createLayerActions=void 0;t.createLayerActions=e=>({show:t=>e.customLayers.show(t),hide:t=>e.customLayers.hide(t),addWidget:(t,i)=>{var r;return null===(r=e.nodes.getUnsafe(i))||void 0===r?void 0:r.addToCustomLayer(t)},removeWidget:(t,i)=>{var r;return null===(r=e.nodes.getUnsafe(i))||void 0===r?void 0:r.removeFromCustomLayer(t)}})},949:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.exportEverythingToCSV=void 0;const exportCSV=(e,t)=>{const i=document.createElement("a");i.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(t)),i.setAttribute("download",e),i.style.display="none",document.body.appendChild(i),i.click(),document.body.removeChild(i)},exportFrameDataCSV=(e,t,i)=>{let r="gifID, width, height, numFrames, startTime\n";const n=i.get(e);if(void 0!==n){r+=`${e},${n.width},${n.height},${n.frameHeaders.length},${n.timestampInitialized}\n\n`;let i="frameNum",s="width",a="height",o="disposal",l="delayMs",d="min",h="max",c="avg",u="std",g=0,f=0;for(let e=0;e<n.numFrames;e++){const r=n.frameHeaders[e];i+=`,${e}`,s+=`,${r.width}`,a+=`,${r.height}`,o+=`,${r.disposal}`,l+=`,${r.delayMs}`;const m=n.calcStatsForFrame(e,t);d+=`,${m.min}`,h+=`,${m.max}`,c+=`,${m.avg}`,u+=`,${m.std}`,g+=r.delayMs,f+=m.avg}i+="\n",s+="\n",a+="\n",o+="\n",l+=`,${g}, FPS:${1e3/(g/n.numFrames)}\n`,c+=`,${f}, FPS:${1e3/(f/n.numFrames)}\n`,u+="\n",d+="\n",h+="\n",r+=i+s+a+o+l+c+u+d+h+"\n";const m=[];for(let e=0;e<n.numFrames;e++){const i=n.delayTimestampsPerFrame[e];for(let r=0;r<i.length&&r<t;r++)void 0===m[r]&&(m[r]=[]),m[r][e]=i[r]}r+=`measurements${",".repeat(n.frameHeaders.length+1)}loopTotalMs\n`;for(const[e,t]of m.entries())t.push(t.reduce(((e,t)=>e+t),0)),r+=`loop ${e},${t.join(",")}\n`}return r};t.exportEverythingToCSV=(e,t,i)=>{((e,t)=>{let i="gifID, width, height, numFrames, startTime\n";for(const e of t.keys()){const r=t.get(e);void 0!==r&&(i+=`${e},${r.width},${r.height},${r.frameHeaders.length},${r.timestampInitialized}\n`)}exportCSV(`${e}-generalInfo.csv`,i)})(e,i);let r="";for(const e of i.keys())r+=exportFrameDataCSV(e,t,i)+"\n\n\n\n\n";exportCSV(`${e}-frameData.csv`,r)}},9285:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GifProfilerImpl=t.GIFInfo=void 0;const r=i(949);class GIFInfo{constructor(e,t=10,i){this.width=-1,this.height=-1,this.totalPixelSize=0,this.totalMemorySize=0,this.numFrames=-1,this.currentFrame=0,this.currentLoop=0,this.timestampInitialized=0,this.instances=new Set,this.instancesOnScreen=new Set,this.isCached=!1,this.name=e,this.expectedMeasurements=t,i&&(this.timestampInitialized=performance.now()),this.lastFrameTimestamp=this.timestampInitialized}initialize(e,t,i){this.width=e,this.height=t,this.totalPixelSize=e*t,this.totalMemorySize=i.reduce(((e,t)=>e+t.width*t.height*4),0),this.numFrames=i.length,this.frameHeaders=i,this.delayTimestampsPerFrame=new Array(this.numFrames);for(let e=0;e<this.delayTimestampsPerFrame.length;e++)this.delayTimestampsPerFrame[e]=new Array(this.expectedMeasurements)}nextFrame(e){const t=performance.now();return this.delayTimestampsPerFrame[e.frameIndex][this.currentLoop]=t-this.lastFrameTimestamp,this.lastFrameTimestamp=t,this.currentFrame++,this.currentFrame==this.delayTimestampsPerFrame.length&&(this.currentFrame=0,this.currentLoop++,this.currentLoop==this.expectedMeasurements)}calcStatsForFrame(e,t){const i=e%this.numFrames,r=this.delayTimestampsPerFrame[i].slice(1,t),n=r.reduce(((e,t)=>e+t)),s=r.reduce(((e,t)=>e>t?e:t)),a=r.reduce(((e,t)=>e<t?e:t)),o=n/(t-1),l=Math.sqrt(r.map((e=>Math.pow(e-o,2))).reduce(((e,t)=>e+t))/(t-1));return{min:a,max:s,avg:o,std:l}}get finishedMeasurements(){return this.currentLoop>=this.expectedMeasurements}}t.GIFInfo=GIFInfo;t.GifProfilerImpl=class GifProfilerImpl{constructor(e={cacheSizeInMBs:0}){this._gifs=new Map,this._running=!1,this._profilingsInProgress=0,this._measurementsNeeded=10,this._exportName="gifs",this.telemetryStats={gifDecoderVersion:1,cacheSize:e.cacheSizeInMBs*Math.pow(10,6),cacheUsed:0,decodeRequests:{cacheMisses:0,total:0},onScreen:{amount:0,amountCached:0,totalMemorySize:0,totalMemorySizeCached:0},inMural:{amount:0,distinctAmount:0}}}addGif(e){this._gifs.set(e,new GIFInfo(e,this._measurementsNeeded,this._running)),this._profilingsInProgress++}initializeGif(e,t,i,r=[]){var n;null===(n=this._gifs.get(e))||void 0===n||n.initialize(t,i,r)}newFrame(e,t){var i;if(!this._running)return;(null===(i=this._gifs.get(e))||void 0===i?void 0:i.nextFrame(t))&&(this._profilingsInProgress--,0===this._profilingsInProgress&&(0,r.exportEverythingToCSV)(this._exportName,10,this._gifs))}addGifInstance(e,t){const i=this._gifs.get(e);i&&i.instances.add(t)}deleteGifInstance(e,t){const i=this._gifs.get(e);this.setGifInstanceOnScreen(e,t,!1),i&&i.instances.delete(t)}addDecodeRequest(e){this.telemetryStats.decodeRequests.cacheMisses+=e?1:0,this.telemetryStats.decodeRequests.total++}setCached(e,t){const i=this._gifs.get(e);i&&(i.isCached=t,this.telemetryStats.cacheUsed+=(t?1:-1)*i.totalMemorySize)}setGifInstanceOnScreen(e,t,i){const r=this._gifs.get(e);r&&(i?r.instancesOnScreen.add(t):r.instancesOnScreen.delete(t))}start(e,t){this._exportName=e,t>0&&(this._measurementsNeeded=t),this._running=!0}stop(){this._running=!1}reset(){this._gifs.clear()}peekStats(){const e=this.telemetryStats;for(const t of this._gifs.values())e.inMural.amount+=t.instances.size,e.inMural.distinctAmount+=t.instances.size>0?1:0,e.onScreen.amount+=t.instancesOnScreen.size,e.onScreen.totalMemorySize+=t.instancesOnScreen.size*t.totalMemorySize,t.isCached&&(e.onScreen.amountCached+=t.instancesOnScreen.size,e.onScreen.totalMemorySizeCached+=t.instancesOnScreen.size*t.totalMemorySize);return e}getStats(){const e=this.peekStats();return this.resetTelemetryStats(),e}resetTelemetryStats(){this.telemetryStats={gifDecoderVersion:this.telemetryStats.gifDecoderVersion,cacheSize:this.telemetryStats.cacheSize,cacheUsed:this.telemetryStats.cacheUsed,decodeRequests:{cacheMisses:0,total:0},onScreen:{amount:0,amountCached:0,totalMemorySize:0,totalMemorySizeCached:0},inMural:{amount:0,distinctAmount:0}}}get gifs(){return Array.from(this._gifs.values())}get running(){return this._running}}},3142:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createProfilerActions=void 0;t.createProfilerActions=e=>({gif:{getStats:()=>e.getStats(),peekStats:()=>e.peekStats()}})},9750:function(e,t,i){"use strict";var r=this&&this.__awaiter||function(e,t,i,r){return new(i||(i=Promise))((function(n,s){function fulfilled(e){try{step(r.next(e))}catch(e){s(e)}}function rejected(e){try{step(r.throw(e))}catch(e){s(e)}}function step(e){e.done?n(e.value):function adopt(e){return e instanceof i?e:new i((function(t){t(e)}))}(e.value).then(fulfilled,rejected)}step((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.createScreenshotActions=void 0;const n=i(3152),s=i(9118);t.createScreenshotActions=(e,t,i,a,o)=>{const l=new Set,d=((e,t)=>({canvas:{width:16,height:16},minimap:{width:16,height:16},ctxBackground:"white",drawExplicitShadows:e.drawExplicitShadows,detectContextLost:e.detectContextLost,getImageFromUrl:(i,r,n)=>{const s=e.getImageFromUrl(i,r,n),a=s.requestedImagePromise;return a&&(t.add(a),a.finally((()=>t.delete(a)))),s},textFunctions:e.textFunctions,onViewportChange:()=>{},renderScaleMultiplier:1,runtimeInfo:e.runtimeInfo,canvasFactory:e.canvasFactory,viewport:{x:0,y:0,zoom:1},gifProfiler:e.gifProfiler}))(i,l),h=Object.assign(Object.assign({},a),{ignoreDownloadProgress:!0});let c=null,u=0;const g={viewport:(t,i,r,n)=>e.screenshot.viewport(t,i,r,s.STATES_VISIBLE_BY_DEFAULT,n),only:(t,i,r)=>e.screenshot.only(t,i,s.STATES_VISIBLE_BY_DEFAULT,r),customWidgets:(e,i,a)=>r(void 0,void 0,void 0,(function*(){const{engine:r,astContext:g}=(()=>(c||(c=t(d,h),c.engine.debug.setUseCache(!1),c.engine.debug.setUseViewportOptimization(!1)),c))(),f=new Map,m=(0,n.mapWidgetsIds)(e,(e=>{const t=f.get(e),i=t||"unique-id-"+u++;return t||f.set(e,i),i}));try{o(m,r,d,g);const takeScreenshot=()=>r.screenshot.only(m.map((e=>e.id)),i,s.STATES_VISIBLE_BY_DEFAULT,a),e=yield takeScreenshot();if(0===l.size||0===a.imageDownloadTimeout)return e;void 0!==a.imageDownloadTimeout&&a.imageDownloadTimeout>=0?yield Promise.race([Promise.all([...l]),new Promise((e=>setTimeout(e,a.imageDownloadTimeout)))]):yield Promise.all([...l]);return yield takeScreenshot()}finally{m.forEach((e=>r.nodes.remove([e.id])))}}))};return{actions:g,onDestroy:()=>{c&&(c.destroyEngine(),c=null)}}}},5156:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createTextActions=void 0;const r=i(4086),n=i(3155),s=i(45),a=i(4424),o=i(6402),l=i(3993);t.createTextActions=e=>({measure:(t,i,r)=>{const n=(0,a.drawTextBox)({x:0,y:0,height:Number.MAX_SAFE_INTEGER,width:r},t.fontSize,t.textAlign,"top",0,(0,s.formatText)({fontFamily:t.fontFamily,color:t.color,bold:t.bold,italic:t.italic,strike:t.strike},i)),d=(0,o.convertTextBoxToWrappedTextBox)(e,n),h=d.wrappedText,c=(0,l.getTextLayout)(0,0,d.fontSize,h.lineHeight,h.ascent,h.descent,h.lines,h.anchor,!1);if(0===c.length)return{x:0,y:0,x1:0,y1:0};return{x:Math.min(...c.map((e=>e.bounds.x))),y:Math.min(...c.map((e=>e.bounds.y))),x1:Math.max(...c.map((e=>e.bounds.x1))),y1:Math.max(...c.map((e=>e.bounds.y1)))}},measureHtml:(t,i,s)=>{var a,o;(t.bold||t.underline||t.italic||t.strike)&&console.warn("measureHtml(): bold / underline / italic / strike parameters are ignored, any styling should be done using HTML tags in the received HTML");let l=(0,n.drawHtmlTextboxFromHtmlCode)("temp-tb",i,t.fontSize,t.fontFamily,t.color||"#000000",t.textAlign,void 0,e,null!==(a=t.lineHeightMultiplier)&&void 0!==a?a:r.CLASSIC_LINE_HEIGHT_MULTIPLIER);return s>=0&&l.width>s&&(l=(0,n.drawHtmlTextboxFromHtmlCode)("temp-tb",i,t.fontSize,t.fontFamily,t.color||"#000000",t.textAlign,s,e,null!==(o=t.lineHeightMultiplier)&&void 0!==o?o:r.CLASSIC_LINE_HEIGHT_MULTIPLIER)),{x:l.x,y:l.y,x1:l.x+l.width,y1:l.y+l.height}}})},7266:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getBase64FromDataUrlAsBuffer=t.getBase64FromDataUrl=t.isBase64DataUrl=t.createCanvasFromConfig=t.getWidgetForNodeWithoutHint=t.getWidgetForNode=t.getWidgetRefForNodeState=t.getWidgetRefForNode=t.getNodeState=void 0;const r=i(8247),n=i(4424),s={selected:4,"drag-over":2,hover:1,transform:5,scale:3,highlight:6,unread:7,"dragging-visual-feedback":8};t.getNodeState=e=>e?s[e]:0;t.getWidgetRefForNode=(e,t=null)=>null===e?null:{bbox:{x:e.aabbSelfOnlyWithoutRenderOverflow.x,y:e.aabbSelfOnlyWithoutRenderOverflow.y,x1:e.aabbSelfOnlyWithoutRenderOverflow.x1,y1:e.aabbSelfOnlyWithoutRenderOverflow.y1},id:e.externalId,hint:t,width:e.width,height:e.height};t.getWidgetRefForNodeState=e=>{const t=e.border,{x:i,y:r,width:n,height:s,scale:a}=e.transform,o=i-t*a,l=r-t*a;return{bbox:{x:o,y:l,x1:o+(n+2*t)*a,y1:l+(s+2*t)*a},id:e.externalId,hint:null,width:n,height:s}};t.getWidgetForNode=e=>{const i=[];let r=e;for(;r&&r.hint!==n.WIDGET_HINT;)r.hint&&"_"!==r.hint.charAt(0)&&i.push(r.hint),r=r.parent;return(0,t.getWidgetRefForNode)(r,i.length>0?i.join("."):null)};t.getWidgetForNodeWithoutHint=e=>{let i=e;for(;i&&i.hint!==n.WIDGET_HINT;)i=i.parent;return(0,t.getWidgetRefForNode)(i,null)};t.createCanvasFromConfig=(e,t,i)=>{const r=e.createCanvas(t.width,t.height,void 0,i);return t.className&&(r.canvas.className=t.className),t.ariaLabel&&(r.canvas.ariaLabel=t.ariaLabel),void 0!==t.tabIndex&&(r.canvas.tabIndex=t.tabIndex),r};t.isBase64DataUrl=e=>e.includes("base64,");t.getBase64FromDataUrl=e=>(0,t.isBase64DataUrl)(e)?e.split(",")[1]:e;t.getBase64FromDataUrlAsBuffer=e=>(0,r.decode)((0,t.getBase64FromDataUrl)(e))},9118:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getNodeStatesFromWidgets=t.buildNodeGroupHierarchy=t.buildSingleNodeGroup=t.STATES_VISIBLE_BY_DEFAULT=void 0;const r=i(4424),n=i(2807),s=i(4183),a=i(7266);function getMaxStackingLayerFromHint(e){return e.reduce(((e,t)=>Math.max(e,function getStackingLayerFromHintAndState(e,t){return"comment"===e?4===t?3:2:"hidden"===e?1:0}(t.hint,t.state))),0)}function buildSelectionShapes(e){if(!e)return null;const t=[];for(let i=0;i<e.length;i++){const r=e[i];t.push({type:"path",path:new Path2D(r.path),strokeWidth:r.strokeWidth,strokeColor:r.strokeColor,strokePattern:r.strokePattern,strokeLineDashOffset:r.strokeStyleOffset,backgroundColor:r.backgroundColor||"",x:0,y:0,rotation:0,scale:1})}return t}t.STATES_VISIBLE_BY_DEFAULT=[0,3];const buildAstGroupNodeState=(e,t)=>{const{id:i,x:n,y:s,width:o,height:l,rotation:d,children:h,border:c}=e,u="WidgetPrimitive"===e.type,g=u?r.WIDGET_HINT:e.hint,f=u?1:e.scale,m=u?e.stackingOrder:0,v=u?{}:e.animations,y=u?void 0:e.clip,w=u?void 0:e.state,x=u?e.minimapPath:void 0,b=u?e.selectionPaths:void 0,C=u&&e.parentId?(0,r.generateWidgetsContainerId)(e.parentId):null,A=[],I=[],S=[],pushPrimitives=()=>{A.push({animations:v,parentId:null,border:0,children:[],clip:y||null,drawingAst:[...S],externalId:`${i}-chunk-${A.length}`,hint:null,stackingLayer:0,stackingOrder:0,state:0,transform:{height:l,rotation:0,scale:1,width:o,x:0,y:0},minimapShape:null,selectionShapes:null,dontCleanChildrenOnUpdate:!1,dummy:!1}),S.length=0};t||h.forEach((e=>{"Group"==e.type?(S.length&&pushPrimitives(),A.push(buildAstGroupNodeState(e,t))):A.length?S.push(e):I.push(e)})),S.length&&pushPrimitives();return{animations:v,parentId:C,externalId:i,hint:g,state:(0,a.getNodeState)(w),stackingLayer:getMaxStackingLayerFromHint(A),stackingOrder:m,clip:I.length&&y||null,transform:{x:n,y:s,width:o,height:l,scale:f,rotation:d},drawingAst:I,children:A,minimapShape:x?{type:"path",path:new Path2D(x)}:null,border:c,selectionShapes:buildSelectionShapes(b),dontCleanChildrenOnUpdate:g===r.WIDGETS_CONTAINER_HINT,dummy:!1}};t.buildSingleNodeGroup=(e,i)=>{const{externalId:n,hint:a}=e,o=new s.AstGroupNode(n,i);o.init(e);const l=a===r.WIDGET_HINT;return o.isPartialNode=!l,o.ownLayer=l?1:0,o.visible=!o.dummy&&t.STATES_VISIBLE_BY_DEFAULT.includes(o.state),o};t.buildNodeGroupHierarchy=(e,i)=>{const r=(0,t.buildSingleNodeGroup)(e,i);return e.children.map((e=>(0,t.buildNodeGroupHierarchy)(e,i))).forEach((e=>r.addChild(e))),r};t.getNodeStatesFromWidgets=(e,t,i,r,s,a,o,l)=>{var d,h,c;if(!t.length)return[];const u={hideContent:!0,includeStates:!0,skipSorting:!0,labelTypes:s,muralId:a,onAfterParse:null===(d=i.hooks)||void 0===d?void 0:d.onAfterParse,onBeforeParse:null===(h=i.hooks)||void 0===h?void 0:h.onBeforeParse,onBeforeRender:null===(c=i.hooks)||void 0===c?void 0:c.onBeforeRender,resizeImages:!1,darkerHidden:o.darkerHidden};return(0,n.convertWidgetsToWidgetPrimitives)(e,i.textFunctions,t,u,l).map((e=>{r(e);return buildAstGroupNodeState(e,!!o.skipChildren)}))}},2765:function(e,t,i){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.createWidgetActions=void 0;const n=r(i(738)),s=i(4424),a=i(1098),o=i(1106),l=i(7266),d=i(7813),hasParentIn=(e,t)=>{let i=t;for(;i;){if(e.includes(i.externalId))return!0;i=i.parent}return!1},isVisibleInHierarchy=e=>{let t=e;for(;t;){if(!t.visible)return!1;t=t.parent}return!0};t.createWidgetActions=(e,t,i,r,h)=>{const c=new a.WidgetCache;c.set(h);const u=new d.WidgetsPerLabelType;u.set(h);const g={add:(...e)=>{c.set(e),u.set(e),t({toAddOrUpdate:e})},remove:(...e)=>{c.delete(e),u.delete(e),t({toRemove:e})},update:(...e)=>{const i=e.filter((e=>(0,o.isNotNil)(c.get(e.id))));c.set(i),u.set(i),t({toAddOrUpdate:i})},hide:e.nodes.hide,show:e.nodes.show,toggleState:(t,i,r,n=!0)=>{e.nodes.toggleState(t,(0,l.getNodeState)(i),r,n)},setDrawTopSameLayer:(t,i)=>{e.nodes.setDrawTopSameLayer(t,i)},setLoadingProgress:(t,i,r)=>{e.nodes.setLoadingProgress(t,i,r)},setScaleConstraint:(t,i,r,n)=>e.nodes.setScaleConstraint(t,i,r,(0,l.getNodeState)(n)),get:e=>c.get(e)||null,getAllInfoAt:(t,i,r)=>e.nodes.getAllAt(t,i,r,!!r).filter((e=>isVisibleInHierarchy(e)&&2!==e.state)).map(l.getWidgetForNode).filter(o.isNotNil),getAt:(t,i,r={})=>{const{excludeIds:n=[]}=r,s=e.nodes.getAt(t,i,r.tolerance,(e=>isVisibleInHierarchy(e)&&2!==e.state&&(!n.length||!hasParentIn(n,e))));return(0,l.getWidgetForNode)(s)},getAllAtRect:(t,i=[])=>{const r=new Set;return e.nodes.getAllAtRect(t.x,t.y,t.x1,t.y1,(e=>{if(isVisibleInHierarchy(e)&&2!==e.state&&(!i.length||!hasParentIn(i,e))){const t=(e=>{let t=e;for(;t;){if(t.hint===s.WIDGET_HINT)return t;t=t.parent}return null})(e);if(null!==t&&!r.has(t.externalId))return r.add(t.externalId),!0}return!1})).map(l.getWidgetForNodeWithoutHint).filter(o.isNotNil)},getAllAtRectUnordered:t=>{const i=[];return e.nodes.getAllNonPartialNodesAtRectUnordered(t.x,t.y,t.x1,t.y1,s.WIDGET_HINT).forEach((e=>{if(isVisibleInHierarchy(e)){const t=(0,l.getWidgetForNodeWithoutHint)(e);t&&i.push(t)}})),i},getAllRect:()=>{const t=e.nodes.getAllRect();return{x:t.x,y:t.y,x1:t.x+t.width,y1:t.y+t.height}},getHintInfo:(t,i)=>{const r=(0,l.getWidgetRefForNode)(e.nodes.getSafe(t,i),i);return r?Object.assign(Object.assign({},r),{id:t}):r},getInfo:t=>(0,l.getWidgetForNode)(e.nodes.getSafe(t)),moveTo:(e,t,i)=>{const r=c.get(e);r&&g.update(Object.assign(Object.assign({},r),{x:t,y:i}))},highlight:(t,i,r=!0)=>e.nodes.toggleState(t,6,i,r),setAlpha:(t,i)=>e.nodes.setAlpha(t,i),setCommentPulse:(t,i,r)=>e.nodes.setPulse(t,i,r),setIntroScale:(t,i,r,n,s)=>e.nodes.setIntroScale(t,i,r,n,s),labels:{add:e=>{r[e.id]=(0,n.default)(e);const i=u.get(e.id);i&&t({toReparse:[...i]})},update:e=>{r[e.id]=(0,n.default)(e);const i=u.get(e.id);i&&t({toReparse:[...i]})}},invalidate:(...e)=>{t({toReparse:e})},measure:e=>i(e),startTransientActions:(...t)=>e.nodes.startTransientActions(...t)};return g}},1384:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.buildWidgetsProcessor=void 0;const r=i(1106),n=i(6564);t.buildWidgetsProcessor=(e,t,i)=>{const s=new Map;return a=>((e,t,i,s)=>{if(void 0!==s.toAddOrUpdate){const r=[];for(const t of s.toAddOrUpdate){const s=i.get(t.id);s&&(0,n.tryToApplyTrivialUpdate)(s,t,e)||r.push(t),i.set(t.id,t)}t(r)}void 0!==s.toReparse&&t(s.toReparse.map((e=>i.get(e))).filter(r.isNotNil));void 0!==s.toRemove&&(e.nodes.remove(s.toRemove),s.toRemove.forEach((e=>i.delete(e))))})(e,i,s,t.apply(a))}},6564:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.tryToApplyTrivialUpdate=void 0;const r=i(3588),n=i(4424),s=["parentId"],a=new Set(["label","color","strokeWidth","strokeColor","verticalAlign","borderColor","objectFit","title","tip","fontSize","bold","backgroundColor","path","fontFamily","border","footer","link","mask","text","italic","background","shapeType","strokeSize","strokeStyle","columns","group","round","textAlign","parentId","naturalWidth","naturalHeight","titleFontSize","layout","showTitle","hidden","minLines","strike","underline","fixedWidth","textType","labels","stackable","arrowType","points","startRefId","endRefId","stickerURL","aspectRatio","dlpDownloadRestricted","contentPrivate","photoURL","thumbURL","showCaption","privateImage","filledPath","filled","originalWidth","originalHeight","name","paths","replies","currentPage","previewUrl","rowId","rowSpan","columnId","colSpan","textContent","borderWidth","rows"]),hasNonTrivialUpdate=(e,t)=>e.type!==t.type||(e.height!==t.height||e.width!==t.width||((e,t)=>{const i=e.properties,r=t.properties;if(i===r)return!1;for(const e in i){const t=e;if(i[t]!==r[t]&&s.indexOf(t)<0&&a.has(t))return!0}for(const e in r){const t=e;if(!(t in i)&&a.has(t))return!0}return!1})(e,t));t.tryToApplyTrivialUpdate=(e,t,i)=>{if(hasNonTrivialUpdate(e,t))return!1;const s=i.nodes.getUnsafe(e.id);if(null===s)return console.error("Tried to apply a trivial update to a widget that wasn't added to the engine first, this SHOULD NOT be possible: "+e.id),!1;if(t.properties.parentId!==e.properties.parentId){const e=t.properties.parentId?(0,n.generateWidgetsContainerId)(t.properties.parentId):"";if(!i.nodes.setParent(t.id,e))return!1}const a=t.x-e.x,o=t.y-e.y,l=(0,r.normalizeRotation)(t.rotation||0),d=t.stackingOrder;return 0===a&&0===o||s.setPosition(s.x+a,s.y+o),l!==s.rotation&&s.setRotation(l),d!==s.stackingOrder&&s.setStackingOrder(d),!0}},7813:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WidgetsPerLabelType=void 0;const r=i(2575);t.WidgetsPerLabelType=class WidgetsPerLabelType{constructor(){this.widgetsByLabelType=new Map,this.labelTypesPerWidget=new Map}get(e){return this.widgetsByLabelType.get(e)}delete(e){e.forEach((e=>{const t=this.labelTypesPerWidget.get(e);t&&(t.forEach((t=>{const i=this.widgetsByLabelType.get(t);i&&(i.delete(e),0===i.size&&this.widgetsByLabelType.delete(t))})),this.labelTypesPerWidget.delete(e))}))}set(e){e.forEach((e=>{if((0,r.isSticky)(e)){const t=e.properties.labels;if(!t)return void this.delete([e.id]);const i=this.labelTypesPerWidget.get(e.id);if(i){[...i].filter((e=>!t.some((t=>t.type===e)))).forEach((t=>{var i,r;null===(i=this.widgetsByLabelType.get(t))||void 0===i||i.delete(e.id),null===(r=this.labelTypesPerWidget.get(e.id))||void 0===r||r.delete(t)}))}t.forEach((t=>{const r=i||new Set;r.add(t.type),i||this.labelTypesPerWidget.set(e.id,r);const n=this.widgetsByLabelType.get(t.type),s=n||new Set;s.add(e.id),n||this.widgetsByLabelType.set(t.type,s)}))}}))}}},1193:(e,t,i)=>{"use strict";function Worker_fn(){return new Worker(i.p+"gif.worker.1e269737.js")}i.r(t),i.d(t,{default:()=>Worker_fn})}},__webpack_module_cache__={};function __webpack_require__(e){var t=__webpack_module_cache__[e];if(void 0!==t)return t.exports;var i=__webpack_module_cache__[e]={exports:{}};return __webpack_modules__[e].call(i.exports,i,i.exports,__webpack_require__),i.exports}(()=>{__webpack_require__.d=(e,t)=>{for(var i in t)__webpack_require__.o(t,i)&&!__webpack_require__.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})}})(),(()=>{__webpack_require__.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}()})(),(()=>{__webpack_require__.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t)})(),(()=>{__webpack_require__.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}})(),(()=>{var e;__webpack_require__.g.importScripts&&(e=__webpack_require__.g.location+"");var t=__webpack_require__.g.document;if(!e&&t&&(t.currentScript&&(e=t.currentScript.src),!e)){var i=t.getElementsByTagName("script");i.length&&(e=i[i.length-1].src)}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),__webpack_require__.p=e})();var __webpack_exports__={};(()=>{"use strict";const e=__webpack_require__(3824);Object.assign(window,{createEngine:e.createEngineBrowser})})()})();
//# sourceMappingURL=bundle.1e269737.js.map